!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("chart.js"),require("@angular/core"),require("chart.piecelabel.js"),require("@ajf/core/utils")):"function"==typeof define&&define.amd?define("@ajf/core/chart",["exports","chart.js","@angular/core","chart.piecelabel.js","@ajf/core/utils"],e):e(((t=t||self).ajf=t.ajf||{},t.ajf.core=t.ajf.core||{},t.ajf.core.chart={}),t.Chart,t.ng.core,0,t.ng.core.utils)}(this,(function(t,e,r,a,n){"use strict";var i="default"in e?e.default:e,s=i||e,h=function(){return(h=Object.assign||function t(e){for(var r,a=1,n=arguments.length;a<n;a++)for(var i in r=arguments[a])Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);return e}).apply(this,arguments)},o=i||e,l=function(){function t(t,e){this._el=t,this._renderer=e,this._chartTypesNeedPoints=["scatter","bubble"]}return t.prototype.ngAfterViewInit=function(){this._rebuildChart()},t.prototype.ngOnChanges=function(t){"chartType"in t?this._rebuildChart():("options"in t||"data"in t)&&this._updateChart()},t.prototype._fixData=function(t,e){var r=this,a=n.deepCopy(e),i=0;(a.datasets||[]).forEach((function(e){null==e.label&&(e.label=""),i=Math.max(i,(e.data||[]).length),r._chartTypesNeedPoints.indexOf(null!=e.type?e.type:t)>-1&&(e.data=(e.data||[]).map((function(t,e){return"number"==typeof t?{x:e,y:t,r:t}:t})))}));var s=a.labels||[];if(i>0&&s.length<i){for(var h=s.length;h<i;h++)s.push("");a.labels=s}return a},t.prototype._updateChart=function(){null==this._chart?this._rebuildChart():(this._chart.options=h(h({},n.deepCopy(this._chart.options)),n.deepCopy(this.options||{})),this._chart.data=h(h({},n.deepCopy(this._chart.data)),n.deepCopy(this.data)),this._chart.update())},t.prototype._rebuildChart=function(){if(null!=this._chart&&(this._chart.destroy(),this._chart=null),null!=this._chartCanvasElement&&(this._renderer.removeChild(this._el.nativeElement,this._chartCanvasElement),this._chartCanvasElement=null),null!=this.data){this._chartCanvasElement=this._renderer.createElement("canvas"),this._renderer.setStyle(this._chartCanvasElement,"width","inherit"),this._renderer.setStyle(this._chartCanvasElement,"height","inherit"),this._renderer.appendChild(this._el.nativeElement,this._chartCanvasElement);var t=this._chartCanvasElement.getContext("2d");this._chart=new o(t,{type:this.chartType,data:this._fixData(this.chartType,this.data),options:this._fixChartOptions(this.options)})}},t.prototype._fixChartOptions=function(t){if(null==(t=t||{}).scales&&(t.scales={xAxes:[],yAxes:[]}),null==t.scales.xAxes&&(t.scales.xAxes=[]),null==t.scales.yAxes&&(t.scales.yAxes=[]),"pie"==this.chartType){var e=t;return e.pieceLabel={render:function(t){return t.label?t.label+":"+t.value:t.value},position:"outside"},e}return t},t.decorators=[{type:r.Component,args:[{selector:"ajf-chart",template:"",changeDetection:r.ChangeDetectionStrategy.OnPush,encapsulation:r.ViewEncapsulation.None,styles:["ajf-chart{display:block;width:inherit;height:inherit;position:relative}\n"]}]}],t.ctorParameters=function(){return[{type:r.ElementRef},{type:r.Renderer2}]},t.propDecorators={data:[{type:r.Input}],options:[{type:r.Input}],chartType:[{type:r.Input}]},t}(),c=function(){function t(){}return t.decorators=[{type:r.NgModule,args:[{declarations:[l],exports:[l]}]}],t}();
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
t.AjfChartComponent=l,t.AjfChartModule=c,t.registerChartPlugins=function p(t){null!=t&&t.length>0&&t.forEach((function(t){return s.plugins.register(t)}))}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */,Object.defineProperty(t,"__esModule",{value:!0})}));