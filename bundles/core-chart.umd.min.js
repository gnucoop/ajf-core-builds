/**
 * @license
 * Copyright (C) 2018 Gnucoop soc. coop.
 *
 * This file is part of the Advanced JSON forms (ajf).
 *
 * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
 * modify it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the License,
 * or (at your option) any later version.
 *
 * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
 * General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with Advanced JSON forms (ajf).
 * If not, see http://www.gnu.org/licenses/.
 *
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("chart.js"),require("chart.piecelabel.js"),require("@ajf/core/utils")):"function"==typeof define&&define.amd?define("@ajf/core/chart",["exports","@angular/core","chart.js","chart.piecelabel.js","@ajf/core/utils"],e):e(((t=t||self).ajf=t.ajf||{},t.ajf.core=t.ajf.core||{},t.ajf.core.chart={}),t.ng.core,t.chartJs,t.chartPiecelabel,t.ajf.core.utils)}(this,function(t,e,a,r,h){"use strict";var n="default"in a?a.default:a,i=function(){return(i=Object.assign||function(t){for(var e,a=1,r=arguments.length;a<r;a++)for(var n in e=arguments[a])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},s=n||a,o=(l.prototype.ngAfterViewInit=function(){this._rebuildChart()},l.prototype.ngOnChanges=function(t){"chartType"in t?this._rebuildChart():("options"in t||"data"in t)&&this._updateChart()},l.prototype._fixData=function(a,t){var r=this,e=h.deepCopy(t),n=0;(e.datasets||[]).forEach(function(t){null==t.label&&(t.label=""),n=Math.max(n,(t.data||[]).length);var e=null!=t.type?t.type:a;-1<r._chartTypesNeedPoints.indexOf(e)&&(t.data=(t.data||[]).map(function(t,e){return"number"==typeof t?{x:e,y:t,r:t}:t}))});var i=e.labels||[];if(0<n&&i.length<n){for(var s=i.length;s<n;s++)i.push("");e.labels=i}return e},l.prototype._updateChart=function(){null==this._chart?this._rebuildChart():(this._chart.options=i({},h.deepCopy(this._chart.options),h.deepCopy(this.options||{})),this._chart.data=i({},h.deepCopy(this._chart.data),h.deepCopy(this.data)),this._chart.update())},l.prototype._rebuildChart=function(){if(null!=this._chart&&(this._chart.destroy(),this._chart=null),null!=this._chartCanvasElement&&(this._renderer.removeChild(this._el.nativeElement,this._chartCanvasElement),this._chartCanvasElement=null),null!=this.data){this._chartCanvasElement=this._renderer.createElement("canvas"),this._renderer.setStyle(this._chartCanvasElement,"width","inherit"),this._renderer.setStyle(this._chartCanvasElement,"height","inherit"),this._renderer.appendChild(this._el.nativeElement,this._chartCanvasElement);var t=this._chartCanvasElement.getContext("2d");this._chart=new s(t,{type:this.chartType,data:this._fixData(this.chartType,this.data),options:this._fixChartOptions(this.options)})}},l.prototype._fixChartOptions=function(t){if(null==(t=t||{}).scales&&(t.scales={xAxes:[],yAxes:[]}),null==t.scales.xAxes&&(t.scales.xAxes=[]),null==t.scales.yAxes&&(t.scales.yAxes=[]),"pie"!=this.chartType)return t;var e=t;return e.pieceLabel={render:function(t){return t.label?t.label+":"+t.value:t.value},position:"outside"},e},l.decorators=[{type:e.Component,args:[{selector:"ajf-chart",template:"",styles:["ajf-chart{display:block;width:inherit;height:inherit;position:relative}"],changeDetection:e.ChangeDetectionStrategy.OnPush,encapsulation:e.ViewEncapsulation.None}]}],l.ctorParameters=function(){return[{type:e.ElementRef},{type:e.Renderer2}]},l.propDecorators={data:[{type:e.Input}],options:[{type:e.Input}],chartType:[{type:e.Input}]},l);function l(t,e){this._el=t,this._renderer=e,this._chartTypesNeedPoints=["scatter","bubble"]}var c=(p.decorators=[{type:e.NgModule,args:[{declarations:[o],exports:[o]}]}],p);function p(){}t.AjfChartComponent=o,t.AjfChartModule=c,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=core-chart.umd.min.js.map
