!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("chart.js"),require("@angular/core"),require("@ajf/core/utils")):"function"==typeof define&&define.amd?define("@ajf/core/chart",["exports","chart.js","@angular/core","@ajf/core/utils"],t):t(((e=e||self).ajf=e.ajf||{},e.ajf.core=e.ajf.core||{},e.ajf.core.chart={}),e.Chart,e.ng.core,e.ng.core.utils)}(this,(function(e,t,n,i){"use strict";
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
var r,a=function(){function e(e,t){this._el=e,this._renderer=t,this._chartTypesNeedPoints=["scatter","bubble"]}return e.prototype.ngAfterViewInit=function(){this._rebuildChart()},e.prototype.ngOnChanges=function(e){"chartType"in e?this._rebuildChart():("options"in e||"data"in e)&&this._updateChart()},e.prototype._fixData=function(e,t){var n=this,r=i.deepCopy(t),a=0;(r.datasets||[]).forEach((function(t){null==t.label&&(t.label=""),a=Math.max(a,(t.data||[]).length),n._chartTypesNeedPoints.indexOf(null!=t.type?t.type:e)>-1&&(t.data=(t.data||[]).map((function(e,t){return"number"==typeof e?{x:t,y:e,r:e}:e})))}));var o=r.labels||[];if(a>0&&o.length<a){for(var s=o.length;s<a;s++)o.push("");r.labels=o}return r},e.prototype._updateChart=function(){null==this._chart?this._rebuildChart():(this._chart.options=Object.assign(Object.assign({},i.deepCopy(this._chart.options)),i.deepCopy(this.options||{})),this._chart.data=Object.assign(Object.assign({},i.deepCopy(this._chart.data)),i.deepCopy(this.data)),this._chart.update())},e.prototype._rebuildChart=function(){if(null!=this._chart&&(this._chart.destroy(),this._chart=null),null!=this._chartCanvasElement&&(this._renderer.removeChild(this._el.nativeElement,this._chartCanvasElement),this._chartCanvasElement=null),null!=this.data){this._chartCanvasElement=this._renderer.createElement("canvas"),this._renderer.setStyle(this._chartCanvasElement,"width","inherit"),this._renderer.setStyle(this._chartCanvasElement,"height","inherit"),this._renderer.appendChild(this._el.nativeElement,this._chartCanvasElement);var e=this._chartCanvasElement.getContext("2d");this._chart=new t.Chart(e,{type:this.chartType,data:this._fixData(this.chartType,this.data),options:this._fixChartOptions(this.options)})}},e.prototype._fixChartOptions=function(e){if((e=e||{}).legendCallback){var t="string"==typeof e.legendCallback?new Function(e.legendCallback):e.legendCallback;e.legendCallback=t}if(e.onHover){var n="string"==typeof e.onHover?new Function(e.onHover):e.onHover;e.onHover=n}if(e.onClick){var i="string"==typeof e.onClick?new Function(e.onClick):e.onClick;e.onClick=i}if(e.onResize){var r="string"==typeof e.onResize?new Function(e.onResize):e.onResize;e.onResize=r}if(e.legend){var a=e.legend;if(a.onClick&&(i="string"==typeof a.onClick?new Function(a.onClick):a.onClick,a.onClick=i),a.onHover&&(n="string"==typeof a.onHover?new Function(a.onHover):a.onHover,a.onHover=n),a.onLeave){var o="string"==typeof a.onLeave?new Function(a.onLeave):a.onLeave;a.onLeave=o}if(a.labels){var s=a.labels;if(s.generateLabels){var l="string"==typeof s.generateLabels?new Function(s.generateLabels):s.generateLabels;s.generateLabels=l}if(s.filter){var c="string"==typeof s.filter?new Function(s.filter):s.filter;s.filter=c}}}if(e.tooltips){var h=e.tooltips;if(h.custom){var f="string"==typeof h.custom?new Function(h.custom):h.custom;h.custom=f}if(h.callbacks){var p=h.callbacks;for(var u in p){var d=p[u];p[u]="string"==typeof d?new Function(d):d}}if(h.filter&&(c="string"==typeof h.filter?new Function(h.filter):h.filter,h.filter=c),h.itemSort){var v="string"==typeof h.itemSort?new Function(h.itemSort):h.itemSort;h.itemSort=v}}if(e.hover){var g=e.hover;g.onHover&&(n="string"==typeof g.onHover?new Function(g.onHover):g.onHover,g.onHover=n)}if(e.animation){var y=e.animation;if(y.onProgress){var C="string"==typeof y.onProgress?new Function(y.onProgress):y.onProgress;y.onProgress=C}if(y.onComplete){var b="string"==typeof y.onComplete?new Function(y.onComplete):y.onComplete;y.onComplete=b}}if(null==e.scales&&(e.scales={xAxes:[],yAxes:[]}),null==e.scales.xAxes&&(e.scales.xAxes=[]),null==e.scales.yAxes&&(e.scales.yAxes=[]),e.scales.yAxes.forEach((function(e){if(e.ticks&&e.ticks.callback){var t="string"==typeof e.ticks.callback?new Function(e.ticks.callback):e.ticks.callback;e.ticks.callback=t}})),e.scales.xAxes.forEach((function(e){if(e.ticks&&e.ticks.callback){var t="string"==typeof e.ticks.callback?new Function(e.ticks.callback):e.ticks.callback;e.ticks.callback=t}})),"pie"==this.chartType){var _=e;return _.pieceLabel={render:function(e){return e.label?e.label+":"+e.value:e.value},position:"outside"},_}return e},e}();a.decorators=[{type:n.Component,args:[{selector:"ajf-chart",template:"",changeDetection:n.ChangeDetectionStrategy.OnPush,encapsulation:n.ViewEncapsulation.None,styles:["ajf-chart{display:block;width:inherit;height:inherit;position:relative}\n"]}]}],a.ctorParameters=function(){return[{type:n.ElementRef},{type:n.Renderer2}]},a.propDecorators={data:[{type:n.Input}],options:[{type:n.Input}],chartType:[{type:n.Input}]},(r=function r(){}).decorators=[{type:n.NgModule,args:[{declarations:[a],exports:[a]}]}],
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
e.AjfChartComponent=a,e.AjfChartModule=r,e.registerChartPlugins=function o(e){null!=e&&e.length>0&&e.forEach((function(e){return t.Chart.plugins.register(e)}))},Object.defineProperty(e,"__esModule",{value:!0})}));