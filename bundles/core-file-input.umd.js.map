{"version":3,"file":"core-file-input.umd.js","sources":["../../../../../../src/core/file-input/file.ts","../../../../../../src/core/file-input/file-input.ts","../../../../../../src/core/file-input/file-input-module.ts","../../../../../../src/core/file-input/public-api.ts","../../../../../../src/core/file-input/index.ts"],"sourcesContent":["/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport interface AjfFile {\n  name: string;\n  size: number;\n  type: string;\n  content: string;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  ContentChildren,\n  Directive,\n  ElementRef,\n  EventEmitter,\n  forwardRef,\n  Input,\n  OnDestroy,\n  Output,\n  QueryList,\n  ViewChild,\n  ViewContainerRef,\n  ViewEncapsulation,\n} from '@angular/core';\nimport {ControlValueAccessor, NG_VALUE_ACCESSOR} from '@angular/forms';\nimport {DomSanitizer, SafeResourceUrl} from '@angular/platform-browser';\nimport {Observable, Subscription} from 'rxjs';\nimport {filter} from 'rxjs/operators';\n\nimport {AjfFile} from './file';\n\n@Directive({selector: '[ajfDropMessage]'})\nexport class AjfDropMessage {\n}\n\n@Directive({\n  selector: '[ajfFilePreview]',\n  exportAs: 'ajfFilePreview',\n})\nexport class AjfFilePreview implements OnDestroy {\n  private _value: AjfFile;\n  get value(): AjfFile {\n    return this._value;\n  }\n\n  private _valueSub = Subscription.EMPTY;\n\n  constructor(vcr: ViewContainerRef) {\n    const input = vcr.parentInjector.get(AjfFileInput, null);\n    if (input) {\n      this._value = input.value;\n      this._valueSub = input.valueChange\n                           .pipe(\n                               filter(value => value != null),\n                               )\n                           .subscribe(value => {\n                             this._value = value as AjfFile;\n                           });\n    }\n  }\n\n  ngOnDestroy(): void {\n    this._valueSub.unsubscribe();\n  }\n}\n\n@Component({\n  selector: 'ajf-file-input',\n  templateUrl: './file-input.html',\n  styleUrls: ['./file-input.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n  host: {\n    '[class.ajf-file-input]': 'true',\n  },\n  providers: [{\n    provide: NG_VALUE_ACCESSOR,\n    useExisting: forwardRef(() => AjfFileInput),\n    multi: true,\n  }],\n})\nexport class AjfFileInput implements ControlValueAccessor {\n  @ContentChildren(AjfDropMessage, {descendants: false})\n  _dropMessageChildren: QueryList<AjfDropMessage>;\n  @ContentChildren(AjfFilePreview, {descendants: false})\n  _filePreviewChildren: QueryList<AjfFilePreview>;\n  @ViewChild('nativeInput') _nativeInput: ElementRef<HTMLInputElement>;\n\n  readonly fileIcon: SafeResourceUrl;\n  readonly removeIcon: SafeResourceUrl;\n\n  @Input() accept: string;\n\n  private _value: any;\n  get value(): any {\n    return this._value;\n  }\n  @Input()\n  set value(value: any) {\n    if (value instanceof File) {\n      this._processFileUpload(value);\n    } else if (value instanceof FileList) {\n      if (value.length === 1) {\n        this._processFileUpload(value[0]);\n      }\n    } else if (\n        value == null ||\n        (isAjfFile(value) && isValidMimeType((value as AjfFile).type, this.accept))) {\n      this._value = value;\n      this._valueChange.emit(this._value);\n      this._cdr.detectChanges();\n    }\n  }\n\n  private _valueChange = new EventEmitter<AjfFile|undefined>();\n  @Output() readonly valueChange: Observable<AjfFile|undefined> = this._valueChange.asObservable();\n\n  /** The method to be called in order to update ngModel. */\n  _controlValueAccessorChangeFn: (value: any) => void = () => {};\n\n  /** onTouch function registered via registerOnTouch (ControlValueAccessor). */\n  _onTouched: () => any = () => {};\n\n  constructor(domSanitizer: DomSanitizer, private _cdr: ChangeDetectorRef) {\n    this.fileIcon = domSanitizer.bypassSecurityTrustResourceUrl(fileIcon);\n    this.removeIcon = domSanitizer.bypassSecurityTrustResourceUrl(trashIcon);\n  }\n\n  onFileDrop(files: FileList): void {\n    if (files.length !== 1) {\n      return;\n    }\n    const file = files[0];\n    this._processFileUpload(file);\n  }\n\n  onSelectFile(): void {\n    const files = this._nativeInput.nativeElement.files;\n    if (files == null) {\n      return;\n    }\n    const file = files.item(0);\n    if (file == null) {\n      return;\n    }\n    this._processFileUpload(files.item(0) as File);\n  }\n\n  registerOnChange(fn: any): void {\n    this._controlValueAccessorChangeFn = fn;\n  }\n\n  registerOnTouched(fn: any): void {\n    this._onTouched = fn;\n  }\n\n  resetValue(): void {\n    this.value = null;\n    this._nativeInput.nativeElement.value = '';\n  }\n\n  triggerNativeInput(): void {\n    if (!this._nativeInput) {\n      return;\n    }\n    this._nativeInput.nativeElement.click();\n  }\n\n  writeValue(value: any) {\n    this.value = value;\n    this._cdr.markForCheck();\n  }\n\n  private _processFileUpload(file: File): void {\n    const reader = new FileReader();\n    const {name, size, type} = file;\n    if (!isValidMimeType(type, this.accept)) {\n      return;\n    }\n    reader.onload = (e: ProgressEvent<FileReader>) => {\n      const content = reader.result;\n      if (typeof content !== 'string') {\n        return;\n      }\n      this.value = {name, size, type, content};\n      if (this._controlValueAccessorChangeFn != null) {\n        this._controlValueAccessorChangeFn(this.value);\n      }\n    };\n    reader.readAsDataURL(file);\n  }\n}\n\nconst ajfFileKeys = JSON.stringify(['content', 'name', 'size', 'type']);\n\n/**\n * Test if a value is an AjfFile interface.\n */\nfunction isAjfFile(value: any): boolean {\n  if (typeof value !== 'object') {\n    return false;\n  }\n  const keys = Object.keys(value).sort((a, b) => a.localeCompare(b));\n  return JSON.stringify(keys) === ajfFileKeys;\n}\n\nfunction isValidMimeType(mimeType: string, accept: string): boolean {\n  if (accept == null) {\n    return true;\n  }\n  let terminate = true;\n  if (accept.endsWith('*')) {\n    accept = accept.slice(0, accept.length - 1);\n    terminate = false;\n  }\n  const regExStr = '^' + accept + (terminate ? '$' : '');\n  const regEx = new RegExp(regExStr);\n  return regEx.test(mimeType);\n}\n\nexport const fileIcon = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwM' +\n    'C9zdmciIHdpZHRoPSIxNzA2LjY2NyIgaGVpZ2h0PSIxNzA2LjY2NyIgdmlld0JveD0iMCAwIDEyODAgMTI4MCIgcHJl' +\n    'c2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQgbWVldCI+PHBhdGggZD0iTTI4MyAxMDNjLTE3LjcgMi40LTMzLjkgMTM' +\n    'uOC00Mi4yIDI5LjYtNy40IDE0LTYuOC0zMi41LTYuOCA0OTcuNHMtLjYgNDgzLjQgNi44IDQ5Ny40YzYuOCAxMy4xID' +\n    'E4LjYgMjIuNyAzMy43IDI3LjhsNyAyLjNoNzE3bDctMi4zYzE1LjEtNS4xIDI2LjktMTQuNyAzMy43LTI3LjggNy40L' +\n    'TE0IDYuOCAxOS4yIDYuOC0zNzYuNlYzOTQuMWwtMTExLjItLjMtMTExLjMtLjQtOC41LTIuM2MtMjMuOC02LjUtNDMt' +\n    'MjEuMy01Mi40LTQwLjUtNy41LTE1LjMtNy02LTcuMy0xMzMuOWwtLjQtMTE0LjctMjMzLjIuMS0yMzguNy45em01MTI' +\n    'gMTA5LjhjMCAxMjAuNS0uMyAxMTQuOSA2IDEyNC40IDMuNiA1LjUgMTEuNiAxMS4yIDE5LjcgMTQuMSA1LjggMi4yID' +\n    'YuNCAyLjIgMTE1LjggMi41bDExMCAuMy0xMjUtMTI1LjQtMTI1LjctMTI1LjVjLS41LS4xLS44IDQ5LjItLjggMTA5L' +\n    'jZ6Ii8+PC9zdmc+';\n\nconst trashIcon = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmc' +\n    'iIHZpZXdCb3g9IjAgLTI1NiAxNzkyIDE3OTIiIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxwYXRoIGQ9Ik03MD' +\n    'kuNDI0IDQ1NS4wNXY1NzZxMCAxNC05IDIzLTkgOS0yMyA5aC02NHEtMTQgMC0yMy05LTktOS05LTIzdi01NzZxMC0xN' +\n    'CA5LTIzIDktOSAyMy05aDY0cTE0IDAgMjMgOSA5IDkgOSAyM3ptMjU2IDB2NTc2cTAgMTQtOSAyMy05IDktMjMgOWgt' +\n    'NjRxLTE0IDAtMjMtOS05LTktOS0yM3YtNTc2cTAtMTQgOS0yMyA5LTkgMjMtOWg2NHExNCAwIDIzIDkgOSA5IDkgMjN' +\n    '6bTI1NiAwdjU3NnEwIDE0LTkgMjMtOSA5LTIzIDloLTY0cS0xNCAwLTIzLTktOS05LTktMjN2LTU3NnEwLTE0IDktMj' +\n    'MgOS05IDIzLTloNjRxMTQgMCAyMyA5IDkgOSA5IDIzem0xMjggNzI0di05NDhoLTg5NnY5NDhxMCAyMiA3IDQwLjUgN' +\n    'yAxOC41IDE0LjUgMjcgNy41IDguNSAxMC41IDguNWg4MzJxMyAwIDEwLjUtOC41IDcuNS04LjUgMTQuNS0yNyA3LTE4' +\n    'LjUgNy00MC41em0tNjcyLTEwNzZoNDQ4bC00OC0xMTdxLTctOS0xNy0xMWgtMzE3cS0xMCAyLTE3IDExem05MjggMzJ' +\n    '2NjRxMCAxNC05IDIzLTkgOS0yMyA5aC05NnY5NDhxMCA4My00NyAxNDMuNS00NyA2MC41LTExMyA2MC41aC04MzJxLT' +\n    'Y2IDAtMTEzLTU4LjUtNDctNTguNS00Ny0xNDEuNXYtOTUyaC05NnEtMTQgMC0yMy05LTktOS05LTIzdi02NHEwLTE0I' +\n    'DktMjMgOS05IDIzLTloMzA5bDcwLTE2N3ExNS0zNyA1NC02MyAzOS0yNiA3OS0yNmgzMjBxNDAgMCA3OSAyNiAzOSAy' +\n    'NiA1NCA2M2w3MCAxNjdoMzA5cTE0IDAgMjMgOSA5IDkgOSAyM3oiLz48L3N2Zz4=';\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfCommonModule} from '@ajf/core/common';\nimport {CommonModule} from '@angular/common';\nimport {NgModule} from '@angular/core';\nimport {TranslateModule} from '@ngx-translate/core';\n\nimport {AjfDropMessage, AjfFileInput, AjfFilePreview} from './file-input';\n\n@NgModule({\n  declarations: [\n    AjfDropMessage,\n    AjfFileInput,\n    AjfFilePreview,\n  ],\n  exports: [\n    AjfDropMessage,\n    AjfFileInput,\n    AjfFilePreview,\n  ],\n  imports: [\n    AjfCommonModule,\n    CommonModule,\n    TranslateModule,\n  ],\n})\nexport class AjfFileInputModule {\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport * from './file';\nexport * from './file-input';\nexport * from './file-input-module';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":["Directive","Subscription","filter","ViewContainerRef","EventEmitter","Component","ChangeDetectionStrategy","ViewEncapsulation","NG_VALUE_ACCESSOR","forwardRef","DomSanitizer","ChangeDetectorRef","ContentChildren","ViewChild","Input","Output","NgModule","AjfCommonModule","CommonModule","TranslateModule"],"mappings":"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"}