{"version":3,"file":"core-forms.umd.js","sources":["../../src/core/forms/utils/warning/not-empty-warning.ts","../../src/core/forms/utils/validation/not-empty-validation.ts","../../src/core/forms/utils/validation/min-validation.ts","../../src/core/forms/utils/validation/min-digits-validation.ts","../../src/core/forms/utils/validation/max-validation.ts","../../src/core/forms/utils/validation/max-digits-validation.ts","../../src/core/forms/utils/forms/create-form.ts","../../src/core/forms/utils/fields/is-number-field.ts","../../src/core/forms/utils/choices/is-choices-fixed-origin.ts","../../src/core/forms/utils/choices/is-choices-origin.ts","../../src/core/forms/utils/choices/init-choices-origin.ts","../../src/core/forms/utils/choices/create-choices-promise-origin.ts","../../src/core/forms/utils/choices/create-choices-observable-origin.ts","../../src/core/forms/utils/choices/create-choices-observable-array-origin.ts","../../src/core/forms/utils/choices/create-choices-function-origin.ts","../../src/core/forms/utils/choices/create-choices-fixed-origin.ts","../../src/core/forms/interface/choices/choices-type.ts","../../src/core/forms/interface/attachments/attachments-type.ts","../../src/core/forms/serializers/form-serializer.ts","../../src/core/forms/serializers/node-serializer.ts","../../src/core/forms/serializers/warning-group-serializer.ts","../../src/core/forms/serializers/validation-group-serializer.ts","../../src/core/forms/utils/slides/create-slide.ts","../../src/core/forms/utils/slides/create-repeating-slide.ts","../../src/core/forms/utils/nodes/create-node-group.ts","../../src/core/forms/utils/nodes/create-repeating-node.ts","../../src/core/forms/utils/nodes/create-container-node.ts","../../src/core/forms/utils/fields/create-field-with-choices.ts","../../src/core/forms/serializers/choices-origin-serializer.ts","../../src/core/forms/utils/choices/create-choices-origin.ts","../../src/core/forms/serializers/attachments-origin-serializer.ts","../../src/core/forms/utils/attachments/create-attachments-origin.ts","../../src/core/forms/search-alert-threshold.ts","../../src/core/forms/input-field.ts","../../src/core/forms/get-type-name.ts","../../src/core/forms/forms-module.ts","../../src/core/forms/valid-slide.ts","../../src/core/forms/table-visible-columns.ts","../../src/core/forms/table-row-class.ts","../../src/core/forms/range.ts","../../src/core/forms/node-complete-name.ts","../../src/core/forms/is-repeating-slide.ts","../../src/core/forms/increment.ts","../../src/core/forms/expand-input-with-choices.ts","../../src/core/forms/bool-to-int.ts","../../src/core/forms/form.ts","../../src/core/forms/form-renderer.ts","../../src/core/forms/validation-service.ts","../../src/core/forms/utils/slides-instances/valid-slide.ts","../../src/core/forms/utils/slides-instances/update-reps-num.ts","../../src/core/forms/utils/nodes/ordered-nodes.ts","../../src/core/forms/utils/nodes/flatten-nodes.ts","../../src/core/forms/utils/nodes-instances/node-to-node-instance.ts","../../src/core/forms/utils/nodes-instances/is-repeating-slide-instance.ts","../../src/core/forms/utils/nodes/is-repeating-slide.ts","../../src/core/forms/utils/nodes-instances/get-instance-warnings.ts","../../src/core/forms/utils/nodes-instances/get-instance-warning.ts","../../src/core/forms/utils/warning/create-warning.ts","../../src/core/forms/utils/nodes-instances/get-instance-validations.ts","../../src/core/forms/utils/nodes-instances/get-instance-validation.ts","../../src/core/forms/utils/validation/create-validation.ts","../../src/core/forms/utils/nodes-instances/get-instance-formula.ts","../../src/core/forms/utils/nodes-instances/get-instance-conditions.ts","../../src/core/forms/utils/nodes-instances/get-instance-condition.ts","../../src/core/forms/utils/nodes-instances/get-ancestor-repeating-nodes-names.ts","../../src/core/forms/utils/nodes-instances/get-ancestor-repeating-nodes.ts","../../src/core/forms/utils/nodes/is-repeating-container-node.ts","../../src/core/forms/utils/warning/create-warning-group.ts","../../src/core/forms/utils/validation/create-validation-group.ts","../../src/core/forms/utils/slides-instances/create-repeating-slide-instance.ts","../../src/core/forms/utils/slides-instances/create-slide-instance.ts","../../src/core/forms/utils/nodes-instances/create-node-group-instance.ts","../../src/core/forms/utils/fields-instances/create-table-field-instance.ts","../../src/core/forms/utils/fields-instances/create-field-with-choices-instance.ts","../../src/core/forms/utils/fields-instances/create-field-instance.ts","../../src/core/forms/utils/nodes-instances/create-node-instance.ts","../../src/core/forms/utils/nodes-instances/is-slide-instance.ts","../../src/core/forms/utils/nodes/is-slide-node.ts","../../src/core/forms/utils/nodes-instances/is-node-group-instance.ts","../../src/core/forms/utils/nodes/is-node-group.ts","../../src/core/forms/utils/nodes-instances/flatten-nodes-instances-tree.ts","../../src/core/forms/utils/nodes-instances/is-slides-instance.ts","../../src/core/forms/utils/nodes-instances/flatten-nodes-instances.ts","../../src/core/forms/utils/nodes-instances/is-container-node-instance.ts","../../src/core/forms/utils/nodes/is-container-node.ts","../../src/core/forms/utils/nodes/is-slides-node.ts","../../src/core/forms/utils/fields/create-field.ts","../../src/core/forms/utils/nodes/create-node.ts","../../src/core/forms/utils/fields-instances/update-trigger-conditions.ts","../../src/core/forms/utils/fields-instances/update-filtered-choices.ts","../../src/core/forms/utils/fields-instances/update-field-instance-state.ts","../../src/core/forms/utils/fields-instances/update-warning.ts","../../src/core/forms/utils/warning/evaluate-warning-group.ts","../../src/core/forms/utils/warning/evaluate-warning-conditions.ts","../../src/core/forms/utils/warning/evaluate-warning.ts","../../src/core/forms/utils/fields-instances/update-validation.ts","../../src/core/forms/utils/validation/evaluate-validation-group.ts","../../src/core/forms/utils/validation/evaluate-validation-not-empty.ts","../../src/core/forms/utils/validation/evaluate-validation-min-value.ts","../../src/core/forms/utils/validation/evaluate-validation-min-digits.ts","../../src/core/forms/utils/validation/evaluate-validation-max-value.ts","../../src/core/forms/utils/validation/evaluate-validation-max-digits.ts","../../src/core/forms/utils/validation/evaluate-validation-conditions.ts","../../src/core/forms/utils/validation/evaluate-validation.ts","../../src/core/forms/utils/fields-instances/update-next-slide-condition.ts","../../src/core/forms/utils/fields-instances/update-formula.ts","../../src/core/forms/utils/nodes-instances/node-instance-complete-name.ts","../../src/core/forms/utils/nodes-instances/node-instance-suffix.ts","../../src/core/forms/utils/nodes-instances/update-visibility.ts","../../src/core/forms/utils/nodes-instances/update-conditional-branches.ts","../../src/core/forms/utils/fields-instances/is-table-field-instance.ts","../../src/core/forms/utils/fields/is-table-field.ts","../../src/core/forms/utils/fields-instances/is-field-with-choices-instance.ts","../../src/core/forms/utils/nodes-instances/is-field-instance.ts","../../src/core/forms/utils/nodes/is-field.ts","../../src/core/forms/utils/fields/is-field-with-choices.ts","../../src/core/forms/utils/fields/is-custom-field-with-choices.ts","../../src/core/forms/interface/nodes/node-type.ts","../../src/core/forms/field-with-choices.ts","../../src/core/forms/field-service.ts","../../src/core/forms/utils/fields/fields-map.ts","../../src/core/forms/field-host.ts","../../src/core/forms/field.ts","../../src/core/forms/field-is-valid.ts","../../src/core/forms/field-icon.ts","../../src/core/forms/field-utils.ts","../../src/core/forms/interface/fields/field-type.ts","../../src/core/forms/errors.ts","../../src/core/forms/date-value-string.ts","../../src/core/forms/date-value.ts","../../src/core/forms/base-field.ts","../../node_modules/tslib/tslib.es6.js"],"sourcesContent":["/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfWarning} from '../../interface/warning/warning';\nimport {createWarning} from './create-warning';\n\nexport function notEmptyWarning(): AjfWarning {\n  return createWarning({condition: 'notEmpty($value)', warningMessage: 'Value must not be empty'});\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfValidation} from '../../interface/validation/validation';\nimport {createValidation} from './create-validation';\n\nexport function notEmptyValidation(): AjfValidation {\n  return createValidation({condition: `notEmpty($value)`, errorMessage: `Value must not be empty`});\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfValidation} from '../../interface/validation/validation';\nimport {createValidation} from './create-validation';\n\nexport function minValidation(minValue: number): AjfValidation {\n  return createValidation({\n    condition: '$value >= ' + minValue.toString(),\n    errorMessage: 'Value must be >= ' + minValue.toString()\n  });\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfValidation} from '../../interface/validation/validation';\nimport {createValidation} from './create-validation';\n\nexport function minDigitsValidation(minValue: number): AjfValidation {\n  return createValidation({\n    condition: `$value ? $value.toString().length >= ${minValue.toString()} : false`,\n    errorMessage: 'Digits count must be >= ' + minValue.toString()\n  });\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfValidation} from '../../interface/validation/validation';\nimport {createValidation} from './create-validation';\n\nexport function maxValidation(maxValue: number): AjfValidation {\n  return createValidation({\n    condition: '$value >= ' + maxValue.toString(),\n    errorMessage: 'Value must be >= ' + maxValue.toString()\n  });\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfValidation} from '../../interface/validation/validation';\nimport {createValidation} from './create-validation';\n\nexport function maxDigitsValidation(maxValue: number): AjfValidation {\n  return createValidation({\n    condition: `$value ? $value.toString().length >= ${maxValue.toString()} : false`,\n    errorMessage: 'Digits count must be >= ' + maxValue.toString()\n  });\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfForm} from '../../interface/forms/form';\nimport {AjfFormStringIdentifier} from '../../interface/forms/form-string-identifier';\n\nexport type AjfFormCreate = Partial<AjfForm>;\n\nexport function createForm(form: AjfFormCreate = {}): AjfForm {\n  return {\n    nodes: form.nodes || [],\n    choicesOrigins: form.choicesOrigins || [],\n    attachmentsOrigins: form.attachmentsOrigins || [],\n    initContext: form.initContext || {},\n    stringIdentifier: form.stringIdentifier || [] as AjfFormStringIdentifier[],\n    supplementaryInformations: form.supplementaryInformations,\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfField} from '../../interface/fields/field';\nimport {AjfFieldType} from '../../interface/fields/field-type';\n\nexport function isNumberField(field: AjfField): boolean {\n  return field.fieldType === AjfFieldType.Number;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfChoicesOrigin} from '../../interface/choices/choices-origin';\nimport {isChoicesOrigin} from './is-choices-origin';\n\nexport function isChoicesFixedOrigin(origin: AjfChoicesOrigin<any>): boolean {\n  return isChoicesOrigin(origin) && origin.type === 'fixed';\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport function isChoicesOrigin(co: any): boolean {\n  return co != null\n    && typeof co === 'object'\n    && co.name != null\n    && typeof co.name === 'string'\n    && co.label != null\n    && typeof co.label === 'string'\n    && ['fixed', 'promise', 'observable', 'observableArray', 'function'].indexOf(co.type) > -1\n    && co.choices instanceof Array;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfChoicesFunctionOrigin} from '../../interface/choices/choices-function-origin';\nimport {\n  AjfChoicesObservableArrayOrigin\n} from '../../interface/choices/choices-observable-array-origin';\nimport {AjfChoicesObservableOrigin} from '../../interface/choices/choices-observable-origin';\nimport {AjfChoicesOrigin} from '../../interface/choices/choices-origin';\nimport {AjfChoicesPromiseOrigin} from '../../interface/choices/choices-promise-origin';\n\nexport function initChoicesOrigin(origin: AjfChoicesOrigin<any>): Promise<void> {\n  if (origin.type === 'fixed') {\n    return Promise.resolve();\n  }\n  if (origin.type === 'function') {\n    const fo = origin as AjfChoicesFunctionOrigin<any>;\n    fo.choices = fo.generator();\n    return Promise.resolve();\n  }\n  if (origin.type === 'promise') {\n    const po = origin as AjfChoicesPromiseOrigin<any>;\n    return po.generator.then(choices => po.choices = choices).then();\n  }\n  if (origin.type === 'observable') {\n    const obso = origin as AjfChoicesObservableOrigin<any>;\n    if (obso.generator != null) {\n      obso.choices = [];\n      return new Promise<void>(res => {\n        obso.generator.subscribe(\n          c => obso.choices.push(c),\n          () => {},\n          () => res(),\n        );\n      });\n    }\n  }\n  if (origin.type === 'observableArray') {\n    const aoo = origin as AjfChoicesObservableArrayOrigin<any>;\n    if (aoo.generator != null) {\n      aoo.choices = [];\n      return new Promise<void>(res => {\n        aoo.generator.subscribe(\n          choices => {\n            aoo.choices = choices;\n            res();\n          }\n        );\n      });\n    }\n  }\n  return Promise.resolve();\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {\n  AjfChoicesPromiseOrigin\n} from '../../interface/choices/choices-promise-origin';\nimport {AjfChoicesOriginCreate} from './create-choices-origin';\n\nexport type AjfChoicesPromiseOriginCreate<T> =\n  Omit<AjfChoicesOriginCreate<T>, 'type'>&Pick<AjfChoicesPromiseOrigin<T>, 'generator'>\n  &Partial<AjfChoicesPromiseOrigin<T>>;\n\nexport function createChoicesPromiseOrigin<T>(\n  origin: AjfChoicesPromiseOriginCreate<T>\n): AjfChoicesPromiseOrigin<T> {\n  return {\n    ...origin,\n    type: 'promise',\n    label: origin.label || '',\n    choices: origin.choices || [],\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfChoicesObservableOrigin} from '../../interface/choices/choices-observable-origin';\nimport {AjfChoicesOriginCreate} from './create-choices-origin';\n\nexport type AjfChoicesObservableOriginCreate<T> =\n  Omit<AjfChoicesOriginCreate<T>, 'type'>&Pick<AjfChoicesObservableOrigin<T>, 'generator'>\n  &Partial<AjfChoicesObservableOrigin<T>>;\n\nexport function createChoicesObservableOrigin<T>(\n  origin: AjfChoicesObservableOriginCreate<T>\n): AjfChoicesObservableOrigin<T> {\n  return {\n    ...origin,\n    type: 'observable',\n    label: origin.label || '',\n    choices: origin.choices || [],\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {\n  AjfChoicesObservableArrayOrigin\n} from '../../interface/choices/choices-observable-array-origin';\nimport {AjfChoicesOriginCreate} from './create-choices-origin';\n\nexport type AjfChoicesObservableArrayOriginCreate<T> =\n  Omit<AjfChoicesOriginCreate<T>, 'type'>&Pick<AjfChoicesObservableArrayOrigin<T>, 'generator'>\n  &Partial<AjfChoicesObservableArrayOrigin<T>>;\n\nexport function createChoicesObservableArrayOrigin<T>(\n  origin: AjfChoicesObservableArrayOriginCreate<T>\n): AjfChoicesObservableArrayOrigin<T> {\n  return {\n    ...origin,\n    type: 'observableArray',\n    label: origin.label || '',\n    choices: origin.choices || [],\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfChoicesFunctionOrigin} from '../../interface/choices/choices-function-origin';\nimport {AjfChoicesOriginCreate} from './create-choices-origin';\n\nexport type AjfChoicesFunctionOriginCreate<T> =\n  Omit<AjfChoicesOriginCreate<T>, 'type'>&Pick<AjfChoicesFunctionOrigin<T>, 'generator'>\n  &Partial<AjfChoicesFunctionOrigin<T>>;\n\nexport function createChoicesFunctionOrigin<T>(\n  origin: AjfChoicesFunctionOriginCreate<T>\n): AjfChoicesFunctionOrigin<T> {\n  return {\n    ...origin,\n    type: 'function',\n    label: origin.label || '',\n    choices: origin.choices || [],\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfChoicesFixedOrigin} from '../../interface/choices/choices-fixed-origin';\nimport {AjfChoicesOriginCreate, createChoicesOrigin} from './create-choices-origin';\n\nexport type AjfChoicesFixedOriginCreate<T> =\n    Omit<AjfChoicesOriginCreate<T>, 'type'>&Partial<AjfChoicesFixedOrigin<T>>;\n\nexport function createChoicesFixedOrigin<T = string | number>(\n    origin: AjfChoicesFixedOriginCreate<T>): AjfChoicesFixedOrigin<T> {\n  const type = 'fixed';\n  return {...createChoicesOrigin({...origin, type}), type};\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum AjfChoicesType {\n  String,\n  Number,\n  LENGTH\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum AjfAttachmentsType {\n  Link,\n  Pdf,\n  LENGTH\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '@ajf/core/models';\nimport {deepCopy} from '@ajf/core/utils';\nimport {AjfForm} from '../interface/forms/form';\nimport {AjfRepeatingSlide} from '../interface/slides/repeating-slide';\nimport {AjfSlide} from '../interface/slides/slide';\nimport {AjfAttachmentsOriginSerializer} from './attachments-origin-serializer';\nimport {AjfChoicesOriginSerializer} from './choices-origin-serializer';\nimport {AjfNodeSerializer} from './node-serializer';\n\nexport class AjfFormSerializer {\n  static fromJson(form: Partial<AjfForm>, context?: AjfContext): AjfForm {\n    const choicesOrigins =\n        (form.choicesOrigins || []).map(c => AjfChoicesOriginSerializer.fromJson(c));\n    const attachmentsOrigins =\n        (form.attachmentsOrigins || []).map(a => AjfAttachmentsOriginSerializer.fromJson(a));\n    const nodes =\n        (form.nodes || [])\n            .map(n => AjfNodeSerializer.fromJson(n, choicesOrigins, attachmentsOrigins)) as (\n            AjfRepeatingSlide | AjfSlide)[];\n    return {\n      ...form,\n      choicesOrigins,\n      attachmentsOrigins,\n      nodes,\n      stringIdentifier: form.stringIdentifier || [],\n      initContext: deepCopy(context || {}),\n    };\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfConditionSerializer, AjfFormulaSerializer} from '@ajf/core/models';\n\nimport {AjfAttachmentsOrigin} from '../interface/attachments/attachments-origin';\nimport {AjfChoicesOrigin} from '../interface/choices/choices-origin';\nimport {AjfField} from '../interface/fields/field';\nimport {AjfFieldType} from '../interface/fields/field-type';\nimport {AjfFieldWithChoices} from '../interface/fields/field-with-choices';\nimport {AjfFormulaField} from '../interface/fields/formula-field';\nimport {AjfContainerNode} from '../interface/nodes/container-node';\nimport {AjfNode} from '../interface/nodes/node';\nimport {AjfNodeGroup} from '../interface/nodes/node-group';\nimport {AjfFieldNodeLink} from '../interface/nodes/node-link';\nimport {AjfNodeType} from '../interface/nodes/node-type';\nimport {AjfRepeatingNode} from '../interface/nodes/repeating-node';\nimport {AjfRepeatingSlide} from '../interface/slides/repeating-slide';\nimport {AjfSlide} from '../interface/slides/slide';\nimport {componentsMap} from '../utils/fields/fields-map';\nimport {AjfFieldCreate, createField} from '../utils/fields/create-field';\nimport {createFieldWithChoices} from '../utils/fields/create-field-with-choices';\nimport {createContainerNode} from '../utils/nodes/create-container-node';\nimport {AjfNodeCreate, createNode} from '../utils/nodes/create-node';\nimport {createNodeGroup} from '../utils/nodes/create-node-group';\nimport {createRepeatingNode} from '../utils/nodes/create-repeating-node';\nimport {createRepeatingSlide} from '../utils/slides/create-repeating-slide';\nimport {createSlide} from '../utils/slides/create-slide';\n\nimport {AjfValidationGroupSerializer} from './validation-group-serializer';\nimport {AjfWarningGroupSerializer} from './warning-group-serializer';\n\nexport class AjfNodeSerializer {\n  static fromJson(\n      json: Partial<AjfNode>,\n      choicesOrigins?: AjfChoicesOrigin<any>[],\n      attachmentsOrigins?: AjfAttachmentsOrigin<any>[],\n      ): AjfNode {\n    const err = 'Malformed node';\n    json.name = json.name || '';\n    if (json.id == null || json.parent == null || json.nodeType == null) {\n      throw new Error(err);\n    }\n    const obj = json as AjfNodeCreate;\n    if (obj.visibility) {\n      obj.visibility = AjfConditionSerializer.fromJson(obj.visibility);\n    }\n    obj.conditionalBranches =\n        (obj.conditionalBranches || []).map(c => AjfConditionSerializer.fromJson(c));\n    switch (obj.nodeType) {\n      case AjfNodeType.AjfField:\n        return AjfNodeSerializer._fieldFromJson(\n            obj as AjfNodeCreate & Partial<AjfField>,\n            choicesOrigins,\n            attachmentsOrigins,\n        );\n      case AjfNodeType.AjfFieldNodeLink:\n        return AjfNodeSerializer._fieldNodeLinkFromJson(\n            obj as AjfNodeCreate & Partial<AjfFieldNodeLink>);\n      case AjfNodeType.AjfNodeGroup:\n        return AjfNodeSerializer._nodeGroupFromJson(\n            obj as AjfNodeCreate & Partial<AjfNodeGroup>,\n            choicesOrigins,\n            attachmentsOrigins,\n        );\n      case AjfNodeType.AjfRepeatingSlide:\n        return AjfNodeSerializer._repeatingSlideFromJson(\n            obj as AjfNodeCreate & Partial<AjfRepeatingSlide>,\n            choicesOrigins,\n            attachmentsOrigins,\n        );\n      case AjfNodeType.AjfSlide:\n        return AjfNodeSerializer._slideFromJson(\n            obj as AjfNodeCreate & Partial<AjfSlide>,\n            choicesOrigins,\n            attachmentsOrigins,\n        );\n    }\n    throw new Error(err);\n  }\n\n  private static _containerNodeFromJson(\n      json: AjfNodeCreate&Partial<AjfContainerNode>,\n      choicesOrigins?: AjfChoicesOrigin<any>[],\n      attachmentsOrigins?: AjfAttachmentsOrigin<any>[],\n      ): AjfContainerNode {\n    json.nodes = (json.nodes ||\n                  []).map(n => AjfNodeSerializer.fromJson(n, choicesOrigins, attachmentsOrigins));\n    return createContainerNode(json);\n  }\n\n  private static _fieldFromJson(\n      json: AjfNodeCreate&Partial<AjfField>&Partial<{attachmentsOriginRef: string}>,\n      choicesOrigins?: AjfChoicesOrigin<any>[],\n      attachmentsOrigins?: AjfAttachmentsOrigin<any>[],\n      ): AjfField {\n    if (json.fieldType == null) {\n      throw new Error('Malformed field');\n    }\n    const obj = json as AjfFieldCreate;\n    if (obj.validation) {\n      obj.validation = AjfValidationGroupSerializer.fromJson(obj.validation);\n    }\n    if (obj.warning) {\n      obj.warning = AjfWarningGroupSerializer.fromJson(obj.warning);\n    }\n    if (json.attachmentsOriginRef) {\n      obj.attachmentOrigin =\n          (attachmentsOrigins || []).find(a => a.name === json.attachmentsOriginRef);\n    }\n    if (obj.nextSlideCondition) {\n      obj.nextSlideCondition = AjfConditionSerializer.fromJson(obj.nextSlideCondition);\n    }\n    const isCustomFieldWithChoice = obj.fieldType > 100\n      && componentsMap[obj.fieldType] != null\n      && componentsMap[obj.fieldType].isFieldWithChoice === true;\n    if (obj.fieldType > 100) {\n      console.log(obj);\n      console.log(componentsMap[obj.fieldType]);\n    }\n    if (isCustomFieldWithChoice) {\n      return AjfNodeSerializer._fieldWithChoicesFromJson(\n        json as AjfFieldCreate & Partial<AjfFieldWithChoices<any>>,\n        choicesOrigins,\n    );\n    }\n\n    switch (obj.fieldType) {\n      case AjfFieldType.Formula:\n        return AjfNodeSerializer._formulaFieldFromJson(\n            json as AjfFieldCreate & Partial<AjfFormulaField>);\n      case AjfFieldType.MultipleChoice:\n      case AjfFieldType.SingleChoice:\n        return AjfNodeSerializer._fieldWithChoicesFromJson(\n            json as AjfFieldCreate & Partial<AjfFieldWithChoices<any>>,\n            choicesOrigins,\n        );\n    }\n    return createField(obj);\n  }\n\n  private static _fieldNodeLinkFromJson(json: AjfNodeCreate&\n                                       Partial<AjfFieldNodeLink>): AjfFieldNodeLink {\n    return {...createNode(json), nodeType: AjfNodeType.AjfFieldNodeLink};\n  }\n\n  private static _fieldWithChoicesFromJson(\n      json: AjfFieldCreate&Partial<AjfFieldWithChoices<any>>&Partial<{choicesOriginRef: string}>,\n      choicesOrigins?: AjfChoicesOrigin<any>[],\n      ): AjfFieldWithChoices<any> {\n    const err = 'Malformed field with choices';\n    if (json.choicesOriginRef == null) {\n      throw new Error(err);\n    }\n    const choicesOrigin = (choicesOrigins || []).find(c => c.name === json.choicesOriginRef);\n    if (choicesOrigin == null) {\n      throw new Error(err);\n    }\n    if (json.choicesFilter) {\n      json.choicesFilter = AjfFormulaSerializer.fromJson(json.choicesFilter);\n    }\n    if (json.triggerConditions) {\n      json.triggerConditions = json.triggerConditions.map(t => AjfConditionSerializer.fromJson(t));\n    }\n    return createFieldWithChoices<any>({...json, choicesOrigin});\n  }\n\n  private static _formulaFieldFromJson(json: AjfFieldCreate&\n                                      Partial<AjfFormulaField>): AjfFormulaField {\n    if (json.formula) {\n      json.formula = AjfFormulaSerializer.fromJson(json.formula);\n    }\n    return {\n      ...createField(json),\n      fieldType: AjfFieldType.Formula,\n    };\n  }\n\n  private static _nodeGroupFromJson(\n      json: AjfNodeCreate&Partial<AjfNodeGroup>,\n      choicesOrigins?: AjfChoicesOrigin<any>[],\n      attachmentsOrigins?: AjfAttachmentsOrigin<any>[],\n      ): AjfNodeGroup {\n    return createNodeGroup({\n      ...AjfNodeSerializer._containerNodeFromJson(json, choicesOrigins, attachmentsOrigins),\n      ...AjfNodeSerializer._repeatingNodeFromJson(json),\n    });\n  }\n\n  private static _repeatingNodeFromJson(json: AjfNodeCreate&\n                                       Partial<AjfRepeatingNode>): AjfRepeatingNode {\n    if (json.formulaReps) {\n      json.formulaReps = AjfFormulaSerializer.fromJson(json.formulaReps);\n    }\n    return createRepeatingNode(json);\n  }\n\n  private static _repeatingSlideFromJson(\n      json: AjfNodeCreate&Partial<AjfRepeatingSlide>,\n      choicesOrigins?: AjfChoicesOrigin<any>[],\n      attachmentsOrigins?: AjfAttachmentsOrigin<any>[],\n      ): AjfRepeatingSlide {\n    return createRepeatingSlide({\n      ...AjfNodeSerializer._containerNodeFromJson(json, choicesOrigins, attachmentsOrigins),\n      ...AjfNodeSerializer._repeatingNodeFromJson(json),\n    });\n  }\n\n  private static _slideFromJson(\n      json: AjfNodeCreate&Partial<AjfSlide>,\n      choicesOrigins?: AjfChoicesOrigin<any>[],\n      attachmentsOrigins?: AjfAttachmentsOrigin<any>[],\n      ): AjfSlide {\n    return createSlide(\n        AjfNodeSerializer._containerNodeFromJson(json, choicesOrigins, attachmentsOrigins));\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfWarningGroup} from '../interface/warning/warning-group';\nimport {createWarningGroup} from '../utils/warning/create-warning-group';\n\nexport class AjfWarningGroupSerializer {\n  static fromJson(group: Partial<AjfWarningGroup>): AjfWarningGroup {\n    return createWarningGroup(group);\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfValidationGroup} from '../interface/validation/validation-group';\nimport {createValidationGroup} from '../utils/validation/create-validation-group';\n\nexport class AjfValidationGroupSerializer {\n  static fromJson(group: Partial<AjfValidationGroup>): AjfValidationGroup {\n    return createValidationGroup(group);\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeType} from '../../interface/nodes/node-type';\nimport {AjfSlide} from '../../interface/slides/slide';\nimport {AjfContainerNodeCreate, createContainerNode} from '../nodes/create-container-node';\n\nexport type AjfSlideCreate = AjfContainerNodeCreate;\n\nexport function createSlide(nodeGroup: AjfSlideCreate): AjfSlide {\n  return {\n    ...createContainerNode(nodeGroup),\n    nodeType: AjfNodeType.AjfSlide,\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeType} from '../../interface/nodes/node-type';\nimport {AjfRepeatingSlide} from '../../interface/slides/repeating-slide';\nimport {AjfContainerNodeCreate, createContainerNode} from '../nodes/create-container-node';\nimport {AjfRepeatingNodeCreate, createRepeatingNode} from '../nodes/create-repeating-node';\n\nexport type AjfRepeatingSlideCreate = AjfContainerNodeCreate&AjfRepeatingNodeCreate;\n\nexport function createRepeatingSlide(nodeGroup: AjfRepeatingSlideCreate): AjfRepeatingSlide {\n  return {\n    ...createContainerNode(nodeGroup),\n    ...createRepeatingNode(nodeGroup),\n    nodeType: AjfNodeType.AjfRepeatingSlide,\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeGroup} from '../../interface/nodes/node-group';\nimport {AjfNodeType} from '../../interface/nodes/node-type';\nimport {AjfContainerNodeCreate, createContainerNode} from './create-container-node';\nimport {AjfRepeatingNodeCreate, createRepeatingNode} from './create-repeating-node';\n\nexport type AjfNodeGroupCreate = AjfContainerNodeCreate&AjfRepeatingNodeCreate;\n\nexport function createNodeGroup(nodeGroup: AjfNodeGroupCreate): AjfNodeGroup {\n  return {\n    ...createContainerNode(nodeGroup),\n    ...createRepeatingNode(nodeGroup),\n    nodeType: AjfNodeType.AjfNodeGroup,\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfRepeatingNode} from '../../interface/nodes/repeating-node';\nimport {AjfNodeCreate, createNode} from './create-node';\n\nexport type AjfRepeatingNodeCreate = AjfNodeCreate&Partial<AjfRepeatingNode>;\n\nexport function createRepeatingNode(repeatingNode: AjfRepeatingNodeCreate): AjfRepeatingNode {\n  const node = createNode(repeatingNode);\n  return {\n    ...repeatingNode,\n    ...node,\n    minReps: repeatingNode.minReps != null ? repeatingNode.minReps : 1,\n    maxReps: repeatingNode.maxReps != null ? repeatingNode.maxReps : 0,\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContainerNode} from '../../interface/nodes/container-node';\nimport {AjfNodeCreate, createNode} from './create-node';\n\nexport type AjfContainerNodeCreate = AjfNodeCreate&Partial<AjfContainerNode>;\n\nexport function createContainerNode(containerNode: AjfContainerNodeCreate): AjfContainerNode {\n  const node = createNode(containerNode);\n  return {\n    ...node,\n    nodes: containerNode.nodes || [],\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfFieldWithChoices} from '../../interface/fields/field-with-choices';\nimport {AjfFieldCreate, createField} from './create-field';\n\nexport type AjfFieldWithChoicesCreate<T> = AjfFieldCreate&\n    Pick<AjfFieldWithChoices<T>, 'fieldType'|'choicesOrigin'>&Partial<AjfFieldWithChoices<T>>;\n\nexport function createFieldWithChoices<T>(field: AjfFieldWithChoicesCreate<T>):\n    AjfFieldWithChoices<T> {\n  const node = createField({...field});\n  return {\n    ...node,\n    ...field,\n    choices: field.choices || [],\n    forceExpanded: field.forceExpanded || false,\n    forceNarrow: field.forceNarrow || false,\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfChoicesOrigin} from '../interface/choices/choices-origin';\nimport {AjfChoicesOriginCreate, createChoicesOrigin} from '../utils/choices/create-choices-origin';\n\nexport class AjfChoicesOriginSerializer {\n  static fromJson(origin: Partial<AjfChoicesOrigin<any>>): AjfChoicesOrigin<any> {\n    return createChoicesOrigin<any>({\n      ...origin,\n      type: origin.type || 'fixed',\n      name: origin.name || '',\n    } as AjfChoicesOriginCreate<any>);\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfChoicesOrigin} from '../../interface/choices/choices-origin';\n\nexport type AjfChoicesOriginCreate<T> =\n    Pick<AjfChoicesOrigin<any>, 'type'|'name'>&Partial<AjfChoicesOrigin<T>>;\n\nexport function createChoicesOrigin<T>(origin: AjfChoicesOriginCreate<T>): AjfChoicesOrigin<T> {\n  return {\n    ...origin,\n    type: origin.type,\n    label: origin.label || '',\n    choices: origin.choices || [],\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfAttachmentsOrigin} from '../interface/attachments/attachments-origin';\nimport {\n  AjfAttachmentsOriginCreate, createAttachmentsOrigin\n} from '../utils/attachments/create-attachments-origin';\n\nexport class AjfAttachmentsOriginSerializer {\n  static fromJson(origin: Partial<AjfAttachmentsOrigin<any>>): AjfAttachmentsOrigin<any> {\n    if (origin.name == null) {\n      throw new Error('Malformed attachments origin');\n    }\n    return createAttachmentsOrigin(origin as AjfAttachmentsOriginCreate<any>);\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfAttachmentsOrigin} from '../../interface/attachments/attachments-origin';\n\nexport type AjfAttachmentsOriginCreate<T> =\n    Pick<AjfAttachmentsOrigin<T>, 'name'>&Partial<AjfAttachmentsOrigin<T>>;\n\nexport function createAttachmentsOrigin<T>(origin: AjfAttachmentsOriginCreate<T>):\n    AjfAttachmentsOrigin<T> {\n  return {\n    ...origin,\n    attachments: origin.attachments || [],\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {InjectionToken} from '@angular/core';\n\nexport const AJF_SEARCH_ALERT_THRESHOLD = new InjectionToken<number>('AJF_SEARCH_ALERT_THRESHOLD');\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {coerceBooleanProperty} from '@ajf/core/utils';\nimport {AjfBaseFieldComponent} from './base-field';\n\nexport abstract class AjfInputFieldComponent extends AjfBaseFieldComponent {\n  type: 'text' | 'number' = 'text';\n\n  private _readonly = false;\n  get readonly(): boolean { return this._readonly; }\n  set readonly(readonly: boolean) {\n    this._readonly = coerceBooleanProperty(readonly);\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport function getTypeName(v: any): string {\n  let typeStr = typeof v;\n  return typeStr === 'object'\n    ? v.constructor.toString().match(/\\w+/g)[1]\n    : typeStr;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {NgModule} from '@angular/core';\n\nimport {AjfBoolToIntPipe} from './bool-to-int';\nimport {AjfDateValuePipe} from './date-value';\nimport {AjfDateValueStringPipe} from './date-value-string';\nimport {AjfExpandFieldWithChoicesPipe} from './expand-input-with-choices';\nimport {AjfFieldHost} from './field-host';\nimport {AjfFieldIconPipe} from './field-icon';\nimport {AjfFieldIsValidPipe} from './field-is-valid';\nimport {AjfFormRendererService} from './form-renderer';\nimport {AjfIncrementPipe} from './increment';\nimport {AjfIsRepeatingSlideInstancePipe} from './is-repeating-slide';\nimport {AjfNodeCompleteNamePipe} from './node-complete-name';\nimport {AjfRangePipe} from './range';\nimport {AjfTableRowClass} from './table-row-class';\nimport {AjfTableVisibleColumnsPipe} from './table-visible-columns';\nimport {AjfValidationService} from './validation-service';\nimport {AjfValidSlidePipe} from './valid-slide';\n\n@NgModule({\n  declarations: [\n    AjfBoolToIntPipe,\n    AjfDateValuePipe,\n    AjfDateValueStringPipe,\n    AjfExpandFieldWithChoicesPipe,\n    AjfFieldHost,\n    AjfFieldIconPipe,\n    AjfFieldIsValidPipe,\n    AjfIncrementPipe,\n    AjfIsRepeatingSlideInstancePipe,\n    AjfNodeCompleteNamePipe,\n    AjfRangePipe,\n    AjfTableRowClass,\n    AjfTableVisibleColumnsPipe,\n    AjfValidSlidePipe,\n  ],\n  exports: [\n    AjfBoolToIntPipe,\n    AjfDateValuePipe,\n    AjfDateValueStringPipe,\n    AjfExpandFieldWithChoicesPipe,\n    AjfFieldHost,\n    AjfFieldIconPipe,\n    AjfFieldIsValidPipe,\n    AjfIncrementPipe,\n    AjfIsRepeatingSlideInstancePipe,\n    AjfNodeCompleteNamePipe,\n    AjfRangePipe,\n    AjfTableRowClass,\n    AjfTableVisibleColumnsPipe,\n    AjfValidSlidePipe,\n  ],\n  providers: [AjfDateValueStringPipe, AjfFormRendererService, AjfValidationService]\n})\nexport class AjfFormsModule {\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\nimport {AjfBaseSlideInstance} from './interface/slides-instances/base-slide-instance';\n\n@Pipe({name: 'ajfValidSlide', pure: false})\nexport class AjfValidSlidePipe implements PipeTransform {\n  transform (slide: AjfBaseSlideInstance, idx: number): boolean {\n    if (idx == null || typeof idx !== 'number') {\n      return false;\n    }\n    if (idx >= slide.slideNodes.length) {\n      return true;\n    }\n    return slide.slideNodes[idx]\n      .map(n => {\n        if (n.visible && Object.keys(n).indexOf('valid') > -1) {\n          return (<any>n).valid;\n        }\n        return true;\n      }).reduce((v1, v2) => v1 && v2, true);\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\nimport {FormControl} from '@angular/forms';\nimport {AjfTableFieldInstance} from './interface/fields-instances/table-field-instance';\n\n@Pipe({name: 'ajfTableVisibleColumns'})\nexport class AjfTableVisibleColumnsPipe implements PipeTransform {\n  transform(instance: AjfTableFieldInstance): (string|number|FormControl)[][] {\n    if (!instance.node.editable) {\n      return instance.hideEmptyRows\n        ? (instance.value || []).filter(col => col[1].reduce((prev: boolean, cur) => {\n          return prev || (cur != null && cur !== '' && cur !== 0 && cur !== '0');\n        }, false)).map(v => [v[0], ...v[1]])\n        : instance.value.map(v => [v[0], ...v[1]]);\n    }\n    return (instance.controls || []).map(v => [v[0], ...v[1]]);\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\n\n\n@Pipe({name: 'ajfTableRowClass'})\nexport class AjfTableRowClass implements PipeTransform {\n  transform(value: number): string {\n    return value % 2 == 0 ? 'ajf-row-even' : 'ajf-row-odd';\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\n\n@Pipe({name: 'ajfRange'})\nexport class AjfRangePipe implements PipeTransform {\n  transform(size: number = 0, start: number = 1, step: number = 1): number[] {\n    const range: number[] = [];\n    for (let length = 0; length < size; ++length) {\n      range.push(start);\n      start += step;\n    }\n    return range;\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\nimport {AjfNodeInstance} from './interface/nodes-instances/node-instance';\nimport {nodeInstanceCompleteName} from './utils/nodes-instances/node-instance-complete-name';\n\n@Pipe({name: 'ajfNodeCompleteName'})\nexport class AjfNodeCompleteNamePipe implements PipeTransform {\n  transform(instance: AjfNodeInstance): string {\n    return instance ? nodeInstanceCompleteName(instance) : '';\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\nimport {AjfNodeInstance} from './interface/nodes-instances/node-instance';\nimport {isRepeatingSlideInstance} from './utils/nodes-instances/is-repeating-slide-instance';\n\n@Pipe({name: 'ajfIsRepeatingSlideInstance'})\nexport class AjfIsRepeatingSlideInstancePipe implements PipeTransform {\n  transform(instance: AjfNodeInstance): boolean {\n    return isRepeatingSlideInstance(instance);\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\n\n@Pipe({name: 'ajfIncrement'})\nexport class AjfIncrementPipe implements PipeTransform {\n  transform(value: number, increment: number = 1): number {\n    return value + increment;\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\n\nimport {\n  AjfFieldWithChoicesInstance\n} from './interface/fields-instances/field-with-choices-instance';\n\n@Pipe({name: 'ajfExpandFieldWithChoices'})\nexport class AjfExpandFieldWithChoicesPipe implements PipeTransform {\n  transform(instance: AjfFieldWithChoicesInstance<any>, threshold: number) {\n    return !instance.node.forceNarrow && (\n      instance.node.forceExpanded\n      || (instance.filteredChoices && instance.filteredChoices.length <= threshold)\n    );\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\n\n\n@Pipe({name: 'ajfBoolToInt'})\nexport class AjfBoolToIntPipe implements PipeTransform {\n  transform(value: boolean): number {\n    return value ? 1 : 0;\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfPageSlider, AjfPageSliderOrientation} from '@ajf/core/page-slider';\nimport {coerceBooleanProperty} from '@ajf/core/utils';\nimport {\n  AfterViewChecked, AfterViewInit, ChangeDetectorRef, EventEmitter, OnDestroy, QueryList\n} from '@angular/core';\nimport {FormGroup} from '@angular/forms';\nimport {Observable, Subscription} from 'rxjs';\nimport {delayWhen, map, withLatestFrom} from 'rxjs/operators';\n\nimport {AjfFormField} from './field';\nimport {AjfFormInitStatus, AjfFormRendererService} from './form-renderer';\nimport {AjfFieldType} from './interface/fields/field-type';\nimport {AjfForm} from './interface/forms/form';\nimport {AjfNodeGroupInstance} from './interface/nodes-instances/node-group-instance';\nimport {AjfNodeInstance} from './interface/nodes-instances/node-instance';\nimport {AjfRepeatingSlideInstance} from './interface/slides-instances/repeating-slide-instance';\nimport {AjfSlideInstance} from './interface/slides-instances/slide-instance';\nimport {nodeInstanceCompleteName} from './utils/nodes-instances/node-instance-complete-name';\n\nexport class AjfFormActionEvent {\n  source: AjfFormRenderer;\n  value: Object;\n  action: string;\n}\n\nexport abstract class AjfFormRenderer implements AfterViewChecked, AfterViewInit, OnDestroy {\n  // formGroup is an Observable FormGroup type\n  readonly formGroup: Observable<FormGroup | null>;\n\n  //  slides is an observable AjfSlide array type\n  readonly slides: Observable<AjfSlideInstance[]>;\n  readonly slidesNum: Observable<number>;\n  readonly errors: Observable<number>;\n  readonly formIsInit: Observable<boolean>;\n\n  // ajfFieldTypes [ Text, Number, Boolean, SingleChoice, MultipleChoice,\n  // Formula, Empty, Composed, LENGTH ]\n  readonly ajfFieldTypes = AjfFieldType;\n\n  title: string;\n\n  private _orientationChange: EventEmitter<AjfPageSliderOrientation>\n    = new EventEmitter<AjfPageSliderOrientation>();\n  readonly orientationChange: Observable<AjfPageSliderOrientation> =\n    this._orientationChange.asObservable();\n\n  private _saveDisabled: boolean = false;\n  get saveDisabled(): boolean { return this._saveDisabled; }\n  set saveDisabled(saveDisabled: boolean) {\n    this._saveDisabled = coerceBooleanProperty(saveDisabled);\n    this._changeDetectorRef.markForCheck();\n  }\n\n  private _hasStartMessage = false;\n  get hasStartMessage(): boolean { return this._hasStartMessage; }\n  set hasStartMessage(hasStartMessage: boolean) {\n    this._hasStartMessage = coerceBooleanProperty(hasStartMessage);\n    this._changeDetectorRef.markForCheck();\n  }\n\n  private _hasEndMessage = false;\n  get hasEndMessage(): boolean { return this._hasEndMessage; }\n  set hasEndMessage(hasEndMessage: boolean) {\n    this._hasEndMessage = coerceBooleanProperty(hasEndMessage);\n    this._changeDetectorRef.markForCheck();\n  }\n\n  private _hideTopToolbar = false;\n  get hideTopToolbar(): boolean { return this._hideTopToolbar; }\n  set hideTopToolbar(hideTopToolbar: boolean) {\n    this._hideTopToolbar = coerceBooleanProperty(hideTopToolbar);\n    this._changeDetectorRef.markForCheck();\n  }\n\n  private _hideBottomToolbar = false;\n  get hideBottompToolbar(): boolean { return this._hideBottomToolbar; }\n  set hideBottomToolbar(hideBottomToolbar: boolean) {\n    this._hideBottomToolbar = coerceBooleanProperty(hideBottomToolbar);\n    this._changeDetectorRef.markForCheck();\n  }\n\n  private _hideNavigationButtons = false;\n  get hideNavigationButtons(): boolean { return this._hideNavigationButtons; }\n  set hideNavigationButtons(hideNavigationButtons: boolean) {\n    this._hideNavigationButtons = coerceBooleanProperty(hideNavigationButtons);\n    this._changeDetectorRef.markForCheck();\n  }\n\n  private _fixedOrientation = false;\n  get fixedOrientation(): boolean { return this._fixedOrientation; }\n  set fixedOrientation(fixedOrientation: boolean) {\n    this._fixedOrientation = coerceBooleanProperty(fixedOrientation);\n    this._changeDetectorRef.markForCheck();\n  }\n\n  private _orientation: AjfPageSliderOrientation = 'horizontal';\n  get orientation(): AjfPageSliderOrientation { return this._orientation; }\n  set orientation(orientation: AjfPageSliderOrientation) {\n    if (orientation !== 'horizontal' && orientation !== 'vertical') { return; }\n    if (orientation !== this._orientation) {\n      this._orientation = orientation;\n      this._changeDetectorRef.markForCheck();\n      this._orientationChange.emit(this._orientation);\n    }\n  }\n\n  formSlider: AjfPageSlider;\n  fields: QueryList<AjfFormField>;\n\n  private _errorMoveEvent: EventEmitter<boolean> = new EventEmitter<boolean>();\n\n  // _errorPositions is a private subject structure that contains next and prev\n  private _errorPositions: Observable<number[]>;\n\n  // _form is a private ajFForm\n  private _form: AjfForm;\n  // _init is a private boolean\n  private _init = false;\n\n  private _nextSlideSubscription: Subscription = Subscription.EMPTY;\n  private _errorMoveSubscription: Subscription = Subscription.EMPTY;\n\n  private _formAction: EventEmitter<AjfFormActionEvent> = new EventEmitter<AjfFormActionEvent>();\n  readonly formAction: Observable<AjfFormActionEvent> = this._formAction.asObservable();\n\n  set form(form: AjfForm) {\n    this._form = form;\n\n    if (this._init) {\n      this._rendererService.setForm(this._form);\n    }\n  }\n\n  /**\n   * this constructor will init current formula by ajfBuilderService\n   */\n  constructor(\n    private _rendererService: AjfFormRendererService,\n    protected _changeDetectorRef: ChangeDetectorRef\n  ) {\n    this.formGroup = _rendererService.formGroup;\n    this.slides = _rendererService.nodesTree;\n    this._errorPositions = _rendererService.errorPositions;\n    this.errors = _rendererService.errors;\n    this.slidesNum = _rendererService.slidesNum;\n    this.formIsInit = _rendererService.formInitEvent.pipe(\n      map(e => e === AjfFormInitStatus.Complete)\n    );\n  }\n\n  /**\n   * this method will scroll to next error received by subscribe\n   */\n  goToNextError(): void { this._errorMoveEvent.emit(true); }\n  /**\n   * this method will scroll to prev error received by subscribe\n   */\n  goToPrevError(): void { this._errorMoveEvent.emit(false); }\n\n  /**\n   * this method will add group\n   */\n  addGroup(nodeGroup: AjfNodeGroupInstance | AjfRepeatingSlideInstance): void {\n    let s = this._rendererService.addGroup(nodeGroup).pipe(\n      delayWhen(() => this.formSlider.pageScrollFinish),\n    ).subscribe(\n        (r) => { if (r && this.formSlider != null) { this.formSlider.slide({dir: 'down'}); } },\n        (_e) => { if (s) { s.unsubscribe(); } },\n        () => { if (s) { s.unsubscribe(); } }\n      );\n  }\n\n  /**\n   * this method will remove group\n   */\n  removeGroup(nodeGroup: AjfNodeGroupInstance | AjfRepeatingSlideInstance): void {\n    let s = this._rendererService.removeGroup(nodeGroup).pipe(\n      delayWhen(() => this.formSlider.pageScrollFinish),\n    ).subscribe(\n        (r) => { if (r && this.formSlider != null) { this.formSlider.slide({dir: 'up'}); } },\n        (_e) => { if (s) { s.unsubscribe(); } },\n        () => { if (s) { s.unsubscribe(); } }\n      );\n  }\n\n  onSave(_evt: any): void {\n    this._formAction.emit({\n      source: this,\n      action: 'save',\n      value: this._rendererService.getFormValue()\n    });\n  }\n\n  onFormAction(_evt: any, action: string) {\n    this._formAction.emit({\n      source: this,\n      value: this._rendererService.getFormValue(),\n      action: action\n    });\n  }\n\n  /**\n   * this method will set current form in rederer service when init form\n   */\n  ngAfterViewInit(): void {\n    if (this._form != null) {\n      this._rendererService.setForm(this._form);\n      this._changeDetectorRef.detectChanges();\n    }\n  }\n\n  ngAfterViewChecked(): void {\n    if (!this._init && this.formSlider != null) {\n      this._init = true;\n\n      this._errorMoveSubscription = (<Observable<boolean>>this._errorMoveEvent).pipe(\n        withLatestFrom(this._errorPositions)\n      ).subscribe((v: [boolean, number[]]) => {\n          const move = v[0];\n          const currentPosition = this.formSlider.currentPage - (+this.hasStartMessage) + 1;\n          const errors = v[1];\n          if (errors == null) { return; }\n\n          let found = false;\n          let prevIdx = -1;\n          let nextIdx = -1;\n          let idx = 0;\n          let errorsLen = errors.length;\n          while (!found && idx < errorsLen) {\n            if (errors[idx] == currentPosition) {\n              found = true;\n              prevIdx = idx > 0 ? idx - 1 : errorsLen - 1;\n              nextIdx = idx < errorsLen - 1 ? idx + 1 : 0;\n            } else if (errors[idx] > currentPosition) {\n              found = true;\n              prevIdx = idx > 0 ? idx - 1 : errorsLen - 1;\n              nextIdx = idx;\n            }\n            idx++;\n          }\n          if (!found) {\n            prevIdx = errorsLen - 1;\n            nextIdx = 0;\n          }\n\n          this.formSlider.slide({to: move ? errors[nextIdx] - 1 : errors[prevIdx] - 1});\n          this._changeDetectorRef.detectChanges();\n        });\n\n    }\n  }\n\n  ngOnDestroy(): void {\n    this._nextSlideSubscription.unsubscribe();\n    this._errorMoveSubscription.unsubscribe();\n    this._orientationChange.complete();\n    this._errorMoveEvent.complete();\n    this._formAction.complete();\n  }\n\n  orientationChangeHandler(orientation: AjfPageSliderOrientation): void {\n    this.orientation = orientation;\n  }\n\n  trackNodeById(_: number, node: AjfNodeInstance): string {\n    return nodeInstanceCompleteName(node);\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfCondition, AjfContext} from '@ajf/core/models';\nimport {deepCopy} from '@ajf/core/utils';\nimport {EventEmitter, Injectable} from '@angular/core';\nimport {AbstractControl, FormControl, FormGroup} from '@angular/forms';\nimport * as esprima from 'esprima';\nimport {BehaviorSubject, Observable, Subject, Subscriber, Subscription, timer} from 'rxjs';\nimport {\n  debounceTime, filter, map, pairwise, publishReplay, refCount, scan, share, startWith,\n  withLatestFrom\n} from 'rxjs/operators';\n\nimport {AjfFieldInstance} from './interface/fields-instances/field-instance';\nimport {\n  AjfFieldWithChoicesInstance\n} from './interface/fields-instances/field-with-choices-instance';\nimport {AjfFormulaFieldInstance} from './interface/fields-instances/formula-field-instance';\nimport {AjfTableFieldInstance} from './interface/fields-instances/table-field-instance';\nimport {AjfEmptyField} from './interface/fields/empty-field';\nimport {AjfFieldType} from './interface/fields/field-type';\nimport {AjfForm} from './interface/forms/form';\nimport {AjfNodeGroupInstance} from './interface/nodes-instances/node-group-instance';\nimport {AjfNodeInstance} from './interface/nodes-instances/node-instance';\nimport {\n  AjfRepeatingContainerNodeInstance\n} from './interface/nodes-instances/repeating-container-node-instance';\nimport {AjfNode} from './interface/nodes/node';\nimport {AjfNodeGroup} from './interface/nodes/node-group';\nimport {AjfNodeType} from './interface/nodes/node-type';\nimport {AjfNodesInstancesOperation} from './interface/operations/nodes-instances-operation';\nimport {AjfRendererUpdateMapOperation} from './interface/operations/renderer-update-map-operation';\nimport {AjfRendererUpdateMap} from './interface/renderer-maps/update-map';\nimport {AjfBaseSlideInstance} from './interface/slides-instances/base-slide-instance';\nimport {AjfRepeatingSlideInstance} from './interface/slides-instances/repeating-slide-instance';\nimport {AjfSlideInstance} from './interface/slides-instances/slide-instance';\nimport {isCustomFieldWithChoices} from './utils/fields/is-custom-field-with-choices';\nimport {isFieldWithChoicesInstance} from './utils/fields-instances/is-field-with-choices-instance';\nimport {isTableFieldInstance} from './utils/fields-instances/is-table-field-instance';\nimport {updateFieldInstanceState} from './utils/fields-instances/update-field-instance-state';\nimport {updateFilteredChoices} from './utils/fields-instances/update-filtered-choices';\nimport {updateFormula} from './utils/fields-instances/update-formula';\nimport {updateNextSlideCondition} from './utils/fields-instances/update-next-slide-condition';\nimport {updateTriggerConditions} from './utils/fields-instances/update-trigger-conditions';\nimport {updateValidation} from './utils/fields-instances/update-validation';\nimport {updateWarning} from './utils/fields-instances/update-warning';\nimport {createField} from './utils/fields/create-field';\nimport {isFieldWithChoices} from './utils/fields/is-field-with-choices';\nimport {flattenNodesInstances} from './utils/nodes-instances/flatten-nodes-instances';\nimport {flattenNodesInstancesTree} from './utils/nodes-instances/flatten-nodes-instances-tree';\nimport {isFieldInstance} from './utils/nodes-instances/is-field-instance';\nimport {isNodeGroupInstance} from './utils/nodes-instances/is-node-group-instance';\nimport {isSlideInstance} from './utils/nodes-instances/is-slide-instance';\nimport {isSlidesInstance} from './utils/nodes-instances/is-slides-instance';\nimport {nodeInstanceCompleteName} from './utils/nodes-instances/node-instance-complete-name';\nimport {nodeInstanceSuffix} from './utils/nodes-instances/node-instance-suffix';\nimport {nodeToNodeInstance} from './utils/nodes-instances/node-to-node-instance';\nimport {updateConditionalBranches} from './utils/nodes-instances/update-conditional-branches';\nimport {updateVisibility} from './utils/nodes-instances/update-visibility';\nimport {flattenNodes} from './utils/nodes/flatten-nodes';\nimport {isContainerNode} from './utils/nodes/is-container-node';\nimport {isRepeatingContainerNode} from './utils/nodes/is-repeating-container-node';\nimport {orderedNodes} from './utils/nodes/ordered-nodes';\nimport {updateRepsNum} from './utils/slides-instances/update-reps-num';\nimport {validSlide} from './utils/slides-instances/valid-slide';\nimport {AjfValidationService} from './validation-service';\n\nconst esprimaMod: any = (esprima as any).default || esprima;\nconst {tokenize} = esprimaMod;\n\nexport enum AjfFormInitStatus {\n  Initializing,\n  Complete\n}\n\n@Injectable()\nexport class AjfFormRendererService {\n  private _visibilityNodesMap: Observable<AjfRendererUpdateMap>;\n  private _visibilityNodesMapUpdates: Subject<AjfRendererUpdateMapOperation> =\n      new Subject<AjfRendererUpdateMapOperation>();\n\n  private _repetitionNodesMap: Observable<AjfRendererUpdateMap>;\n  private _repetitionNodesMapUpdates: Subject<AjfRendererUpdateMapOperation> =\n      new Subject<AjfRendererUpdateMapOperation>();\n\n  private _conditionalBranchNodesMap: Observable<AjfRendererUpdateMap>;\n  private _conditionalBranchNodesMapUpdates: Subject<AjfRendererUpdateMapOperation> =\n      new Subject<AjfRendererUpdateMapOperation>();\n\n  private _formulaNodesMap: Observable<AjfRendererUpdateMap>;\n  private _formulaNodesMapUpdates: Subject<AjfRendererUpdateMapOperation> =\n      new Subject<AjfRendererUpdateMapOperation>();\n\n  private _validationNodesMap: Observable<AjfRendererUpdateMap>;\n  private _validationNodesMapUpdates: Subject<AjfRendererUpdateMapOperation> =\n      new Subject<AjfRendererUpdateMapOperation>();\n\n  private _warningNodesMap: Observable<AjfRendererUpdateMap>;\n  private _warningNodesMapUpdates: Subject<AjfRendererUpdateMapOperation> =\n      new Subject<AjfRendererUpdateMapOperation>();\n\n  private _filteredChoicesNodesMap: Observable<AjfRendererUpdateMap>;\n  private _filteredChoicesNodesMapUpdates: Subject<AjfRendererUpdateMapOperation> =\n      new Subject<AjfRendererUpdateMapOperation>();\n\n  private _triggerConditionsNodesMap: Observable<AjfRendererUpdateMap>;\n  private _triggerConditionsNodesMapUpdates: Subject<AjfRendererUpdateMapOperation> =\n      new Subject<AjfRendererUpdateMapOperation>();\n\n  private _nextSlideConditionsNodesMap: Observable<AjfRendererUpdateMap>;\n  private _nextSlideConditionsNodesMapUpdates: Subject<AjfRendererUpdateMapOperation> =\n      new Subject<AjfRendererUpdateMapOperation>();\n\n  private _formInitEvent: EventEmitter<AjfFormInitStatus> = new EventEmitter<AjfFormInitStatus>();\n  readonly formInitEvent: Observable<AjfFormInitStatus> = this._formInitEvent.asObservable();\n\n  private _formGroup: BehaviorSubject<FormGroup | null> =\n    new BehaviorSubject<FormGroup | null>(null);\n  readonly formGroup: Observable<FormGroup | null> = this._formGroup.asObservable();\n\n  private _form: BehaviorSubject<{form: AjfForm | null, context?: AjfContext}|null> =\n      new BehaviorSubject<{form: AjfForm | null, context?: AjfContext}|null>(null);\n  private _nodes: Observable<AjfNodeInstance[]>;\n  private _flatNodes: Observable<AjfNodeInstance[]>;\n  private _flatNodesTree: Observable<AjfSlideInstance[]>;\n  private _nodesUpdates: Subject<AjfNodesInstancesOperation> =\n      new Subject<AjfNodesInstancesOperation>();\n  private _errorPositions: Observable<number[]>;\n  private _errors: Observable<number>;\n\n  private _formGroupSubscription: Subscription = Subscription.EMPTY;\n  private _valueChanged: Subject<void> = new Subject<void>();\n\n  private _nodesMaps: Observable<AjfRendererUpdateMap>[];\n\n  private _nextSlideTrigger: EventEmitter<AjfNodeInstance> = new EventEmitter<AjfNodeInstance>();\n  readonly nextSlideTrigger: Observable<AjfNodeInstance> = this._nextSlideTrigger.asObservable();\n\n  private _slidesNum: BehaviorSubject<number> = new BehaviorSubject<number>(0);\n  readonly slidesNum: Observable<number> = this._slidesNum.asObservable();\n\n  get nodesTree(): Observable<AjfSlideInstance[]> {\n    return this._flatNodesTree;\n  }\n  get errorPositions(): Observable<number[]> { return this._errorPositions; }\n  get errors(): Observable<number> { return this._errors; }\n  get currentSupplementaryInformations(): any {\n    const form = this._form.getValue();\n    return form != null && form.form != null ? form.form.supplementaryInformations : null;\n  }\n\n  constructor(_: AjfValidationService) {\n    this._initUpdateMapStreams();\n    this._initNodesStreams();\n    this._initErrorsStreams();\n    this._initFormStreams();\n    this._updateFormValueAndValidity();\n  }\n\n  setForm(form: AjfForm|null, context: AjfContext = {}) {\n    this._initUpdateMapStreams();\n    if (form != null && Object.keys(context).length === 0 &&\n        Object.keys(form.initContext || {}).length > 0) {\n      context = form.initContext || {};\n    }\n    const currentForm = this._form.getValue();\n    if (\n      (currentForm == null && form != null) ||\n      (currentForm != null && form !== currentForm.form)\n    ) {\n      this._form.next({form: form, context: context});\n    }\n  }\n\n  getFormValue(): any {\n    const formGroup = this._formGroup.getValue();\n    if (formGroup == null) { return {}; }\n    let res = deepCopy(formGroup.value);\n    return res;\n  }\n\n  addGroup(group: AjfNodeGroupInstance | AjfRepeatingSlideInstance): Observable<boolean> {\n    return new Observable<boolean>((subscriber: Subscriber<boolean>) => {\n      if (group.formulaReps != null) {\n        subscriber.next(false);\n        subscriber.complete();\n        return;\n      }\n      const maxReps = group.node.maxReps;\n      if (maxReps > 0 && group.reps + 1 > maxReps) {\n        subscriber.next(false);\n        subscriber.complete();\n        return;\n      }\n      const oldReps = group.reps;\n      group.reps = group.reps + 1;\n      group.canAdd = group.node.maxReps === 0 || group.reps < group.node.maxReps;\n      group.canRemove = group.node.minReps === 0 || group.reps > group.node.minReps;\n      this._nodesUpdates.next((nodes: AjfNodeInstance[]): AjfNodeInstance[] => {\n        const flatNodes = flattenNodesInstances(nodes, true);\n        this._adjustReps(flatNodes, group, oldReps, this.getFormValue());\n        subscriber.next(true);\n        subscriber.complete();\n        return nodes;\n      });\n    });\n  }\n\n  removeGroup(group: AjfNodeGroupInstance | AjfRepeatingSlideInstance): Observable<boolean> {\n    return new Observable<boolean>((subscriber: Subscriber<boolean>) => {\n      if (group.formulaReps != null) {\n        subscriber.next(false);\n        subscriber.complete();\n        return;\n      }\n      const minReps = group.node.minReps;\n      if (group.reps - 1 < minReps) {\n        subscriber.next(false);\n        subscriber.complete();\n        return;\n      }\n      const oldReps = group.reps;\n      group.reps = group.reps - 1;\n      group.canAdd = group.node.maxReps === 0 || group.reps < group.node.maxReps;\n      group.canRemove = group.node.minReps === 0 || group.reps > group.node.minReps;\n      this._nodesUpdates.next((nodes: AjfNodeInstance[]): AjfNodeInstance[] => {\n        this._adjustReps(nodes, group, oldReps, this.getFormValue());\n        subscriber.next(true);\n        subscriber.complete();\n        return nodes;\n      });\n    });\n  }\n\n  getControl(field: AjfFieldInstance): Observable<AbstractControl | null> {\n    return this.formGroup.pipe(map((f) => {\n      const fieldName = nodeInstanceCompleteName(field);\n      return f != null && f.contains(fieldName) ? f.controls[fieldName] : null;\n    }));\n  }\n\n  private _initErrorsStreams(): void {\n    this._errorPositions = this._valueChanged.pipe(\n        withLatestFrom(this._nodes, this._form), filter(v => v[2] != null && v[2].form != null),\n        map((v: [void, AjfNodeInstance[], {form: AjfForm | null, context?: AjfContext}|null]) => {\n          const nodes = v[1];\n          const form = v[2]!.form!;\n          let currentPosition = 0;\n          const errors: number[] = [];\n          nodes.forEach((node) => {\n            if (node.node.nodeType === AjfNodeType.AjfRepeatingSlide) {\n              const rsNode = node as AjfRepeatingSlideInstance;\n              for (let i = 0; i < rsNode.reps; i++) {\n                if (node.visible) {\n                  currentPosition++;\n                  if (i == 0) {\n                    rsNode.position = currentPosition;\n                  }\n                  if (!validSlide(rsNode, i)) {\n                    errors.push(currentPosition);\n                  }\n                }\n              }\n            } else if (node.node.nodeType === AjfNodeType.AjfSlide) {\n              const sNode = node as AjfSlideInstance;\n              if (sNode.visible) {\n                currentPosition++;\n                sNode.position = currentPosition;\n                if (!sNode.valid) {\n                  errors.push(currentPosition);\n                }\n              }\n            }\n          });\n          form.valid = errors.length == 0;\n          this._slidesNum.next(currentPosition);\n          return errors;\n        }),\n        publishReplay(), refCount());\n    this._errors = this._errorPositions.pipe(\n      map(e => e != null ? e.length : 0),\n      startWith(0),\n      publishReplay(),\n      refCount()\n    );\n  }\n\n  private _initUpdateMapStreams(): void {\n    this._visibilityNodesMap =\n        (<Observable<AjfRendererUpdateMapOperation>>this._visibilityNodesMapUpdates)\n            .pipe(scan((rmap: AjfRendererUpdateMap, op: AjfRendererUpdateMapOperation) => {\n                    return op(rmap);\n                  }, {}), startWith<AjfRendererUpdateMap>({}), share());\n    this._repetitionNodesMap =\n        (<Observable<AjfRendererUpdateMapOperation>>this._repetitionNodesMapUpdates)\n            .pipe(scan((rmap: AjfRendererUpdateMap, op: AjfRendererUpdateMapOperation) => {\n                    return op(rmap);\n                  }, {}), startWith<AjfRendererUpdateMap>({}), share());\n    this._conditionalBranchNodesMap =\n        (<Observable<AjfRendererUpdateMapOperation>>this._conditionalBranchNodesMapUpdates)\n            .pipe(scan((rmap: AjfRendererUpdateMap, op: AjfRendererUpdateMapOperation) => {\n                    return op(rmap);\n                  }, {}), startWith<AjfRendererUpdateMap>({}), share());\n    this._formulaNodesMap =\n        (<Observable<AjfRendererUpdateMapOperation>>this._formulaNodesMapUpdates)\n            .pipe(scan((rmap: AjfRendererUpdateMap, op: AjfRendererUpdateMapOperation) => {\n                    return op(rmap);\n                  }, {}), startWith<AjfRendererUpdateMap>({}), share());\n    this._validationNodesMap =\n        (<Observable<AjfRendererUpdateMapOperation>>this._validationNodesMapUpdates)\n            .pipe(scan((rmap: AjfRendererUpdateMap, op: AjfRendererUpdateMapOperation) => {\n                    return op(rmap);\n                  }, {}), startWith<AjfRendererUpdateMap>({}), share());\n    this._warningNodesMap =\n        (<Observable<AjfRendererUpdateMapOperation>>this._warningNodesMapUpdates)\n            .pipe(scan((rmap: AjfRendererUpdateMap, op: AjfRendererUpdateMapOperation) => {\n                    return op(rmap);\n                  }, {}), startWith<AjfRendererUpdateMap>({}), share());\n    this._filteredChoicesNodesMap =\n        (<Observable<AjfRendererUpdateMapOperation>>this._filteredChoicesNodesMapUpdates)\n            .pipe(scan((rmap: AjfRendererUpdateMap, op: AjfRendererUpdateMapOperation) => {\n                    return op(rmap);\n                  }, {}), startWith<AjfRendererUpdateMap>({}), share());\n    this._triggerConditionsNodesMap =\n        (<Observable<AjfRendererUpdateMapOperation>>this._triggerConditionsNodesMapUpdates)\n            .pipe(scan((rmap: AjfRendererUpdateMap, op: AjfRendererUpdateMapOperation) => {\n                    return op(rmap);\n                  }, {}), startWith<AjfRendererUpdateMap>({}), share());\n    this._nextSlideConditionsNodesMap =\n        (<Observable<AjfRendererUpdateMapOperation>>this._nextSlideConditionsNodesMapUpdates)\n            .pipe(scan((rmap: AjfRendererUpdateMap, op: AjfRendererUpdateMapOperation) => {\n                    return op(rmap);\n                  }, {}), startWith<AjfRendererUpdateMap>({}), share());\n\n    this._nodesMaps = [\n      this._visibilityNodesMap,\n      this._repetitionNodesMap,\n      this._conditionalBranchNodesMap,\n      this._formulaNodesMap,\n      this._validationNodesMap,\n      this._warningNodesMap,\n      this._nextSlideConditionsNodesMap,\n      this._filteredChoicesNodesMap,\n      this._triggerConditionsNodesMap\n    ];\n  }\n\n  private _initFormStreams(): void {\n    const formObs = <Observable<{form: AjfForm | null, context?: AjfContext}>>this._form;\n    formObs\n      .pipe(map((_form) => {\n        return this._initFormGroupStreams(new FormGroup({}));\n      }))\n      .subscribe(this._formGroup);\n    formObs\n        .pipe(map((form) => {\n          return (_nodesInstances: AjfNodeInstance[]): AjfNodeInstance[] => {\n            const nodes = form != null && form.form != null ?\n                this._orderedNodesInstancesTree(\n                    flattenNodes(form.form.nodes), form.form.nodes, undefined, [],\n                    form.context || {}) :\n                [];\n            let currentPosition = 0;\n            nodes.forEach((node) => {\n              if (node.node.nodeType === AjfNodeType.AjfRepeatingSlide) {\n                const rsNode = node as AjfRepeatingSlideInstance;\n                for (let i = 0; i < rsNode.reps; i++) {\n                  if (node.visible) {\n                    currentPosition++;\n                    if (i == 0) {\n                      rsNode.position = currentPosition;\n                    }\n                  }\n                }\n              } else if (node.node.nodeType === AjfNodeType.AjfSlide) {\n                const sNode = node as AjfSlideInstance;\n                if (sNode.visible) {\n                  currentPosition++;\n                  sNode.position = currentPosition;\n                }\n              }\n            });\n            return nodes;\n          };\n        }))\n        .subscribe(this._nodesUpdates);\n  }\n\n  private _initNodeInstance(\n      allNodes: AjfNode[]|AjfNodeInstance[], node: AjfNode, prefix: number[], context: AjfContext,\n      branchVisibility = true): AjfNodeInstance|null {\n    let instance = nodeToNodeInstance(allNodes, node, prefix, context);\n    if (instance != null) {\n      const nodeType = instance.node.nodeType;\n      if (nodeType === AjfNodeType.AjfNodeGroup || nodeType === AjfNodeType.AjfRepeatingSlide) {\n        this._explodeRepeatingNode(\n            allNodes, instance as AjfNodeGroupInstance | AjfRepeatingSlideInstance, context);\n      } else if (nodeType === AjfNodeType.AjfSlide) {\n        const sInstance = instance as AjfSlideInstance;\n        sInstance.nodes = this._orderedNodesInstancesTree(\n            allNodes, sInstance.node.nodes, sInstance.node.id, prefix, context);\n      }\n      updateVisibility(instance, context, branchVisibility);\n      updateConditionalBranches(instance, context);\n      if (nodeType === AjfNodeType.AjfField) {\n        const fInstance = instance as AjfFieldInstance;\n\n        if (isCustomFieldWithChoices(fInstance.node) || isFieldWithChoices(fInstance.node)) {\n          updateFilteredChoices(fInstance as AjfFieldWithChoicesInstance<any>, context);\n        } else {\n          if (isTableFieldInstance(fInstance)) {\n            const tfInstance = fInstance as AjfTableFieldInstance;\n            const tNode = tfInstance.node;\n            tfInstance.context = context[nodeInstanceCompleteName(tfInstance)] || context;\n            if (!tNode.editable) {\n              const value: [string, string[]][] = [];\n              value.push([tNode.label, tNode.columnLabels]);\n              tNode.rows.forEach((row, rowIndex) => {\n                value.push([tNode.rowLabels[rowIndex], row.map(k => {\n                  tfInstance.context[k] = context[k];\n                  return context[k];\n                })]);\n              });\n              tfInstance.value = value;\n            } else {\n              const formGroup = this._formGroup.getValue();\n              let controlsWithLabels: [string, (string|FormControl)[]][] = [];\n              controlsWithLabels.push([node.label, tNode.columnLabels]);\n              tNode.rows.forEach((row, idx) => {\n                let r: FormControl[] = [];\n                row.forEach((k) => {\n                  const control = new FormControl();\n                  console.log(k);\n                  console.log(tfInstance.context[k]);\n                  control.setValue(tfInstance.context[k]);\n                  if (formGroup != null) {\n                    formGroup.registerControl(k, control);\n                  }\n                  r.push(control);\n                });\n                controlsWithLabels.push([tNode.rowLabels[idx], r]);\n              });\n              tfInstance.controls = controlsWithLabels;\n            }\n          } else {\n            fInstance.value = context[nodeInstanceCompleteName(instance)];\n          }\n          updateFieldInstanceState(fInstance, context);\n        }\n      }\n      this._addNodeInstance(instance);\n    }\n    return instance;\n  }\n\n  private _adjustReps(\n      allNodes: AjfNode[]|AjfNodeInstance[], instance: AjfRepeatingContainerNodeInstance,\n      oldReps: number,\n      context: AjfContext): {added: AjfNodeInstance[]|null, removed: AjfNodeInstance[]|null} {\n    const newReps = instance.reps;\n    const result: { added: AjfNodeInstance[] | null, removed: AjfNodeInstance[] | null } = {\n      added: null,\n      removed: null\n    };\n    if (oldReps < newReps) {\n      const newNodes: AjfNodeInstance[] = [];\n      if (instance.nodes == null) {\n        instance.nodes = [];\n      }\n      if (instance.node.nodeType === AjfNodeType.AjfNodeGroup) {\n        const node = createField({\n                       id: 999,\n                       name: '',\n                       parent: -1,\n                       fieldType: AjfFieldType.Empty,\n                       label: instance.node.label\n                     }) as AjfEmptyField;\n        const newInstance = this._initNodeInstance(\n          allNodes, node, instance.prefix.slice(0), context);\n        if (newInstance != null) {\n          instance.nodes.push(newInstance);\n        }\n      }\n      for (let i = oldReps ; i < newReps ; i++) {\n        const prefix = instance.prefix.slice(0);\n        const group = instance.node;\n        prefix.push(i);\n        orderedNodes(group.nodes, instance.node.id)\n          .forEach((n) => {\n            const newInstance = this._initNodeInstance(allNodes, n, prefix, context);\n            if (newInstance != null) {\n              newNodes.push(newInstance);\n              instance.nodes.push(newInstance);\n            }\n          });\n        this._addNodeInstance(instance);\n      }\n      result.added = newNodes;\n    } else if (oldReps > newReps) {\n      let nodesNum = instance.nodes.length / oldReps;\n      if (instance.node.nodeType === AjfNodeType.AjfNodeGroup) {\n        nodesNum ++;\n      }\n      result.removed = instance.nodes.splice(newReps * nodesNum, nodesNum);\n      result.removed.forEach((n => {\n        this._removeNodeInstance(n);\n      }));\n    }\n    if (oldReps != newReps && instance.formulaReps == null) {\n      const fg = this._formGroup.getValue();\n      const completeName = nodeInstanceCompleteName(instance);\n      if (fg != null && fg.contains(completeName)) {\n        fg.controls[completeName].setValue(instance.reps);\n      }\n    }\n    instance.flatNodes = flattenNodesInstances(instance.nodes);\n    if (instance.node.nodeType === AjfNodeType.AjfRepeatingSlide) {\n      const rsInstance = instance as AjfRepeatingSlideInstance;\n      const slideNodes: AjfNodeInstance[][] = [];\n      const nodesPerSlide =\n          rsInstance.nodes != null ? rsInstance.nodes.length / rsInstance.reps : 0;\n      for (let i = 0 ; i < instance.reps ; i++) {\n        const startNode = i * nodesPerSlide;\n        slideNodes.push(instance.nodes.slice(startNode, startNode + nodesPerSlide));\n      }\n      rsInstance.slideNodes = slideNodes;\n    }\n    return result;\n  }\n\n  private _updateFormValueAndValidity(): void {\n    this._nodesUpdates.asObservable()\n        .pipe(\n            withLatestFrom(this._formGroup),\n            filter((values: [AjfNodesInstancesOperation, FormGroup|null]) => values[1] !== null))\n        .subscribe((values: [AjfNodesInstancesOperation, FormGroup|null]) => {\n          const form: FormGroup = <FormGroup>values[1];\n          form.updateValueAndValidity();\n        });\n  }\n\n  private _explodeRepeatingNode(\n      allNodes: AjfNode[]|AjfNodeInstance[],\n      instance: AjfNodeGroupInstance|AjfRepeatingSlideInstance, context: AjfContext) {\n    const oldReps = updateRepsNum(instance, context);\n    if (oldReps !== instance.reps) {\n      this._adjustReps(allNodes, instance, oldReps, context);\n    }\n  }\n\n  private _orderedNodesInstancesTree(\n      allNodes: AjfNode[]|AjfNodeInstance[], nodes: AjfNode[], parent: number|null = null,\n      prefix: number[] = [], context: AjfContext): AjfNodeInstance[] {\n    let nodesInstances: AjfNodeInstance[] = [];\n    const curSuffix = prefix.length > 0 ? '__' + prefix.join('__') : '';\n    orderedNodes(nodes, parent).forEach((node: AjfNode) => {\n      const parentNodeInstance = nodesInstances.find(\n          ni => ni.node.id == node.parent && nodeInstanceSuffix(ni) == curSuffix);\n      const branchVisibility = parentNodeInstance != null ?\n          parentNodeInstance.verifiedBranch != null &&\n              parentNodeInstance.verifiedBranch == node.parentNode :\n          true;\n      const nni = this._initNodeInstance(allNodes, node, prefix, context, branchVisibility);\n      if (nni != null) {\n        nodesInstances.push(nni);\n      }\n    });\n    return nodesInstances;\n  }\n\n  private _formValueDelta(oldValue: any, newValue: any): string[] {\n    return Object.keys(newValue)\n      .filter((k) => oldValue[k] !== newValue[k]);\n  }\n\n  private _initFormGroupStreams(formGroup: FormGroup): FormGroup {\n    this._formGroupSubscription.unsubscribe();\n    let init = true;\n    let initForm = true;\n    this._formInitEvent.emit(AjfFormInitStatus.Initializing);\n    this._formGroupSubscription =\n        formGroup.valueChanges\n            .pipe(\n                startWith<any>({}), pairwise(), debounceTime(200),\n                withLatestFrom<\n                    [any, any],\n                    [\n                      [any, any], AjfRendererUpdateMap, AjfRendererUpdateMap, AjfRendererUpdateMap,\n                      AjfRendererUpdateMap, AjfRendererUpdateMap, AjfRendererUpdateMap,\n                      AjfRendererUpdateMap, AjfRendererUpdateMap, AjfRendererUpdateMap,\n                      AjfNodeInstance[]\n                    ]>(...(this._nodesMaps), this._flatNodes))\n            .subscribe((v: [\n                         [any, any], AjfRendererUpdateMap, AjfRendererUpdateMap,\n                         AjfRendererUpdateMap, AjfRendererUpdateMap, AjfRendererUpdateMap,\n                         AjfRendererUpdateMap, AjfRendererUpdateMap, AjfRendererUpdateMap,\n                         AjfRendererUpdateMap, AjfNodeInstance[]\n                       ]) => {\n              const oldFormValue = init && {} || v[0][0];\n              init = false;\n              const newFormValue = v[0][1];\n              const visibilityMap = v[1];\n              const repetitionMap = v[2];\n              const conditionalBranchesMap = v[3];\n              const formulaMap = v[4];\n              const validationMap = v[5];\n              const warningMap = v[6];\n              const nextSlideConditionsMap = v[7];\n              const filteredChoicesMap = v[8];\n              const triggerConditionsMap = v[9];\n              const nodes = v[10];\n\n              (window as any).nodes = nodes;\n              const delta = this._formValueDelta(oldFormValue, newFormValue);\n              const deltaLen = delta.length;\n              let updatedNodes: AjfNodeInstance[] = [];\n\n              delta.forEach((fieldName) => {\n                updatedNodes = updatedNodes.concat(\n                    nodes.filter(n => nodeInstanceCompleteName(n) === fieldName));\n                if (visibilityMap[fieldName] != null) {\n                  visibilityMap[fieldName].forEach(nodeInstance => {\n                    const completeName = nodeInstanceCompleteName(nodeInstance);\n                    const visibilityChanged = updateVisibility(nodeInstance, newFormValue);\n                    const isField = isFieldInstance(nodeInstance);\n                    if (visibilityChanged && !nodeInstance.visible) {\n                      const fg = this._formGroup.getValue();\n                      if (fg != null) {\n                        const s = timer(200).subscribe(() => {\n                          if (s && !s.closed) {\n                            s.unsubscribe();\n                          }\n                          fg.controls[completeName].setValue(null);\n                        });\n                      }\n                      if (isField) {\n                        (nodeInstance as AjfFieldInstance).value = null;\n                      }\n                    } else if (visibilityChanged && nodeInstance.visible && isField) {\n                      const fg = this._formGroup.getValue();\n                      const res = updateFormula(nodeInstance as AjfFieldInstance, newFormValue);\n                      if (fg != null && res.changed) {\n                        fg.controls[completeName].setValue(res.value);\n                      }\n                    }\n                    if (updatedNodes.indexOf(nodeInstance) === -1) {\n                      updatedNodes.push(nodeInstance);\n                    }\n                  });\n                }\n\n                if (repetitionMap[fieldName] != null) {\n                  repetitionMap[fieldName].forEach(nodeInstance => {\n                    if (isRepeatingContainerNode(nodeInstance.node)) {\n                      const rnInstance = nodeInstance as AjfRepeatingContainerNodeInstance;\n                      const oldReps = updateRepsNum(rnInstance, newFormValue);\n                      if (oldReps !== rnInstance.reps) {\n                        this._adjustReps(nodes, rnInstance, oldReps, newFormValue);\n                      }\n                    }\n                    if (updatedNodes.indexOf(nodeInstance) === -1) {\n                      updatedNodes.push(nodeInstance);\n                    }\n                  });\n                }\n\n                if (conditionalBranchesMap[fieldName] != null) {\n                  conditionalBranchesMap[fieldName].forEach((nodeInstance) => {\n                    // const branchChanged = nodeInstance.updateConditionalBranches(newFormValue);\n                    updateConditionalBranches(nodeInstance, newFormValue);\n                    // if (branchChanged) {\n                    const verifiedBranch = nodeInstance.verifiedBranch;\n                    nodeInstance.conditionalBranches.forEach((_condition, idx) => {\n                      if (idx == verifiedBranch) {\n                        this._showSubtree(newFormValue, nodes, nodeInstance, idx);\n                      } else {\n                        this._hideSubtree(newFormValue, nodes, nodeInstance, idx);\n                      }\n                    });\n                    // }\n                    if (updatedNodes.indexOf(nodeInstance) === -1) {\n                      updatedNodes.push(nodeInstance);\n                    }\n                  });\n                }\n\n                if (formulaMap[fieldName] != null) {\n                  formulaMap[fieldName].forEach((nodeInstance) => {\n                    if (isFieldInstance(nodeInstance)) {\n                      const fInstance = nodeInstance as AjfFieldInstance;\n                      const res = updateFormula(fInstance, newFormValue);\n                      const fg = this._formGroup.getValue();\n                      if (fg != null && res.changed) {\n                        updateValidation(fInstance, newFormValue);\n                        fg.controls[nodeInstanceCompleteName(nodeInstance)].setValue(res.value);\n                      }\n                    }\n                    if (updatedNodes.indexOf(nodeInstance) === -1) {\n                      updatedNodes.push(nodeInstance);\n                    }\n                  });\n                }\n\n                if (validationMap[fieldName] != null) {\n                  validationMap[fieldName].forEach((nodeInstance) => {\n                    if (isFieldInstance(nodeInstance)) {\n                      const fInstance = nodeInstance as AjfFieldInstance;\n                      newFormValue.$value = newFormValue[nodeInstanceCompleteName(nodeInstance)];\n                      updateValidation(\n                          fInstance, newFormValue, this.currentSupplementaryInformations);\n                    }\n                    if (updatedNodes.indexOf(nodeInstance) === -1) {\n                      updatedNodes.push(nodeInstance);\n                    }\n                  });\n                }\n\n                if (warningMap[fieldName] != null) {\n                  warningMap[fieldName].forEach((nodeInstance) => {\n                    if (isFieldInstance(nodeInstance)) {\n                      const fInstance = nodeInstance as AjfFieldInstance;\n                      updateWarning(fInstance, newFormValue);\n                      if (fInstance.warningResults != null &&\n                          fInstance.warningResults.filter(warning => warning.result).length > 0) {\n                        fInstance.warningTrigger.emit();\n                      }\n                    }\n                    if (updatedNodes.indexOf(nodeInstance) === -1) {\n                      updatedNodes.push(nodeInstance);\n                    }\n                  });\n                }\n\n                if (deltaLen == 1 && nextSlideConditionsMap[fieldName] != null) {\n                  if (nextSlideConditionsMap[fieldName]\n                          .filter((nodeInstance) => {\n                            if (isFieldInstance(nodeInstance)) {\n                              const fInstance = nodeInstance as AjfFieldInstance;\n                              return updateNextSlideCondition(fInstance, newFormValue);\n                            }\n                            return false;\n                          })\n                          .length == 1) {\n                    this._nextSlideTrigger.emit();\n                  }\n                }\n\n                if (filteredChoicesMap[fieldName] != null) {\n                  filteredChoicesMap[fieldName].forEach((nodeInstance) => {\n                    if (isFieldInstance(nodeInstance)) {\n                      const fInstance = nodeInstance as AjfFieldInstance;\n                      if (isFieldWithChoices(fInstance.node)) {\n                        updateFilteredChoices(\n                            fInstance as AjfFieldWithChoicesInstance<any>, newFormValue);\n                      }\n                    }\n                    if (updatedNodes.indexOf(nodeInstance) === -1) {\n                      updatedNodes.push(nodeInstance);\n                    }\n                  });\n                }\n\n                if (deltaLen == 1 && triggerConditionsMap[fieldName] != null) {\n                  const res = triggerConditionsMap[fieldName].filter((nodeInstance) => {\n                    if (!isFieldInstance(nodeInstance)) {\n                      return false;\n                    }\n                    const fInstance = nodeInstance as AjfFieldInstance;\n                    if (!isFieldWithChoices(fInstance.node)) {\n                      return false;\n                    }\n                    return updateTriggerConditions(\n                        fInstance as AjfFieldWithChoicesInstance<any>, newFormValue);\n                  });\n                  if (res.length == 1) {\n                    (res[0] as AjfFieldWithChoicesInstance<any>).selectionTrigger.emit();\n                  }\n                }\n              });\n              updatedNodes.forEach(n => {\n                const nodeIdx = nodes.indexOf(n);\n                let idx = nodeIdx - 1;\n                while (idx >= 0) {\n                  const curNode = nodes[idx];\n                  if (isSlidesInstance(curNode)) {\n                    const slide = curNode as (AjfRepeatingSlideInstance | AjfSlideInstance);\n                    const subNodesNum = slide.flatNodes.length;\n                    let valid = true;\n                    for (let i = 0 ; i < subNodesNum ; i++) {\n                      const subNode = slide.flatNodes[i];\n                      if (\n                        subNode.visible && isFieldInstance(subNode)\n                        && !(subNode as AjfFieldInstance).valid\n                      ) {\n                        valid = false;\n                        break;\n                      }\n                    }\n                    if (slide.valid !== valid) {\n                      slide.valid = valid;\n                    }\n                    slide.updatedEvt.emit();\n                  }\n                  idx--;\n                }\n                n.updatedEvt.emit();\n              });\n              if (initForm) {\n                initForm = false;\n                this._formInitEvent.emit(AjfFormInitStatus.Complete);\n              }\n              this._valueChanged.next();\n            });\n    return formGroup;\n  }\n\n  private _showSubtree(\n      context: AjfContext, nodes: AjfNodeInstance[], node: AjfNodeInstance, branch?: number) {\n    this._updateSubtreeVisibility(context, nodes, node, true, branch);\n  }\n\n  private _hideSubtree(\n      context: AjfContext, nodes: AjfNodeInstance[], node: AjfNodeInstance, branch?: number) {\n    this._updateSubtreeVisibility(context, nodes, node, false, branch);\n  }\n\n  private _updateSubtreeVisibility(\n      context: AjfContext, nodes: AjfNodeInstance[], node: AjfNodeInstance, visible: boolean,\n      branch?: number) {\n    let subNodes: AjfNodeInstance[];\n    const nodeSuffix = nodeInstanceSuffix(node);\n    if (branch != null) {\n      subNodes = nodes.filter(n => {\n        const suffix = nodeInstanceSuffix(n);\n        return suffix == nodeSuffix && n.node.parent == node.node.id && n.node.parentNode == branch;\n      });\n    } else {\n      subNodes = nodes.filter(n => {\n        const suffix = nodeInstanceSuffix(n);\n        return suffix == nodeSuffix && n.node.parent == node.node.id;\n      });\n    }\n    const isContainer = isContainerNode(node.node);\n    subNodes.forEach((n) => {\n      if (\n        !isContainer ||\n        (isContainer && (<AjfNodeGroup>node.node).nodes.find(cn => cn.id == n.node.id) == null)\n      ) {\n        updateVisibility(n, context, visible);\n        updateFormula(n as AjfFormulaFieldInstance, context);\n        this._updateSubtreeVisibility(context, nodes, n, visible);\n      }\n    });\n  }\n\n  private _initNodesStreams(): void {\n    this._nodes =\n        this._nodesUpdates.pipe(scan((nodes: AjfNodeInstance[], op: AjfNodesInstancesOperation) => {\n                                  return op(nodes);\n                                }, []), share());\n    this._flatNodesTree = this._nodes.pipe(map(nodes => flattenNodesInstancesTree(nodes)), share());\n    this._flatNodes = this._flatNodesTree.pipe(\n        map(slides => {\n          let nodes: AjfNodeInstance[] = [];\n          slides.forEach(s => {\n            nodes.push(s);\n            nodes = nodes.concat(s.flatNodes);\n          });\n          return nodes;\n        }),\n        share());\n  }\n\n  private _removeNodeInstance(nodeInstance: AjfNodeInstance): AjfNodeInstance {\n    const nodeName = nodeInstanceCompleteName(nodeInstance);\n    this._removeNodesVisibilityMapIndex(nodeName);\n    this._removeNodesRepetitionMapIndex(nodeName);\n    this._removeNodesConditionalBranchMapIndex(nodeName);\n    this._removeNodesFormulaMapIndex(nodeName);\n    this._removeNodesValidationMapIndex(nodeName);\n    this._removeNodesWarningMapIndex(nodeName);\n    this._removeNodesNextSlideConditionsMapIndex(nodeName);\n    this._removeNodesFilteredChoicesMapIndex(nodeName);\n    this._removeNodesTriggerConditionsMapIndex(nodeName);\n    if (isSlidesInstance(nodeInstance)) {\n      return this._removeSlideInstance(nodeInstance as AjfBaseSlideInstance);\n    } else if (isRepeatingContainerNode(nodeInstance.node)) {\n      this._removeNodeGroupInstance(nodeInstance as AjfRepeatingContainerNodeInstance);\n    } else if (isFieldInstance(nodeInstance)) {\n      this._removeFieldInstance(nodeInstance as AjfFieldInstance);\n    }\n\n    return nodeInstance;\n  }\n\n  private _removeSlideInstance(slideInstance: AjfBaseSlideInstance): AjfBaseSlideInstance {\n    const slide = slideInstance.node;\n    if (slide.visibility != null) {\n      this._removeFromNodesVisibilityMap(slideInstance, slide.visibility.condition);\n    }\n    slideInstance.conditionalBranches.forEach((conditionalBranch: AjfCondition) => {\n      this._removeFromNodesConditionalBranchMap(slideInstance, conditionalBranch.condition);\n    });\n    return slideInstance;\n  }\n\n  private _removeNodeGroupInstance(nodeGroupInstance: AjfRepeatingContainerNodeInstance):\n      AjfRepeatingContainerNodeInstance {\n    const nodeGroup = nodeGroupInstance.node;\n    if (nodeGroup.visibility != null) {\n      this._removeFromNodesVisibilityMap(nodeGroupInstance, nodeGroup.visibility.condition);\n    }\n    if (nodeGroupInstance.formulaReps != null && nodeGroup.formulaReps != null) {\n      this._removeFromNodesRepetitionMap(nodeGroupInstance, nodeGroup.formulaReps.formula);\n    }\n    return nodeGroupInstance;\n  }\n\n  private _removeFieldInstance(fieldInstance: AjfFieldInstance): AjfFieldInstance {\n    const formGroup = this._formGroup.getValue();\n    const fieldInstanceName = nodeInstanceCompleteName(fieldInstance);\n    if (formGroup != null && formGroup.contains(fieldInstanceName)) {\n      formGroup.removeControl(fieldInstanceName);\n    }\n    if (fieldInstance.validation != null) {\n      this._validationNodesMapUpdates.next((vmap: AjfRendererUpdateMap): AjfRendererUpdateMap => {\n        if (vmap[fieldInstanceName] == null) {\n          delete vmap[fieldInstanceName];\n        }\n        return vmap;\n      });\n    }\n\n    if (fieldInstance.visibility != null) {\n      this._removeFromNodesVisibilityMap(fieldInstance, fieldInstance.visibility.condition);\n    }\n\n    fieldInstance.conditionalBranches.forEach((conditionalBranch: AjfCondition) => {\n      this._removeFromNodesConditionalBranchMap(fieldInstance, conditionalBranch.condition);\n    });\n\n    if (fieldInstance.formula) {\n      this._removeFromNodesFormulaMap(fieldInstance, fieldInstance.formula.formula);\n    }\n\n    // TODO: check this, probably is never verified\n    if (isRepeatingContainerNode(fieldInstance.node)) {\n      const rcInstance = (fieldInstance as AjfNodeInstance as AjfRepeatingContainerNodeInstance);\n      if (rcInstance.formulaReps != null) {\n        this._removeFromNodesRepetitionMap(fieldInstance, rcInstance.formulaReps.formula);\n      }\n    }\n\n    if (fieldInstance.validation != null && fieldInstance.validation.conditions != null) {\n      fieldInstance.validation.conditions.forEach((condition) => {\n        this._removeFromNodesValidationMap(fieldInstance, condition.condition);\n      });\n    }\n\n    if (fieldInstance.warning != null) {\n      fieldInstance.warning.conditions.forEach((condition) => {\n        this._removeFromNodesWarningMap(fieldInstance, condition.condition);\n      });\n    }\n\n    if (fieldInstance.nextSlideCondition != null) {\n      this._removeFromNodesNextSlideConditionsMap(\n        fieldInstance, fieldInstance.nextSlideCondition.condition\n      );\n    }\n\n    if (isFieldWithChoices(fieldInstance.node)) {\n      const fwcInstance = fieldInstance as AjfFieldWithChoicesInstance<any>;\n      if (fwcInstance.choicesFilter != null) {\n        this._removeFromNodesFilteredChoicesMap(fieldInstance, fwcInstance.choicesFilter.formula);\n        if (fwcInstance.triggerConditions != null) {\n          fwcInstance.triggerConditions.forEach((condition) => {\n            this._removeFromNodesTriggerConditionsMap(fieldInstance, condition.condition);\n          });\n        }\n      }\n    }\n\n    return fieldInstance;\n  }\n\n  private _addNodeInstance(nodeInstance: AjfNodeInstance): AjfNodeInstance {\n    if (isRepeatingContainerNode(nodeInstance.node)) {\n      return this._addNodeGroupInstance(nodeInstance as AjfRepeatingContainerNodeInstance);\n    } else if (isSlideInstance(nodeInstance)) {\n      return this._addSlideInstance(nodeInstance as AjfSlideInstance);\n    } else if (isFieldInstance(nodeInstance)) {\n      return this._addFieldInstance(nodeInstance as AjfFieldInstance);\n    }\n\n    return nodeInstance;\n  }\n\n  private _addFieldInstance(fieldInstance: AjfFieldInstance): AjfFieldInstance {\n    const formGroup = this._formGroup.getValue();\n    const fieldInstanceName = nodeInstanceCompleteName(fieldInstance);\n    if (formGroup != null && !formGroup.contains(fieldInstanceName)) {\n      const control = new FormControl();\n      control.setValue(fieldInstance.value);\n      formGroup.registerControl(fieldInstanceName, control);\n    }\n    if (fieldInstance.validation != null) {\n      this._validationNodesMapUpdates.next((vmap: AjfRendererUpdateMap): AjfRendererUpdateMap => {\n        if (vmap[fieldInstanceName] == null) {\n          vmap[fieldInstanceName] = [];\n        }\n        if (vmap[fieldInstanceName].indexOf(fieldInstance) == -1) {\n          vmap[fieldInstanceName].push(fieldInstance);\n        }\n        return vmap;\n      });\n    }\n\n    if (fieldInstance.visibility != null) {\n      this._addToNodesVisibilityMap(fieldInstance, fieldInstance.visibility.condition);\n    }\n\n    fieldInstance.conditionalBranches.forEach((conditionalBranch: AjfCondition) => {\n      this._addToNodesConditionalBranchMap(fieldInstance, conditionalBranch.condition);\n    });\n\n    if (fieldInstance.formula) {\n      this._addToNodesFormulaMap(fieldInstance, fieldInstance.formula.formula);\n    }\n\n    if (isNodeGroupInstance(fieldInstance)) {\n      const ngInstance = fieldInstance as AjfNodeInstance as AjfNodeGroupInstance;\n      if (ngInstance.formulaReps != null) {\n        this._addToNodesRepetitionMap(fieldInstance, ngInstance.formulaReps.formula);\n      }\n    }\n\n    if (fieldInstance.validation != null && fieldInstance.validation.conditions != null) {\n      fieldInstance.validation.conditions.forEach((condition) => {\n        this._addToNodesValidationMap(fieldInstance, condition.condition);\n      });\n    }\n\n    if (fieldInstance.warning != null) {\n      fieldInstance.warning.conditions.forEach((condition) => {\n        this._addToNodesWarningMap(fieldInstance, condition.condition);\n      });\n    }\n\n    if (fieldInstance.nextSlideCondition != null) {\n      this._addToNodesNextSlideConditionsMap(\n        fieldInstance, fieldInstance.nextSlideCondition.condition\n      );\n    }\n\n    if (isCustomFieldWithChoices(fieldInstance.node) || isFieldWithChoicesInstance(fieldInstance)) {\n      const fwcInstance = fieldInstance as AjfFieldWithChoicesInstance<any>;\n      if (fwcInstance.choicesFilter != null) {\n        this._addToNodesFilteredChoicesMap(fieldInstance, fwcInstance.choicesFilter.formula);\n      }\n      if (fwcInstance.triggerConditions != null) {\n        fwcInstance.triggerConditions.forEach((condition: AjfCondition) => {\n          this._addToNodesTriggerConditionsMap(fieldInstance, condition.condition);\n        });\n      }\n    }\n\n    return fieldInstance;\n  }\n\n  private _addSlideInstance(slideInstance: AjfSlideInstance): AjfSlideInstance {\n    const slide = slideInstance.node;\n    if (slide.visibility != null) {\n      this._addToNodesVisibilityMap(slideInstance, slide.visibility.condition);\n    }\n    slideInstance.conditionalBranches.forEach((conditionalBranch: AjfCondition) => {\n      this._addToNodesConditionalBranchMap(slideInstance, conditionalBranch.condition);\n    });\n    return slideInstance;\n  }\n\n  private _addNodeGroupInstance(nodeGroupInstance: AjfRepeatingContainerNodeInstance):\n      AjfRepeatingContainerNodeInstance {\n    const nodeGroup = nodeGroupInstance.node;\n    if (nodeGroup.visibility != null) {\n      this._addToNodesVisibilityMap(nodeGroupInstance, nodeGroup.visibility.condition);\n    }\n    nodeGroupInstance.conditionalBranches.forEach((conditionalBranch: AjfCondition) => {\n      this._addToNodesConditionalBranchMap(nodeGroupInstance, conditionalBranch.condition);\n    });\n    if (nodeGroupInstance.formulaReps != null) {\n      if (nodeGroup.formulaReps != null) {\n        this._addToNodesRepetitionMap(nodeGroupInstance, nodeGroup.formulaReps.formula);\n      }\n    } else {\n      let formGroup = this._formGroup.getValue();\n      let nodeGroupInstanceName = nodeInstanceCompleteName(nodeGroupInstance);\n      if (formGroup != null && !formGroup.contains(nodeGroupInstanceName)) {\n        const control = new FormControl();\n        control.setValue(nodeGroupInstance.reps);\n        formGroup.registerControl(nodeGroupInstanceName, control);\n      }\n    }\n    return nodeGroupInstance;\n  }\n\n  private _removeNodesVisibilityMapIndex(index: string): void {\n    this._removeNodesMapIndex(this._visibilityNodesMapUpdates, index);\n  }\n\n  private _removeNodesRepetitionMapIndex(index: string): void {\n    this._removeNodesMapIndex(this._repetitionNodesMapUpdates, index);\n  }\n\n  private _removeNodesConditionalBranchMapIndex(index: string): void {\n    this._removeNodesMapIndex(this._conditionalBranchNodesMapUpdates, index);\n  }\n\n  private _removeNodesFormulaMapIndex(index: string): void {\n    this._removeNodesMapIndex(this._formulaNodesMapUpdates, index);\n  }\n\n  private _removeNodesValidationMapIndex(index: string): void {\n    this._removeNodesMapIndex(this._validationNodesMapUpdates, index);\n  }\n\n  private _removeNodesWarningMapIndex(index: string): void {\n    this._removeNodesMapIndex(this._warningNodesMapUpdates, index);\n  }\n\n  private _removeNodesFilteredChoicesMapIndex(index: string): void {\n    this._removeNodesMapIndex(this._filteredChoicesNodesMapUpdates, index);\n  }\n\n  private _removeNodesTriggerConditionsMapIndex(index: string): void {\n    this._removeNodesMapIndex(this._triggerConditionsNodesMapUpdates, index);\n  }\n\n  private _removeNodesNextSlideConditionsMapIndex(index: string): void {\n    this._removeNodesMapIndex(this._nextSlideConditionsNodesMapUpdates, index);\n  }\n\n  private _removeNodesMapIndex(nodesMap: Subject<AjfRendererUpdateMapOperation>, index: string) {\n    nodesMap.next((vmap: AjfRendererUpdateMap): AjfRendererUpdateMap => {\n      if (Object.keys(vmap).indexOf(index) > -1) {\n        delete vmap[index];\n      }\n      return vmap;\n    });\n  }\n\n  private _removeFromNodesVisibilityMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._removeFromNodesMap(this._visibilityNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _removeFromNodesRepetitionMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._removeFromNodesMap(this._repetitionNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _removeFromNodesConditionalBranchMap(\n    nodeInstance: AjfNodeInstance, formula: string\n  ): void {\n    this._removeFromNodesMap(this._conditionalBranchNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _removeFromNodesFormulaMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._removeFromNodesMap(this._formulaNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _removeFromNodesValidationMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._removeFromNodesMap(this._validationNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _removeFromNodesWarningMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._removeFromNodesMap(this._warningNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _removeFromNodesFilteredChoicesMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._removeFromNodesMap(this._filteredChoicesNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _removeFromNodesTriggerConditionsMap(\n    nodeInstance: AjfNodeInstance, formula: string\n  ): void {\n    this._removeFromNodesMap(this._filteredChoicesNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _removeFromNodesNextSlideConditionsMap(\n    nodeInstance: AjfNodeInstance, formula: string\n  ): void {\n    this._removeFromNodesMap(this._nextSlideConditionsNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _removeFromNodesMap(\n      nodesMap: Subject<AjfRendererUpdateMapOperation>, nodeInstance: AjfNodeInstance,\n      formula: string): void {\n    let tokens = tokenize(formula)\n      .filter((token: any) => token.type == 'Identifier' && token.value != '$value');\n    if (tokens.length > 0) {\n      nodesMap.next((vmap: AjfRendererUpdateMap): AjfRendererUpdateMap => {\n        tokens.forEach((token: any) => {\n          let tokenName = token.value;\n          if (vmap[tokenName] != null) {\n            const idx = vmap[tokenName].indexOf(nodeInstance);\n            if (idx > -1) {\n              vmap[tokenName].splice(idx, 1);\n              if (vmap[tokenName].length == 0) {\n                delete vmap[tokenName];\n              }\n            }\n          }\n        });\n        return vmap;\n      });\n    }\n  }\n\n  private _addToNodesVisibilityMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._addToNodesMap(this._visibilityNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _addToNodesRepetitionMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._addToNodesMap(this._repetitionNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _addToNodesConditionalBranchMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._addToNodesMap(this._conditionalBranchNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _addToNodesFormulaMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._addToNodesMap(this._formulaNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _addToNodesValidationMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._addToNodesMap(this._validationNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _addToNodesWarningMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._addToNodesMap(this._warningNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _addToNodesFilteredChoicesMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._addToNodesMap(this._filteredChoicesNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _addToNodesTriggerConditionsMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._addToNodesMap(this._triggerConditionsNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _addToNodesNextSlideConditionsMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._addToNodesMap(this._nextSlideConditionsNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _addToNodesMap(\n      nodesMap: Subject<AjfRendererUpdateMapOperation>, nodeInstance: AjfNodeInstance,\n      formula: string): void {\n    let tokens = tokenize(formula)\n      .filter((token: any) => token.type == 'Identifier' && token.value != '$value');\n    if (tokens.length > 0) {\n      nodesMap.next((vmap: AjfRendererUpdateMap): AjfRendererUpdateMap => {\n        tokens.forEach((token: any) => {\n          let tokenName = token.value;\n          if (vmap[tokenName] == null) {\n            vmap[tokenName] = [];\n          }\n          if (vmap[tokenName].indexOf(nodeInstance) === -1) {\n            vmap[tokenName].push(nodeInstance);\n          }\n        });\n        return vmap;\n      });\n    }\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfExpressionUtils} from '@ajf/core/models';\nimport {Injectable} from '@angular/core';\n\n@Injectable()\nexport class AjfValidationService {\n  private _baseUtilFunctions: string[] = [\n    `/**\n        * count the number of digit contained on x.\n        * @param  x the value used for digit count\n        * @return the count of the digit\n      */\n    var digitCount = function(x) { return x.toString().length; }`,\n    `/**\n        * count the number of decimal contained on x.\n        * @param  x the value used for decimal count\n        * @return the count of the decimal\n      */\n    var decimalCount = function(x) {\n      return (parseFloat(x).toString().split('.')[1] || []).length;\n    }`,\n    `/**\n        * check if x is integer\n        * @param  x the value used for check\n        * @return true if x is a number\n      */\n    var isInt = function(x) { return !/[,.]/.test(x); }`,\n    `/**\n        * check if x is not empity\n        * @param  x the value used for check\n        * @return true if x defined and not null and the number of digit is > 0\n      */\n    var notEmpty = function (x) {\n      return (typeof x !== 'undefined' && x !== null ? x.toString().length > 0 : false);\n    }`,\n    `/**\n        * check if x is contained on array\n        * @param  x the value used for check\n        * @return the position of x on array or if array === x\n      */\n    var valueInChoice = function(array, x) { return array.indexOf(x) > -1 || array === x; }`,\n    `var scanGroupField = function(reps, acc, callback) {\n        for (var i = 0; i < reps; i++) {\n            acc = callback(acc, i);\n        }\n        return acc;\n    }`,\n    `/**\n        * sum the value contained on array\n        * @param  x the array\n        * @return the sum\n      */\n    var sum = function(array) {return array.reduce(function(a, b){ return a + b; }, 0); }`,\n    `var dateOperations = function(dString, period, operation, v) {\n        fmt = 'MM/DD/YYYY';\n        var d = (typeof dString !== 'undefined') ? dateUtils.parse(dString) : new Date();\n        if (operation == 'remove') {\n          v = -v;\n        }\n        var dateOp;\n        switch (period) {\n          case 'day':\n            dateOp = dateUtils.addDays;\n            break;\n          case 'month':\n            dateOp = dateUtils.addMonths;\n            break;\n          case 'year':\n            dateOp = dateUtils.addYears;\n            break;\n          default:\n            return -1;\n        }\n        return dateUtils.format(dateOp(d, v), fmt);\n      }`,\n    `/**\n        * round the num\n        * @param  num the value to round\n        * @param  digits how many digit\n        * @return num rounded\n      */\n      var round = function(num, digits) {\n        digits = digits || 0;\n        var f = 0;\n        try { f = parseFloat(num); } catch (e) { }\n        var m = Math.pow(10, digits);\n        return Math.round(f * m) / m;\n      }`,\n    `/**\n        * extract the property of the source object with property != null\n        * @param  source array of object wich contains property\n        * @param  property the property on wich we want filter\n        * @return array of dates\n      */\n      var extractArray = function(source, property, property2) {\n        source = (source || []).slice(0);\n        var l = source.length;\n        var res = [];\n        for (var i = 0; i < l ; i++) {\n          if (source[i][property] != null && source[i][property2] != null) {\n            res.push(source[i][property] + source[i][property2]);\n          }\n          else if (source[i][property] != null) {\n            res.push(source[i][property]);\n          }\n        }\n        return res;\n      }`,\n    `/**\n        * extract the property of the source object with property != null\n        * @param  source array of object wich contains property\n        * @param  propertues string array the properties to sum\n        * @return the sum\n      */\n      var extractSum = function(source, properties) {\n        var sum = 0;\n        properties = (properties || []).slice(0);\n        var l = properties.length;\n\n        for (var i = 0; i < l ; i++) {\n          var array = extractArray(source, properties[i]);\n          var leng = array.length;\n          for(var j = 0; j < leng; i++) {\n            sum += array[j];\n          }\n        }\n        return sum;\n      }`,\n      `/**\n        * extract the array of sum for each week != null\n        * @param  source array of object wich contains property\n        * @param  propertues string array the properties to sum\n        * @return the sum\n      */\n      var extractArraySum = function(source, properties) {\n        var arrays = [];\n        properties = (properties || []).slice(0);\n\n        for (var propI = 0; propI < properties.length ; propI++) {\n          var array = extractArray(source, properties[propI]);\n          arrays.push(array);\n        }\n\n        var res = [];\n        for (var weekI = 0; weekI < array.length; weekI ++ ) {\n          var sum = 0;\n          for (var propI = 0; propI < properties.length ; propI++) {\n            sum = sum + arrays[propI][weekI]\n          }\n          res.push(sum);\n        }\n        return res;\n      }`,\n    `/**\n        * draw a threshold line on chart related to the property\n        * @param  source array of object wich contains property\n        * @param  property the property on wich we want filter\n        * @return array of dates\n      */\n      var drawThreshold = function(source, property, threshold) {\n        source = (source || []).slice(0);\n        var l = source.length;\n        var res = [];\n        for (var i = 0; i < l ; i++) {\n          if (source[i][property] != null) {\n            res.push(threshold);\n          }\n        }\n        return res;\n      }`,\n    `/**\n        * extract the dates of the source object with property != null\n        * @param  source array of object wich contains property and date_start\n        * @param  property the property on wich we want to calculate dates\n        * @param  format the format of the date\n        * @return array of dates\n      */\n      var extractDates = function(source, property, format) {\n        source = (source || []).slice(0);\n        var l = source.length;\n        var res = [];\n        var prefix = '';\n        for (var i = 0; i < l ; i++) {\n          if (source[i][property] != null) {\n            switch(format) {\n              case \"WW\":\n                prefix = \"W\";\n                break;\n              case \"MM\":\n                prefix = \"M\";\n                break;\n              default:\n                prefix = \"\";\n            }\n            res.push(prefix + formatDate(source[i][\"date_start\"], format));\n          }\n        }\n        return res;\n      }`,\n    `/**\n        * extract the last property contains in source != null\n        * @param  source array of object wich contains property and date_start\n        * @param  property the property to find\n        * @return the last property != null\n      */\n      var lastProperty = function(source, property) {\n        source = (source || []).slice(0);\n        var l = source.length -1;\n\n        while (l >= 0 && source[l][property] == null) {\n          l--;\n          if (l < 0) return 0;\n        }\n        return l >= 0 ? source[l][property] : 0;\n      }`,\n    `var sumLastProperties = function(source, properties) {\n        source = (source || []).slice(0);\n        var sum = 0;\n        for (var i = 0; i < properties.length; i++) {\n          sum += lastProperty(source, properties[i]);\n        }\n\n        return sum;\n      }`,\n    `/**\n        * compute the trend of the property contained on the source.\n        * @param  source array of object wich contains property\n        * @param  property the property on wich we want to calculate the trend\n        * @return an html icon that identifies the trend\n      */\n      var calculateTrendProperty = function(source, property) {\n        source = (source || []).slice(0);\n        var last = source.length - 1;\n        while (source[last][property] == null) {\n          if (last == 0) {\n            break;\n          }\n          last--;\n        }\n        var lastLast = last - 1;\n        if (last == 0) {\n          lastLast = last;\n        } else {\n          while (source[lastLast][property] == null) {\n            if (lastLast == 0) {\n              lastLast = last;\n              break;\n            }\n            lastLast--;\n          }\n        }\n\n        var lastProperty = source[last]?(source[last][property] || 0): 0;\n        var lastLastProperty = source[lastLast]?(source[lastLast][property] || 0): 0;\n\n        if (lastProperty == lastLastProperty) {\n          return '<p><i class=\"material-icons\" style=\"color:blue\">trending_flat</i></p>';\n        } else if (lastProperty > lastLastProperty) {\n          return '<p><i class=\"material-icons\" style=\"color:green\">trending_up</i></p>';\n        } else {\n          return '<p><i class=\"material-icons\" style=\"color:red\">trending_down</i></p>';\n        }\n      }`,\n    `/**\n        * compute the average value of the property contained on the source.\n        * @param  source array of object wich contains property\n        * @param  property the property on wich we want to calculate the average\n        * @param  range the range on wich we want to calculate the average\n        * @param  coefficent the coefficent used for calculate the threshold\n                  if coefficent is 0 mean return the count of property > 0\n        * @return the average value || the count of property > 0\n      */\n      var calculateAvgProperty = function(source, property, range, coefficient) {\n        source = (source || []).slice(0);\n\n        source.pop();\n\n        coefficient = coefficient || 1;\n        range = range || 12;\n\n        var l = source.length;\n        var res = 0;\n        var counter = 0;\n        var noZero = 0;\n\n        if(l < range) {\n          range = l;\n        }\n\n        while (range != 0) {\n          counter++;\n          if (source[l - 1][property] != null) {\n            res += source[l - 1][property];\n\n            if (source[l - 1][property] > 0) {\n              noZero++;\n            }\n          }\n          l--;\n          range--;\n        }\n\n        if (coefficient == 0) {\n          return noZero;\n        } else {\n          var threshold = (res/counter)*coefficient || 0;\n          return threshold;\n        }\n      }`,\n    `var alert = function(source, property, threshold, fmt) {\n        source = (source || []).slice(0);\n        var l = source.length;\n\n        if ( lastProperty(source, property)  > threshold ) {\n          return '<p><i class=\"material-icons\" style=\"color:red\">warning</i></p>';\n          } else {\n            return '<p></p>';\n          }\n      }`,\n    `var formatNumber = function(num, fmt) {\n        fmt = fmt || '0,0[.]0';\n        return numeral(num).format(fmt);\n      }`,\n    `var formatDate = function(date, fmt) {\n        fmt = fmt || 'MM-DD-YYYY';\n        return dateUtils.format(date, fmt);\n      }`,\n    `var isoMonth = function(date, fmt) {\n        fmt = fmt || 'MM';\n        var du = dateUtils;\n        return du.format(du.addDays(du.startOfMonth(date), 4),fmt)\n      }`,\n    `var nextCounterValue = function(counterName, firstValue) {\n        firstValue = firstValue != null ? firstValue : 0;\n        if (execContext['$$'+counterName] == null) {\n          execContext['$$'+counterName] = firstValue;\n        } else {\n          execContext['$$'+counterName]++;\n        }\n        return execContext['$$'+counterName];\n      }`,\n    `var getCoordinate = function(source, zoom) {\n        zoom = zoom || 6;\n        if(source == null) {\n          return [51.505,-0.09, zoom];\n        } else {\n          return [source[0], source[1], zoom];\n        }\n      }`\n  ];\n\n  private _functions: (Function | string)[] = [];\n  private _functionsStr: string = '';\n\n  constructor() {\n    this._initFunctions();\n  }\n\n  addFunction(f: Function | string): void {\n    this._functions.push(f);\n    this._initFunctions();\n  }\n\n  addFunctionHandler(name: string, fn: any): void {\n    if (AjfExpressionUtils.utils[name] === undefined) {\n      AjfExpressionUtils.utils[name] = {fn};\n    }\n  }\n\n  private _initFunctions(): void {\n    const functionsStr = this._functions\n      .map(f => typeof f === 'string' ? f : f.toString())\n      .join('; ');\n    this._functionsStr = `${this._baseUtilFunctions.join('; ')}; ${functionsStr}`;\n    AjfExpressionUtils.UTIL_FUNCTIONS = this._functionsStr;\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfBaseSlideInstance} from '../../interface/slides-instances/base-slide-instance';\n\nexport function validSlide(slide: AjfBaseSlideInstance, idx: number): boolean {\n  if (idx >= slide.slideNodes.length) {\n    return true;\n  }\n  return slide.slideNodes[idx]\n      .map(n => {\n        if (n.visible && Object.keys(n).indexOf('valid') > -1) {\n          return (<any>n).valid;\n        }\n        return true;\n      })\n      .reduce((v1, v2) => v1 && v2, true);\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext, evaluateExpression} from '@ajf/core/models';\n\nimport {AjfRepeatingNodeInstance} from '../../interface/nodes-instances/repeating-node-instance';\nimport {nodeInstanceCompleteName} from '../nodes-instances/node-instance-complete-name';\n\nexport function updateRepsNum(instance: AjfRepeatingNodeInstance, context?: AjfContext): number {\n  const oldReps: number = instance.reps || 0;\n  context = context || {};\n  if (instance.node.formulaReps == null) {\n    const ctxReps = context[nodeInstanceCompleteName(instance)];\n    if (ctxReps != null) {\n      instance.reps = ctxReps;\n    } else if (oldReps == 0) {\n      instance.reps = 1;\n    }\n  } else {\n    let newReps = evaluateExpression(instance.node.formulaReps.formula, context);\n    if (newReps !== oldReps) {\n      instance.reps = newReps;\n    }\n  }\n  instance.canAdd = instance.node.maxReps === 0 || instance.reps < instance.node.maxReps;\n  instance.canRemove = instance.node.minReps === 0 || instance.reps > instance.node.minReps;\n  return oldReps;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNode} from '../../interface/nodes/node';\n\nexport function orderedNodes(nodes: AjfNode[], parent: number|null): AjfNode[] {\n  let newNodes: AjfNode[] = [];\n  nodes\n      .filter(\n          (n: AjfNode) => parent != null ? n.parent == parent : n.parent == null || n.parent === 0)\n      .sort((n1: AjfNode, n2: AjfNode) => n1.parentNode - n2.parentNode)\n      .forEach((n: AjfNode) => {\n        newNodes.push(n);\n        newNodes = newNodes.concat(orderedNodes(nodes, n.id));\n      });\n  return newNodes;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContainerNode} from '../../interface/nodes/container-node';\nimport {AjfNode} from '../../interface/nodes/node';\nimport {isContainerNode} from './is-container-node';\n\nexport function flattenNodes(nodes: AjfNode[]): AjfNode[] {\n  let flatNodes: AjfNode[] = [];\n  nodes.forEach((node: AjfNode) => {\n    flatNodes.push(node);\n    if (isContainerNode(node)) {\n      flatNodes = flatNodes.concat(flattenNodes((node as AjfContainerNode).nodes));\n    }\n  });\n  return flatNodes;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {\n  AjfContext, createCondition, createFormula, normalizeExpression, alwaysCondition\n} from '@ajf/core/models';\n\nimport {AjfFieldInstance} from '../../interface/fields-instances/field-instance';\nimport {\n  AjfFieldWithChoicesInstance\n} from '../../interface/fields-instances/field-with-choices-instance';\nimport {AjfField} from '../../interface/fields/field';\nimport {AjfFieldType} from '../../interface/fields/field-type';\nimport {AjfFieldWithChoices} from '../../interface/fields/field-with-choices';\nimport {AjfTableField} from '../../interface/fields/table-field';\nimport {AjfNodeGroupInstance} from '../../interface/nodes-instances/node-group-instance';\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {\n  AjfRepeatingContainerNodeInstance\n} from '../../interface/nodes-instances/repeating-container-node-instance';\nimport {AjfNode} from '../../interface/nodes/node';\nimport {AjfNodeGroup} from '../../interface/nodes/node-group';\nimport {AjfNodeType} from '../../interface/nodes/node-type';\nimport {AjfRepeatingSlideInstance} from '../../interface/slides-instances/repeating-slide-instance';\nimport {AjfRepeatingSlide} from '../../interface/slides/repeating-slide';\nimport {AjfSlide} from '../../interface/slides/slide';\nimport {componentsMap} from '../fields/fields-map';\nimport {createFieldInstance} from '../fields-instances/create-field-instance';\nimport {\n  createFieldWithChoicesInstance\n} from '../fields-instances/create-field-with-choices-instance';\nimport {createTableFieldInstance} from '../fields-instances/create-table-field-instance';\nimport {isFieldWithChoicesInstance} from '../fields-instances/is-field-with-choices-instance';\nimport {isFieldWithChoices} from '../fields/is-field-with-choices';\nimport {createNodeGroupInstance} from '../nodes-instances/create-node-group-instance';\nimport {createRepeatingSlideInstance} from '../slides-instances/create-repeating-slide-instance';\nimport {createSlideInstance} from '../slides-instances/create-slide-instance';\nimport {createValidationGroup} from '../validation/create-validation-group';\nimport {createWarningGroup} from '../warning/create-warning-group';\n\nimport {getAncestorRepeatingNodesNames} from './get-ancestor-repeating-nodes-names';\nimport {getInstanceCondition} from './get-instance-condition';\nimport {getInstanceConditions} from './get-instance-conditions';\nimport {getInstanceFormula} from './get-instance-formula';\nimport {getInstanceValidations} from './get-instance-validations';\nimport {getInstanceWarnings} from './get-instance-warnings';\nimport {isFieldInstance} from './is-field-instance';\nimport {isNodeGroupInstance} from './is-node-group-instance';\nimport {isRepeatingSlideInstance} from './is-repeating-slide-instance';\n\nexport function nodeToNodeInstance(\n    allNodes: AjfNode[]|AjfNodeInstance[], node: AjfNode, prefix: number[],\n    context: AjfContext): AjfNodeInstance|null {\n  let instance: AjfNodeInstance|null = null;\n  const nodeType = node.nodeType;\n  switch (nodeType) {\n    case AjfNodeType.AjfField:\n      const field = node as AjfField;\n      if (field.fieldType > 100) {\n        if (\n          componentsMap[field.fieldType] != null\n          && componentsMap[field.fieldType].createInstance != null\n        ) {\n          instance = componentsMap[field.fieldType].createInstance!(\n            {node: node as AjfField, prefix}, context);\n        } else {\n          instance = createFieldInstance({node: node as AjfField, prefix}, context);\n        }\n      } else {\n        switch (field.fieldType) {\n          case AjfFieldType.SingleChoice:\n          case AjfFieldType.MultipleChoice:\n            instance = createFieldWithChoicesInstance(\n                {node: node as AjfFieldWithChoices<any>, prefix}, context);\n            break;\n          case AjfFieldType.Table:\n            instance = createTableFieldInstance({node: node as AjfTableField, prefix}, context);\n            break;\n          default:\n            instance = createFieldInstance({node: node as AjfField, prefix}, context);\n            break;\n        }\n      }\n      break;\n    case AjfNodeType.AjfNodeGroup:\n      instance = createNodeGroupInstance({node: node as AjfNodeGroup, prefix});\n      break;\n    case AjfNodeType.AjfRepeatingSlide:\n      instance = createRepeatingSlideInstance({node: node as AjfRepeatingSlide, prefix});\n      break;\n    case AjfNodeType.AjfSlide:\n      instance = createSlideInstance({node: node as AjfSlide, prefix});\n      break;\n  }\n  if (instance != null) {\n    const hasPrefix = prefix != null && prefix.length > 0;\n    if (hasPrefix) {\n      const ancestorsNames = getAncestorRepeatingNodesNames(allNodes, node);\n\n      if (node.visibility != null) {\n        const oldVisibility = node.visibility.condition;\n        const newVisibility = normalizeExpression(oldVisibility, ancestorsNames, prefix);\n        instance.visibility = newVisibility !== oldVisibility ?\n            createCondition({condition: newVisibility}) :\n            node.visibility;\n      }\n\n      const conditionalBranches = instance.node.conditionalBranches != null\n        && instance.node.conditionalBranches.length > 0\n        ? instance.node.conditionalBranches\n        : [alwaysCondition()];\n      instance.conditionalBranches = getInstanceConditions(\n        conditionalBranches, ancestorsNames, prefix);\n\n      if (nodeType === AjfNodeType.AjfNodeGroup || nodeType === AjfNodeType.AjfRepeatingSlide) {\n        const ngInstance = instance as AjfNodeGroupInstance | AjfRepeatingSlideInstance;\n        const formulaReps = ngInstance.node.formulaReps;\n        if (formulaReps != null) {\n          const oldFormula = formulaReps.formula;\n          let newFormula = normalizeExpression(oldFormula, ancestorsNames, prefix);\n          ngInstance.formulaReps =\n              newFormula !== oldFormula ? createFormula({formula: newFormula}) : formulaReps;\n        }\n      } else if (nodeType === AjfNodeType.AjfField) {\n        const fInstance = instance as AjfFieldInstance;\n        const fNode = fInstance.node;\n\n        if (fNode.formula) {\n          fInstance.formula = getInstanceFormula(fNode.formula, ancestorsNames, prefix);\n        }\n\n        if (fNode.validation != null) {\n          const newConditions =\n              getInstanceValidations(fNode.validation.conditions, ancestorsNames, prefix);\n          if (newConditions !== fNode.validation.conditions) {\n            fInstance.validation = createValidationGroup(fNode.validation);\n            fInstance.validation.conditions = newConditions;\n          } else {\n            fInstance.validation = fNode.validation;\n          }\n        }\n\n        if (fNode.warning != null) {\n          const newWarnings = getInstanceWarnings(fNode.warning.conditions, ancestorsNames, prefix);\n          if (newWarnings !== fNode.warning.conditions) {\n            fInstance.warning = createWarningGroup(fNode.warning);\n            fInstance.warning.conditions = newWarnings;\n          } else {\n            fInstance.warning = fNode.warning;\n          }\n        }\n\n        if (fNode.nextSlideCondition != null) {\n          fInstance.nextSlideCondition =\n              getInstanceCondition(fNode.nextSlideCondition, ancestorsNames, prefix);\n        }\n\n        if (isFieldWithChoices(fNode)) {\n          const fwcInstance = instance as AjfFieldWithChoicesInstance<any>;\n          const fwcNode = fwcInstance.node;\n          if (fwcNode.choicesFilter != null) {\n            fwcInstance.choicesFilter =\n                getInstanceFormula(fwcNode.choicesFilter, ancestorsNames, prefix);\n          }\n          if (fwcNode.triggerConditions != null) {\n            fwcInstance.triggerConditions =\n                getInstanceConditions(fwcNode.triggerConditions, ancestorsNames, prefix);\n          }\n        }\n      }\n    } else {\n      instance.visibility = instance.node.visibility;\n      const conditionalBranches = instance.node.conditionalBranches != null\n        && instance.node.conditionalBranches.length > 0\n        ? instance.node.conditionalBranches\n        : [alwaysCondition()];\n      instance.conditionalBranches = conditionalBranches;\n      if (isNodeGroupInstance(instance) || isRepeatingSlideInstance(instance)) {\n        const rgInstance = instance as AjfRepeatingContainerNodeInstance;\n        rgInstance.formulaReps = rgInstance.node.formulaReps;\n      } else if (isFieldInstance(instance)) {\n        const fInstance = instance as AjfFieldInstance;\n        fInstance.validation = fInstance.node.validation;\n        fInstance.warning = fInstance.node.warning;\n        fInstance.nextSlideCondition = fInstance.node.nextSlideCondition;\n        if (isFieldWithChoicesInstance(instance)) {\n          const fwcInstance = instance as AjfFieldWithChoicesInstance<any>;\n          fwcInstance.choicesFilter = fwcInstance.node.choicesFilter;\n          fwcInstance.triggerConditions = fwcInstance.node.triggerConditions;\n        }\n        fInstance.formula = fInstance.node.formula;\n      }\n    }\n  }\n  return instance;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {isSlidesInstance} from '../nodes-instances/is-slides-instance';\nimport {isRepeatingSlide} from '../nodes/is-repeating-slide';\n\nexport function isRepeatingSlideInstance(nodeInstance: AjfNodeInstance): boolean {\n  return nodeInstance != null && nodeInstance.node != null && isSlidesInstance(nodeInstance) &&\n      isRepeatingSlide(nodeInstance.node);\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNode} from '../../interface/nodes/node';\nimport {AjfNodeType} from '../../interface/nodes/node-type';\n\nexport function isRepeatingSlide(node: AjfNode): boolean {\n  return node != null && node.nodeType === AjfNodeType.AjfRepeatingSlide;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfWarning} from '../../interface/warning/warning';\nimport {getInstanceWarning} from './get-instance-warning';\n\nexport function getInstanceWarnings(\n    warnings: AjfWarning[], ancestorsNames: {[prop: string]: number},\n    prefix: number[]): AjfWarning[] {\n  let changed = false;\n  const newWarnings = warnings.map((warning) => {\n    const newWarning = getInstanceWarning(warning, ancestorsNames, prefix);\n    if (newWarning !== warning) {\n      changed = true;\n    }\n    return newWarning;\n  });\n  return changed ? newWarnings : warnings;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {normalizeExpression} from '@ajf/core/models';\n\nimport {AjfWarning} from '../../interface/warning/warning';\nimport {createWarning} from '../warning/create-warning';\n\nexport function getInstanceWarning(\n    warning: AjfWarning, ancestorsNames: {[prop: string]: number}, prefix: number[]): AjfWarning {\n  const oldWarning = warning.condition;\n  let newWarning = normalizeExpression(oldWarning, ancestorsNames, prefix);\n  if (newWarning === oldWarning) {\n    return warning;\n  }\n  return createWarning({condition: newWarning});\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfWarning} from '../../interface/warning/warning';\n\nexport function createWarning(warning: Pick<AjfWarning, 'condition'>&\n                              Partial<AjfWarning>): AjfWarning {\n  return {...warning, warningMessage: warning.warningMessage || 'Undefined Warning'};\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfValidation} from '../../interface/validation/validation';\nimport {getInstanceValidation} from './get-instance-validation';\n\nexport function getInstanceValidations(\n    validations: AjfValidation[], ancestorsNames: {[prop: string]: number},\n    prefix: number[]): AjfValidation[] {\n  let changed = false;\n  const newValidations = validations.map((validation) => {\n    const newValidation = getInstanceValidation(validation, ancestorsNames, prefix);\n    if (newValidation !== validation) {\n      changed = true;\n    }\n    return newValidation;\n  });\n  return changed ? newValidations : validations;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {normalizeExpression} from '@ajf/core/models';\n\nimport {AjfValidation} from '../../interface/validation/validation';\nimport {createValidation} from '../validation/create-validation';\n\nexport function getInstanceValidation(\n    validation: AjfValidation, ancestorsNames: {[prop: string]: number},\n    prefix: number[]): AjfValidation {\n  const oldValidation = validation.condition;\n  let newValidation = normalizeExpression(oldValidation, ancestorsNames, prefix);\n  if (newValidation === oldValidation) {\n    return validation;\n  }\n  return createValidation({condition: newValidation});\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfValidation} from '../../interface/validation/validation';\n\nexport function createValidation(validation: Pick<AjfValidation, 'condition'>&\n                                 Partial<AjfValidation>): AjfValidation {\n  return {\n    ...validation,\n    clientValidation: validation.clientValidation || false,\n    errorMessage: validation.errorMessage || 'Undefined Error'\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfFormula, normalizeExpression} from '@ajf/core/models';\n\nexport function getInstanceFormula(\n    formula: AjfFormula, ancestorsNames: {[prop: string]: number}, prefix: number[]): AjfFormula {\n  const oldFormula = formula.formula;\n  let newFormula = normalizeExpression(oldFormula, ancestorsNames, prefix);\n  if (newFormula === oldFormula) {\n    return formula;\n  }\n  return {formula: newFormula};\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfCondition} from '@ajf/core/models';\n\nimport {getInstanceCondition} from './get-instance-condition';\n\nexport function getInstanceConditions(\n    conditions: AjfCondition[], ancestorsNames: {[prop: string]: number},\n    prefix: number[]): AjfCondition[] {\n  let changed = false;\n  const newConditions = conditions.map((condition) => {\n    const newCondition = getInstanceCondition(condition, ancestorsNames, prefix);\n    if (newCondition !== condition) {\n      changed = true;\n    }\n    return newCondition;\n  });\n  return changed ? newConditions : conditions;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfCondition, normalizeExpression} from '@ajf/core/models';\n\nexport function getInstanceCondition(\n    condition: AjfCondition, ancestorsNames: {[prop: string]: number},\n    prefix: number[]): AjfCondition {\n  const oldCondition = condition.condition;\n  let newCondition = normalizeExpression(oldCondition, ancestorsNames, prefix);\n  if (newCondition === oldCondition) {\n    return condition;\n  }\n  return {condition: newCondition};\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {AjfNode} from '../../interface/nodes/node';\nimport {AjfNodeGroup} from '../../interface/nodes/node-group';\nimport {isField} from '../nodes/is-field';\n\nimport {getAncestorRepeatingNodes} from './get-ancestor-repeating-nodes';\n\nexport function getAncestorRepeatingNodesNames(\n    allNodes: (AjfNode|AjfNodeInstance)[], node: AjfNode): {[prop: string]: number} {\n  let names: {[prop: string]: number} = {};\n  const nodeGroups = getAncestorRepeatingNodes(allNodes, node) as AjfNodeGroup[];\n  nodeGroups.forEach((n, idx) => (n.nodes || []).forEach((sn) => {\n    if (isField(sn)) {\n      names[sn.name] = idx;\n    }\n  }));\n  return names;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {AjfNode} from '../../interface/nodes/node';\nimport {isRepeatingContainerNode} from '../nodes/is-repeating-container-node';\n\nexport function getAncestorRepeatingNodes(\n    allNodes: (AjfNode|AjfNodeInstance)[], node: AjfNode): AjfNode[] {\n  let nodeGroups: AjfNode[] = [];\n  let curParent: number|null = node.parent;\n  while (curParent != null) {\n    const curNode =\n        allNodes.map((n: AjfNode|AjfNodeInstance) => (n as AjfNodeInstance).node || n as AjfNode)\n            .find(n => n.id == curParent);\n    if (curNode) {\n      if (isRepeatingContainerNode(curNode)) {\n        nodeGroups.push(curNode);\n      }\n    }\n    curParent = curNode != null ? curNode.parent : null;\n  }\n  return nodeGroups;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNode} from '../../interface/nodes/node';\nimport {AjfNodeType} from '../../interface/nodes/node-type';\n\nexport function isRepeatingContainerNode(node: AjfNode): boolean {\n  return node != null &&\n      (node.nodeType === AjfNodeType.AjfNodeGroup ||\n       node.nodeType === AjfNodeType.AjfRepeatingSlide);\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfWarningGroup} from '../../interface/warning/warning-group';\n\nexport function createWarningGroup(group: Partial<AjfWarningGroup>): AjfWarningGroup {\n  return {...group, conditions: group.conditions || []};\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfValidationGroup} from '../../interface/validation/validation-group';\n\nexport function createValidationGroup(group: Partial<AjfValidationGroup>): AjfValidationGroup {\n  return {...group, conditions: group.conditions || []};\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfRepeatingSlideInstance} from '../../interface/slides-instances/repeating-slide-instance';\nimport {AjfSlideInstanceCreate, createSlideInstance} from './create-slide-instance';\n\nexport type AjfRepeatingSlideInstanceCreate = Omit<AjfSlideInstanceCreate, 'node'>&\n    Pick<AjfRepeatingSlideInstance, 'node'>&Partial<AjfRepeatingSlideInstance>;\n\nexport function createRepeatingSlideInstance(instance: AjfRepeatingSlideInstanceCreate):\n    AjfRepeatingSlideInstance {\n  const slideInstance = createSlideInstance(instance);\n  return {\n    ...slideInstance,\n    node: instance.node,\n    slideNodes: [],\n    formulaReps: instance.formulaReps,\n    reps: 0,\n    nodes: [],\n    flatNodes: [],\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfSlideInstance} from '../../interface/slides-instances/slide-instance';\nimport {createNodeInstance} from '../nodes-instances/create-node-instance';\nimport {AjfBaseSlideInstanceCreate} from './base';\n\nexport type AjfSlideInstanceCreate = AjfBaseSlideInstanceCreate&Partial<AjfSlideInstance>;\n\nexport function createSlideInstance(instance: AjfSlideInstanceCreate): AjfSlideInstance {\n  const nodeInstance = createNodeInstance(instance);\n  return {\n    ...nodeInstance,\n    node: instance.node,\n    nodes: [],\n    slideNodes: [],\n    flatNodes: [],\n    valid: false,\n    position: 0,\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeGroupInstance} from '../../interface/nodes-instances/node-group-instance';\nimport {AjfNodeInstanceCreate, createNodeInstance} from './create-node-instance';\n\nexport type AjfNodeGroupInstanceCreate = AjfNodeInstanceCreate&Partial<AjfNodeGroupInstance>;\n\nexport function createNodeGroupInstance(instance: AjfNodeGroupInstanceCreate):\n    AjfNodeGroupInstance {\n  const nodeInstance = createNodeInstance(instance);\n  return {\n    ...nodeInstance,\n    node: instance.node,\n    formulaReps: instance.formulaReps,\n    reps: 0,\n    nodes: [],\n    flatNodes: [],\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '@ajf/core/models';\n\nimport {AjfTableFieldInstance} from '../../interface/fields-instances/table-field-instance';\nimport {AjfFieldInstanceCreate, createFieldInstance} from './create-field-instance';\n\nexport type AjfTableFieldInstanceCreate = AjfFieldInstanceCreate&Partial<AjfTableFieldInstance>;\n\nexport function createTableFieldInstance(\n    instance: AjfTableFieldInstanceCreate, context: AjfContext): AjfTableFieldInstance {\n  const fieldInstance = createFieldInstance(instance, context);\n  return {\n    ...fieldInstance,\n    node: instance.node,\n    context,\n    hideEmptyRows: instance.hideEmptyRows || false,\n    controls: [],\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '@ajf/core/models';\nimport {EventEmitter} from '@angular/core';\n\nimport {\n  AjfFieldWithChoicesInstance\n} from '../../interface/fields-instances/field-with-choices-instance';\n\nimport {AjfFieldInstanceCreate, createFieldInstance} from './create-field-instance';\n\nexport type AjfFieldWithChoicesInstanceCreate<T> =\n    AjfFieldInstanceCreate&Partial<AjfFieldWithChoicesInstance<T>>;\n\nexport function createFieldWithChoicesInstance<T>(\n    instance: AjfFieldWithChoicesInstanceCreate<T>,\n    context: AjfContext): AjfFieldWithChoicesInstance<T> {\n  const fieldInstance = createFieldInstance(instance, context);\n  return {\n    ...fieldInstance,\n    node: instance.node,\n    filteredChoices: [...instance.node.choices],\n    firstTriggerConditionDone: {},\n    selectionTrigger: new EventEmitter<void>(),\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '@ajf/core/models';\nimport {EventEmitter} from '@angular/core';\n\nimport {AjfFieldInstance} from '../../interface/fields-instances/field-instance';\nimport {AjfNodeInstanceCreate, createNodeInstance} from '../nodes-instances/create-node-instance';\nimport {nodeInstanceCompleteName} from '../nodes-instances/node-instance-complete-name';\n\nexport type AjfFieldInstanceCreate = AjfNodeInstanceCreate&Partial<AjfFieldInstance>;\n\nexport function createFieldInstance(\n    instance: AjfFieldInstanceCreate, context: AjfContext): AjfFieldInstance {\n  const nodeInstance = createNodeInstance(instance);\n  let value: any = null;\n  if (nodeInstance.node != null && context != null) {\n    const completeName = nodeInstanceCompleteName(nodeInstance);\n    if (context[nodeInstance.node.name] != null) {\n      value = context[nodeInstance.node.name];\n    } else if (context[completeName] != null) {\n      value = context[completeName];\n    }\n  }\n  return {\n    ...nodeInstance,\n    node: instance.node,\n    value,\n    valid: false,\n    defaultValue: instance.defaultValue != null ? instance.defaultValue : null,\n    validationResults: instance.validationResults || [],\n    warningResults: instance.warningResults || [],\n    warningTrigger: new EventEmitter<void>(),\n    updated: new EventEmitter<void>(),\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {EventEmitter} from '@angular/core';\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\n\nexport type AjfNodeInstanceCreate = Pick<AjfNodeInstance, 'node'>&Partial<AjfNodeInstance>;\n\nexport function createNodeInstance(instance: AjfNodeInstanceCreate): AjfNodeInstance {\n  return {\n    node: instance.node,\n    prefix: instance.prefix ? [...instance.prefix] : [],\n    visible: instance.visible != null ? instance.visible : true,\n    conditionalBranches: [],\n    updatedEvt: new EventEmitter<void>()\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {isSlideNode} from '../nodes/is-slide-node';\n\nexport function isSlideInstance(nodeInstance: AjfNodeInstance): boolean {\n  return nodeInstance != null && nodeInstance.node != null && isSlideNode(nodeInstance.node);\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNode} from '../../interface/nodes/node';\nimport {AjfNodeType} from '../../interface/nodes/node-type';\n\nexport function isSlideNode(node: AjfNode): boolean {\n  return node != null && node.nodeType === AjfNodeType.AjfSlide;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {isNodeGroup} from '../nodes/is-node-group';\n\nexport function isNodeGroupInstance(nodeInstance: AjfNodeInstance): boolean {\n  return nodeInstance != null && nodeInstance.node != null && isNodeGroup(nodeInstance.node);\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNode} from '../../interface/nodes/node';\nimport {AjfNodeType} from '../../interface/nodes/node-type';\n\nexport function isNodeGroup(node: AjfNode): boolean {\n  return node != null && node.nodeType === AjfNodeType.AjfNodeGroup;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {AjfSlideInstance} from '../../interface/slides-instances/slide-instance';\nimport {flattenNodesInstances} from './flatten-nodes-instances';\nimport {isSlidesInstance} from './is-slides-instance';\n\nexport function flattenNodesInstancesTree(nodes: AjfNodeInstance[]): AjfSlideInstance[] {\n  let flatTree: AjfSlideInstance[] = [];\n  nodes.forEach((nodeInstance: AjfNodeInstance) => {\n    if (isSlidesInstance(nodeInstance)) {\n      const ni = nodeInstance as AjfSlideInstance;\n      flatTree.push(ni);\n      ni.flatNodes = flattenNodesInstances(ni.nodes);\n    }\n  });\n  return flatTree;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {isSlidesNode} from '../nodes/is-slides-node';\n\nexport function isSlidesInstance(nodeInstance: AjfNodeInstance): boolean {\n  return nodeInstance != null && nodeInstance.node != null && isSlidesNode(nodeInstance.node);\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContainerNodeInstance} from '../../interface/nodes-instances/container-node-instance';\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\n\nimport {isContainerNodeInstance} from './is-container-node-instance';\nimport {isFieldInstance} from './is-field-instance';\n\nexport function flattenNodesInstances(\n    nodes: AjfNodeInstance[], includeGroups = false): AjfNodeInstance[] {\n  let flatNodes: AjfNodeInstance[] = [];\n  nodes.forEach((nodeInstance: AjfNodeInstance) => {\n    if (isFieldInstance(nodeInstance)) {\n      flatNodes.push(nodeInstance);\n    }\n    if (isContainerNodeInstance(nodeInstance)) {\n      if (includeGroups) {\n        flatNodes.push(nodeInstance);\n      }\n      flatNodes = flatNodes.concat(\n          flattenNodesInstances((nodeInstance as AjfContainerNodeInstance).nodes, includeGroups));\n    }\n  });\n  return flatNodes;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {isContainerNode} from '../nodes/is-container-node';\n\nexport function isContainerNodeInstance(nodeInstance: AjfNodeInstance): boolean {\n  return nodeInstance != null && nodeInstance.node != null && isContainerNode(nodeInstance.node);\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNode} from '../../interface/nodes/node';\nimport {AjfNodeType} from '../../interface/nodes/node-type';\nimport {isSlidesNode} from './is-slides-node';\n\nexport function isContainerNode(node: AjfNode): boolean {\n  return node != null && (node.nodeType === AjfNodeType.AjfNodeGroup || isSlidesNode(node));\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNode} from '../../interface/nodes/node';\nimport {AjfNodeType} from '../../interface/nodes/node-type';\n\nexport function isSlidesNode(node: AjfNode): boolean {\n  return node != null &&\n      (node.nodeType === AjfNodeType.AjfRepeatingSlide || node.nodeType === AjfNodeType.AjfSlide);\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfField} from '../../interface/fields/field';\nimport {AjfFieldType} from '../../interface/fields/field-type';\nimport {AjfNodeType} from '../../interface/nodes/node-type';\nimport {AjfNodeCreate, createNode} from '../nodes/create-node';\n\nexport type AjfFieldCreate =\n    Omit<AjfNodeCreate, 'nodeType'>&Pick<AjfField, 'fieldType'>&Partial<AjfField>;\n\nexport function createField(field: AjfFieldCreate): AjfField {\n  const node = createNode({...field, nodeType: AjfNodeType.AjfField});\n  const editable = field.editable != null ?\n      field.editable :\n      field.fieldType !== AjfFieldType.Formula && field.fieldType !== AjfFieldType.Table;\n  return {\n    ...node,\n    ...field,\n    nodeType: AjfNodeType.AjfField,\n    editable,\n    defaultValue: field.defaultValue != null ? field.defaultValue : null,\n    size: field.size || 'normal',\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {alwaysCondition} from '@ajf/core/models';\n\nimport {AjfNode} from '../../interface/nodes/node';\n\nexport type AjfNodeCreate = Pick<AjfNode, 'nodeType'|'id'|'parent'|'name'>&Partial<AjfNode>;\n\nexport function createNode(node: AjfNodeCreate): AjfNode {\n  const conditionalBranches =\n      node.conditionalBranches != null && node.conditionalBranches.length > 0 ?\n      node.conditionalBranches :\n      [alwaysCondition()];\n  return {\n    ...node,\n    parentNode: node.parentNode != null ? node.parentNode : 0,\n    label: node.label || '',\n    visibility: node.visibility || alwaysCondition(),\n    conditionalBranches,\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext, evaluateExpression} from '@ajf/core/models';\n\nimport {\n  AjfFieldWithChoicesInstance\n} from '../../interface/fields-instances/field-with-choices-instance';\nimport {nodeInstanceCompleteName} from '../nodes-instances/node-instance-complete-name';\n\nexport function updateTriggerConditions(\n    instance: AjfFieldWithChoicesInstance<any>, context: AjfContext): boolean {\n  if (instance.triggerConditions == null) {\n    return false;\n  }\n  const completeName = nodeInstanceCompleteName(instance);\n  if (instance.firstTriggerConditionDone[completeName]) {\n    return false;\n  }\n  let found = false;\n  const conditionsNum = instance.triggerConditions.length;\n  for (let i = 0; i < conditionsNum; i++) {\n    if (evaluateExpression(instance.triggerConditions[i].condition, context)) {\n      found = true;\n      break;\n    }\n  }\n  instance.firstTriggerConditionDone[completeName] = found;\n  return found;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext, evaluateExpression} from '@ajf/core/models';\n\nimport {\n  AjfFieldWithChoicesInstance\n} from '../../interface/fields-instances/field-with-choices-instance';\n\nexport function updateFilteredChoices(\n    instance: AjfFieldWithChoicesInstance<any>, context: AjfContext): void {\n  if (instance.choicesFilter != null) {\n    instance.filteredChoices = instance.node.choicesOrigin.choices.filter(c => {\n      context.$choiceValue = c.value;\n      return evaluateExpression(instance.choicesFilter!.formula, context);\n    });\n  } else {\n    instance.filteredChoices = instance.node.choicesOrigin.choices;\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '@ajf/core/models';\n\nimport {AjfFieldInstance} from '../../interface/fields-instances/field-instance';\nimport {AjfFormulaFieldInstance} from '../../interface/fields-instances/formula-field-instance';\nimport {updateConditionalBranches} from '../nodes-instances/update-conditional-branches';\nimport {updateVisibility} from '../nodes-instances/update-visibility';\nimport {updateFormula} from './update-formula';\nimport {updateNextSlideCondition} from './update-next-slide-condition';\nimport {updateValidation} from './update-validation';\nimport {updateWarning} from './update-warning';\n\nexport function updateFieldInstanceState(\n    instance: AjfFieldInstance, context: AjfContext, branchVisibility = true): void {\n  updateVisibility(instance, context, branchVisibility);\n  updateConditionalBranches(instance, context);\n  updateFormula(instance as AjfFormulaFieldInstance, context);\n  updateValidation(instance, context);\n  updateWarning(instance, context);\n  updateNextSlideCondition(instance, context);\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '@ajf/core/models';\n\nimport {AjfFieldInstance} from '../../interface/fields-instances/field-instance';\nimport {nodeInstanceCompleteName} from '../nodes-instances/node-instance-complete-name';\nimport {evaluateWarningGroup} from '../warning/evaluate-warning-group';\n\nexport function updateWarning(instance: AjfFieldInstance, context: AjfContext): void {\n  const warning = instance.warning;\n  if (warning == null) {\n    return;\n  }\n\n  const completeName = nodeInstanceCompleteName(instance);\n\n  if (context[completeName] != null && warning) {\n    instance.warningResults = evaluateWarningGroup(warning, context);\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '@ajf/core/models';\n\nimport {AjfWarningGroup} from '../../interface/warning/warning-group';\nimport {AjfWarningResult} from '../../interface/warning/warning-result';\nimport {evaluateWarningConditions} from './evaluate-warning-conditions';\n\nexport function evaluateWarningGroup(\n    warning: AjfWarningGroup, context?: AjfContext): AjfWarningResult[] {\n  return evaluateWarningConditions(warning, context);\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '@ajf/core/models';\n\nimport {AjfWarningGroup} from '../../interface/warning/warning-group';\nimport {AjfWarningResult} from '../../interface/warning/warning-result';\nimport {evaluateWarning} from './evaluate-warning';\n\nexport function evaluateWarningConditions(\n    warning: AjfWarningGroup, context?: AjfContext): AjfWarningResult[] {\n  return warning.conditions.map(cond => evaluateWarning(cond, context));\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext, evaluateExpression} from '@ajf/core/models';\n\nimport {AjfWarning} from '../../interface/warning/warning';\nimport {AjfWarningResult} from '../../interface/warning/warning-result';\n\nexport function evaluateWarning(\n    warning: AjfWarning, context?: AjfContext, forceFormula?: string): AjfWarningResult {\n  return {\n    result: evaluateExpression(warning.condition, context, forceFormula),\n    warning: warning.warningMessage,\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext, evaluateExpression} from '@ajf/core/models';\n\nimport {AjfFieldInstance} from '../../interface/fields-instances/field-instance';\nimport {AjfValidationResult} from '../../interface/validation/validation-results';\nimport {nodeInstanceCompleteName} from '../nodes-instances/node-instance-complete-name';\nimport {evaluateValidationGroup} from '../validation/evaluate-validation-group';\n\nexport function updateValidation(\n    instance: AjfFieldInstance, context: AjfContext, supplementaryInformations?: any): void {\n  const validation = instance.validation;\n  if (validation == null) {\n    return;\n  }\n\n  if (supplementaryInformations) {\n    Object.keys(supplementaryInformations).forEach((key) => {\n      context[`__supplementary__${key}__`] = supplementaryInformations[key];\n    });\n  }\n\n  const completeName = nodeInstanceCompleteName(instance);\n\n  if (context[completeName] != null && validation && validation.forceValue) {\n    instance.value = evaluateExpression(validation.forceValue.condition, context);\n    context[completeName] = instance.value;\n    context.$value = instance.value;\n  }\n\n  if (validation != null) {\n    instance.validationResults =\n        evaluateValidationGroup(validation, context[completeName], context);\n    instance.valid = instance.validationResults.reduce(\n        (prev: boolean, x: AjfValidationResult) => prev && x.result, true);\n  } else {\n    instance.valid = true;\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '@ajf/core/models';\nimport {deepCopy} from '@ajf/core/utils';\n\nimport {AjfValidationGroup} from '../../interface/validation/validation-group';\nimport {AjfValidationResult} from '../../interface/validation/validation-results';\n\nimport {evaluateValidationConditions} from './evaluate-validation-conditions';\nimport {evaluateValidationMaxDigits} from './evaluate-validation-max-digits';\nimport {evaluateValidationMaxValue} from './evaluate-validation-max-value';\nimport {evaluateValidationMinDigits} from './evaluate-validation-min-digits';\nimport {evaluateValidationMinValue} from './evaluate-validation-min-value';\nimport {evaluateValidationNotEmpty} from './evaluate-validation-not-empty';\n\nexport function evaluateValidationGroup(\n    validation: AjfValidationGroup, value: any, context?: AjfContext): AjfValidationResult[] {\n  let res: AjfValidationResult[] = [];\n  let ctx = deepCopy(context);\n  ctx['$value'] = value;\n  res = evaluateValidationConditions(validation, ctx);\n  if (validation.maxValue) {\n    const maxValue = evaluateValidationMaxValue(validation, value);\n    if (maxValue != null) {\n      res.push(maxValue);\n    }\n  }\n  if (validation.minValue) {\n    const minValue = evaluateValidationMinValue(validation, value);\n    if (minValue != null) {\n      res.push(minValue);\n    }\n  }\n  if (validation.notEmpty) {\n    const notEmpty = evaluateValidationNotEmpty(validation, value);\n    if (notEmpty != null) {\n      res.push(notEmpty);\n    }\n  }\n  if (validation.maxDigits) {\n    const maxDigits = evaluateValidationMaxDigits(validation, value);\n    if (maxDigits != null) {\n      res.push(maxDigits);\n    }\n  }\n  if (validation.minDigits) {\n    const minDigits = evaluateValidationMinDigits(validation, value);\n    if (minDigits != null) {\n      res.push(minDigits);\n    }\n  }\n  return res;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {evaluateExpression} from '@ajf/core/models';\nimport {AjfValidationGroup} from '../../interface/validation/validation-group';\nimport {AjfValidationResult} from '../../interface/validation/validation-results';\nimport {evaluateValidation} from './evaluate-validation';\n\nexport function evaluateValidationNotEmpty(\n    validation: AjfValidationGroup, value: any): AjfValidationResult|null {\n  if (validation.notEmpty == null) {\n    return null;\n  }\n  const ctx = {'$value': value};\n  if (typeof validation.notEmpty === 'boolean') {\n    return {\n      result: evaluateExpression(`($value != null) === ${validation.notEmpty}`, ctx),\n      error: 'Value must not be empty',\n      clientValidation: false\n    };\n  }\n  return evaluateValidation(validation.notEmpty, );\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {evaluateExpression} from '@ajf/core/models';\nimport {AjfValidationGroup} from '../../interface/validation/validation-group';\nimport {AjfValidationResult} from '../../interface/validation/validation-results';\nimport {evaluateValidation} from './evaluate-validation';\n\nexport function evaluateValidationMinValue(\n    validation: AjfValidationGroup, value: any): AjfValidationResult|null {\n  if (validation.minValue == null) {\n    return null;\n  }\n  const ctx = {'$value': value};\n  if (typeof validation.minValue === 'number') {\n    return {\n      result: evaluateExpression(`$value.length <= ${validation.minValue}`, ctx),\n      error: `Value must be >= ${validation.minValue}`,\n      clientValidation: false\n    };\n  }\n  return evaluateValidation(validation.minValue, {'$value': value});\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {evaluateExpression} from '@ajf/core/models';\nimport {AjfValidationGroup} from '../../interface/validation/validation-group';\nimport {AjfValidationResult} from '../../interface/validation/validation-results';\nimport {evaluateValidation} from './evaluate-validation';\n\nexport function evaluateValidationMinDigits(\n    validation: AjfValidationGroup, value: any): AjfValidationResult|null {\n  if (validation.minDigits == null) {\n    return null;\n  }\n  const ctx = {'$value': value};\n  if (typeof validation.minDigits === 'number') {\n    return {\n      result: evaluateExpression(`$value.toString().length >= ${validation.minDigits}`, ctx),\n      error: `Digits count must be >= ${validation.minValue}`,\n      clientValidation: false\n    };\n  }\n  return evaluateValidation(validation.minDigits, ctx);\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {evaluateExpression} from '@ajf/core/models';\nimport {AjfValidationGroup} from '../../interface/validation/validation-group';\nimport {AjfValidationResult} from '../../interface/validation/validation-results';\nimport {evaluateValidation} from './evaluate-validation';\n\nexport function evaluateValidationMaxValue(\n    validation: AjfValidationGroup, value: any): AjfValidationResult|null {\n  if (validation.maxValue == null) {\n    return null;\n  }\n  const ctx = {'$value': value};\n  if (typeof validation.maxValue === 'number') {\n    return {\n      result: evaluateExpression(`$value.length <= ${validation.maxValue}`, ctx),\n      error: `Value must be <= ${validation.minValue}`,\n      clientValidation: false\n    };\n  }\n  return evaluateValidation(validation.maxValue, {'$value': value});\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {evaluateExpression} from '@ajf/core/models';\nimport {AjfValidationGroup} from '../../interface/validation/validation-group';\nimport {AjfValidationResult} from '../../interface/validation/validation-results';\nimport {evaluateValidation} from './evaluate-validation';\n\nexport function evaluateValidationMaxDigits(\n    validation: AjfValidationGroup, value: any): AjfValidationResult|null {\n  if (validation.maxDigits == null) {\n    return null;\n  }\n  const ctx = {'$value': value};\n  if (typeof validation.maxDigits === 'number') {\n    return {\n      result: evaluateExpression(`$value.toString().length <= ${validation.maxDigits}`, ctx),\n      error: `Digits count must be <= ${validation.minValue}`,\n      clientValidation: false\n    };\n  }\n  return evaluateValidation(validation.maxDigits, ctx);\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '@ajf/core/models';\n\nimport {AjfValidationGroup} from '../../interface/validation/validation-group';\nimport {AjfValidationResult} from '../../interface/validation/validation-results';\nimport {evaluateValidation} from './evaluate-validation';\n\nexport function evaluateValidationConditions(\n    validation: AjfValidationGroup, context?: AjfContext): AjfValidationResult[] {\n  let res: AjfValidationResult[] = [];\n  validation.conditions.forEach((cond) => {\n    res.push(evaluateValidation(cond, context));\n  });\n  return res;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext, evaluateExpression} from '@ajf/core/models';\n\nimport {AjfValidation} from '../../interface/validation/validation';\nimport {AjfValidationResult} from '../../interface/validation/validation-results';\n\nexport function evaluateValidation(\n    validation: AjfValidation, context?: AjfContext, forceFormula?: string): AjfValidationResult {\n  return {\n    result: evaluateExpression(validation.condition, context, forceFormula),\n    error: validation.errorMessage,\n    clientValidation: validation.clientValidation,\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext, evaluateExpression} from '@ajf/core/models';\n\nimport {AjfFieldInstance} from '../../interface/fields-instances/field-instance';\n\nexport function updateNextSlideCondition(instance: AjfFieldInstance, context: AjfContext): boolean {\n  if (instance.nextSlideCondition != null) {\n    return evaluateExpression(instance.nextSlideCondition.condition, context);\n  }\n  return false;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext, evaluateExpression} from '@ajf/core/models';\n\nimport {AjfFieldInstance} from '../../interface/fields-instances/field-instance';\nimport {nodeInstanceCompleteName} from '../nodes-instances/node-instance-complete-name';\n\nexport function updateFormula(\n    instance: AjfFieldInstance, context: AjfContext): {changed: boolean, value: any} {\n  const formula = instance.formula;\n  const editable = instance.node.editable;\n  if (formula != null && instance.visible && (!editable || (editable && instance.value == null))) {\n    let newValue: any = evaluateExpression(formula.formula, context);\n    const oldValue = instance.value;\n    if (newValue !== instance.value) {\n      instance.value = newValue;\n      context[nodeInstanceCompleteName(instance)] = instance.value;\n      context.$value = instance.value;\n    }\n    return {changed: newValue !== oldValue, value: newValue};\n  }\n  return {changed: false, value: instance.value};\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {nodeInstanceSuffix} from './node-instance-suffix';\n\nexport function nodeInstanceCompleteName(instance: AjfNodeInstance): string {\n  return `${instance.node.name}${nodeInstanceSuffix(instance)}`;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\n\nexport function nodeInstanceSuffix(instance: AjfNodeInstance): string {\n  if (instance.prefix == null || instance.prefix.length == 0) {\n    return '';\n  }\n  return `__${instance.prefix.join('__')}`;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfCondition, AjfContext, evaluateExpression} from '@ajf/core/models';\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\n\nexport function updateVisibility(\n    instance: AjfNodeInstance, context: AjfContext, branchVisibility = true): boolean {\n  if (instance.visibility == null) {\n    instance.visible = false;\n    return false;\n  }\n  const visibility: AjfCondition = instance.visibility;\n\n  const oldVisibility: boolean = instance.visible;\n  let newVisibility: boolean =\n      branchVisibility && evaluateExpression(visibility.condition, context);\n  if (newVisibility !== instance.visible) {\n    instance.visible = newVisibility;\n  }\n\n  return oldVisibility !== newVisibility;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext, evaluateExpression} from '@ajf/core/models';\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\n\nexport function updateConditionalBranches(instance: AjfNodeInstance, context: AjfContext): boolean {\n  const conditionalBranches = instance.conditionalBranches;\n\n  if (conditionalBranches != null) {\n    const oldBranch = instance.verifiedBranch;\n    let idx = 0;\n    let found = false;\n    while (idx < conditionalBranches.length && !found) {\n      let verified: boolean = evaluateExpression(conditionalBranches[idx].condition, context);\n      if (verified) {\n        found = true;\n        if (idx !== instance.verifiedBranch) {\n          instance.verifiedBranch = idx;\n        }\n      }\n      idx++;\n    }\n\n    if (oldBranch !== instance.verifiedBranch) {\n      return true;\n    }\n  }\n\n  return false;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfFieldInstance} from '../../interface/fields-instances/field-instance';\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {isTableField} from '../fields/is-table-field';\nimport {isFieldInstance} from '../nodes-instances/is-field-instance';\n\nexport function isTableFieldInstance(nodeInstance: AjfNodeInstance): boolean {\n  return nodeInstance != null && isFieldInstance(nodeInstance) &&\n      isTableField((nodeInstance as AjfFieldInstance).node);\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfField} from '../../interface/fields/field';\nimport {AjfFieldType} from '../../interface/fields/field-type';\n\nexport function isTableField(field: AjfField): boolean {\n  return field.fieldType === AjfFieldType.Table;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfFieldInstance} from '../../interface/fields-instances/field-instance';\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {isFieldWithChoices} from '../fields/is-field-with-choices';\nimport {isFieldInstance} from '../nodes-instances/is-field-instance';\n\nexport function isFieldWithChoicesInstance(nodeInstance: AjfNodeInstance): boolean {\n  return nodeInstance != null && isFieldInstance(nodeInstance) &&\n      isFieldWithChoices((nodeInstance as AjfFieldInstance).node);\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {isField} from '../nodes/is-field';\n\nexport function isFieldInstance(nodeInstance: AjfNodeInstance): boolean {\n  return nodeInstance != null && nodeInstance.node != null && isField(nodeInstance.node);\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNode} from '../../interface/nodes/node';\nimport {AjfNodeType} from '../../interface/nodes/node-type';\n\nexport function isField(node: AjfNode): boolean {\n  return node != null && node.nodeType === AjfNodeType.AjfField;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfField} from '../../interface/fields/field';\nimport {AjfFieldType} from '../../interface/fields/field-type';\n\nexport function isFieldWithChoices(field: AjfField): boolean {\n  return field.fieldType === AjfFieldType.SingleChoice ||\n      field.fieldType === AjfFieldType.MultipleChoice;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfField} from '../../interface/fields/field';\nimport {componentsMap} from './fields-map';\n\nexport function isCustomFieldWithChoices(field: AjfField): boolean {\n  return field.fieldType > 100\n    && componentsMap[field.fieldType] != null\n    && componentsMap[field.fieldType].isFieldWithChoice === true;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum AjfNodeType {\n  AjfField,\n  AjfFieldNodeLink,\n  AjfNodeGroup,\n  AjfSlide,\n  AjfRepeatingSlide,\n  LENGTH\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ChangeDetectorRef} from '@angular/core';\n\nimport {\n  AjfFieldWithChoicesInstance\n} from './interface/fields-instances/field-with-choices-instance';\nimport {AjfBaseFieldComponent} from './base-field';\nimport {AjfFormRendererService} from './form-renderer';\nimport {AjfWarningAlertService} from './warning-alert-service';\n\nexport abstract class AjfFieldWithChoicesComponent<T>\n    extends AjfBaseFieldComponent<AjfFieldWithChoicesInstance<T>> {\n  private _searchThreshold: number = 6;\n  get searchThreshold(): number { return this._searchThreshold; }\n\n  constructor(\n    cdr: ChangeDetectorRef,\n    service: AjfFormRendererService,\n    warningAlertService: AjfWarningAlertService,\n    searchThreshold: number\n  ) {\n    super(cdr, service, warningAlertService);\n    if (searchThreshold != null) {\n      this._searchThreshold = searchThreshold;\n    }\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '@ajf/core/models';\nimport {Type} from '@angular/core';\n\nimport {AjfBaseFieldComponent} from './base-field';\nimport {AjfFieldComponentsMap} from './interface/fields/field-components-map';\nimport {AjfFieldInstance} from './interface/fields-instances/field-instance';\nimport {componentsMap} from './utils/fields/fields-map';\nimport {AjfFieldInstanceCreate} from './utils/fields-instances/create-field-instance';\n\nexport abstract class AjfFieldService {\n  readonly componentsMap: AjfFieldComponentsMap = componentsMap;\n\n  registerCustomField(field: {\n    fieldType: number,\n    component: Type<AjfBaseFieldComponent>,\n    createInstance?: (instance: AjfFieldInstanceCreate, context: AjfContext) => AjfFieldInstance;\n    isFieldWithChoice?: boolean,\n  }): void {\n    const {fieldType, component} = field;\n    if (fieldType < 100) {\n      throw new Error('Invalid custom field type, it must be greater than 100');\n    }\n    if (component == null) {\n      throw new Error('Invalid custom field component');\n    }\n    this.componentsMap[fieldType] = field;\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfFieldComponentsMap} from '../../interface/fields/field-components-map';\n\nexport const componentsMap: AjfFieldComponentsMap = {};\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Directive, ViewContainerRef} from '@angular/core';\n\n@Directive({selector: '[ajf-field-host]'})\nexport class AjfFieldHost {\n  constructor(readonly viewContainerRef: ViewContainerRef) {}\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ComponentFactoryResolver, OnInit} from '@angular/core';\n\nimport {AjfFieldComponentsMap} from './interface/fields/field-components-map';\nimport {AjfFieldInstance} from './interface/fields-instances/field-instance';\nimport {AjfFieldHost} from './field-host';\n\nexport abstract class AjfFormField implements OnInit {\n  fieldHost: AjfFieldHost;\n\n  private _instance: AjfFieldInstance;\n  get instance(): AjfFieldInstance { return this._instance; }\n  set instance(instance: AjfFieldInstance) {\n    if (this._instance !== instance) {\n      this._instance = instance;\n      this._loadComponent();\n    }\n  }\n\n  protected abstract componentsMap: AjfFieldComponentsMap;\n\n  constructor(private _cfr: ComponentFactoryResolver) { }\n\n  ngOnInit(): void {\n    this._loadComponent();\n  }\n\n  private _loadComponent(): void {\n    if (this._instance == null || this.fieldHost == null) { return; }\n\n    const vcr = this.fieldHost.viewContainerRef;\n    vcr.clear();\n    const componentDef = this.componentsMap[this._instance.node.fieldType];\n    if (componentDef == null) { return; }\n    const component = componentDef.component;\n    try {\n      const componentFactory = this._cfr.resolveComponentFactory(component);\n      const componentRef = vcr.createComponent(componentFactory);\n      const componentInstance = componentRef.instance;\n      componentInstance.instance = this._instance;\n      if (componentDef.inputs) {\n        Object.keys(componentDef.inputs).forEach(key => {\n          if (key in componentInstance) {\n            (componentInstance as any)[key] = componentDef.inputs![key];\n          }\n        });\n      }\n    } catch (e) { }\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe} from '@angular/core';\nimport {AjfFieldInstance} from './interface/fields-instances/field-instance';\n\n@Pipe({ name: 'ajfFieldIsValid' })\nexport class AjfFieldIsValidPipe {\n    transform(fieldInstance: AjfFieldInstance): boolean {\n        if (\n            fieldInstance &&\n            fieldInstance.validationResults &&\n            fieldInstance.validationResults.length === 0\n        ) {\n            return true;\n        } else {\n            return false;\n        }\n    }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\n\nimport {fieldIconName} from './field-utils';\nimport {AjfField} from './interface/fields/field';\nimport {AjfFieldType} from './interface/fields/field-type';\n\n@Pipe({name: 'ajfFieldIcon'})\nexport class AjfFieldIconPipe implements PipeTransform {\n  transform(field: AjfField | AjfFieldType): string {\n    return fieldIconName(\n        (field as AjfField).fieldType ? (field as AjfField).fieldType : field as AjfFieldType);\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfFieldType} from './interface/fields/field-type';\n\nexport function fieldIconName(type: AjfFieldType): string {\n  return `ajf-icon-field-${\n    typeof AjfFieldType[type] === 'string'\n    ? AjfFieldType[type].toLowerCase()\n    : type}`;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum AjfFieldType {\n  String,\n  Text,\n  Number,\n  Boolean,\n  SingleChoice,\n  MultipleChoice,\n  Formula,\n  Empty,\n  Date,\n  DateInput,\n  Time,\n  Table,\n  Geolocation,\n  Barcode,\n  LENGTH\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfError} from '@ajf/core/models';\n\n/**\n * This class will define an Ajf invalid field definition error\n */\nexport class AjfInvalidFieldDefinitionError extends AjfError {\n  get name(): string { return 'AjfInvalidFieldDefinitionError'; }\n\n  constructor(message?: string) {\n    super(message);\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Injectable, Pipe, PipeTransform} from '@angular/core';\nimport {format} from 'date-fns';\n\n@Injectable()\n@Pipe({name: 'ajfDateValueString'})\nexport class AjfDateValueStringPipe implements PipeTransform {\n  transform(date: Date|'today'|undefined): string|undefined {\n    if (date == null) { return undefined; }\n    const dateObj = date === 'today' ? new Date() : date;\n    return format(dateObj, 'YYYY-MM-DD');\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\n\n@Pipe({name: 'ajfDateValue'})\nexport class AjfDateValuePipe implements PipeTransform {\n  transform(date: Date|'today'|undefined): Date|undefined {\n    if (date == null) { return undefined; }\n    return date === 'today' ? new Date() : date as Date;\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ChangeDetectorRef, OnDestroy, OnInit} from '@angular/core';\nimport {AbstractControl, FormControl} from '@angular/forms';\nimport {defer, Observable, Subscription} from 'rxjs';\nimport {filter, map, withLatestFrom} from 'rxjs/operators';\n\nimport {AjfFieldWarningAlertResult} from './field-warning-alert-result';\nimport {AjfFormRendererService} from './form-renderer';\nimport {AjfFieldInstance} from './interface/fields-instances/field-instance';\nimport {AjfWarningAlertService} from './warning-alert-service';\n\nexport abstract class AjfBaseFieldComponent<T extends AjfFieldInstance = AjfFieldInstance>\n    implements OnDestroy, OnInit {\n  private _instance: T;\n  get instance(): T { return this._instance; }\n  set instance(instance: T) {\n    if (instance !== this._instance) {\n      this._instance = instance;\n      this._setUpInstanceUpdate();\n      this._onInstanceChange();\n    }\n  }\n\n  private _control: Observable<AbstractControl | null>;\n  get control(): Observable<AbstractControl | null> { return this._control; }\n\n  private _warningTriggerSub: Subscription = Subscription.EMPTY;\n  private _instanceUpdateSub: Subscription = Subscription.EMPTY;\n\n  constructor(\n    protected _changeDetectorRef: ChangeDetectorRef,\n    private _service: AjfFormRendererService,\n    private _warningAlertService: AjfWarningAlertService,\n  ) {\n    this._control = defer(() => this._service.getControl(this.instance).pipe(\n      map(ctrl => ctrl || new FormControl()),\n    ));\n  }\n\n  ngOnInit(): void {\n    this._warningTriggerSub = this.instance.warningTrigger.pipe(\n      withLatestFrom(this.control),\n      filter(v => v[1] != null)\n    ).subscribe((v: [void, AbstractControl | null]) => {\n      if (this.instance.warningResults == null) { return; }\n      const control = v[1];\n      const s = this._warningAlertService.showWarningAlertPrompt(\n        this.instance.warningResults.filter(w => w.result).map(w => w.warning)\n      ).subscribe(\n        (r: AjfFieldWarningAlertResult) => {\n          if (r.result) { control!.setValue(null); }\n        },\n        (_e: any) => { if (s) { s.unsubscribe(); }},\n        () => { if (s) { s.unsubscribe(); }}\n      );\n    });\n  }\n\n  ngOnDestroy(): void {\n    this._warningTriggerSub.unsubscribe();\n    this._instanceUpdateSub.unsubscribe();\n  }\n\n  protected _onInstanceChange(): void { }\n\n  private _setUpInstanceUpdate(): void {\n    this._instanceUpdateSub.unsubscribe();\n    if (this._instance != null) {\n      this._instanceUpdateSub = this._instance.updated.subscribe(() => {\n        if (this._changeDetectorRef) {\n          try {\n            this._changeDetectorRef.detectChanges();\n          } catch (e) { }\n        }\n      });\n    } else {\n      this._instanceUpdateSub = Subscription.EMPTY;\n    }\n    this._changeDetectorRef.detectChanges();\n  }\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n"],"names":["tslib_1.__assign","deepCopy","AjfFormulaSerializer","AjfConditionSerializer","InjectionToken","coerceBooleanProperty","tslib_1.__extends","NgModule","Pipe","withLatestFrom","delayWhen","map","EventEmitter","Subscription","Injectable","FormControl","share","scan","timer","startWith","pairwise","debounceTime","filter","FormGroup","publishReplay","refCount","Observable","BehaviorSubject","Subject","((/** @type {?} */ (esprima))).default","esprima","AjfExpressionUtils","evaluateExpression","alwaysCondition","createFormula","normalizeExpression","createCondition","ViewContainerRef","Directive","AjfError","format","defer"],"mappings":"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"}