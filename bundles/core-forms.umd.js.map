{"version":3,"file":"core-forms.umd.js","sources":["../../../../../src/core/forms/as-field-instance.ts","../../../../../src/core/forms/as-repeating-slide-instance.ts","../../../../../external/npm/node_modules/tslib/tslib.es6.js","../../../../../src/core/forms/interface/fields/field-type.ts","../../../../../src/core/forms/interface/nodes/node-type.ts","../../../../../src/core/forms/utils/choices/init-choices-origin.ts","../../../../../src/core/forms/utils/fields/is-field-with-choices.ts","../../../../../src/core/forms/utils/nodes/is-field.ts","../../../../../src/core/forms/utils/nodes-instances/is-field-instance.ts","../../../../../src/core/forms/utils/fields-instances/is-field-with-choices-instance.ts","../../../../../src/core/forms/utils/fields/is-table-field.ts","../../../../../src/core/forms/utils/fields-instances/is-table-field-instance.ts","../../../../../src/core/forms/utils/nodes-instances/update-conditional-branches.ts","../../../../../src/core/forms/utils/nodes-instances/update-visibility.ts","../../../../../src/core/forms/utils/nodes-instances/node-instance-suffix.ts","../../../../../src/core/forms/utils/nodes-instances/node-instance-complete-name.ts","../../../../../src/core/forms/utils/fields-instances/update-formula.ts","../../../../../src/core/forms/utils/fields-instances/update-next-slide-condition.ts","../../../../../src/core/forms/utils/validation/evaluate-validation.ts","../../../../../src/core/forms/utils/validation/evaluate-validation-conditions.ts","../../../../../src/core/forms/utils/validation/evaluate-validation-max-digits.ts","../../../../../src/core/forms/utils/validation/evaluate-validation-max-value.ts","../../../../../src/core/forms/utils/validation/evaluate-validation-min-digits.ts","../../../../../src/core/forms/utils/validation/evaluate-validation-min-value.ts","../../../../../src/core/forms/utils/validation/evaluate-validation-not-empty.ts","../../../../../src/core/forms/utils/validation/evaluate-validation-group.ts","../../../../../src/core/forms/utils/fields-instances/update-validation.ts","../../../../../src/core/forms/utils/warning/evaluate-warning.ts","../../../../../src/core/forms/utils/warning/evaluate-warning-conditions.ts","../../../../../src/core/forms/utils/warning/evaluate-warning-group.ts","../../../../../src/core/forms/utils/fields-instances/update-warning.ts","../../../../../src/core/forms/utils/fields-instances/update-field-instance-state.ts","../../../../../src/core/forms/utils/fields-instances/update-filtered-choices.ts","../../../../../src/core/forms/utils/fields-instances/update-trigger-conditions.ts","../../../../../src/core/forms/utils/nodes/create-node.ts","../../../../../src/core/forms/utils/fields/create-field.ts","../../../../../src/core/forms/utils/fields/fields-map.ts","../../../../../src/core/forms/utils/fields/is-custom-field-with-choices.ts","../../../../../src/core/forms/utils/nodes/is-slides-node.ts","../../../../../src/core/forms/utils/nodes/is-container-node.ts","../../../../../src/core/forms/utils/nodes-instances/is-container-node-instance.ts","../../../../../src/core/forms/utils/nodes-instances/flatten-nodes-instances.ts","../../../../../src/core/forms/utils/nodes-instances/is-slides-instance.ts","../../../../../src/core/forms/utils/nodes-instances/flatten-nodes-instances-tree.ts","../../../../../src/core/forms/utils/nodes/is-node-group.ts","../../../../../src/core/forms/utils/nodes-instances/is-node-group-instance.ts","../../../../../src/core/forms/utils/nodes/is-slide-node.ts","../../../../../src/core/forms/utils/nodes-instances/is-slide-instance.ts","../../../../../src/core/forms/utils/nodes-instances/create-node-instance.ts","../../../../../src/core/forms/utils/fields-instances/create-field-instance.ts","../../../../../src/core/forms/utils/fields-instances/create-field-with-choices-instance.ts","../../../../../src/core/forms/utils/fields-instances/create-table-field-instance.ts","../../../../../src/core/forms/utils/nodes-instances/create-node-group-instance.ts","../../../../../src/core/forms/utils/slides-instances/create-slide-instance.ts","../../../../../src/core/forms/utils/slides-instances/create-repeating-slide-instance.ts","../../../../../src/core/forms/utils/validation/create-validation-group.ts","../../../../../src/core/forms/utils/warning/create-warning-group.ts","../../../../../src/core/forms/utils/nodes/is-repeating-container-node.ts","../../../../../src/core/forms/utils/nodes-instances/get-ancestor-repeating-nodes.ts","../../../../../src/core/forms/utils/nodes-instances/get-ancestor-repeating-nodes-names.ts","../../../../../src/core/forms/utils/nodes-instances/get-instance-condition.ts","../../../../../src/core/forms/utils/nodes-instances/get-instance-conditions.ts","../../../../../src/core/forms/utils/nodes-instances/get-instance-formula.ts","../../../../../src/core/forms/utils/validation/create-validation.ts","../../../../../src/core/forms/utils/nodes-instances/get-instance-validation.ts","../../../../../src/core/forms/utils/nodes-instances/get-instance-validations.ts","../../../../../src/core/forms/utils/warning/create-warning.ts","../../../../../src/core/forms/utils/nodes-instances/get-instance-warning.ts","../../../../../src/core/forms/utils/nodes-instances/get-instance-warnings.ts","../../../../../src/core/forms/utils/nodes/is-repeating-slide.ts","../../../../../src/core/forms/utils/nodes-instances/is-repeating-slide-instance.ts","../../../../../src/core/forms/utils/nodes-instances/node-to-node-instance.ts","../../../../../src/core/forms/utils/nodes/flatten-nodes.ts","../../../../../src/core/forms/utils/nodes/ordered-nodes.ts","../../../../../src/core/forms/utils/slides-instances/update-reps-num.ts","../../../../../src/core/forms/utils/slides-instances/valid-slide.ts","../../../../../src/core/forms/validation-service.ts","../../../../../src/core/forms/form-renderer.ts","../../../../../src/core/forms/base-field.ts","../../../../../src/core/forms/bool-to-int.ts","../../../../../src/core/forms/date-value.ts","../../../../../src/core/forms/date-value-string.ts","../../../../../src/core/forms/errors.ts","../../../../../src/core/forms/expand-input-with-choices.ts","../../../../../src/core/forms/field-host.ts","../../../../../src/core/forms/field.ts","../../../../../src/core/forms/field-utils.ts","../../../../../src/core/forms/field-icon.ts","../../../../../src/core/forms/field-is-valid.ts","../../../../../src/core/forms/field-service.ts","../../../../../src/core/forms/field-with-choices.ts","../../../../../src/core/forms/warning-alert-service.ts","../../../../../src/core/forms/file-field.ts","../../../../../src/core/forms/form.ts","../../../../../src/core/forms/utils/forms/build-form-string-identifier.ts","../../../../../src/core/forms/form-string-identifier.ts","../../../../../src/core/forms/get-table-cell-control.ts","../../../../../src/core/forms/image-field.ts","../../../../../src/core/forms/increment.ts","../../../../../src/core/forms/is-cell-editable.ts","../../../../../src/core/forms/is-readonly-input-field.ts","../../../../../src/core/forms/is-repeating-slide.ts","../../../../../src/core/forms/node-complete-name.ts","../../../../../src/core/forms/range.ts","../../../../../src/core/forms/input-field.ts","../../../../../src/core/forms/read-only-field.ts","../../../../../src/core/forms/read-only-file-field.ts","../../../../../src/core/forms/read-only-image-field.ts","../../../../../src/core/forms/read-only-select-field.ts","../../../../../src/core/forms/read-only-table-field.ts","../../../../../src/core/forms/video-url-field.ts","../../../../../src/core/forms/read-only-video-url-field.ts","../../../../../src/core/forms/table-row-class.ts","../../../../../src/core/forms/table-visible-columns.ts","../../../../../src/core/forms/valid-slide.ts","../../../../../src/core/forms/forms-module.ts","../../../../../src/core/forms/get-type-name.ts","../../../../../src/core/forms/search-alert-threshold.ts","../../../../../src/core/forms/utils/attachments/create-attachments-origin.ts","../../../../../src/core/forms/serializers/attachments-origin-serializer.ts","../../../../../src/core/forms/utils/choices/create-choices-origin.ts","../../../../../src/core/forms/serializers/choices-origin-serializer.ts","../../../../../src/core/forms/utils/fields/create-field-with-choices.ts","../../../../../src/core/forms/utils/nodes/create-container-node.ts","../../../../../src/core/forms/utils/nodes/create-repeating-node.ts","../../../../../src/core/forms/utils/nodes/create-node-group.ts","../../../../../src/core/forms/utils/slides/create-repeating-slide.ts","../../../../../src/core/forms/utils/slides/create-slide.ts","../../../../../src/core/forms/serializers/validation-group-serializer.ts","../../../../../src/core/forms/serializers/warning-group-serializer.ts","../../../../../src/core/forms/serializers/node-serializer.ts","../../../../../src/core/forms/serializers/form-serializer.ts","../../../../../src/core/forms/table-field.ts","../../../../../src/core/forms/utils/choices/create-choices-fixed-origin.ts","../../../../../src/core/forms/utils/choices/create-choices-function-origin.ts","../../../../../src/core/forms/utils/choices/create-choices-observable-array-origin.ts","../../../../../src/core/forms/utils/choices/create-choices-observable-origin.ts","../../../../../src/core/forms/utils/choices/create-choices-promise-origin.ts","../../../../../src/core/forms/utils/choices/is-choices-origin.ts","../../../../../src/core/forms/utils/choices/is-choices-fixed-origin.ts","../../../../../src/core/forms/utils/fields/is-number-field.ts","../../../../../src/core/forms/utils/forms/create-form.ts","../../../../../src/core/forms/utils/validation/max-digits-validation.ts","../../../../../src/core/forms/utils/validation/max-validation.ts","../../../../../src/core/forms/utils/validation/min-digits-validation.ts","../../../../../src/core/forms/utils/validation/min-validation.ts","../../../../../src/core/forms/utils/validation/not-empty-validation.ts","../../../../../src/core/forms/utils/warning/not-empty-warning.ts","../../../../../src/core/forms/public-api.ts","../../../../../src/core/forms/index.ts"],"sourcesContent":["/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\n\nimport {AjfFieldInstance} from './interface/fields-instances/field-instance';\nimport {AjfNodeInstance} from './interface/nodes-instances/node-instance';\n\n@Pipe({name: 'ajfAsFieldInstance'})\nexport class AjfAsFieldInstancePipe implements PipeTransform {\n  transform(instance: AjfNodeInstance): AjfFieldInstance {\n    return instance as AjfFieldInstance;\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\n\nimport {AjfRepeatingSlideInstance} from './interface/slides-instances/repeating-slide-instance';\nimport {AjfSlideInstance} from './interface/slides-instances/slide-instance';\n\n@Pipe({name: 'ajfAsRepeatingSlideInstance'})\nexport class AjfAsRepeatingSlideInstancePipe implements PipeTransform {\n  transform(instance: AjfSlideInstance): AjfRepeatingSlideInstance {\n    return instance as unknown as AjfRepeatingSlideInstance;\n  }\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\n// tslint:disable-next-line:prefer-const-enum\nexport enum AjfFieldType {\n  String,\n  Text,\n  Number,\n  Boolean,\n  SingleChoice,\n  MultipleChoice,\n  Formula,\n  Empty,\n  Date,\n  DateInput,\n  Time,\n  Table,\n  Geolocation,\n  Barcode,\n  File,\n  Image,\n  VideoUrl,\n  LENGTH\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\n// tslint:disable-next-line:prefer-const-enum\nexport enum AjfNodeType {\n  AjfField,\n  AjfFieldNodeLink,\n  AjfNodeGroup,\n  AjfSlide,\n  AjfRepeatingSlide,\n  LENGTH\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfChoicesFunctionOrigin} from '../../interface/choices/choices-function-origin';\nimport {\n  AjfChoicesObservableArrayOrigin\n} from '../../interface/choices/choices-observable-array-origin';\nimport {AjfChoicesObservableOrigin} from '../../interface/choices/choices-observable-origin';\nimport {AjfChoicesOrigin} from '../../interface/choices/choices-origin';\nimport {AjfChoicesPromiseOrigin} from '../../interface/choices/choices-promise-origin';\n\nexport function initChoicesOrigin(origin: AjfChoicesOrigin<any>): Promise<void> {\n  if (origin.type === 'fixed') {\n    return Promise.resolve();\n  }\n  if (origin.type === 'function') {\n    const fo = origin as AjfChoicesFunctionOrigin<any>;\n    fo.choices = fo.generator();\n    return Promise.resolve();\n  }\n  if (origin.type === 'promise') {\n    const po = origin as AjfChoicesPromiseOrigin<any>;\n    return po.generator.then(choices => po.choices = choices).then();\n  }\n  if (origin.type === 'observable') {\n    const obso = origin as AjfChoicesObservableOrigin<any>;\n    if (obso.generator != null) {\n      obso.choices = [];\n      return new Promise<void>(res => {\n        obso.generator.subscribe(\n            c => obso.choices.push(c),\n            () => {},\n            () => res(),\n        );\n      });\n    }\n  }\n  if (origin.type === 'observableArray') {\n    const aoo = origin as AjfChoicesObservableArrayOrigin<any>;\n    if (aoo.generator != null) {\n      aoo.choices = [];\n      return new Promise<void>(res => {\n        aoo.generator.subscribe(choices => {\n          aoo.choices = choices;\n          res();\n        });\n      });\n    }\n  }\n  return Promise.resolve();\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfField} from '../../interface/fields/field';\nimport {AjfFieldType} from '../../interface/fields/field-type';\n\nexport function isFieldWithChoices(field: AjfField): boolean {\n  return field.fieldType === AjfFieldType.SingleChoice ||\n      field.fieldType === AjfFieldType.MultipleChoice;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNode} from '../../interface/nodes/node';\nimport {AjfNodeType} from '../../interface/nodes/node-type';\n\nexport function isField(node: AjfNode): boolean {\n  return node != null && node.nodeType === AjfNodeType.AjfField;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {isField} from '../nodes/is-field';\n\nexport function isFieldInstance(nodeInstance: AjfNodeInstance): boolean {\n  return nodeInstance != null && nodeInstance.node != null && isField(nodeInstance.node);\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfFieldInstance} from '../../interface/fields-instances/field-instance';\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {isFieldWithChoices} from '../fields/is-field-with-choices';\nimport {isFieldInstance} from '../nodes-instances/is-field-instance';\n\nexport function isFieldWithChoicesInstance(nodeInstance: AjfNodeInstance): boolean {\n  return nodeInstance != null && isFieldInstance(nodeInstance) &&\n      isFieldWithChoices((nodeInstance as AjfFieldInstance).node);\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfField} from '../../interface/fields/field';\nimport {AjfFieldType} from '../../interface/fields/field-type';\n\nexport function isTableField(field: AjfField): boolean {\n  return field.fieldType === AjfFieldType.Table;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfFieldInstance} from '../../interface/fields-instances/field-instance';\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {isTableField} from '../fields/is-table-field';\nimport {isFieldInstance} from '../nodes-instances/is-field-instance';\n\nexport function isTableFieldInstance(nodeInstance: AjfNodeInstance): boolean {\n  return nodeInstance != null && isFieldInstance(nodeInstance) &&\n      isTableField((nodeInstance as AjfFieldInstance).node);\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext, evaluateExpression} from '@ajf/core/models';\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\n\nexport function updateConditionalBranches(instance: AjfNodeInstance, context: AjfContext): boolean {\n  const conditionalBranches = instance.conditionalBranches;\n\n  if (conditionalBranches != null) {\n    const oldBranch = instance.verifiedBranch;\n    let idx = 0;\n    let found = false;\n    while (idx < conditionalBranches.length && !found) {\n      let verified: boolean = evaluateExpression(conditionalBranches[idx].condition, context);\n      if (verified) {\n        found = true;\n        if (idx !== instance.verifiedBranch) {\n          instance.verifiedBranch = idx;\n        }\n      }\n      idx++;\n    }\n\n    if (oldBranch !== instance.verifiedBranch) {\n      return true;\n    }\n  }\n\n  return false;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfCondition, AjfContext, evaluateExpression} from '@ajf/core/models';\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\n\nexport function updateVisibility(\n    instance: AjfNodeInstance, context: AjfContext, branchVisibility = true): boolean {\n  if (instance.visibility == null) {\n    instance.visible = false;\n    return false;\n  }\n  const visibility: AjfCondition = instance.visibility;\n\n  const oldVisibility: boolean = instance.visible;\n  let newVisibility: boolean =\n      branchVisibility && evaluateExpression(visibility.condition, context);\n  if (newVisibility !== instance.visible) {\n    instance.visible = newVisibility;\n  }\n\n  return oldVisibility !== newVisibility;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\n\nexport function nodeInstanceSuffix(instance: AjfNodeInstance): string {\n  if (instance.prefix == null || instance.prefix.length == 0) {\n    return '';\n  }\n  return `__${instance.prefix.join('__')}`;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {nodeInstanceSuffix} from './node-instance-suffix';\n\nexport function nodeInstanceCompleteName(instance: AjfNodeInstance): string {\n  return instance != null && instance.node != null ?\n      `${instance.node.name}${nodeInstanceSuffix(instance)}` :\n      '';\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext, evaluateExpression} from '@ajf/core/models';\n\nimport {AjfFieldInstance} from '../../interface/fields-instances/field-instance';\nimport {nodeInstanceCompleteName} from '../nodes-instances/node-instance-complete-name';\n\n/**\n * update the relative instance value and the context\n * if !editable evaluate expression once one time and flag changed is false\n */\nexport function updateFormula(\n    instance: AjfFieldInstance, context: AjfContext): {changed: boolean, value: any} {\n  const formula = instance.formula;\n  const editable = instance.node.editable;\n  if (formula != null && instance.visible && (!editable || (editable && instance.value == null))) {\n    let newValue: any = evaluateExpression(formula.formula, context);\n    const oldValue = instance.value;\n    if (newValue !== instance.value) {\n      instance.value = newValue;\n      context[nodeInstanceCompleteName(instance)] = instance.value;\n      context.$value = instance.value;\n    }\n    return {changed: newValue !== oldValue, value: newValue};\n  }\n  return {changed: false, value: instance.value};\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext, evaluateExpression} from '@ajf/core/models';\n\nimport {AjfFieldInstance} from '../../interface/fields-instances/field-instance';\n\nexport function updateNextSlideCondition(instance: AjfFieldInstance, context: AjfContext): boolean {\n  if (instance.nextSlideCondition != null) {\n    return evaluateExpression(instance.nextSlideCondition.condition, context);\n  }\n  return false;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext, evaluateExpression} from '@ajf/core/models';\n\nimport {AjfValidation} from '../../interface/validation/validation';\nimport {AjfValidationResult} from '../../interface/validation/validation-results';\n\nexport function evaluateValidation(\n    validation: AjfValidation, context?: AjfContext, forceFormula?: string): AjfValidationResult {\n  return {\n    result: evaluateExpression(validation.condition, context, forceFormula),\n    error: validation.errorMessage,\n    clientValidation: validation.clientValidation,\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '@ajf/core/models';\n\nimport {AjfValidationGroup} from '../../interface/validation/validation-group';\nimport {AjfValidationResult} from '../../interface/validation/validation-results';\nimport {evaluateValidation} from './evaluate-validation';\n\nexport function evaluateValidationConditions(\n    validation: AjfValidationGroup, context?: AjfContext): AjfValidationResult[] {\n  let res: AjfValidationResult[] = [];\n  validation.conditions.forEach((cond) => {\n    res.push(evaluateValidation(cond, context));\n  });\n  return res;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {evaluateExpression} from '@ajf/core/models';\nimport {AjfValidationGroup} from '../../interface/validation/validation-group';\nimport {AjfValidationResult} from '../../interface/validation/validation-results';\nimport {evaluateValidation} from './evaluate-validation';\n\nexport function evaluateValidationMaxDigits(\n    validation: AjfValidationGroup, value: any): AjfValidationResult|null {\n  if (validation.maxDigits == null) {\n    return null;\n  }\n  const ctx = {'$value': value};\n  if (typeof validation.maxDigits === 'number') {\n    return {\n      result: evaluateExpression(`$value.toString().length <= ${validation.maxDigits}`, ctx),\n      error: `Digits count must be <= ${validation.maxDigits}`,\n      clientValidation: false\n    };\n  }\n  return evaluateValidation(validation.maxDigits, ctx);\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {evaluateExpression} from '@ajf/core/models';\nimport {AjfValidationGroup} from '../../interface/validation/validation-group';\nimport {AjfValidationResult} from '../../interface/validation/validation-results';\nimport {evaluateValidation} from './evaluate-validation';\n\nexport function evaluateValidationMaxValue(\n    validation: AjfValidationGroup, value: any): AjfValidationResult|null {\n  if (validation.maxValue == null) {\n    return null;\n  }\n  const ctx = {'$value': value};\n  if (typeof validation.maxValue === 'number') {\n    return {\n      result: evaluateExpression(`$value.length <= ${validation.maxValue}`, ctx),\n      error: `Value must be <= ${validation.maxValue}`,\n      clientValidation: false\n    };\n  }\n  return evaluateValidation(validation.maxValue, {'$value': value});\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {evaluateExpression} from '@ajf/core/models';\nimport {AjfValidationGroup} from '../../interface/validation/validation-group';\nimport {AjfValidationResult} from '../../interface/validation/validation-results';\nimport {evaluateValidation} from './evaluate-validation';\n\nexport function evaluateValidationMinDigits(\n    validation: AjfValidationGroup, value: any): AjfValidationResult|null {\n  if (validation.minDigits == null) {\n    return null;\n  }\n  const ctx = {'$value': value};\n  if (typeof validation.minDigits === 'number') {\n    return {\n      result: evaluateExpression(`$value.toString().length >= ${validation.minDigits}`, ctx),\n      error: `Digits count must be >= ${validation.minDigits}`,\n      clientValidation: false\n    };\n  }\n  return evaluateValidation(validation.minDigits, ctx);\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {evaluateExpression} from '@ajf/core/models';\nimport {AjfValidationGroup} from '../../interface/validation/validation-group';\nimport {AjfValidationResult} from '../../interface/validation/validation-results';\nimport {evaluateValidation} from './evaluate-validation';\n\nexport function evaluateValidationMinValue(\n    validation: AjfValidationGroup, value: any): AjfValidationResult|null {\n  if (validation.minValue == null) {\n    return null;\n  }\n  const ctx = {'$value': value};\n  if (typeof validation.minValue === 'number') {\n    return {\n      result: evaluateExpression(`$value.length <= ${validation.minValue}`, ctx),\n      error: `Value must be >= ${validation.minValue}`,\n      clientValidation: false\n    };\n  }\n  return evaluateValidation(validation.minValue, {'$value': value});\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {evaluateExpression} from '@ajf/core/models';\nimport {AjfValidationGroup} from '../../interface/validation/validation-group';\nimport {AjfValidationResult} from '../../interface/validation/validation-results';\nimport {evaluateValidation} from './evaluate-validation';\n\nexport function evaluateValidationNotEmpty(\n    validation: AjfValidationGroup, value: any): AjfValidationResult|null {\n  if (validation.notEmpty == null) {\n    return null;\n  }\n  const ctx = {'$value': value};\n  if (typeof validation.notEmpty === 'boolean') {\n    return {\n      result: evaluateExpression(`($value != null) === ${validation.notEmpty}`, ctx),\n      error: 'Value must not be empty',\n      clientValidation: false\n    };\n  }\n  return evaluateValidation(validation.notEmpty, ctx);\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '@ajf/core/models';\nimport {deepCopy} from '@ajf/core/utils';\n\nimport {AjfValidationGroup} from '../../interface/validation/validation-group';\nimport {AjfValidationResult} from '../../interface/validation/validation-results';\n\nimport {evaluateValidationConditions} from './evaluate-validation-conditions';\nimport {evaluateValidationMaxDigits} from './evaluate-validation-max-digits';\nimport {evaluateValidationMaxValue} from './evaluate-validation-max-value';\nimport {evaluateValidationMinDigits} from './evaluate-validation-min-digits';\nimport {evaluateValidationMinValue} from './evaluate-validation-min-value';\nimport {evaluateValidationNotEmpty} from './evaluate-validation-not-empty';\n\nexport function evaluateValidationGroup(\n    validation: AjfValidationGroup, value: any, context?: AjfContext): AjfValidationResult[] {\n  let res: AjfValidationResult[] = [];\n  let ctx = deepCopy(context);\n  ctx['$value'] = value;\n  res = evaluateValidationConditions(validation, ctx);\n  if (validation.maxValue) {\n    const maxValue = evaluateValidationMaxValue(validation, value);\n    if (maxValue != null) {\n      res.push(maxValue);\n    }\n  }\n  if (validation.minValue) {\n    const minValue = evaluateValidationMinValue(validation, value);\n    if (minValue != null) {\n      res.push(minValue);\n    }\n  }\n  if (validation.notEmpty) {\n    const notEmpty = evaluateValidationNotEmpty(validation, value);\n    if (notEmpty != null) {\n      res.push(notEmpty);\n    }\n  }\n  if (validation.maxDigits) {\n    const maxDigits = evaluateValidationMaxDigits(validation, value);\n    if (maxDigits != null) {\n      res.push(maxDigits);\n    }\n  }\n  if (validation.minDigits) {\n    const minDigits = evaluateValidationMinDigits(validation, value);\n    if (minDigits != null) {\n      res.push(minDigits);\n    }\n  }\n  return res;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext, evaluateExpression} from '@ajf/core/models';\n\nimport {AjfFieldInstance} from '../../interface/fields-instances/field-instance';\nimport {AjfValidationResult} from '../../interface/validation/validation-results';\nimport {nodeInstanceCompleteName} from '../nodes-instances/node-instance-complete-name';\nimport {evaluateValidationGroup} from '../validation/evaluate-validation-group';\n\nexport function updateValidation(\n    instance: AjfFieldInstance, context: AjfContext, supplementaryInformations?: any): void {\n  const validation = instance.validation;\n  if (validation == null) {\n    instance.valid = true;\n    return;\n  }\n\n  if (supplementaryInformations) {\n    Object.keys(supplementaryInformations).forEach((key) => {\n      context[`__supplementary__${key}__`] = supplementaryInformations[key];\n    });\n  }\n\n  const completeName = nodeInstanceCompleteName(instance);\n\n  if (context[completeName] != null && validation && validation.forceValue) {\n    instance.value = evaluateExpression(validation.forceValue.condition, context);\n    context[completeName] = instance.value;\n    context.$value = instance.value;\n  }\n\n  instance.validationResults = evaluateValidationGroup(validation, context[completeName], context);\n  instance.valid = instance.validationResults.reduce(\n      (prev: boolean, x: AjfValidationResult) => prev && x.result, true);\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext, evaluateExpression} from '@ajf/core/models';\n\nimport {AjfWarning} from '../../interface/warning/warning';\nimport {AjfWarningResult} from '../../interface/warning/warning-result';\n\nexport function evaluateWarning(\n    warning: AjfWarning, context?: AjfContext, forceFormula?: string): AjfWarningResult {\n  return {\n    result: evaluateExpression(warning.condition, context, forceFormula),\n    warning: warning.warningMessage,\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '@ajf/core/models';\n\nimport {AjfWarningGroup} from '../../interface/warning/warning-group';\nimport {AjfWarningResult} from '../../interface/warning/warning-result';\nimport {evaluateWarning} from './evaluate-warning';\n\nexport function evaluateWarningConditions(\n    warning: AjfWarningGroup, context?: AjfContext): AjfWarningResult[] {\n  return warning.conditions.map(cond => evaluateWarning(cond, context));\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '@ajf/core/models';\n\nimport {AjfWarningGroup} from '../../interface/warning/warning-group';\nimport {AjfWarningResult} from '../../interface/warning/warning-result';\nimport {evaluateWarningConditions} from './evaluate-warning-conditions';\n\nexport function evaluateWarningGroup(\n    warning: AjfWarningGroup, context?: AjfContext): AjfWarningResult[] {\n  return evaluateWarningConditions(warning, context);\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '@ajf/core/models';\n\nimport {AjfFieldInstance} from '../../interface/fields-instances/field-instance';\nimport {nodeInstanceCompleteName} from '../nodes-instances/node-instance-complete-name';\nimport {evaluateWarningGroup} from '../warning/evaluate-warning-group';\n\nexport function updateWarning(instance: AjfFieldInstance, context: AjfContext): void {\n  const warning = instance.warning;\n  if (warning == null) {\n    return;\n  }\n\n  const completeName = nodeInstanceCompleteName(instance);\n\n  if (context[completeName] != null && warning) {\n    instance.warningResults = evaluateWarningGroup(warning, context);\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '@ajf/core/models';\n\nimport {AjfFieldInstance} from '../../interface/fields-instances/field-instance';\nimport {AjfFormulaFieldInstance} from '../../interface/fields-instances/formula-field-instance';\nimport {updateConditionalBranches} from '../nodes-instances/update-conditional-branches';\nimport {updateVisibility} from '../nodes-instances/update-visibility';\nimport {updateFormula} from './update-formula';\nimport {updateNextSlideCondition} from './update-next-slide-condition';\nimport {updateValidation} from './update-validation';\nimport {updateWarning} from './update-warning';\n\nexport function updateFieldInstanceState(\n    instance: AjfFieldInstance, context: AjfContext, branchVisibility = true): void {\n  updateVisibility(instance, context, branchVisibility);\n  updateConditionalBranches(instance, context);\n  updateFormula(instance as AjfFormulaFieldInstance, context);\n  updateValidation(instance, context);\n  updateWarning(instance, context);\n  updateNextSlideCondition(instance, context);\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext, evaluateExpression} from '@ajf/core/models';\n\nimport {\n  AjfFieldWithChoicesInstance\n} from '../../interface/fields-instances/field-with-choices-instance';\n\nexport function updateFilteredChoices(\n    instance: AjfFieldWithChoicesInstance<any>, context: AjfContext): void {\n  if (instance.choicesFilter != null) {\n    instance.filteredChoices = instance.node.choicesOrigin.choices.filter(c => {\n      context.$choice = c;\n      context.$choiceValue = c.value;\n      return evaluateExpression(instance.choicesFilter!.formula, context);\n    });\n  } else {\n    instance.filteredChoices = instance.node.choicesOrigin.choices;\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext, evaluateExpression} from '@ajf/core/models';\n\nimport {\n  AjfFieldWithChoicesInstance\n} from '../../interface/fields-instances/field-with-choices-instance';\nimport {nodeInstanceCompleteName} from '../nodes-instances/node-instance-complete-name';\n\nexport function updateTriggerConditions(\n    instance: AjfFieldWithChoicesInstance<any>, context: AjfContext): boolean {\n  if (instance.triggerConditions == null) {\n    return false;\n  }\n  const completeName = nodeInstanceCompleteName(instance);\n  if (instance.firstTriggerConditionDone[completeName]) {\n    return false;\n  }\n  let found = false;\n  const conditionsNum = instance.triggerConditions.length;\n  for (let i = 0; i < conditionsNum; i++) {\n    if (evaluateExpression(instance.triggerConditions[i].condition, context)) {\n      found = true;\n      break;\n    }\n  }\n  instance.firstTriggerConditionDone[completeName] = found;\n  return found;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {alwaysCondition} from '@ajf/core/models';\n\nimport {AjfNode} from '../../interface/nodes/node';\n\nexport type AjfNodeCreate = Pick<AjfNode, 'nodeType'|'id'|'parent'|'name'>&Partial<AjfNode>;\n\nexport function createNode(node: AjfNodeCreate): AjfNode {\n  const conditionalBranches =\n      node.conditionalBranches != null && node.conditionalBranches.length > 0 ?\n      node.conditionalBranches :\n      [alwaysCondition()];\n  return {\n    ...node,\n    parentNode: node.parentNode != null ? node.parentNode : 0,\n    label: node.label || '',\n    visibility: node.visibility || alwaysCondition(),\n    conditionalBranches,\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfField} from '../../interface/fields/field';\nimport {AjfFieldType} from '../../interface/fields/field-type';\nimport {AjfNodeType} from '../../interface/nodes/node-type';\nimport {AjfNodeCreate, createNode} from '../nodes/create-node';\n\nexport type AjfFieldCreate =\n    Omit<AjfNodeCreate, 'nodeType'>&Pick<AjfField, 'fieldType'>&Partial<AjfField>;\n\nexport function createField(field: AjfFieldCreate): AjfField {\n  const node = createNode({...field, nodeType: AjfNodeType.AjfField});\n  const editable = field.editable != null ?\n      field.editable :\n      field.fieldType !== AjfFieldType.Formula && field.fieldType !== AjfFieldType.Table;\n  return {\n    ...node,\n    ...field,\n    nodeType: AjfNodeType.AjfField,\n    editable,\n    defaultValue: field.defaultValue != null ? field.defaultValue : null,\n    size: field.size || 'normal',\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfFieldComponentsMap} from '../../interface/fields/field-components-map';\n\nexport const componentsMap: AjfFieldComponentsMap = {};\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfField} from '../../interface/fields/field';\nimport {componentsMap} from './fields-map';\n\nexport function isCustomFieldWithChoices(field: AjfField): boolean {\n  return field.fieldType > 100 && componentsMap[field.fieldType] != null &&\n      componentsMap[field.fieldType].isFieldWithChoice === true;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNode} from '../../interface/nodes/node';\nimport {AjfNodeType} from '../../interface/nodes/node-type';\n\nexport function isSlidesNode(node: AjfNode): boolean {\n  return node != null &&\n      (node.nodeType === AjfNodeType.AjfRepeatingSlide || node.nodeType === AjfNodeType.AjfSlide);\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNode} from '../../interface/nodes/node';\nimport {AjfNodeType} from '../../interface/nodes/node-type';\nimport {isSlidesNode} from './is-slides-node';\n\nexport function isContainerNode(node: AjfNode): boolean {\n  return node != null && (node.nodeType === AjfNodeType.AjfNodeGroup || isSlidesNode(node));\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {isContainerNode} from '../nodes/is-container-node';\n\nexport function isContainerNodeInstance(nodeInstance: AjfNodeInstance): boolean {\n  return nodeInstance != null && nodeInstance.node != null && isContainerNode(nodeInstance.node);\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContainerNodeInstance} from '../../interface/nodes-instances/container-node-instance';\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\n\nimport {isContainerNodeInstance} from './is-container-node-instance';\nimport {isFieldInstance} from './is-field-instance';\n\nexport function flattenNodesInstances(\n    nodes: AjfNodeInstance[], includeGroups = false): AjfNodeInstance[] {\n  let flatNodes: AjfNodeInstance[] = [];\n  nodes.forEach((nodeInstance: AjfNodeInstance) => {\n    if (isFieldInstance(nodeInstance)) {\n      flatNodes.push(nodeInstance);\n    }\n    if (isContainerNodeInstance(nodeInstance)) {\n      if (includeGroups) {\n        flatNodes.push(nodeInstance);\n      }\n      flatNodes = flatNodes.concat(\n          flattenNodesInstances((nodeInstance as AjfContainerNodeInstance).nodes, includeGroups));\n    }\n  });\n  return flatNodes;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {isSlidesNode} from '../nodes/is-slides-node';\n\nexport function isSlidesInstance(nodeInstance: AjfNodeInstance): boolean {\n  return nodeInstance != null && nodeInstance.node != null && isSlidesNode(nodeInstance.node);\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {AjfSlideInstance} from '../../interface/slides-instances/slide-instance';\nimport {flattenNodesInstances} from './flatten-nodes-instances';\nimport {isSlidesInstance} from './is-slides-instance';\n\nexport function flattenNodesInstancesTree(nodes: AjfNodeInstance[]): AjfSlideInstance[] {\n  let flatTree: AjfSlideInstance[] = [];\n  nodes.forEach((nodeInstance: AjfNodeInstance) => {\n    if (isSlidesInstance(nodeInstance)) {\n      const ni = nodeInstance as AjfSlideInstance;\n      flatTree.push(ni);\n      ni.flatNodes = flattenNodesInstances(ni.nodes);\n    }\n  });\n  return flatTree;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNode} from '../../interface/nodes/node';\nimport {AjfNodeType} from '../../interface/nodes/node-type';\n\nexport function isNodeGroup(node: AjfNode): boolean {\n  return node != null && node.nodeType === AjfNodeType.AjfNodeGroup;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {isNodeGroup} from '../nodes/is-node-group';\n\nexport function isNodeGroupInstance(nodeInstance: AjfNodeInstance): boolean {\n  return nodeInstance != null && nodeInstance.node != null && isNodeGroup(nodeInstance.node);\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNode} from '../../interface/nodes/node';\nimport {AjfNodeType} from '../../interface/nodes/node-type';\n\nexport function isSlideNode(node: AjfNode): boolean {\n  return node != null && node.nodeType === AjfNodeType.AjfSlide;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {isSlideNode} from '../nodes/is-slide-node';\n\nexport function isSlideInstance(nodeInstance: AjfNodeInstance): boolean {\n  return nodeInstance != null && nodeInstance.node != null && isSlideNode(nodeInstance.node);\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {EventEmitter} from '@angular/core';\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\n\nexport type AjfNodeInstanceCreate = Pick<AjfNodeInstance, 'node'>&Partial<AjfNodeInstance>;\n\nexport function createNodeInstance(instance: AjfNodeInstanceCreate): AjfNodeInstance {\n  return {\n    node: instance.node,\n    prefix: instance.prefix ? [...instance.prefix] : [],\n    visible: instance.visible != null ? instance.visible : true,\n    conditionalBranches: [],\n    updatedEvt: new EventEmitter<void>()\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '@ajf/core/models';\nimport {EventEmitter} from '@angular/core';\n\nimport {AjfFieldInstance} from '../../interface/fields-instances/field-instance';\nimport {AjfNodeInstanceCreate, createNodeInstance} from '../nodes-instances/create-node-instance';\nimport {nodeInstanceCompleteName} from '../nodes-instances/node-instance-complete-name';\n\nexport type AjfFieldInstanceCreate = AjfNodeInstanceCreate&Partial<AjfFieldInstance>;\n\nexport function createFieldInstance(\n    instance: AjfFieldInstanceCreate, context: AjfContext): AjfFieldInstance {\n  const nodeInstance = createNodeInstance(instance);\n  let value: any = null;\n  if (nodeInstance.node != null && context != null) {\n    const completeName = nodeInstanceCompleteName(nodeInstance);\n    if (context[nodeInstance.node.name] != null) {\n      value = context[nodeInstance.node.name];\n    } else if (context[completeName] != null) {\n      value = context[completeName];\n    } else if (instance.node.defaultValue != null) {\n      context[completeName] = instance.node.defaultValue;\n      value = context[completeName];\n    }\n  }\n  return {\n    ...nodeInstance,\n    node: instance.node,\n    value,\n    valid: false,\n    validationResults: instance.validationResults || [],\n    warningResults: instance.warningResults || [],\n    warningTrigger: new EventEmitter<void>(),\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '@ajf/core/models';\nimport {EventEmitter} from '@angular/core';\n\nimport {\n  AjfFieldWithChoicesInstance\n} from '../../interface/fields-instances/field-with-choices-instance';\nimport {AjfFieldInstanceCreate, createFieldInstance} from './create-field-instance';\n\nexport type AjfFieldWithChoicesInstanceCreate<T> =\n    AjfFieldInstanceCreate&Partial<AjfFieldWithChoicesInstance<T>>;\n\nexport function createFieldWithChoicesInstance<T>(\n    instance: AjfFieldWithChoicesInstanceCreate<T>,\n    context: AjfContext): AjfFieldWithChoicesInstance<T> {\n  const fieldInstance = createFieldInstance(instance, context);\n  return {\n    ...fieldInstance,\n    node: instance.node,\n    filteredChoices: [...instance.node.choices],\n    firstTriggerConditionDone: {},\n    selectionTrigger: new EventEmitter<void>(),\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '@ajf/core/models';\n\nimport {AjfTableFieldInstance} from '../../interface/fields-instances/table-field-instance';\nimport {AjfTableCell, AjfTableField} from '../../interface/fields/table-field';\n\nimport {AjfFieldInstanceCreate, createFieldInstance} from './create-field-instance';\n\nexport type AjfTableFieldInstanceCreate = AjfFieldInstanceCreate&Partial<AjfTableFieldInstance>;\n/**\n * to mantain retrocompatibility with old string type convert string to AjfTableCell\n * check  node.rows: (string|AjfTableCell)[][];\n * if elem of map is string convert in to AjfTableCell object\n */\nfunction normalizeRows(node: AjfTableField): void {\n  node.rows.forEach((row, rowIdx) => {\n    row.forEach((elem, elemIdx) => {\n      if (typeof elem === 'string') {\n        node.rows[rowIdx][elemIdx] = {formula: elem, editable: node.editable} as AjfTableCell;\n      }\n    });\n  });\n}\n\nexport function createTableFieldInstance(\n    instance: AjfTableFieldInstanceCreate, context: AjfContext): AjfTableFieldInstance {\n  normalizeRows(instance.node as AjfTableField);\n  const fieldInstance = createFieldInstance(instance, context);\n  return {\n    ...fieldInstance,\n    node: instance.node,\n    context,\n    hideEmptyRows: instance.hideEmptyRows || false,\n    controls: []\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeGroupInstance} from '../../interface/nodes-instances/node-group-instance';\nimport {AjfNodeInstanceCreate, createNodeInstance} from './create-node-instance';\n\nexport type AjfNodeGroupInstanceCreate = AjfNodeInstanceCreate&Partial<AjfNodeGroupInstance>;\n\nexport function createNodeGroupInstance(instance: AjfNodeGroupInstanceCreate):\n    AjfNodeGroupInstance {\n  const nodeInstance = createNodeInstance(instance);\n  return {\n    ...nodeInstance,\n    node: instance.node,\n    formulaReps: instance.formulaReps,\n    reps: 0,\n    nodes: [],\n    flatNodes: [],\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfSlideInstance} from '../../interface/slides-instances/slide-instance';\nimport {createNodeInstance} from '../nodes-instances/create-node-instance';\nimport {AjfBaseSlideInstanceCreate} from './base';\n\nexport type AjfSlideInstanceCreate = AjfBaseSlideInstanceCreate&Partial<AjfSlideInstance>;\n\nexport function createSlideInstance(instance: AjfSlideInstanceCreate): AjfSlideInstance {\n  const nodeInstance = createNodeInstance(instance);\n  return {\n    ...nodeInstance,\n    node: instance.node,\n    nodes: [],\n    slideNodes: [],\n    flatNodes: [],\n    valid: false,\n    position: 0,\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeType} from '../../interface/nodes/node-type';\nimport {AjfRepeatingSlideInstance} from '../../interface/slides-instances/repeating-slide-instance';\nimport {AjfSlideInstanceCreate, createSlideInstance} from './create-slide-instance';\n\nexport type AjfRepeatingSlideInstanceCreate = Omit<AjfSlideInstanceCreate, 'node'>&\n    Pick<AjfRepeatingSlideInstance, 'node'>&Partial<AjfRepeatingSlideInstance>;\n\nexport function createRepeatingSlideInstance(instance: AjfRepeatingSlideInstanceCreate):\n    AjfRepeatingSlideInstance {\n  const {node, ...slideInstanceCreate} = instance;\n  const {nodeType, ...slideNode} = node;\n  const slideInstance = createSlideInstance(\n      {...slideInstanceCreate, node: {nodeType: AjfNodeType.AjfSlide, ...slideNode}});\n  return {\n    ...slideInstance,\n    node: instance.node,\n    slideNodes: [],\n    formulaReps: instance.formulaReps,\n    reps: 0,\n    nodes: [],\n    flatNodes: [],\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfValidationGroup} from '../../interface/validation/validation-group';\n\nexport function createValidationGroup(group: Partial<AjfValidationGroup>): AjfValidationGroup {\n  return {...group, conditions: group.conditions || []};\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfWarningGroup} from '../../interface/warning/warning-group';\n\nexport function createWarningGroup(group: Partial<AjfWarningGroup>): AjfWarningGroup {\n  return {...group, conditions: group.conditions || []};\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNode} from '../../interface/nodes/node';\nimport {AjfNodeType} from '../../interface/nodes/node-type';\n\nexport function isRepeatingContainerNode(node: AjfNode): boolean {\n  return node != null &&\n      (node.nodeType === AjfNodeType.AjfNodeGroup ||\n       node.nodeType === AjfNodeType.AjfRepeatingSlide);\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {AjfNode} from '../../interface/nodes/node';\nimport {isRepeatingContainerNode} from '../nodes/is-repeating-container-node';\n\nexport function getAncestorRepeatingNodes(\n    allNodes: (AjfNode|AjfNodeInstance)[], node: AjfNode): AjfNode[] {\n  let nodeGroups: AjfNode[] = [];\n  let curParent: number|null = node.parent;\n  while (curParent != null) {\n    const curNode =\n        allNodes.map((n: AjfNode|AjfNodeInstance) => (n as AjfNodeInstance).node || n as AjfNode)\n            .find(n => n.id == curParent);\n    if (curNode) {\n      if (isRepeatingContainerNode(curNode)) {\n        nodeGroups.push(curNode);\n      }\n    }\n    curParent = curNode != null ? curNode.parent : null;\n  }\n  return nodeGroups;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {AjfNode} from '../../interface/nodes/node';\nimport {AjfNodeGroup} from '../../interface/nodes/node-group';\nimport {isField} from '../nodes/is-field';\n\nimport {getAncestorRepeatingNodes} from './get-ancestor-repeating-nodes';\n\nexport function getAncestorRepeatingNodesNames(\n    allNodes: (AjfNode|AjfNodeInstance)[], node: AjfNode): {[prop: string]: number} {\n  let names: {[prop: string]: number} = {};\n  const nodeGroups = getAncestorRepeatingNodes(allNodes, node) as AjfNodeGroup[];\n  nodeGroups.forEach((n, idx) => (n.nodes || []).forEach((sn) => {\n    if (isField(sn)) {\n      names[sn.name] = idx;\n    }\n  }));\n  return names;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfCondition, normalizeExpression} from '@ajf/core/models';\n\nexport function getInstanceCondition(\n    condition: AjfCondition, ancestorsNames: {[prop: string]: number},\n    prefix: number[]): AjfCondition {\n  const oldCondition = condition.condition;\n  let newCondition = normalizeExpression(oldCondition, ancestorsNames, prefix);\n  if (newCondition === oldCondition) {\n    return condition;\n  }\n  return {condition: newCondition};\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfCondition} from '@ajf/core/models';\n\nimport {getInstanceCondition} from './get-instance-condition';\n\nexport function getInstanceConditions(\n    conditions: AjfCondition[], ancestorsNames: {[prop: string]: number},\n    prefix: number[]): AjfCondition[] {\n  let changed = false;\n  const newConditions = conditions.map((condition) => {\n    const newCondition = getInstanceCondition(condition, ancestorsNames, prefix);\n    if (newCondition !== condition) {\n      changed = true;\n    }\n    return newCondition;\n  });\n  return changed ? newConditions : conditions;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfFormula, normalizeExpression} from '@ajf/core/models';\n\nexport function getInstanceFormula(\n    formula: AjfFormula, ancestorsNames: {[prop: string]: number}, prefix: number[]): AjfFormula {\n  const oldFormula = formula.formula;\n  let newFormula = normalizeExpression(oldFormula, ancestorsNames, prefix);\n  if (newFormula === oldFormula) {\n    return formula;\n  }\n  return {formula: newFormula};\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfValidation} from '../../interface/validation/validation';\n\nexport function createValidation(validation: Pick<AjfValidation, 'condition'>&\n                                 Partial<AjfValidation>): AjfValidation {\n  return {\n    ...validation,\n    clientValidation: validation.clientValidation || false,\n    errorMessage: validation.errorMessage || 'Undefined Error'\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {normalizeExpression} from '@ajf/core/models';\n\nimport {AjfValidation} from '../../interface/validation/validation';\nimport {createValidation} from '../validation/create-validation';\n\nexport function getInstanceValidation(\n    validation: AjfValidation, ancestorsNames: {[prop: string]: number},\n    prefix: number[]): AjfValidation {\n  const oldValidation = validation.condition;\n  let newValidation = normalizeExpression(oldValidation, ancestorsNames, prefix);\n  if (newValidation === oldValidation) {\n    return validation;\n  }\n  return createValidation({condition: newValidation});\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfValidation} from '../../interface/validation/validation';\nimport {getInstanceValidation} from './get-instance-validation';\n\nexport function getInstanceValidations(\n    validations: AjfValidation[], ancestorsNames: {[prop: string]: number},\n    prefix: number[]): AjfValidation[] {\n  let changed = false;\n  const newValidations = validations.map((validation) => {\n    const newValidation = getInstanceValidation(validation, ancestorsNames, prefix);\n    if (newValidation !== validation) {\n      changed = true;\n    }\n    return newValidation;\n  });\n  return changed ? newValidations : validations;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfWarning} from '../../interface/warning/warning';\n\nexport function createWarning(warning: Pick<AjfWarning, 'condition'>&\n                              Partial<AjfWarning>): AjfWarning {\n  return {...warning, warningMessage: warning.warningMessage || 'Undefined Warning'};\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {normalizeExpression} from '@ajf/core/models';\n\nimport {AjfWarning} from '../../interface/warning/warning';\nimport {createWarning} from '../warning/create-warning';\n\nexport function getInstanceWarning(\n    warning: AjfWarning, ancestorsNames: {[prop: string]: number}, prefix: number[]): AjfWarning {\n  const oldWarning = warning.condition;\n  let newWarning = normalizeExpression(oldWarning, ancestorsNames, prefix);\n  if (newWarning === oldWarning) {\n    return warning;\n  }\n  return createWarning({condition: newWarning});\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfWarning} from '../../interface/warning/warning';\nimport {getInstanceWarning} from './get-instance-warning';\n\nexport function getInstanceWarnings(\n    warnings: AjfWarning[], ancestorsNames: {[prop: string]: number},\n    prefix: number[]): AjfWarning[] {\n  let changed = false;\n  const newWarnings = warnings.map((warning) => {\n    const newWarning = getInstanceWarning(warning, ancestorsNames, prefix);\n    if (newWarning !== warning) {\n      changed = true;\n    }\n    return newWarning;\n  });\n  return changed ? newWarnings : warnings;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNode} from '../../interface/nodes/node';\nimport {AjfNodeType} from '../../interface/nodes/node-type';\n\nexport function isRepeatingSlide(node: AjfNode): boolean {\n  return node != null && node.nodeType === AjfNodeType.AjfRepeatingSlide;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {isSlidesInstance} from '../nodes-instances/is-slides-instance';\nimport {isRepeatingSlide} from '../nodes/is-repeating-slide';\n\nexport function isRepeatingSlideInstance(nodeInstance: AjfNodeInstance): boolean {\n  return nodeInstance != null && nodeInstance.node != null && isSlidesInstance(nodeInstance) &&\n      isRepeatingSlide(nodeInstance.node);\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {\n  AjfContext,\n  alwaysCondition,\n  createCondition,\n  createFormula,\n  normalizeExpression\n} from '@ajf/core/models';\n\nimport {AjfFieldInstance} from '../../interface/fields-instances/field-instance';\nimport {\n  AjfFieldWithChoicesInstance\n} from '../../interface/fields-instances/field-with-choices-instance';\nimport {AjfField} from '../../interface/fields/field';\nimport {AjfFieldType} from '../../interface/fields/field-type';\nimport {AjfFieldWithChoices} from '../../interface/fields/field-with-choices';\nimport {AjfTableField} from '../../interface/fields/table-field';\nimport {AjfNodeGroupInstance} from '../../interface/nodes-instances/node-group-instance';\nimport {AjfNodeInstance} from '../../interface/nodes-instances/node-instance';\nimport {\n  AjfRepeatingContainerNodeInstance\n} from '../../interface/nodes-instances/repeating-container-node-instance';\nimport {AjfNode} from '../../interface/nodes/node';\nimport {AjfNodeGroup} from '../../interface/nodes/node-group';\nimport {AjfNodeType} from '../../interface/nodes/node-type';\nimport {AjfRepeatingSlideInstance} from '../../interface/slides-instances/repeating-slide-instance';\nimport {AjfRepeatingSlide} from '../../interface/slides/repeating-slide';\nimport {AjfSlide} from '../../interface/slides/slide';\nimport {createFieldInstance} from '../fields-instances/create-field-instance';\nimport {\n  createFieldWithChoicesInstance\n} from '../fields-instances/create-field-with-choices-instance';\nimport {createTableFieldInstance} from '../fields-instances/create-table-field-instance';\nimport {isFieldWithChoicesInstance} from '../fields-instances/is-field-with-choices-instance';\nimport {componentsMap} from '../fields/fields-map';\nimport {isFieldWithChoices} from '../fields/is-field-with-choices';\nimport {createNodeGroupInstance} from '../nodes-instances/create-node-group-instance';\nimport {createRepeatingSlideInstance} from '../slides-instances/create-repeating-slide-instance';\nimport {createSlideInstance} from '../slides-instances/create-slide-instance';\nimport {createValidationGroup} from '../validation/create-validation-group';\nimport {createWarningGroup} from '../warning/create-warning-group';\n\nimport {getAncestorRepeatingNodesNames} from './get-ancestor-repeating-nodes-names';\nimport {getInstanceCondition} from './get-instance-condition';\nimport {getInstanceConditions} from './get-instance-conditions';\nimport {getInstanceFormula} from './get-instance-formula';\nimport {getInstanceValidations} from './get-instance-validations';\nimport {getInstanceWarnings} from './get-instance-warnings';\nimport {isFieldInstance} from './is-field-instance';\nimport {isNodeGroupInstance} from './is-node-group-instance';\nimport {isRepeatingSlideInstance} from './is-repeating-slide-instance';\n\nexport function nodeToNodeInstance(\n    allNodes: AjfNode[]|AjfNodeInstance[], node: AjfNode, prefix: number[],\n    context: AjfContext): AjfNodeInstance|null {\n  let instance: AjfNodeInstance|null = null;\n  const nodeType = node.nodeType;\n  switch (nodeType) {\n    case AjfNodeType.AjfField:\n      const field = node as AjfField;\n      if (field.fieldType > 100) {\n        if (componentsMap[field.fieldType] != null &&\n            componentsMap[field.fieldType].createInstance != null) {\n          instance = componentsMap[field.fieldType].createInstance!\n                     ({node: node as AjfField, prefix}, context);\n        } else {\n          instance = createFieldInstance({node: node as AjfField, prefix}, context);\n        }\n      } else {\n        switch (field.fieldType) {\n          case AjfFieldType.SingleChoice:\n          case AjfFieldType.MultipleChoice:\n            instance = createFieldWithChoicesInstance(\n                {node: node as AjfFieldWithChoices<any>, prefix}, context);\n            break;\n          case AjfFieldType.Table:\n            instance = createTableFieldInstance({node: node as AjfTableField, prefix}, context);\n            break;\n          default:\n            instance = createFieldInstance({node: node as AjfField, prefix}, context);\n            break;\n        }\n      }\n      break;\n    case AjfNodeType.AjfNodeGroup:\n      instance = createNodeGroupInstance({node: node as AjfNodeGroup, prefix});\n      break;\n    case AjfNodeType.AjfRepeatingSlide:\n      instance = createRepeatingSlideInstance({node: node as AjfRepeatingSlide, prefix});\n      break;\n    case AjfNodeType.AjfSlide:\n      instance = createSlideInstance({node: node as AjfSlide, prefix});\n      break;\n  }\n  if (instance != null) {\n    const hasPrefix = prefix != null && prefix.length > 0;\n    if (hasPrefix) {\n      const ancestorsNames = getAncestorRepeatingNodesNames(allNodes, node);\n\n      if (node.visibility != null) {\n        const oldVisibility = node.visibility.condition;\n        const newVisibility = normalizeExpression(oldVisibility, ancestorsNames, prefix);\n        instance.visibility = newVisibility !== oldVisibility ?\n            createCondition({condition: newVisibility}) :\n            node.visibility;\n      }\n\n      const conditionalBranches = instance.node.conditionalBranches != null &&\n              instance.node.conditionalBranches.length > 0 ?\n          instance.node.conditionalBranches :\n          [alwaysCondition()];\n      instance.conditionalBranches =\n          getInstanceConditions(conditionalBranches, ancestorsNames, prefix);\n\n      if (nodeType === AjfNodeType.AjfNodeGroup || nodeType === AjfNodeType.AjfRepeatingSlide) {\n        const ngInstance = instance as AjfNodeGroupInstance | AjfRepeatingSlideInstance;\n        const formulaReps = ngInstance.node.formulaReps;\n        if (formulaReps != null) {\n          const oldFormula = formulaReps.formula;\n          let newFormula = normalizeExpression(oldFormula, ancestorsNames, prefix);\n          ngInstance.formulaReps =\n              newFormula !== oldFormula ? createFormula({formula: newFormula}) : formulaReps;\n        }\n      } else if (nodeType === AjfNodeType.AjfField) {\n        const fInstance = instance as AjfFieldInstance;\n        const fNode = fInstance.node;\n\n        if (fNode.formula) {\n          fInstance.formula = getInstanceFormula(fNode.formula, ancestorsNames, prefix);\n        }\n\n        if (fNode.validation != null) {\n          const newConditions =\n              getInstanceValidations(fNode.validation.conditions, ancestorsNames, prefix);\n          if (newConditions !== fNode.validation.conditions) {\n            fInstance.validation = createValidationGroup(fNode.validation);\n            fInstance.validation.conditions = newConditions;\n          } else {\n            fInstance.validation = fNode.validation;\n          }\n        }\n\n        if (fNode.warning != null) {\n          const newWarnings = getInstanceWarnings(fNode.warning.conditions, ancestorsNames, prefix);\n          if (newWarnings !== fNode.warning.conditions) {\n            fInstance.warning = createWarningGroup(fNode.warning);\n            fInstance.warning.conditions = newWarnings;\n          } else {\n            fInstance.warning = fNode.warning;\n          }\n        }\n\n        if (fNode.nextSlideCondition != null) {\n          fInstance.nextSlideCondition =\n              getInstanceCondition(fNode.nextSlideCondition, ancestorsNames, prefix);\n        }\n\n        if (isFieldWithChoices(fNode)) {\n          const fwcInstance = instance as AjfFieldWithChoicesInstance<any>;\n          const fwcNode = fwcInstance.node;\n          if (fwcNode.choicesFilter != null) {\n            fwcInstance.choicesFilter =\n                getInstanceFormula(fwcNode.choicesFilter, ancestorsNames, prefix);\n          }\n          if (fwcNode.triggerConditions != null) {\n            fwcInstance.triggerConditions =\n                getInstanceConditions(fwcNode.triggerConditions, ancestorsNames, prefix);\n          }\n        }\n      }\n    } else {\n      instance.visibility = instance.node.visibility;\n      const conditionalBranches = instance.node.conditionalBranches != null &&\n              instance.node.conditionalBranches.length > 0 ?\n          instance.node.conditionalBranches :\n          [alwaysCondition()];\n      instance.conditionalBranches = conditionalBranches;\n      if (isNodeGroupInstance(instance) || isRepeatingSlideInstance(instance)) {\n        const rgInstance = instance as AjfRepeatingContainerNodeInstance;\n        rgInstance.formulaReps = rgInstance.node.formulaReps;\n      } else if (isFieldInstance(instance)) {\n        const fInstance = instance as AjfFieldInstance;\n        fInstance.validation = fInstance.node.validation;\n        fInstance.warning = fInstance.node.warning;\n        fInstance.nextSlideCondition = fInstance.node.nextSlideCondition;\n        if (isFieldWithChoicesInstance(instance)) {\n          const fwcInstance = instance as AjfFieldWithChoicesInstance<any>;\n          fwcInstance.choicesFilter = fwcInstance.node.choicesFilter;\n          fwcInstance.triggerConditions = fwcInstance.node.triggerConditions;\n        }\n        fInstance.formula = fInstance.node.formula;\n      }\n    }\n  }\n  return instance;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContainerNode} from '../../interface/nodes/container-node';\nimport {AjfNode} from '../../interface/nodes/node';\nimport {isContainerNode} from './is-container-node';\n\nexport function flattenNodes(nodes: AjfNode[]): AjfNode[] {\n  let flatNodes: AjfNode[] = [];\n  nodes.forEach((node: AjfNode) => {\n    flatNodes.push(node);\n    if (isContainerNode(node)) {\n      flatNodes = flatNodes.concat(flattenNodes((node as AjfContainerNode).nodes));\n    }\n  });\n  return flatNodes;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNode} from '../../interface/nodes/node';\n\nexport function orderedNodes(nodes: AjfNode[], parent: number|null): AjfNode[] {\n  let newNodes: AjfNode[] = [];\n  nodes\n      .filter(\n          (n: AjfNode) => parent != null ? n.parent == parent : n.parent == null || n.parent === 0)\n      .sort((n1: AjfNode, n2: AjfNode) => n1.parentNode - n2.parentNode)\n      .forEach((n: AjfNode) => {\n        newNodes.push(n);\n        newNodes = newNodes.concat(orderedNodes(nodes, n.id));\n      });\n  return newNodes;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext, evaluateExpression} from '@ajf/core/models';\n\nimport {AjfRepeatingNodeInstance} from '../../interface/nodes-instances/repeating-node-instance';\nimport {nodeInstanceCompleteName} from '../nodes-instances/node-instance-complete-name';\n\nexport function updateRepsNum(instance: AjfRepeatingNodeInstance, context?: AjfContext): number {\n  const oldReps: number = instance.reps || 0;\n  context = context || {};\n  if (instance.node.formulaReps == null) {\n    const ctxReps = context[nodeInstanceCompleteName(instance)];\n    if (ctxReps != null) {\n      instance.reps = ctxReps;\n    } else if (oldReps == 0) {\n      instance.reps = 1;\n    }\n  } else {\n    let newReps = evaluateExpression(instance.node.formulaReps.formula, context);\n    if (newReps !== oldReps) {\n      instance.reps = newReps;\n    }\n  }\n  instance.canAdd = instance.node.maxReps === 0 || instance.reps < instance.node.maxReps;\n  instance.canRemove = instance.node.minReps === 0 || instance.reps > instance.node.minReps;\n  return oldReps;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfBaseSlideInstance} from '../../interface/slides-instances/base-slide-instance';\n\nexport function validSlide(slide: AjfBaseSlideInstance, idx: number): boolean {\n  if (idx >= slide.slideNodes.length) {\n    return true;\n  }\n  return slide.slideNodes[idx]\n      .map(n => {\n        if (n.visible && Object.keys(n).indexOf('valid') > -1) {\n          return (<any>n).valid;\n        }\n        return true;\n      })\n      .reduce((v1, v2) => v1 && v2, true);\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfExpressionUtils} from '@ajf/core/models';\nimport {Injectable} from '@angular/core';\n\n@Injectable()\nexport class AjfValidationService {\n  private _baseUtilFunctions: string[] = [\n    `/**\n        * count the number of digit contained on x.\n        * @param  x the value used for digit count\n        * @return the count of the digit\n      */\n    var digitCount = function(x) { return x.toString().length; }`,\n    `/**\n        * count the number of decimal contained on x.\n        * @param  x the value used for decimal count\n        * @return the count of the decimal\n      */\n    var decimalCount = function(x) {\n      return (parseFloat(x).toString().split('.')[1] || []).length;\n    }`,\n    `/**\n        * check if x is integer\n        * @param  x the value used for check\n        * @return true if x is a number\n      */\n    var isInt = function(x) { return !/[,.]/.test(x); }`,\n    `/**\n        * check if x is not empity\n        * @param  x the value used for check\n        * @return true if x defined and not null and the number of digit is > 0\n      */\n    var notEmpty = function (x) {\n      return (typeof x !== 'undefined' && x !== null ? x.toString().length > 0 : false);\n    }`,\n    `/**\n        * check if x is contained on array\n        * @param  x the value used for check\n        * @return the position of x on array or if array === x\n      */\n    var valueInChoice = function(array, x) { return array.indexOf(x) > -1 || array === x; }`,\n    `var scanGroupField = function(reps, acc, callback) {\n        for (var i = 0; i < reps; i++) {\n            acc = callback(acc, i);\n        }\n        return acc;\n    }`,\n    `/**\n        * sum the value contained on array\n        * @param  x the array\n        * @return the sum\n      */\n    var sum = function(array) {return array.reduce(function(a, b){ return a + b; }, 0); }`,\n    `var dateOperations = function(dString, period, operation, v) {\n        fmt = 'mm/dd/yyyy';\n        var d = (typeof dString !== 'undefined') ? dateUtils.parse(dString) : new Date();\n        if (operation == 'remove') {\n          v = -v;\n        }\n        var dateOp;\n        switch (period) {\n          case 'day':\n            dateOp = dateUtils.addDays;\n            break;\n          case 'month':\n            dateOp = dateUtils.addMonths;\n            break;\n          case 'year':\n            dateOp = dateUtils.addYears;\n            break;\n          default:\n            return -1;\n        }\n        return dateUtils.format(dateOp(d, v), fmt);\n      }`,\n    `/**\n        * round the num\n        * @param  num the value to round\n        * @param  digits how many digit\n        * @return num rounded\n      */\n      var round = function(num, digits) {\n        digits = digits || 0;\n        var f = 0;\n        try { f = parseFloat(num); } catch (e) { }\n        var m = Math.pow(10, digits);\n        return Math.round(f * m) / m;\n      }`,\n    `/**\n        * extract the property of the source object with property != null\n        * @param  source array of object wich contains property\n        * @param  property the property on wich we want filter\n        * @return array of dates\n      */\n      var extractArray = function(source, property, property2) {\n        source = (source || []).slice(0);\n        var l = source.length;\n        var res = [];\n        for (var i = 0; i < l ; i++) {\n          if (source[i][property] != null && source[i][property2] != null) {\n            res.push(source[i][property] + source[i][property2]);\n          }\n          else if (source[i][property] != null) {\n            res.push(source[i][property]);\n          }\n        }\n        return res;\n      }`,\n    `/**\n        * extract the property of the source object with property != null\n        * @param  source array of object wich contains property\n        * @param  propertues string array the properties to sum\n        * @return the sum\n      */\n      var extractSum = function(source, properties) {\n        var sum = 0;\n        properties = (properties || []).slice(0);\n        var l = properties.length;\n\n        for (var i = 0; i < l ; i++) {\n          var array = extractArray(source, properties[i]);\n          var leng = array.length;\n          for(var j = 0; j < leng; i++) {\n            sum += array[j];\n          }\n        }\n        return sum;\n      }`,\n    `/**\n        * extract the array of sum for each week != null\n        * @param  source array of object wich contains property\n        * @param  propertues string array the properties to sum\n        * @return the sum\n      */\n      var extractArraySum = function(source, properties) {\n        var arrays = [];\n        properties = (properties || []).slice(0);\n\n        for (var propI = 0; propI < properties.length ; propI++) {\n          var array = extractArray(source, properties[propI]);\n          arrays.push(array);\n        }\n\n        var res = [];\n        for (var weekI = 0; weekI < array.length; weekI ++ ) {\n          var sum = 0;\n          for (var propI = 0; propI < properties.length ; propI++) {\n            sum = sum + arrays[propI][weekI]\n          }\n          res.push(sum);\n        }\n        return res;\n      }`,\n    `/**\n        * draw a threshold line on chart related to the property\n        * @param  source array of object wich contains property\n        * @param  property the property on wich we want filter\n        * @return array of dates\n      */\n      var drawThreshold = function(source, property, threshold) {\n        source = (source || []).slice(0);\n        var l = source.length;\n        var res = [];\n        for (var i = 0; i < l ; i++) {\n          if (source[i][property] != null) {\n            res.push(threshold);\n          }\n        }\n        return res;\n      }`,\n    `/**\n        * extract the dates of the source object with property != null\n        * @param  source array of object wich contains property and date_start\n        * @param  property the property on wich we want to calculate dates\n        * @param  format the format of the date\n        * @return array of dates\n      */\n      var extractDates = function(source, property, format) {\n        source = (source || []).slice(0);\n        var l = source.length;\n        var res = [];\n        var prefix = '';\n        for (var i = 0; i < l ; i++) {\n          if (source[i][property] != null) {\n            switch(format) {\n              case \"WW\":\n                prefix = \"W\";\n                break;\n              case \"mm\":\n                prefix = \"M\";\n                break;\n              default:\n                prefix = \"\";\n            }\n            res.push(prefix + formatDate(source[i][\"date_start\"], format));\n          }\n        }\n        return res;\n      }`,\n    `/**\n        * extract the last property contains in source != null\n        * @param  source array of object wich contains property and date_start\n        * @param  property the property to find\n        * @return the last property != null\n      */\n      var lastProperty = function(source, property) {\n        source = (source || []).slice(0);\n        var l = source.length -1;\n\n        while (l >= 0 && source[l][property] == null) {\n          l--;\n          if (l < 0) return 0;\n        }\n        return l >= 0 ? source[l][property] : 0;\n      }`,\n    `var sumLastProperties = function(source, properties) {\n        source = (source || []).slice(0);\n        var sum = 0;\n        for (var i = 0; i < properties.length; i++) {\n          sum += lastProperty(source, properties[i]);\n        }\n\n        return sum;\n      }`,\n    `/**\n        * compute the trend of the property contained on the source.\n        * @param  source array of object wich contains property\n        * @param  property the property on wich we want to calculate the trend\n        * @return an html icon that identifies the trend\n      */\n      var calculateTrendProperty = function(source, property) {\n        source = (source || []).slice(0);\n        var last = source.length - 1;\n        while (source[last][property] == null) {\n          if (last == 0) {\n            break;\n          }\n          last--;\n        }\n        var lastLast = last - 1;\n        if (last == 0) {\n          lastLast = last;\n        } else {\n          while (source[lastLast][property] == null) {\n            if (lastLast == 0) {\n              lastLast = last;\n              break;\n            }\n            lastLast--;\n          }\n        }\n\n        var lastProperty = source[last]?(source[last][property] || 0): 0;\n        var lastLastProperty = source[lastLast]?(source[lastLast][property] || 0): 0;\n\n        if (lastProperty == lastLastProperty) {\n          return '<p><i class=\"material-icons\" style=\"color:blue\">trending_flat</i></p>';\n        } else if (lastProperty > lastLastProperty) {\n          return '<p><i class=\"material-icons\" style=\"color:green\">trending_up</i></p>';\n        } else {\n          return '<p><i class=\"material-icons\" style=\"color:red\">trending_down</i></p>';\n        }\n      }`,\n    `/**\n        * compute the average value of the property contained on the source.\n        * @param  source array of object wich contains property\n        * @param  property the property on wich we want to calculate the average\n        * @param  range the range on wich we want to calculate the average\n        * @param  coefficent the coefficent used for calculate the threshold\n                  if coefficent is 0 mean return the count of property > 0\n        * @return the average value || the count of property > 0\n      */\n      var calculateAvgProperty = function(source, property, range, coefficient) {\n        source = (source || []).slice(0);\n\n        source.pop();\n\n        coefficient = coefficient || 1;\n        range = range || 12;\n\n        var l = source.length;\n        var res = 0;\n        var counter = 0;\n        var noZero = 0;\n\n        if(l < range) {\n          range = l;\n        }\n\n        while (range != 0) {\n          counter++;\n          if (source[l - 1][property] != null) {\n            res += source[l - 1][property];\n\n            if (source[l - 1][property] > 0) {\n              noZero++;\n            }\n          }\n          l--;\n          range--;\n        }\n\n        if (coefficient == 0) {\n          return noZero;\n        } else {\n          var threshold = (res/counter)*coefficient || 0;\n          return threshold;\n        }\n      }`,\n    `var alert = function(source, property, threshold, fmt) {\n        source = (source || []).slice(0);\n        var l = source.length;\n\n        if ( lastProperty(source, property)  > threshold ) {\n          return '<p><i class=\"material-icons\" style=\"color:red\">warning</i></p>';\n          } else {\n            return '<p></p>';\n          }\n      }`,\n    `var formatNumber = function(num, fmt) {\n        fmt = fmt || '0,0[.]0';\n        return numbro(num).format(fmt);\n      }`,\n    `var formatDate = function(date, fmt) {\n        fmt = fmt || 'mm-dd-yyyy';\n        return dateUtils.format(date, fmt);\n      }`,\n    `var isoMonth = function(date, fmt) {\n        fmt = fmt || 'mm';\n        var du = dateUtils;\n        return du.format(du.addDays(du.startOfMonth(date), 4),fmt)\n      }`,\n    `var nextCounterValue = function(counterName, firstValue) {\n        firstValue = firstValue != null ? firstValue : 0;\n        if (execContext['$$'+counterName] == null) {\n          execContext['$$'+counterName] = firstValue;\n        } else {\n          execContext['$$'+counterName]++;\n        }\n        return execContext['$$'+counterName];\n      }`,\n    `var getCoordinate = function(source, zoom) {\n        zoom = zoom || 6;\n        if(source == null) {\n          return [51.505,-0.09, zoom];\n        } else {\n          return [source[0], source[1], zoom];\n        }\n      }`\n  ];\n\n  private _functions: (Function|string)[] = [];\n  private _functionsStr: string = '';\n\n  constructor() {\n    this._initFunctions();\n  }\n\n  addFunction(f: Function|string): void {\n    this._functions.push(f);\n    this._initFunctions();\n  }\n\n  addFunctionHandler(name: string, fn: any): void {\n    if (AjfExpressionUtils.utils[name] === undefined) {\n      AjfExpressionUtils.utils[name] = {fn};\n    }\n  }\n\n  private _initFunctions(): void {\n    const functionsStr =\n        this._functions.map(f => typeof f === 'string' ? f : f.toString()).join('; ');\n    this._functionsStr = `${this._baseUtilFunctions.join('; ')}; ${functionsStr}`;\n    AjfExpressionUtils.UTIL_FUNCTIONS = this._functionsStr;\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfCondition, AjfContext} from '@ajf/core/models';\nimport {deepCopy} from '@ajf/core/utils';\nimport {EventEmitter, Injectable} from '@angular/core';\nimport {AbstractControl, FormControl, FormGroup} from '@angular/forms';\nimport {tokenize} from 'esprima';\nimport {\n  BehaviorSubject,\n  from,\n  Observable,\n  of as obsOf,\n  Subject,\n  Subscriber,\n  Subscription,\n  timer\n} from 'rxjs';\nimport {\n  debounceTime,\n  filter,\n  map,\n  pairwise,\n  publishReplay,\n  refCount,\n  scan,\n  share,\n  startWith,\n  switchMap,\n  withLatestFrom\n} from 'rxjs/operators';\n\nimport {AjfFieldInstance} from './interface/fields-instances/field-instance';\nimport {\n  AjfFieldWithChoicesInstance\n} from './interface/fields-instances/field-with-choices-instance';\nimport {AjfFormulaFieldInstance} from './interface/fields-instances/formula-field-instance';\nimport {AjfTableFieldInstance} from './interface/fields-instances/table-field-instance';\nimport {AjfEmptyField} from './interface/fields/empty-field';\nimport {AjfFieldType} from './interface/fields/field-type';\nimport {AjfTableCell} from './interface/fields/table-field';\nimport {AjfForm} from './interface/forms/form';\nimport {AjfTableFormControl} from './interface/forms/table-form-control';\nimport {AjfNodeGroupInstance} from './interface/nodes-instances/node-group-instance';\nimport {AjfNodeInstance} from './interface/nodes-instances/node-instance';\nimport {\n  AjfRepeatingContainerNodeInstance\n} from './interface/nodes-instances/repeating-container-node-instance';\nimport {AjfNode} from './interface/nodes/node';\nimport {AjfNodeGroup} from './interface/nodes/node-group';\nimport {AjfNodeType} from './interface/nodes/node-type';\nimport {AjfNodesInstancesOperation} from './interface/operations/nodes-instances-operation';\nimport {AjfRendererUpdateMapOperation} from './interface/operations/renderer-update-map-operation';\nimport {AjfRendererUpdateMap} from './interface/renderer-maps/update-map';\nimport {AjfBaseSlideInstance} from './interface/slides-instances/base-slide-instance';\nimport {AjfRepeatingSlideInstance} from './interface/slides-instances/repeating-slide-instance';\nimport {AjfSlideInstance} from './interface/slides-instances/slide-instance';\nimport {initChoicesOrigin} from './utils/choices/init-choices-origin';\nimport {isFieldWithChoicesInstance} from './utils/fields-instances/is-field-with-choices-instance';\nimport {isTableFieldInstance} from './utils/fields-instances/is-table-field-instance';\nimport {updateFieldInstanceState} from './utils/fields-instances/update-field-instance-state';\nimport {updateFilteredChoices} from './utils/fields-instances/update-filtered-choices';\nimport {updateFormula} from './utils/fields-instances/update-formula';\nimport {updateNextSlideCondition} from './utils/fields-instances/update-next-slide-condition';\nimport {updateTriggerConditions} from './utils/fields-instances/update-trigger-conditions';\nimport {updateValidation} from './utils/fields-instances/update-validation';\nimport {updateWarning} from './utils/fields-instances/update-warning';\nimport {createField} from './utils/fields/create-field';\nimport {isCustomFieldWithChoices} from './utils/fields/is-custom-field-with-choices';\nimport {isFieldWithChoices} from './utils/fields/is-field-with-choices';\nimport {flattenNodesInstances} from './utils/nodes-instances/flatten-nodes-instances';\nimport {flattenNodesInstancesTree} from './utils/nodes-instances/flatten-nodes-instances-tree';\nimport {isFieldInstance} from './utils/nodes-instances/is-field-instance';\nimport {isNodeGroupInstance} from './utils/nodes-instances/is-node-group-instance';\nimport {isSlideInstance} from './utils/nodes-instances/is-slide-instance';\nimport {isSlidesInstance} from './utils/nodes-instances/is-slides-instance';\nimport {nodeInstanceCompleteName} from './utils/nodes-instances/node-instance-complete-name';\nimport {nodeInstanceSuffix} from './utils/nodes-instances/node-instance-suffix';\nimport {nodeToNodeInstance} from './utils/nodes-instances/node-to-node-instance';\nimport {updateConditionalBranches} from './utils/nodes-instances/update-conditional-branches';\nimport {updateVisibility} from './utils/nodes-instances/update-visibility';\nimport {flattenNodes} from './utils/nodes/flatten-nodes';\nimport {isContainerNode} from './utils/nodes/is-container-node';\nimport {isRepeatingContainerNode} from './utils/nodes/is-repeating-container-node';\nimport {orderedNodes} from './utils/nodes/ordered-nodes';\nimport {updateRepsNum} from './utils/slides-instances/update-reps-num';\nimport {validSlide} from './utils/slides-instances/valid-slide';\nimport {AjfValidationService} from './validation-service';\n\nexport const enum AjfFormInitStatus {\n  Initializing,\n  Complete\n}\n\nconst updateSlideValidity = (slide: AjfRepeatingSlideInstance|AjfSlideInstance) => {\n  const subNodesNum = slide.flatNodes.length;\n  let valid = true;\n  for (let i = 0; i < subNodesNum; i++) {\n    const subNode = slide.flatNodes[i];\n    if (subNode.visible && isFieldInstance(subNode) && !(subNode as AjfFieldInstance).valid) {\n      valid = false;\n      break;\n    }\n  }\n  if (slide.valid !== valid) {\n    slide.valid = valid;\n  }\n};\n\n@Injectable()\nexport class AjfFormRendererService {\n  private _visibilityNodesMap: Observable<AjfRendererUpdateMap>;\n  private _visibilityNodesMapUpdates: Subject<AjfRendererUpdateMapOperation> =\n      new Subject<AjfRendererUpdateMapOperation>();\n\n  private _repetitionNodesMap: Observable<AjfRendererUpdateMap>;\n  private _repetitionNodesMapUpdates: Subject<AjfRendererUpdateMapOperation> =\n      new Subject<AjfRendererUpdateMapOperation>();\n\n  private _conditionalBranchNodesMap: Observable<AjfRendererUpdateMap>;\n  private _conditionalBranchNodesMapUpdates: Subject<AjfRendererUpdateMapOperation> =\n      new Subject<AjfRendererUpdateMapOperation>();\n\n  private _formulaNodesMap: Observable<AjfRendererUpdateMap>;\n  private _formulaNodesMapUpdates: Subject<AjfRendererUpdateMapOperation> =\n      new Subject<AjfRendererUpdateMapOperation>();\n\n  private _validationNodesMap: Observable<AjfRendererUpdateMap>;\n  private _validationNodesMapUpdates: Subject<AjfRendererUpdateMapOperation> =\n      new Subject<AjfRendererUpdateMapOperation>();\n\n  private _warningNodesMap: Observable<AjfRendererUpdateMap>;\n  private _warningNodesMapUpdates: Subject<AjfRendererUpdateMapOperation> =\n      new Subject<AjfRendererUpdateMapOperation>();\n\n  private _filteredChoicesNodesMap: Observable<AjfRendererUpdateMap>;\n  private _filteredChoicesNodesMapUpdates: Subject<AjfRendererUpdateMapOperation> =\n      new Subject<AjfRendererUpdateMapOperation>();\n\n  private _triggerConditionsNodesMap: Observable<AjfRendererUpdateMap>;\n  private _triggerConditionsNodesMapUpdates: Subject<AjfRendererUpdateMapOperation> =\n      new Subject<AjfRendererUpdateMapOperation>();\n\n  private _nextSlideConditionsNodesMap: Observable<AjfRendererUpdateMap>;\n  private _nextSlideConditionsNodesMapUpdates: Subject<AjfRendererUpdateMapOperation> =\n      new Subject<AjfRendererUpdateMapOperation>();\n\n  private _formInitEvent: EventEmitter<AjfFormInitStatus> = new EventEmitter<AjfFormInitStatus>();\n  readonly formInitEvent: Observable<AjfFormInitStatus> =\n      this._formInitEvent as Observable<AjfFormInitStatus>;\n\n  private _formGroup: BehaviorSubject<FormGroup|null> = new BehaviorSubject<FormGroup|null>(null);\n  readonly formGroup: Observable<FormGroup|null> = this._formGroup as Observable<FormGroup|null>;\n\n  private _form: BehaviorSubject<{form: AjfForm | null, context?: AjfContext}|null> =\n      new BehaviorSubject<{form: AjfForm | null, context?: AjfContext}|null>(null);\n  private _nodes: Observable<AjfNodeInstance[]>;\n  private _flatNodes: Observable<AjfNodeInstance[]>;\n  private _flatNodesTree: Observable<AjfSlideInstance[]>;\n  private _nodesUpdates: Subject<AjfNodesInstancesOperation> =\n      new Subject<AjfNodesInstancesOperation>();\n  private _errorPositions: Observable<number[]>;\n  private _errors: Observable<number>;\n\n  private _formGroupSubscription: Subscription = Subscription.EMPTY;\n  private _valueChanged: Subject<void> = new Subject<void>();\n\n  private _nodesMaps: Observable<AjfRendererUpdateMap>[];\n\n  private _nextSlideTrigger: EventEmitter<AjfNodeInstance> = new EventEmitter<AjfNodeInstance>();\n  readonly nextSlideTrigger: Observable<AjfNodeInstance> =\n      this._nextSlideTrigger as Observable<AjfNodeInstance>;\n\n  private _slidesNum: BehaviorSubject<number> = new BehaviorSubject<number>(0);\n  readonly slidesNum: Observable<number> = this._slidesNum as Observable<number>;\n\n  get nodesTree(): Observable<AjfSlideInstance[]> {\n    return this._flatNodesTree;\n  }\n  get errorPositions(): Observable<number[]> {\n    return this._errorPositions;\n  }\n  get errors(): Observable<number> {\n    return this._errors;\n  }\n  get currentSupplementaryInformations(): any {\n    const form = this._form.getValue();\n    return form != null && form.form != null ? form.form.supplementaryInformations : null;\n  }\n\n  constructor(_: AjfValidationService) {\n    this._initUpdateMapStreams();\n    this._initNodesStreams();\n    this._initErrorsStreams();\n    this._initFormStreams();\n    this._updateFormValueAndValidity();\n  }\n\n  setForm(form: AjfForm|null, context: AjfContext = {}) {\n    this._initUpdateMapStreams();\n    if (form != null && Object.keys(context).length === 0 &&\n        Object.keys(form.initContext || {}).length > 0) {\n      context = form.initContext || {};\n    }\n    const currentForm = this._form.getValue();\n    if ((currentForm == null && form != null) ||\n        (currentForm != null && form !== currentForm.form)) {\n      this._form.next({form: form, context: context});\n    }\n  }\n\n  getFormValue(): any {\n    const formGroup = this._formGroup.getValue();\n    if (formGroup == null) {\n      return {};\n    }\n    let res = deepCopy(formGroup.value);\n    return res;\n  }\n\n  addGroup(group: AjfNodeGroupInstance|AjfRepeatingSlideInstance): Observable<boolean> {\n    return new Observable<boolean>((subscriber: Subscriber<boolean>) => {\n      if (group.formulaReps != null) {\n        subscriber.next(false);\n        subscriber.complete();\n        return;\n      }\n      const maxReps = group.node.maxReps;\n      if (maxReps > 0 && group.reps + 1 > maxReps) {\n        subscriber.next(false);\n        subscriber.complete();\n        return;\n      }\n      const oldReps = group.reps;\n      group.reps = group.reps + 1;\n      group.canAdd = group.node.maxReps === 0 || group.reps < group.node.maxReps;\n      group.canRemove = group.node.minReps === 0 || group.reps > group.node.minReps;\n      this._nodesUpdates.next((nodes: AjfNodeInstance[]): AjfNodeInstance[] => {\n        const flatNodes = flattenNodesInstances(nodes, true);\n        this._adjustReps(flatNodes, group, oldReps, this.getFormValue());\n        subscriber.next(true);\n        subscriber.complete();\n        return nodes;\n      });\n    });\n  }\n\n  removeGroup(group: AjfNodeGroupInstance|AjfRepeatingSlideInstance): Observable<boolean> {\n    return new Observable<boolean>((subscriber: Subscriber<boolean>) => {\n      if (group.formulaReps != null) {\n        subscriber.next(false);\n        subscriber.complete();\n        return;\n      }\n      const minReps = group.node.minReps;\n      if (group.reps - 1 < minReps) {\n        subscriber.next(false);\n        subscriber.complete();\n        return;\n      }\n      const oldReps = group.reps;\n      group.reps = group.reps - 1;\n      group.canAdd = group.node.maxReps === 0 || group.reps < group.node.maxReps;\n      group.canRemove = group.node.minReps === 0 || group.reps > group.node.minReps;\n      this._nodesUpdates.next((nodes: AjfNodeInstance[]): AjfNodeInstance[] => {\n        this._adjustReps(nodes, group, oldReps, this.getFormValue());\n        subscriber.next(true);\n        subscriber.complete();\n        return nodes;\n      });\n    });\n  }\n\n  getControl(field: AjfFieldInstance): Observable<AbstractControl|null> {\n    return this.formGroup.pipe(map((f) => {\n      const fieldName = nodeInstanceCompleteName(field);\n      return f != null && f.contains(fieldName) ? f.controls[fieldName] : null;\n    }));\n  }\n\n  private _initErrorsStreams(): void {\n    this._errorPositions = this._valueChanged.pipe(\n        withLatestFrom(this._nodes, this._form),\n        filter(\n            ([_, __, form]) => form != null &&\n                (form as {form: AjfForm | null, context?: AjfContext}).form != null),\n        map(([_, nodes, formDef]) => {\n          const form = (formDef as {form: AjfForm | null, context?: AjfContext}).form as AjfForm;\n          let currentPosition = 0;\n          const errors: number[] = [];\n          (nodes as AjfNodeInstance[]).forEach((node) => {\n            if (node.node.nodeType === AjfNodeType.AjfRepeatingSlide) {\n              const rsNode = node as AjfRepeatingSlideInstance;\n              for (let i = 0; i < rsNode.reps; i++) {\n                if (node.visible) {\n                  currentPosition++;\n                  if (i == 0) {\n                    rsNode.position = currentPosition;\n                  }\n                  if (!validSlide(rsNode, i)) {\n                    errors.push(currentPosition);\n                  }\n                }\n              }\n            } else if (node.node.nodeType === AjfNodeType.AjfSlide) {\n              const sNode = node as AjfSlideInstance;\n              if (sNode.visible) {\n                currentPosition++;\n                sNode.position = currentPosition;\n                if (!sNode.valid) {\n                  errors.push(currentPosition);\n                }\n              }\n            }\n          });\n          form.valid = errors.length == 0;\n          this._slidesNum.next(currentPosition);\n          return errors;\n        }),\n        publishReplay(),\n        refCount(),\n    );\n    this._errors = this._errorPositions.pipe(\n        map(e => e != null ? e.length : 0),\n        startWith(0),\n        publishReplay(),\n        refCount(),\n    );\n  }\n\n  private _initUpdateMapStreams(): void {\n    this._visibilityNodesMap =\n        (<Observable<AjfRendererUpdateMapOperation>>this._visibilityNodesMapUpdates)\n            .pipe(\n                scan(\n                    (rmap: AjfRendererUpdateMap, op: AjfRendererUpdateMapOperation) => {\n                      return op(rmap);\n                    },\n                    {}),\n                startWith({} as AjfRendererUpdateMap),\n                share(),\n            );\n    this._repetitionNodesMap =\n        (<Observable<AjfRendererUpdateMapOperation>>this._repetitionNodesMapUpdates)\n            .pipe(\n                scan(\n                    (rmap: AjfRendererUpdateMap, op: AjfRendererUpdateMapOperation) => {\n                      return op(rmap);\n                    },\n                    {}),\n                startWith({} as AjfRendererUpdateMap),\n                share(),\n            );\n    this._conditionalBranchNodesMap =\n        (<Observable<AjfRendererUpdateMapOperation>>this._conditionalBranchNodesMapUpdates)\n            .pipe(\n                scan(\n                    (rmap: AjfRendererUpdateMap, op: AjfRendererUpdateMapOperation) => {\n                      return op(rmap);\n                    },\n                    {}),\n                startWith({} as AjfRendererUpdateMap),\n                share(),\n            );\n    this._formulaNodesMap =\n        (<Observable<AjfRendererUpdateMapOperation>>this._formulaNodesMapUpdates)\n            .pipe(\n                scan(\n                    (rmap: AjfRendererUpdateMap, op: AjfRendererUpdateMapOperation) => {\n                      return op(rmap);\n                    },\n                    {}),\n                startWith({} as AjfRendererUpdateMap),\n                share(),\n            );\n    this._validationNodesMap =\n        (<Observable<AjfRendererUpdateMapOperation>>this._validationNodesMapUpdates)\n            .pipe(\n                scan(\n                    (rmap: AjfRendererUpdateMap, op: AjfRendererUpdateMapOperation) => {\n                      return op(rmap);\n                    },\n                    {}),\n                startWith({} as AjfRendererUpdateMap),\n                share(),\n            );\n    this._warningNodesMap =\n        (<Observable<AjfRendererUpdateMapOperation>>this._warningNodesMapUpdates)\n            .pipe(\n                scan(\n                    (rmap: AjfRendererUpdateMap, op: AjfRendererUpdateMapOperation) => {\n                      return op(rmap);\n                    },\n                    {}),\n                startWith({} as AjfRendererUpdateMap),\n                share(),\n            );\n    this._filteredChoicesNodesMap =\n        (<Observable<AjfRendererUpdateMapOperation>>this._filteredChoicesNodesMapUpdates)\n            .pipe(\n                scan(\n                    (rmap: AjfRendererUpdateMap, op: AjfRendererUpdateMapOperation) => {\n                      return op(rmap);\n                    },\n                    {}),\n                startWith({} as AjfRendererUpdateMap),\n                share(),\n            );\n    this._triggerConditionsNodesMap =\n        (<Observable<AjfRendererUpdateMapOperation>>this._triggerConditionsNodesMapUpdates)\n            .pipe(\n                scan(\n                    (rmap: AjfRendererUpdateMap, op: AjfRendererUpdateMapOperation) => {\n                      return op(rmap);\n                    },\n                    {}),\n                startWith({} as AjfRendererUpdateMap),\n                share(),\n            );\n    this._nextSlideConditionsNodesMap =\n        (<Observable<AjfRendererUpdateMapOperation>>this._nextSlideConditionsNodesMapUpdates)\n            .pipe(\n                scan(\n                    (rmap: AjfRendererUpdateMap, op: AjfRendererUpdateMapOperation) => {\n                      return op(rmap);\n                    },\n                    {}),\n                startWith({} as AjfRendererUpdateMap),\n                share(),\n            );\n\n    this._nodesMaps = [\n      this._visibilityNodesMap, this._repetitionNodesMap, this._conditionalBranchNodesMap,\n      this._formulaNodesMap, this._validationNodesMap, this._warningNodesMap,\n      this._nextSlideConditionsNodesMap, this._filteredChoicesNodesMap,\n      this._triggerConditionsNodesMap\n    ];\n  }\n\n  private _initFormStreams(): void {\n    const formObs = this._form;\n    formObs\n        .pipe(map((_form) => {\n          return this._initFormGroupStreams(new FormGroup({}));\n        }))\n        .subscribe(this._formGroup);\n    formObs\n        .pipe(\n            switchMap(form => {\n              if (form == null || form.form == null) {\n                return obsOf(form);\n              }\n              const choicesOrigins = form.form.choicesOrigins || [];\n              if (choicesOrigins.length === 0) {\n                return obsOf(form);\n              }\n              return from(Promise.all(choicesOrigins.map(co => initChoicesOrigin(co))))\n                  .pipe(\n                      map(() => form),\n                  );\n            }),\n            map((formDef) => {\n              return (_nodesInstances: AjfNodeInstance[]): AjfNodeInstance[] => {\n                let nodes: AjfNodeInstance[];\n                if (formDef != null &&\n                    (formDef as {form: AjfForm | null, context?: AjfContext}).form != null) {\n                  const form = (formDef as {form: AjfForm, context: AjfContext});\n                  const baseNodes = form.form.nodes;\n                  nodes = this._orderedNodesInstancesTree(\n                      flattenNodes(baseNodes), baseNodes, undefined, [], form.context || {});\n                } else {\n                  nodes = [];\n                }\n                let currentPosition = 0;\n                nodes.forEach((node) => {\n                  if (node.node.nodeType === AjfNodeType.AjfRepeatingSlide) {\n                    const rsNode = node as AjfRepeatingSlideInstance;\n                    for (let i = 0; i < rsNode.reps; i++) {\n                      if (node.visible) {\n                        currentPosition++;\n                        if (i == 0) {\n                          rsNode.position = currentPosition;\n                        }\n                      }\n                    }\n                  } else if (node.node.nodeType === AjfNodeType.AjfSlide) {\n                    const sNode = node as AjfSlideInstance;\n                    if (sNode.visible) {\n                      currentPosition++;\n                      sNode.position = currentPosition;\n                    }\n                  }\n                });\n                return nodes;\n              };\n            }),\n            )\n        .subscribe(this._nodesUpdates);\n  }\n\n  private _initNodeInstance(\n      allNodes: AjfNode[]|AjfNodeInstance[], node: AjfNode, prefix: number[], context: AjfContext,\n      branchVisibility = true): AjfNodeInstance|null {\n    let instance = nodeToNodeInstance(allNodes, node, prefix, context);\n    if (instance != null) {\n      const nodeType = instance.node.nodeType;\n      if (nodeType === AjfNodeType.AjfNodeGroup || nodeType === AjfNodeType.AjfRepeatingSlide) {\n        this._explodeRepeatingNode(\n            allNodes, instance as AjfNodeGroupInstance | AjfRepeatingSlideInstance, context);\n      } else if (nodeType === AjfNodeType.AjfSlide) {\n        const sInstance = instance as AjfSlideInstance;\n        sInstance.nodes = this._orderedNodesInstancesTree(\n            allNodes, sInstance.node.nodes, sInstance.node.id, prefix, context);\n      }\n      updateVisibility(instance, context, branchVisibility);\n      updateConditionalBranches(instance, context);\n      if (nodeType === AjfNodeType.AjfField) {\n        const fInstance = instance as AjfFieldInstance;\n\n        if (isCustomFieldWithChoices(fInstance.node) || isFieldWithChoices(fInstance.node)) {\n          updateFilteredChoices(fInstance as AjfFieldWithChoicesInstance<any>, context);\n        } else {\n          if (isTableFieldInstance(fInstance)) {\n            const tfInstance = fInstance as AjfTableFieldInstance;\n            const tNode = tfInstance.node;\n            tfInstance.context = context[nodeInstanceCompleteName(tfInstance)] || context;\n            const formGroup = this._formGroup.getValue();\n            let controlsWithLabels: [string, (string | AjfTableFormControl)[]][] = [];\n            controlsWithLabels.push([node.label, tNode.columnLabels]);\n            if (formGroup != null) {\n              tNode.rows.forEach((row, rowIdx) => {\n                let r: AjfTableFormControl[] = [];\n                (row as AjfTableCell[]).forEach((cell, idx) => {\n                  /*\n                  every control is registered with the cell position\n                  inside the form control matrix\n                  with this mask `${tNode.name}__${rowIdx}__${idx}`\n                  */\n                  const name = `${tNode.name}__${rowIdx}__${idx}`;\n                  const tableFormControl:\n                      AjfTableFormControl = {control: new FormControl(), show: false};\n                  tableFormControl.control.setValue(tfInstance.context[cell.formula]);\n                  formGroup.registerControl(name, tableFormControl.control);\n                  r.push(tableFormControl);\n                  /* create a object that respect the instance interface\n                  with the minimum defined properties to allow to run addToNodeFormula map*/\n                  const fakeInstance = {\n                    formula: {formula: cell.formula},\n                    node: {name, nodeType: 0, editable: false},\n                    visible: true,\n                    prefix: [],\n                    conditionalBranches: [],\n                    updatedEvt: new EventEmitter<void>()\n                  } as unknown as AjfNodeInstance;\n                  this._addToNodesFormulaMap(fakeInstance, cell.formula);\n                });\n                controlsWithLabels.push([tNode.rowLabels[rowIdx], r]);\n              });\n              tfInstance.controls = controlsWithLabels;\n            }\n          } else {\n            fInstance.value = context[nodeInstanceCompleteName(instance)];\n          }\n          updateFieldInstanceState(fInstance, context);\n        }\n      }\n      this._addNodeInstance(instance);\n    }\n    return instance;\n  }\n\n  private _adjustReps(\n      allNodes: AjfNode[]|AjfNodeInstance[], instance: AjfRepeatingContainerNodeInstance,\n      oldReps: number,\n      context: AjfContext): {added: AjfNodeInstance[]|null, removed: AjfNodeInstance[]|null} {\n    const newReps = instance.reps;\n    const result:\n        {added: AjfNodeInstance[]|null,\n         removed: AjfNodeInstance[]|null} = {added: null, removed: null};\n    if (oldReps < newReps) {\n      const newNodes: AjfNodeInstance[] = [];\n      if (instance.nodes == null) {\n        instance.nodes = [];\n      }\n      if (instance.node.nodeType === AjfNodeType.AjfNodeGroup) {\n        const node = createField({\n                       id: 999,\n                       name: '',\n                       parent: -1,\n                       fieldType: AjfFieldType.Empty,\n                       label: instance.node.label\n                     }) as AjfEmptyField;\n        const newInstance =\n            this._initNodeInstance(allNodes, node, instance.prefix.slice(0), context);\n        if (newInstance != null) {\n          instance.nodes.push(newInstance);\n        }\n      }\n      for (let i = oldReps; i < newReps; i++) {\n        const prefix = instance.prefix.slice(0);\n        const group = instance.node;\n        prefix.push(i);\n        orderedNodes(group.nodes, instance.node.id).forEach((n) => {\n          const newInstance = this._initNodeInstance(allNodes, n, prefix, context);\n          if (newInstance != null) {\n            newNodes.push(newInstance);\n            instance.nodes.push(newInstance);\n          }\n        });\n        this._addNodeInstance(instance);\n      }\n      result.added = newNodes;\n    } else if (oldReps > newReps) {\n      let nodesNum = instance.nodes.length / oldReps;\n      if (instance.node.nodeType === AjfNodeType.AjfNodeGroup) {\n        nodesNum++;\n      }\n      result.removed = instance.nodes.splice(newReps * nodesNum, nodesNum);\n      result.removed.forEach((n => {\n        this._removeNodeInstance(n);\n      }));\n    }\n    if (oldReps != newReps && instance.formulaReps == null) {\n      const fg = this._formGroup.getValue();\n      const completeName = nodeInstanceCompleteName(instance);\n      if (fg != null && fg.contains(completeName)) {\n        fg.controls[completeName].setValue(instance.reps);\n      }\n    }\n    instance.flatNodes = flattenNodesInstances(instance.nodes);\n    if (instance.node.nodeType === AjfNodeType.AjfRepeatingSlide) {\n      const rsInstance = instance as AjfRepeatingSlideInstance;\n      const slideNodes: AjfNodeInstance[][] = [];\n      const nodesPerSlide =\n          rsInstance.nodes != null ? rsInstance.nodes.length / rsInstance.reps : 0;\n      for (let i = 0; i < instance.reps; i++) {\n        const startNode = i * nodesPerSlide;\n        slideNodes.push(instance.nodes.slice(startNode, startNode + nodesPerSlide));\n      }\n      rsInstance.slideNodes = slideNodes;\n    }\n    return result;\n  }\n\n  private _updateFormValueAndValidity(): void {\n    this._nodesUpdates\n        .pipe(\n            withLatestFrom(this._formGroup),\n            filter(([_, fg]) => fg !== null),\n            )\n        .subscribe(([_, fg]) => {\n          const form = fg as FormGroup;\n          form.updateValueAndValidity();\n        });\n  }\n\n  private _explodeRepeatingNode(\n      allNodes: AjfNode[]|AjfNodeInstance[],\n      instance: AjfNodeGroupInstance|AjfRepeatingSlideInstance, context: AjfContext) {\n    const oldReps = updateRepsNum(instance, context);\n    if (oldReps !== instance.reps) {\n      this._adjustReps(allNodes, instance, oldReps, context);\n    }\n  }\n\n  private _orderedNodesInstancesTree(\n      allNodes: AjfNode[]|AjfNodeInstance[], nodes: AjfNode[], parent: number|null = null,\n      prefix: number[] = [], context: AjfContext): AjfNodeInstance[] {\n    let nodesInstances: AjfNodeInstance[] = [];\n    const curSuffix = prefix.length > 0 ? '__' + prefix.join('__') : '';\n    orderedNodes(nodes, parent).forEach((node: AjfNode) => {\n      const parentNodeInstance = nodesInstances.find(\n          ni => ni.node.id == node.parent && nodeInstanceSuffix(ni) == curSuffix);\n      const branchVisibility = parentNodeInstance != null ?\n          parentNodeInstance.verifiedBranch != null &&\n              parentNodeInstance.verifiedBranch == node.parentNode :\n          true;\n      const nni = this._initNodeInstance(allNodes, node, prefix, context, branchVisibility);\n      if (nni != null) {\n        nodesInstances.push(nni);\n      }\n    });\n    return nodesInstances;\n  }\n\n  private _formValueDelta(oldValue: any, newValue: any): string[] {\n    return Object.keys(newValue).filter((k) => oldValue[k] !== newValue[k]);\n  }\n\n  private _initFormGroupStreams(formGroup: FormGroup): FormGroup {\n    this._formGroupSubscription.unsubscribe();\n    let init = true;\n    let initForm = true;\n    this._formInitEvent.emit(AjfFormInitStatus.Initializing);\n    this._formGroupSubscription =\n        formGroup.valueChanges\n            .pipe(\n                startWith({} as any),\n                pairwise(),\n                debounceTime(200),\n                withLatestFrom<\n                    [any, any],\n                    [\n                      [any, any], AjfRendererUpdateMap, AjfRendererUpdateMap, AjfRendererUpdateMap,\n                      AjfRendererUpdateMap, AjfRendererUpdateMap, AjfRendererUpdateMap,\n                      AjfRendererUpdateMap, AjfRendererUpdateMap, AjfRendererUpdateMap,\n                      AjfNodeInstance[]\n                    ]>(...(this._nodesMaps), this._flatNodes),\n                )\n            .subscribe((v: [\n                         [any, any], AjfRendererUpdateMap, AjfRendererUpdateMap,\n                         AjfRendererUpdateMap, AjfRendererUpdateMap, AjfRendererUpdateMap,\n                         AjfRendererUpdateMap, AjfRendererUpdateMap, AjfRendererUpdateMap,\n                         AjfRendererUpdateMap, AjfNodeInstance[]\n                       ]) => {\n              const oldFormValue = init && {} || v[0][0];\n              init = false;\n              const newFormValue = v[0][1];\n              const visibilityMap = v[1];\n              const repetitionMap = v[2];\n              const conditionalBranchesMap = v[3];\n              const formulaMap = v[4];\n              const validationMap = v[5];\n              const warningMap = v[6];\n              const nextSlideConditionsMap = v[7];\n              const filteredChoicesMap = v[8];\n              const triggerConditionsMap = v[9];\n              const nodes = v[10];\n\n              // takes the names of the fields that have changed\n              const delta = this._formValueDelta(oldFormValue, newFormValue);\n              const deltaLen = delta.length;\n              let updatedNodes: AjfNodeInstance[] = [];\n\n              /*\n                for each field update all properties map\n                with the following rule  \"if fieldname is in map update it\" and\n                push on updateNodes the node instance that wrap field\n              */\n              delta.forEach((fieldName) => {\n                updatedNodes = updatedNodes.concat(\n                    nodes.filter(n => nodeInstanceCompleteName(n) === fieldName));\n                if (visibilityMap[fieldName] != null) {\n                  visibilityMap[fieldName].forEach(nodeInstance => {\n                    const completeName = nodeInstanceCompleteName(nodeInstance);\n                    const visibilityChanged = updateVisibility(nodeInstance, newFormValue);\n                    const isField = isFieldInstance(nodeInstance);\n                    if (visibilityChanged && !nodeInstance.visible) {\n                      const fg = this._formGroup.getValue();\n                      if (fg != null) {\n                        const s = timer(200).subscribe(() => {\n                          if (s && !s.closed) {\n                            s.unsubscribe();\n                          }\n                          fg.controls[completeName].setValue(null);\n                        });\n                      }\n                      if (isField) {\n                        (nodeInstance as AjfFieldInstance).value = null;\n                      }\n                    } else if (visibilityChanged && nodeInstance.visible && isField) {\n                      const fg = this._formGroup.getValue();\n                      const res = updateFormula(nodeInstance as AjfFieldInstance, newFormValue);\n                      if (fg != null && res.changed) {\n                        fg.controls[completeName].setValue(res.value);\n                      }\n                    }\n                    if (updatedNodes.indexOf(nodeInstance) === -1) {\n                      updatedNodes.push(nodeInstance);\n                    }\n                  });\n                }\n\n                if (repetitionMap[fieldName] != null) {\n                  repetitionMap[fieldName].forEach(nodeInstance => {\n                    if (isRepeatingContainerNode(nodeInstance.node)) {\n                      const rnInstance = nodeInstance as AjfRepeatingContainerNodeInstance;\n                      const oldReps = updateRepsNum(rnInstance, newFormValue);\n                      if (oldReps !== rnInstance.reps) {\n                        this._adjustReps(nodes, rnInstance, oldReps, newFormValue);\n                      }\n                    }\n                    if (updatedNodes.indexOf(nodeInstance) === -1) {\n                      updatedNodes.push(nodeInstance);\n                    }\n                  });\n                }\n\n                if (conditionalBranchesMap[fieldName] != null) {\n                  conditionalBranchesMap[fieldName].forEach((nodeInstance) => {\n                    // const branchChanged = nodeInstance.updateConditionalBranches(newFormValue);\n                    updateConditionalBranches(nodeInstance, newFormValue);\n                    // if (branchChanged) {\n                    const verifiedBranch = nodeInstance.verifiedBranch;\n                    nodeInstance.conditionalBranches.forEach((_condition, idx) => {\n                      if (idx == verifiedBranch) {\n                        this._showSubtree(newFormValue, nodes, nodeInstance, idx);\n                      } else {\n                        this._hideSubtree(newFormValue, nodes, nodeInstance, idx);\n                      }\n                    });\n                    // }\n                    if (updatedNodes.indexOf(nodeInstance) === -1) {\n                      updatedNodes.push(nodeInstance);\n                    }\n                  });\n                }\n\n                if (formulaMap[fieldName] != null) {\n                  formulaMap[fieldName].forEach((nodeInstance) => {\n                    if (isFieldInstance(nodeInstance)) {\n                      const fInstance = nodeInstance as AjfFieldInstance;\n                      const res = updateFormula(fInstance, newFormValue);\n                      const fg = this._formGroup.getValue();\n                      if (fg != null && res.changed) {\n                        updateValidation(fInstance, newFormValue);\n                        fg.controls[nodeInstanceCompleteName(nodeInstance)].setValue(res.value);\n                      }\n                    }\n                    if (updatedNodes.indexOf(nodeInstance) === -1) {\n                      updatedNodes.push(nodeInstance);\n                    }\n                  });\n                }\n\n                if (validationMap[fieldName] != null) {\n                  validationMap[fieldName].forEach((nodeInstance) => {\n                    if (isFieldInstance(nodeInstance)) {\n                      const fInstance = nodeInstance as AjfFieldInstance;\n                      newFormValue.$value = newFormValue[nodeInstanceCompleteName(nodeInstance)];\n                      updateValidation(\n                          fInstance, newFormValue, this.currentSupplementaryInformations);\n                    }\n                    if (updatedNodes.indexOf(nodeInstance) === -1) {\n                      updatedNodes.push(nodeInstance);\n                    }\n                  });\n                }\n\n                if (warningMap[fieldName] != null) {\n                  warningMap[fieldName].forEach((nodeInstance) => {\n                    if (isFieldInstance(nodeInstance)) {\n                      const fInstance = nodeInstance as AjfFieldInstance;\n                      updateWarning(fInstance, newFormValue);\n                      if (fInstance.warningResults != null &&\n                          fInstance.warningResults.filter(warning => warning.result).length > 0) {\n                        fInstance.warningTrigger.emit();\n                      }\n                    }\n                    if (updatedNodes.indexOf(nodeInstance) === -1) {\n                      updatedNodes.push(nodeInstance);\n                    }\n                  });\n                }\n\n                if (deltaLen == 1 && nextSlideConditionsMap[fieldName] != null) {\n                  if (nextSlideConditionsMap[fieldName]\n                          .filter((nodeInstance) => {\n                            if (isFieldInstance(nodeInstance)) {\n                              const fInstance = nodeInstance as AjfFieldInstance;\n                              return updateNextSlideCondition(fInstance, newFormValue);\n                            }\n                            return false;\n                          })\n                          .length == 1) {\n                    this._nextSlideTrigger.emit();\n                  }\n                }\n\n                if (filteredChoicesMap[fieldName] != null) {\n                  filteredChoicesMap[fieldName].forEach((nodeInstance) => {\n                    if (isFieldInstance(nodeInstance)) {\n                      const fInstance = nodeInstance as AjfFieldInstance;\n                      if (isFieldWithChoices(fInstance.node)) {\n                        updateFilteredChoices(\n                            fInstance as AjfFieldWithChoicesInstance<any>, newFormValue);\n                      }\n                    }\n                    if (updatedNodes.indexOf(nodeInstance) === -1) {\n                      updatedNodes.push(nodeInstance);\n                    }\n                  });\n                }\n\n                if (deltaLen == 1 && triggerConditionsMap[fieldName] != null) {\n                  const res = triggerConditionsMap[fieldName].filter((nodeInstance) => {\n                    if (!isFieldInstance(nodeInstance)) {\n                      return false;\n                    }\n                    const fInstance = nodeInstance as AjfFieldInstance;\n                    if (!isFieldWithChoices(fInstance.node)) {\n                      return false;\n                    }\n                    return updateTriggerConditions(\n                        fInstance as AjfFieldWithChoicesInstance<any>, newFormValue);\n                  });\n                  if (res.length == 1) {\n                    (res[0] as AjfFieldWithChoicesInstance<any>).selectionTrigger.emit();\n                  }\n                }\n              });\n              updatedNodes.forEach(n => {\n                const nodeIdx = nodes.indexOf(n);\n                let idx = nodeIdx - 1;\n                while (idx >= 0) {\n                  const curNode = nodes[idx];\n                  if (isSlidesInstance(curNode)) {\n                    updateSlideValidity(curNode as AjfRepeatingSlideInstance | AjfSlideInstance);\n                    curNode.updatedEvt.emit();\n                  }\n                  idx--;\n                }\n                n.updatedEvt.emit();\n              });\n              if (initForm) {\n                initForm = false;\n                this._formInitEvent.emit(AjfFormInitStatus.Complete);\n              }\n              this._valueChanged.next();\n            });\n    return formGroup;\n  }\n\n  private _showSubtree(\n      context: AjfContext, nodes: AjfNodeInstance[], node: AjfNodeInstance, branch?: number) {\n    this._updateSubtreeVisibility(context, nodes, node, true, branch);\n  }\n\n  private _hideSubtree(\n      context: AjfContext, nodes: AjfNodeInstance[], node: AjfNodeInstance, branch?: number) {\n    this._updateSubtreeVisibility(context, nodes, node, false, branch);\n  }\n\n  private _updateSubtreeVisibility(\n      context: AjfContext, nodes: AjfNodeInstance[], node: AjfNodeInstance, visible: boolean,\n      branch?: number) {\n    let subNodes: AjfNodeInstance[];\n    const nodeSuffix = nodeInstanceSuffix(node);\n    if (branch != null) {\n      subNodes = nodes.filter(n => {\n        const suffix = nodeInstanceSuffix(n);\n        return suffix == nodeSuffix && n.node.parent == node.node.id && n.node.parentNode == branch;\n      });\n    } else {\n      subNodes = nodes.filter(n => {\n        const suffix = nodeInstanceSuffix(n);\n        return suffix == nodeSuffix && n.node.parent == node.node.id;\n      });\n    }\n    const isContainer = isContainerNode(node.node);\n    subNodes.forEach((n) => {\n      if (!isContainer ||\n          (isContainer && (<AjfNodeGroup>node.node).nodes.find(cn => cn.id == n.node.id) == null)) {\n        updateVisibility(n, context, visible);\n        updateFormula(n as AjfFormulaFieldInstance, context);\n        this._updateSubtreeVisibility(context, nodes, n, visible);\n      }\n    });\n  }\n\n  private _initNodesStreams(): void {\n    this._nodes =\n        this._nodesUpdates.pipe(scan((nodes: AjfNodeInstance[], op: AjfNodesInstancesOperation) => {\n                                  return op(nodes);\n                                }, []), share());\n    this._flatNodesTree = this._nodes.pipe(map(nodes => flattenNodesInstancesTree(nodes)), share());\n    this._flatNodes = this._flatNodesTree.pipe(\n        map(slides => {\n          let nodes: AjfNodeInstance[] = [];\n          slides.forEach(s => {\n            nodes.push(s);\n            nodes = nodes.concat(s.flatNodes);\n            updateSlideValidity(s);\n          });\n          return nodes;\n        }),\n        share(),\n    );\n  }\n\n  private _removeNodeInstance(nodeInstance: AjfNodeInstance): AjfNodeInstance {\n    const nodeName = nodeInstanceCompleteName(nodeInstance);\n    this._removeNodesVisibilityMapIndex(nodeName);\n    this._removeNodesRepetitionMapIndex(nodeName);\n    this._removeNodesConditionalBranchMapIndex(nodeName);\n    this._removeNodesFormulaMapIndex(nodeName);\n    this._removeNodesValidationMapIndex(nodeName);\n    this._removeNodesWarningMapIndex(nodeName);\n    this._removeNodesNextSlideConditionsMapIndex(nodeName);\n    this._removeNodesFilteredChoicesMapIndex(nodeName);\n    this._removeNodesTriggerConditionsMapIndex(nodeName);\n    if (isSlidesInstance(nodeInstance)) {\n      return this._removeSlideInstance(nodeInstance as AjfBaseSlideInstance);\n    } else if (isRepeatingContainerNode(nodeInstance.node)) {\n      this._removeNodeGroupInstance(nodeInstance as AjfRepeatingContainerNodeInstance);\n    } else if (isFieldInstance(nodeInstance)) {\n      this._removeFieldInstance(nodeInstance as AjfFieldInstance);\n    }\n\n    return nodeInstance;\n  }\n\n  private _removeSlideInstance(slideInstance: AjfBaseSlideInstance): AjfBaseSlideInstance {\n    const slide = slideInstance.node;\n    if (slide.visibility != null) {\n      this._removeFromNodesVisibilityMap(slideInstance, slide.visibility.condition);\n    }\n    slideInstance.conditionalBranches.forEach((conditionalBranch: AjfCondition) => {\n      this._removeFromNodesConditionalBranchMap(slideInstance, conditionalBranch.condition);\n    });\n    return slideInstance;\n  }\n\n  private _removeNodeGroupInstance(nodeGroupInstance: AjfRepeatingContainerNodeInstance):\n      AjfRepeatingContainerNodeInstance {\n    const nodeGroup = nodeGroupInstance.node;\n    if (nodeGroup.visibility != null) {\n      this._removeFromNodesVisibilityMap(nodeGroupInstance, nodeGroup.visibility.condition);\n    }\n    if (nodeGroupInstance.formulaReps != null && nodeGroup.formulaReps != null) {\n      this._removeFromNodesRepetitionMap(nodeGroupInstance, nodeGroup.formulaReps.formula);\n    }\n    return nodeGroupInstance;\n  }\n\n  private _removeFieldInstance(fieldInstance: AjfFieldInstance): AjfFieldInstance {\n    const formGroup = this._formGroup.getValue();\n    const fieldInstanceName = nodeInstanceCompleteName(fieldInstance);\n    if (formGroup != null && formGroup.contains(fieldInstanceName)) {\n      formGroup.removeControl(fieldInstanceName);\n    }\n    if (fieldInstance.validation != null) {\n      this._validationNodesMapUpdates.next((vmap: AjfRendererUpdateMap): AjfRendererUpdateMap => {\n        if (vmap[fieldInstanceName] == null) {\n          delete vmap[fieldInstanceName];\n        }\n        return vmap;\n      });\n    }\n\n    if (fieldInstance.visibility != null) {\n      this._removeFromNodesVisibilityMap(fieldInstance, fieldInstance.visibility.condition);\n    }\n\n    fieldInstance.conditionalBranches.forEach((conditionalBranch: AjfCondition) => {\n      this._removeFromNodesConditionalBranchMap(fieldInstance, conditionalBranch.condition);\n    });\n\n    if (fieldInstance.formula) {\n      this._removeFromNodesFormulaMap(fieldInstance, fieldInstance.formula.formula);\n    }\n\n    // TODO: check this, probably is never verified\n    if (isRepeatingContainerNode(fieldInstance.node)) {\n      const rcInstance = (fieldInstance as AjfNodeInstance as AjfRepeatingContainerNodeInstance);\n      if (rcInstance.formulaReps != null) {\n        this._removeFromNodesRepetitionMap(fieldInstance, rcInstance.formulaReps.formula);\n      }\n    }\n\n    if (fieldInstance.validation != null && fieldInstance.validation.conditions != null) {\n      fieldInstance.validation.conditions.forEach((condition) => {\n        this._removeFromNodesValidationMap(fieldInstance, condition.condition);\n      });\n    }\n\n    if (fieldInstance.warning != null) {\n      fieldInstance.warning.conditions.forEach((condition) => {\n        this._removeFromNodesWarningMap(fieldInstance, condition.condition);\n      });\n    }\n\n    if (fieldInstance.nextSlideCondition != null) {\n      this._removeFromNodesNextSlideConditionsMap(\n          fieldInstance, fieldInstance.nextSlideCondition.condition);\n    }\n\n    if (isFieldWithChoices(fieldInstance.node)) {\n      const fwcInstance = fieldInstance as AjfFieldWithChoicesInstance<any>;\n      if (fwcInstance.choicesFilter != null) {\n        this._removeFromNodesFilteredChoicesMap(fieldInstance, fwcInstance.choicesFilter.formula);\n        if (fwcInstance.triggerConditions != null) {\n          fwcInstance.triggerConditions.forEach((condition) => {\n            this._removeFromNodesTriggerConditionsMap(fieldInstance, condition.condition);\n          });\n        }\n      }\n    }\n\n    return fieldInstance;\n  }\n\n  private _addNodeInstance(nodeInstance: AjfNodeInstance): AjfNodeInstance {\n    if (isRepeatingContainerNode(nodeInstance.node)) {\n      return this._addNodeGroupInstance(nodeInstance as AjfRepeatingContainerNodeInstance);\n    } else if (isSlideInstance(nodeInstance)) {\n      return this._addSlideInstance(nodeInstance as AjfSlideInstance);\n    } else if (isFieldInstance(nodeInstance)) {\n      return this._addFieldInstance(nodeInstance as AjfFieldInstance);\n    }\n\n    return nodeInstance;\n  }\n\n  private _addFieldInstance(fieldInstance: AjfFieldInstance): AjfFieldInstance {\n    const formGroup = this._formGroup.getValue();\n    const fieldInstanceName = nodeInstanceCompleteName(fieldInstance);\n    if (formGroup != null && !formGroup.contains(fieldInstanceName)) {\n      const control = new FormControl();\n      control.setValue(fieldInstance.value);\n      formGroup.registerControl(fieldInstanceName, control);\n    }\n    if (fieldInstance.validation != null) {\n      this._validationNodesMapUpdates.next((vmap: AjfRendererUpdateMap): AjfRendererUpdateMap => {\n        if (vmap[fieldInstanceName] == null) {\n          vmap[fieldInstanceName] = [];\n        }\n        if (vmap[fieldInstanceName].indexOf(fieldInstance) == -1) {\n          vmap[fieldInstanceName].push(fieldInstance);\n        }\n        return vmap;\n      });\n    } else {\n      fieldInstance.valid = true;\n    }\n\n    if (fieldInstance.visibility != null) {\n      this._addToNodesVisibilityMap(fieldInstance, fieldInstance.visibility.condition);\n    }\n\n    fieldInstance.conditionalBranches.forEach((conditionalBranch: AjfCondition) => {\n      this._addToNodesConditionalBranchMap(fieldInstance, conditionalBranch.condition);\n    });\n\n    if (fieldInstance.formula) {\n      this._addToNodesFormulaMap(fieldInstance, fieldInstance.formula.formula);\n    }\n\n    if (isNodeGroupInstance(fieldInstance)) {\n      const ngInstance = fieldInstance as AjfNodeInstance as AjfNodeGroupInstance;\n      if (ngInstance.formulaReps != null) {\n        this._addToNodesRepetitionMap(fieldInstance, ngInstance.formulaReps.formula);\n      }\n    }\n\n    if (fieldInstance.validation != null && fieldInstance.validation.conditions != null) {\n      fieldInstance.validation.conditions.forEach((condition) => {\n        this._addToNodesValidationMap(fieldInstance, condition.condition);\n      });\n    }\n\n    if (fieldInstance.warning != null) {\n      fieldInstance.warning.conditions.forEach((condition) => {\n        this._addToNodesWarningMap(fieldInstance, condition.condition);\n      });\n    }\n\n    if (fieldInstance.nextSlideCondition != null) {\n      this._addToNodesNextSlideConditionsMap(\n          fieldInstance, fieldInstance.nextSlideCondition.condition);\n    }\n\n    if (isCustomFieldWithChoices(fieldInstance.node) || isFieldWithChoicesInstance(fieldInstance)) {\n      const fwcInstance = fieldInstance as AjfFieldWithChoicesInstance<any>;\n      if (fwcInstance.choicesFilter != null) {\n        this._addToNodesFilteredChoicesMap(fieldInstance, fwcInstance.choicesFilter.formula);\n      }\n      if (fwcInstance.triggerConditions != null) {\n        fwcInstance.triggerConditions.forEach((condition: AjfCondition) => {\n          this._addToNodesTriggerConditionsMap(fieldInstance, condition.condition);\n        });\n      }\n    }\n\n    return fieldInstance;\n  }\n\n  private _addSlideInstance(slideInstance: AjfSlideInstance): AjfSlideInstance {\n    const slide = slideInstance.node;\n    if (slide.visibility != null) {\n      this._addToNodesVisibilityMap(slideInstance, slide.visibility.condition);\n    }\n    slideInstance.conditionalBranches.forEach((conditionalBranch: AjfCondition) => {\n      this._addToNodesConditionalBranchMap(slideInstance, conditionalBranch.condition);\n    });\n    return slideInstance;\n  }\n\n  private _addNodeGroupInstance(nodeGroupInstance: AjfRepeatingContainerNodeInstance):\n      AjfRepeatingContainerNodeInstance {\n    const nodeGroup = nodeGroupInstance.node;\n    if (nodeGroup.visibility != null) {\n      this._addToNodesVisibilityMap(nodeGroupInstance, nodeGroup.visibility.condition);\n    }\n    nodeGroupInstance.conditionalBranches.forEach((conditionalBranch: AjfCondition) => {\n      this._addToNodesConditionalBranchMap(nodeGroupInstance, conditionalBranch.condition);\n    });\n    if (nodeGroupInstance.formulaReps != null) {\n      if (nodeGroup.formulaReps != null) {\n        this._addToNodesRepetitionMap(nodeGroupInstance, nodeGroup.formulaReps.formula);\n      }\n    } else {\n      let formGroup = this._formGroup.getValue();\n      let nodeGroupInstanceName = nodeInstanceCompleteName(nodeGroupInstance);\n      if (formGroup != null && !formGroup.contains(nodeGroupInstanceName)) {\n        const control = new FormControl();\n        control.setValue(nodeGroupInstance.reps);\n        formGroup.registerControl(nodeGroupInstanceName, control);\n      }\n    }\n    return nodeGroupInstance;\n  }\n\n  private _removeNodesVisibilityMapIndex(index: string): void {\n    this._removeNodesMapIndex(this._visibilityNodesMapUpdates, index);\n  }\n\n  private _removeNodesRepetitionMapIndex(index: string): void {\n    this._removeNodesMapIndex(this._repetitionNodesMapUpdates, index);\n  }\n\n  private _removeNodesConditionalBranchMapIndex(index: string): void {\n    this._removeNodesMapIndex(this._conditionalBranchNodesMapUpdates, index);\n  }\n\n  private _removeNodesFormulaMapIndex(index: string): void {\n    this._removeNodesMapIndex(this._formulaNodesMapUpdates, index);\n  }\n\n  private _removeNodesValidationMapIndex(index: string): void {\n    this._removeNodesMapIndex(this._validationNodesMapUpdates, index);\n  }\n\n  private _removeNodesWarningMapIndex(index: string): void {\n    this._removeNodesMapIndex(this._warningNodesMapUpdates, index);\n  }\n\n  private _removeNodesFilteredChoicesMapIndex(index: string): void {\n    this._removeNodesMapIndex(this._filteredChoicesNodesMapUpdates, index);\n  }\n\n  private _removeNodesTriggerConditionsMapIndex(index: string): void {\n    this._removeNodesMapIndex(this._triggerConditionsNodesMapUpdates, index);\n  }\n\n  private _removeNodesNextSlideConditionsMapIndex(index: string): void {\n    this._removeNodesMapIndex(this._nextSlideConditionsNodesMapUpdates, index);\n  }\n\n  private _removeNodesMapIndex(nodesMap: Subject<AjfRendererUpdateMapOperation>, index: string) {\n    nodesMap.next((vmap: AjfRendererUpdateMap): AjfRendererUpdateMap => {\n      if (Object.keys(vmap).indexOf(index) > -1) {\n        delete vmap[index];\n      }\n      return vmap;\n    });\n  }\n\n  private _removeFromNodesVisibilityMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._removeFromNodesMap(this._visibilityNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _removeFromNodesRepetitionMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._removeFromNodesMap(this._repetitionNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _removeFromNodesConditionalBranchMap(nodeInstance: AjfNodeInstance, formula: string):\n      void {\n    this._removeFromNodesMap(this._conditionalBranchNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _removeFromNodesFormulaMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._removeFromNodesMap(this._formulaNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _removeFromNodesValidationMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._removeFromNodesMap(this._validationNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _removeFromNodesWarningMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._removeFromNodesMap(this._warningNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _removeFromNodesFilteredChoicesMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._removeFromNodesMap(this._filteredChoicesNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _removeFromNodesTriggerConditionsMap(nodeInstance: AjfNodeInstance, formula: string):\n      void {\n    this._removeFromNodesMap(this._filteredChoicesNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _removeFromNodesNextSlideConditionsMap(nodeInstance: AjfNodeInstance, formula: string):\n      void {\n    this._removeFromNodesMap(this._nextSlideConditionsNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _removeFromNodesMap(\n      nodesMap: Subject<AjfRendererUpdateMapOperation>, nodeInstance: AjfNodeInstance,\n      formula: string): void {\n    let tokens = tokenize(formula).filter(\n        (token: any) => token.type == 'Identifier' && token.value != '$value');\n    if (tokens.length > 0) {\n      nodesMap.next((vmap: AjfRendererUpdateMap): AjfRendererUpdateMap => {\n        tokens.forEach((token: any) => {\n          let tokenName = token.value;\n          if (vmap[tokenName] != null) {\n            const idx = vmap[tokenName].indexOf(nodeInstance);\n            if (idx > -1) {\n              vmap[tokenName].splice(idx, 1);\n              if (vmap[tokenName].length == 0) {\n                delete vmap[tokenName];\n              }\n            }\n          }\n        });\n        return vmap;\n      });\n    }\n  }\n\n  private _addToNodesVisibilityMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._addToNodesMap(this._visibilityNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _addToNodesRepetitionMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._addToNodesMap(this._repetitionNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _addToNodesConditionalBranchMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._addToNodesMap(this._conditionalBranchNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _addToNodesFormulaMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._addToNodesMap(this._formulaNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _addToNodesValidationMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._addToNodesMap(this._validationNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _addToNodesWarningMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._addToNodesMap(this._warningNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _addToNodesFilteredChoicesMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._addToNodesMap(this._filteredChoicesNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _addToNodesTriggerConditionsMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._addToNodesMap(this._triggerConditionsNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _addToNodesNextSlideConditionsMap(nodeInstance: AjfNodeInstance, formula: string): void {\n    this._addToNodesMap(this._nextSlideConditionsNodesMapUpdates, nodeInstance, formula);\n  }\n\n  private _addToNodesMap(\n      nodesMap: Subject<AjfRendererUpdateMapOperation>, nodeInstance: AjfNodeInstance,\n      formula: string): void {\n    let tokens = tokenize(formula).filter(\n        (token: any) => token.type == 'Identifier' && token.value != '$value');\n    if (tokens.length > 0) {\n      nodesMap.next((vmap: AjfRendererUpdateMap): AjfRendererUpdateMap => {\n        tokens.forEach((token: any) => {\n          let tokenName = token.value;\n          if (vmap[tokenName] == null) {\n            vmap[tokenName] = [];\n          }\n          if (vmap[tokenName].indexOf(nodeInstance) === -1) {\n            vmap[tokenName].push(nodeInstance);\n          }\n        });\n        return vmap;\n      });\n    }\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ChangeDetectorRef, Directive, OnDestroy, OnInit} from '@angular/core';\nimport {FormControl} from '@angular/forms';\nimport {defer, Observable, Subscription} from 'rxjs';\nimport {filter, map, withLatestFrom} from 'rxjs/operators';\n\nimport {AjfFieldWarningAlertResult} from './field-warning-alert-result';\nimport {AjfFormRendererService} from './form-renderer';\nimport {AjfFieldInstance} from './interface/fields-instances/field-instance';\nimport {AjfWarningAlertService} from './warning-alert-service';\n\n@Directive()\nexport abstract class AjfBaseFieldComponent<T extends AjfFieldInstance = AjfFieldInstance>\n    implements OnDestroy, OnInit {\n  private _instance: T;\n  get instance(): T {\n    return this._instance;\n  }\n  set instance(instance: T) {\n    if (instance !== this._instance) {\n      this._instance = instance;\n      this._setUpInstanceUpdate();\n      this._onInstanceChange();\n    }\n  }\n\n  private _control: Observable<FormControl|null>;\n  get control(): Observable<FormControl|null> {\n    return this._control;\n  }\n\n  private _warningTriggerSub: Subscription = Subscription.EMPTY;\n  private _instanceUpdateSub: Subscription = Subscription.EMPTY;\n\n  constructor(\n      protected _changeDetectorRef: ChangeDetectorRef,\n      private _service: AjfFormRendererService,\n      private _warningAlertService: AjfWarningAlertService,\n  ) {\n    this._control = defer(\n                        () => this._service.getControl(this.instance)\n                                  .pipe(\n                                      map(ctrl => (ctrl || new FormControl()) as FormControl),\n                                      )) as Observable<FormControl|null>;\n  }\n\n  ngOnInit(): void {\n    this._warningTriggerSub =\n        this.instance.warningTrigger\n            .pipe(\n                withLatestFrom(this.control),\n                filter(([_, ctrl]) => ctrl != null),\n                )\n            .subscribe(([_, ctrl]) => {\n              if (this.instance.warningResults == null) {\n                return;\n              }\n              const control = ctrl as FormControl;\n              const s =\n                  this._warningAlertService\n                      .showWarningAlertPrompt(\n                          this.instance.warningResults.filter(w => w.result).map(w => w.warning))\n                      .subscribe(\n                          (r: AjfFieldWarningAlertResult) => {\n                            if (r.result) {\n                              control!.setValue(null);\n                            }\n                          },\n                          (_e: any) => {\n                            if (s) {\n                              s.unsubscribe();\n                            }\n                          },\n                          () => {\n                            if (s) {\n                              s.unsubscribe();\n                            }\n                          });\n            });\n  }\n\n  ngOnDestroy(): void {\n    this._warningTriggerSub.unsubscribe();\n    this._instanceUpdateSub.unsubscribe();\n  }\n\n  protected _onInstanceChange(): void {}\n\n  private _setUpInstanceUpdate(): void {\n    this._instanceUpdateSub.unsubscribe();\n    if (this._instance != null) {\n      this._instanceUpdateSub = this._instance.updatedEvt.subscribe(() => {\n        if (this._changeDetectorRef) {\n          try {\n            this._changeDetectorRef.detectChanges();\n          } catch (e) {\n          }\n        }\n      });\n    } else {\n      this._instanceUpdateSub = Subscription.EMPTY;\n    }\n    this._changeDetectorRef.detectChanges();\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\n\n\n@Pipe({name: 'ajfBoolToInt'})\nexport class AjfBoolToIntPipe implements PipeTransform {\n  transform(value: boolean): number {\n    return value ? 1 : 0;\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\n\n@Pipe({name: 'ajfDateValue'})\nexport class AjfDateValuePipe implements PipeTransform {\n  transform(date: Date|'today'|undefined): Date|null {\n    if (date == null) {\n      return null;\n    }\n    return date === 'today' ? new Date() : date as Date;\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Injectable, Pipe, PipeTransform} from '@angular/core';\nimport {format} from 'date-fns';\n\n@Injectable()\n@Pipe({name: 'ajfDateValueString'})\nexport class AjfDateValueStringPipe implements PipeTransform {\n  transform(date: Date|'today'|undefined): string|undefined {\n    if (date == null) {\n      return undefined;\n    }\n    const dateObj = date === 'today' ? new Date() : date;\n    return format(dateObj, 'yyyy-MM-dd');\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfError} from '@ajf/core/models';\n\n/**\n * This class will define an Ajf invalid field definition error\n */\nexport class AjfInvalidFieldDefinitionError extends AjfError {\n  get name(): string {\n    return 'AjfInvalidFieldDefinitionError';\n  }\n\n  constructor(message?: string) {\n    super(message);\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\n\nimport {\n  AjfFieldWithChoicesInstance\n} from './interface/fields-instances/field-with-choices-instance';\n\n@Pipe({name: 'ajfExpandFieldWithChoices'})\nexport class AjfExpandFieldWithChoicesPipe implements PipeTransform {\n  transform(instance: AjfFieldWithChoicesInstance<any>, threshold: number) {\n    return !instance.node.forceNarrow &&\n        (instance.node.forceExpanded ||\n         (instance.filteredChoices && instance.filteredChoices.length <= threshold));\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Directive, ViewContainerRef} from '@angular/core';\n\n@Directive({selector: '[ajf-field-host]'})\nexport class AjfFieldHost {\n  constructor(readonly viewContainerRef: ViewContainerRef) {}\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {coerceBooleanProperty} from '@angular/cdk/coercion';\nimport {\n  ChangeDetectorRef,\n  ComponentFactoryResolver,\n  Directive,\n  Input,\n  OnDestroy,\n  OnInit,\n  ViewChild\n} from '@angular/core';\nimport {Subscription} from 'rxjs';\n\nimport {AjfBaseFieldComponent} from './base-field';\nimport {AjfFieldHost} from './field-host';\nimport {AjfFieldInstance} from './interface/fields-instances/field-instance';\nimport {AjfFieldComponentsMap} from './interface/fields/field-components-map';\n\n@Directive()\nexport abstract class AjfFormField implements OnDestroy, OnInit {\n  @ViewChild(AjfFieldHost, {static: true}) fieldHost: AjfFieldHost;\n\n  private _instance: AjfFieldInstance;\n  get instance(): AjfFieldInstance {\n    return this._instance;\n  }\n  @Input()\n  set instance(instance: AjfFieldInstance) {\n    if (this._instance !== instance) {\n      this._instance = instance;\n      if (this._init) {\n        this._loadComponent();\n      }\n    }\n  }\n\n  private _readonly: boolean;\n  get readonly(): boolean {\n    return this._readonly;\n  }\n  @Input()\n  set readonly(readonly: boolean) {\n    this._readonly = coerceBooleanProperty(readonly);\n    if (this._init) {\n      this._loadComponent();\n    }\n  }\n\n  private _componentInstance: AjfBaseFieldComponent<AjfFieldInstance>;\n  private _init: boolean = false;\n\n  protected abstract componentsMap: AjfFieldComponentsMap;\n  private _updatedSub = Subscription.EMPTY;\n\n  constructor(private _cdr: ChangeDetectorRef, private _cfr: ComponentFactoryResolver) {}\n\n  ngOnDestroy(): void {\n    this._updatedSub.unsubscribe();\n  }\n\n  ngOnInit(): void {\n    this._init = true;\n    this._loadComponent();\n  }\n\n  private _loadComponent(): void {\n    this._updatedSub.unsubscribe();\n    this._updatedSub = Subscription.EMPTY;\n    if (this._instance == null || this.fieldHost == null) {\n      return;\n    }\n\n    const vcr = this.fieldHost.viewContainerRef;\n    vcr.clear();\n    const componentDef = this.componentsMap[this._instance.node.fieldType];\n    if (componentDef == null) {\n      return;\n    }\n    const component = this._readonly && componentDef.readOnlyComponent ?\n        componentDef.readOnlyComponent :\n        componentDef.component;\n    try {\n      const componentFactory = this._cfr.resolveComponentFactory(component);\n      const componentRef = vcr.createComponent(componentFactory);\n      this._componentInstance = componentRef.instance;\n      this._componentInstance.instance = this._instance;\n\n      if (componentDef.inputs) {\n        Object.keys(componentDef.inputs).forEach(key => {\n          if (key in this._componentInstance) {\n            (this._componentInstance as any)[key] = componentDef.inputs![key];\n          }\n        });\n      }\n      this._updatedSub = this._instance.updatedEvt.subscribe(() => this._cdr.markForCheck());\n    } catch (e) {\n      console.log(e);\n    }\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfFieldType} from './interface/fields/field-type';\n\nexport function fieldIconName(type: AjfFieldType): string {\n  return `ajf-icon-field-${\n      typeof AjfFieldType[type] === 'string' ? AjfFieldType[type].toLowerCase() : type}`;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\n\nimport {fieldIconName} from './field-utils';\nimport {AjfField} from './interface/fields/field';\nimport {AjfFieldType} from './interface/fields/field-type';\n\n@Pipe({name: 'ajfFieldIcon'})\nexport class AjfFieldIconPipe implements PipeTransform {\n  transform(field: AjfField|AjfFieldType): string {\n    return fieldIconName(\n        (field as AjfField).fieldType ? (field as AjfField).fieldType : field as AjfFieldType);\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe} from '@angular/core';\n\nimport {AjfValidationResult} from './interface/validation/validation-results';\n\n@Pipe({name: 'ajfFieldIsValid'})\nexport class AjfFieldIsValidPipe {\n  transform(validationResults?: AjfValidationResult[]): boolean {\n    return validationResults != null && validationResults.filter((f) => !f.result).length === 0;\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '@ajf/core/models';\nimport {Type} from '@angular/core';\n\nimport {AjfBaseFieldComponent} from './base-field';\nimport {AjfFieldInstance} from './interface/fields-instances/field-instance';\nimport {AjfFieldComponentsMap} from './interface/fields/field-components-map';\nimport {AjfFieldInstanceCreate} from './utils/fields-instances/create-field-instance';\nimport {componentsMap} from './utils/fields/fields-map';\n\nexport abstract class AjfFieldService {\n  readonly componentsMap: AjfFieldComponentsMap = componentsMap;\n\n  registerCustomField(field: {\n    fieldType: number,\n    component: Type<AjfBaseFieldComponent>,\n    readOnlyComponent?: Type<AjfBaseFieldComponent>,\n    createInstance?: (instance: AjfFieldInstanceCreate, context: AjfContext) => AjfFieldInstance;\n    isFieldWithChoice?: boolean,\n  }): void {\n    const {fieldType, component} = field;\n    if (fieldType < 100) {\n      throw new Error('Invalid custom field type, it must be greater than 100');\n    }\n    if (component == null) {\n      throw new Error('Invalid custom field component');\n    }\n    this.componentsMap[fieldType] = field;\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ChangeDetectorRef} from '@angular/core';\n\nimport {AjfBaseFieldComponent} from './base-field';\nimport {AjfFormRendererService} from './form-renderer';\nimport {\n  AjfFieldWithChoicesInstance\n} from './interface/fields-instances/field-with-choices-instance';\nimport {AjfWarningAlertService} from './warning-alert-service';\n\nexport abstract class AjfFieldWithChoicesComponent<T> extends\n    AjfBaseFieldComponent<AjfFieldWithChoicesInstance<T>> {\n  private _searchThreshold: number = 6;\n  get searchThreshold(): number {\n    return this._searchThreshold;\n  }\n\n  constructor(\n      cdr: ChangeDetectorRef, service: AjfFormRendererService,\n      warningAlertService: AjfWarningAlertService, searchThreshold: number) {\n    super(cdr, service, warningAlertService);\n    if (searchThreshold != null) {\n      this._searchThreshold = searchThreshold;\n    }\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {InjectionToken} from '@angular/core';\nimport {Observable} from 'rxjs';\n\nimport {AjfFieldWarningAlertResult} from './field-warning-alert-result';\n\nexport interface AjfWarningAlertService {\n  showWarningAlertPrompt(warnings: string[]): Observable<AjfFieldWarningAlertResult>;\n}\n\nexport const AJF_WARNING_ALERT_SERVICE =\n    new InjectionToken<AjfWarningAlertService>('ajf-warning-alert-service');\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  Inject,\n  ViewEncapsulation\n} from '@angular/core';\n\nimport {AjfBaseFieldComponent} from './base-field';\nimport {AjfFormRendererService} from './form-renderer';\nimport {AJF_WARNING_ALERT_SERVICE, AjfWarningAlertService} from './warning-alert-service';\n\n@Component({\n  selector: 'ajf-file-field',\n  templateUrl: 'file-field.html',\n  styleUrls: ['file-field.css'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n})\nexport class AjfFileFieldComponent extends AjfBaseFieldComponent {\n  constructor(\n      cdr: ChangeDetectorRef, service: AjfFormRendererService,\n      @Inject(AJF_WARNING_ALERT_SERVICE) was: AjfWarningAlertService) {\n    super(cdr, service, was);\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfPageSlider, AjfPageSliderOrientation} from '@ajf/core/page-slider';\nimport {coerceBooleanProperty} from '@angular/cdk/coercion';\nimport {\n  AfterViewChecked,\n  AfterViewInit,\n  ChangeDetectorRef,\n  Directive,\n  EventEmitter,\n  Input,\n  OnDestroy,\n  Output,\n  QueryList,\n  ViewChild,\n  ViewChildren\n} from '@angular/core';\nimport {FormGroup} from '@angular/forms';\nimport {Observable, Subscription} from 'rxjs';\nimport {delayWhen, map, withLatestFrom} from 'rxjs/operators';\n\nimport {AjfFormField} from './field';\nimport {AjfFormInitStatus, AjfFormRendererService} from './form-renderer';\n\nimport {AjfFieldType} from './interface/fields/field-type';\nimport {AjfForm} from './interface/forms/form';\nimport {AjfNodeGroupInstance} from './interface/nodes-instances/node-group-instance';\nimport {AjfNodeInstance} from './interface/nodes-instances/node-instance';\nimport {AjfRepeatingSlideInstance} from './interface/slides-instances/repeating-slide-instance';\nimport {AjfSlideInstance} from './interface/slides-instances/slide-instance';\nimport {nodeInstanceCompleteName} from './utils/nodes-instances/node-instance-complete-name';\n\nexport class AjfFormActionEvent {\n  source: AjfFormRenderer;\n  value: Object;\n  action: string;\n}\n\n@Directive()\nexport abstract class AjfFormRenderer implements AfterViewChecked, AfterViewInit, OnDestroy {\n  // formGroup is an Observable FormGroup type\n  readonly formGroup: Observable<FormGroup|null>;\n\n  //  slides is an observable AjfSlide array type\n  readonly slides: Observable<AjfSlideInstance[]>;\n  readonly slidesNum: Observable<number>;\n  readonly errors: Observable<number>;\n  readonly formIsInit: Observable<boolean>;\n\n  // ajfFieldTypes [ Text, Number, Boolean, SingleChoice, MultipleChoice,\n  // Formula, Empty, Composed, LENGTH ]\n  readonly ajfFieldTypes = AjfFieldType;\n\n  @Input() title: string;\n\n  private _orientationChange: EventEmitter<AjfPageSliderOrientation> =\n      new EventEmitter<AjfPageSliderOrientation>();\n  @Output()\n  readonly orientationChange: Observable<AjfPageSliderOrientation> =\n      this._orientationChange as Observable<AjfPageSliderOrientation>;\n\n  private _saveDisabled: boolean = false;\n  get saveDisabled(): boolean {\n    return this._saveDisabled;\n  }\n  @Input()\n  set saveDisabled(saveDisabled: boolean) {\n    this._saveDisabled = coerceBooleanProperty(saveDisabled);\n    this._changeDetectorRef.markForCheck();\n  }\n\n  private _hasStartMessage = false;\n  get hasStartMessage(): boolean {\n    return this._hasStartMessage;\n  }\n  @Input()\n  set hasStartMessage(hasStartMessage: boolean) {\n    this._hasStartMessage = coerceBooleanProperty(hasStartMessage);\n    this._changeDetectorRef.markForCheck();\n  }\n\n  private _hasEndMessage = false;\n  get hasEndMessage(): boolean {\n    return this._hasEndMessage;\n  }\n  @Input()\n  set hasEndMessage(hasEndMessage: boolean) {\n    this._hasEndMessage = coerceBooleanProperty(hasEndMessage);\n    this._changeDetectorRef.markForCheck();\n  }\n\n  private _hideTopToolbar = false;\n  get hideTopToolbar(): boolean {\n    return this._hideTopToolbar;\n  }\n  @Input()\n  set hideTopToolbar(hideTopToolbar: boolean) {\n    this._hideTopToolbar = coerceBooleanProperty(hideTopToolbar);\n    this._changeDetectorRef.markForCheck();\n  }\n\n  private _hideBottomToolbar = false;\n  get hideBottompToolbar(): boolean {\n    return this._hideBottomToolbar;\n  }\n  @Input()\n  set hideBottomToolbar(hideBottomToolbar: boolean) {\n    this._hideBottomToolbar = coerceBooleanProperty(hideBottomToolbar);\n    this._changeDetectorRef.markForCheck();\n  }\n\n  private _hideNavigationButtons = false;\n  get hideNavigationButtons(): boolean {\n    return this._hideNavigationButtons;\n  }\n  @Input()\n  set hideNavigationButtons(hideNavigationButtons: boolean) {\n    this._hideNavigationButtons = coerceBooleanProperty(hideNavigationButtons);\n    this._changeDetectorRef.markForCheck();\n  }\n\n  private _fixedOrientation = false;\n  get fixedOrientation(): boolean {\n    return this._fixedOrientation;\n  }\n  @Input()\n  set fixedOrientation(fixedOrientation: boolean) {\n    this._fixedOrientation = coerceBooleanProperty(fixedOrientation);\n    this._changeDetectorRef.markForCheck();\n  }\n\n  private _readonly = false;\n  get readonly(): boolean {\n    return this._readonly;\n  }\n  @Input()\n  set readonly(readonly: boolean) {\n    this._readonly = coerceBooleanProperty(readonly);\n    this._changeDetectorRef.markForCheck();\n  }\n\n  private _orientation: AjfPageSliderOrientation = 'horizontal';\n  get orientation(): AjfPageSliderOrientation {\n    return this._orientation;\n  }\n  @Input()\n  set orientation(orientation: AjfPageSliderOrientation) {\n    if (orientation !== 'horizontal' && orientation !== 'vertical') {\n      return;\n    }\n    if (orientation !== this._orientation) {\n      this._orientation = orientation;\n      this._changeDetectorRef.markForCheck();\n      this._orientationChange.emit(this._orientation);\n    }\n  }\n\n  @ViewChild('formSlider', {static: false}) formSlider: AjfPageSlider;\n  @ViewChildren(AjfFormField) fields: QueryList<AjfFormField>;\n\n  private _errorMoveEvent: EventEmitter<boolean> = new EventEmitter<boolean>();\n\n  // _errorPositions is a private subject structure that contains next and prev\n  private _errorPositions: Observable<number[]>;\n\n  // _form is a private ajFForm\n  private _form: AjfForm;\n  // _init is a private boolean\n  private _init = false;\n\n  private _nextSlideSubscription: Subscription = Subscription.EMPTY;\n  private _errorMoveSubscription: Subscription = Subscription.EMPTY;\n\n  private _formAction: EventEmitter<AjfFormActionEvent> = new EventEmitter<AjfFormActionEvent>();\n  @Output()\n  readonly formAction: Observable<AjfFormActionEvent> =\n      this._formAction as Observable<AjfFormActionEvent>;\n\n  @Input()\n  set form(form: AjfForm) {\n    this._form = form;\n\n    if (this._init) {\n      this._rendererService.setForm(this._form);\n    }\n  }\n\n  /**\n   * this constructor will init current formula by ajfBuilderService\n   */\n  constructor(\n      private _rendererService: AjfFormRendererService,\n      protected _changeDetectorRef: ChangeDetectorRef) {\n    this.formGroup = _rendererService.formGroup;\n    this.slides = _rendererService.nodesTree;\n    this._errorPositions = _rendererService.errorPositions;\n    this.errors = _rendererService.errors;\n    this.slidesNum = _rendererService.slidesNum;\n    this.formIsInit =\n        _rendererService.formInitEvent.pipe(map(e => e === AjfFormInitStatus.Complete));\n  }\n\n  /**\n   * this method will scroll to next error received by subscribe\n   */\n  goToNextError(): void {\n    this._errorMoveEvent.emit(true);\n  }\n  /**\n   * this method will scroll to prev error received by subscribe\n   */\n  goToPrevError(): void {\n    this._errorMoveEvent.emit(false);\n  }\n\n  /**\n   * this method will add group\n   */\n  addGroup(nodeGroup: AjfNodeGroupInstance|AjfSlideInstance|AjfRepeatingSlideInstance): void {\n    let s = this._rendererService.addGroup(nodeGroup as AjfNodeGroupInstance)\n                .pipe(\n                    delayWhen(() => this.formSlider.pageScrollFinish),\n                    )\n                .subscribe(\n                    (r) => {\n                      if (r && this.formSlider != null) {\n                        this.formSlider.slide({dir: 'down'});\n                      }\n                    },\n                    (_e) => {\n                      if (s) {\n                        s.unsubscribe();\n                      }\n                    },\n                    () => {\n                      if (s) {\n                        s.unsubscribe();\n                      }\n                    });\n  }\n\n  /**\n   * this method will remove group\n   */\n  removeGroup(nodeGroup: AjfNodeGroupInstance|AjfSlideInstance|AjfRepeatingSlideInstance): void {\n    let s = this._rendererService.removeGroup(nodeGroup as AjfNodeGroupInstance)\n                .pipe(\n                    delayWhen(() => this.formSlider.pageScrollFinish),\n                    )\n                .subscribe(\n                    (r) => {\n                      if (r && this.formSlider != null) {\n                        this.formSlider.slide({dir: 'up'});\n                      }\n                    },\n                    (_e) => {\n                      if (s) {\n                        s.unsubscribe();\n                      }\n                    },\n                    () => {\n                      if (s) {\n                        s.unsubscribe();\n                      }\n                    });\n  }\n\n  onSave(_evt: any): void {\n    this._formAction.emit(\n        {source: this, action: 'save', value: this._rendererService.getFormValue()});\n  }\n\n  onFormAction(_evt: any, action: string) {\n    this._formAction.emit(\n        {source: this, value: this._rendererService.getFormValue(), action: action});\n  }\n\n  /**\n   * this method will set current form in rederer service when init form\n   */\n  ngAfterViewInit(): void {\n    if (this._form != null) {\n      this._rendererService.setForm(this._form);\n      this._changeDetectorRef.detectChanges();\n    }\n  }\n\n  ngAfterViewChecked(): void {\n    if (!this._init && this.formSlider != null) {\n      this._init = true;\n\n      this._errorMoveSubscription =\n          (<Observable<boolean>>this._errorMoveEvent)\n              .pipe(withLatestFrom(this._errorPositions))\n              .subscribe(([move, errs]) => {\n                const currentPosition = this.formSlider.currentPage - (+this.hasStartMessage) + 1;\n                if (errs == null) {\n                  return;\n                }\n                const errors = errs as number[];\n\n                let found = false;\n                let prevIdx = -1;\n                let nextIdx = -1;\n                let idx = 0;\n                let errorsLen = errors.length;\n                while (!found && idx < errorsLen) {\n                  if (errors[idx] == currentPosition) {\n                    found = true;\n                    prevIdx = idx > 0 ? idx - 1 : errorsLen - 1;\n                    nextIdx = idx < errorsLen - 1 ? idx + 1 : 0;\n                  } else if (errors[idx] > currentPosition) {\n                    found = true;\n                    prevIdx = idx > 0 ? idx - 1 : errorsLen - 1;\n                    nextIdx = idx;\n                  }\n                  idx++;\n                }\n                if (!found) {\n                  prevIdx = errorsLen - 1;\n                  nextIdx = 0;\n                }\n\n                this.formSlider.slide({to: move ? errors[nextIdx] - 1 : errors[prevIdx] - 1});\n                this._changeDetectorRef.detectChanges();\n              });\n    }\n  }\n\n  ngOnDestroy(): void {\n    this._nextSlideSubscription.unsubscribe();\n    this._errorMoveSubscription.unsubscribe();\n    this._orientationChange.complete();\n    this._errorMoveEvent.complete();\n    this._formAction.complete();\n  }\n\n  orientationChangeHandler(orientation: AjfPageSliderOrientation): void {\n    this.orientation = orientation;\n  }\n\n  trackNodeById(_: number, node: AjfNodeInstance): string {\n    return nodeInstanceCompleteName(node);\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {\n  AjfContext,\n  buildStringIdentifier,\n  buildStringIdentifierOpts,\n  BuildStringIdentifierOpts,\n} from '@ajf/core/common';\n\nimport {AjfField} from '../../interface/fields/field';\nimport {AjfFieldType} from '../../interface/fields/field-type';\nimport {AjfFieldWithChoices} from '../../interface/fields/field-with-choices';\nimport {AjfMultipleChoiceField} from '../../interface/fields/multiple-choice-field';\nimport {AjfSingleChoiceField} from '../../interface/fields/single-choice-field';\nimport {AjfForm} from '../../interface/forms/form';\nimport {isFieldWithChoices} from '../fields/is-field-with-choices';\nimport {flattenNodes} from '../nodes/flatten-nodes';\nimport {isField} from '../nodes/is-field';\n\nexport const buildFormStringIdentifier =\n    (form: AjfForm, context: AjfContext, opts?: BuildStringIdentifierOpts): string => {\n      if (form == null) {\n        return '';\n      }\n      const stringIdentifier = form.stringIdentifier || [];\n      if (stringIdentifier.length === 0) {\n        return '';\n      }\n      const fields =\n          flattenNodes(form.nodes).filter(n => isField(n) && isFieldWithChoices(n as AjfField)) as\n          AjfFieldWithChoices<unknown>[];\n      if (fields.length > 0) {\n        context = {...context};\n        fields.forEach(field => {\n          const value = context[field.name];\n          if (value == null) {\n            return;\n          }\n          if (field.fieldType === AjfFieldType.SingleChoice) {\n            const singleChoiceField = field as AjfSingleChoiceField<unknown>;\n            const choice = singleChoiceField.choicesOrigin.choices.find(c => c.value === value);\n            if (choice == null) {\n              return;\n            }\n            context[field.name] = choice.label;\n          } else if (\n              field.fieldType === AjfFieldType.MultipleChoice && Array.isArray(value) &&\n              value.length > 0) {\n            const strings = buildStringIdentifierOpts(opts);\n            const multipleChoiceField = field as AjfMultipleChoiceField<unknown>;\n            const choices =\n                multipleChoiceField.choicesOrigin.choices.filter(c => value.indexOf(c.value) > -1);\n            context[field.name] = choices.map(c => c.label).join(strings.valuesDivider);\n          }\n        });\n      }\n      return buildStringIdentifier(stringIdentifier, context, opts);\n    };\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext, BuildStringIdentifierOpts} from '@ajf/core/common';\nimport {Pipe, PipeTransform} from '@angular/core';\n\nimport {AjfForm} from './interface/forms/form';\nimport {buildFormStringIdentifier} from './utils/forms/build-form-string-identifier';\n\n@Pipe({name: 'ajfFormStringIdentifier'})\nexport class AjfFormStringIdentifierPipe implements PipeTransform {\n  transform(form: AjfForm, context: AjfContext, opts?: BuildStringIdentifierOpts): string {\n    return buildFormStringIdentifier(form, context, opts);\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\n\nimport {AjfTableFormControl} from './interface/forms/table-form-control';\n\n@Pipe({name: 'ajfGetTableCellControl'})\nexport class AjfGetTableCellControlPipe implements PipeTransform {\n  transform(ctrl: null|string|AjfTableFormControl): AjfTableFormControl|null {\n    if (ctrl == null || typeof ctrl === 'string') {\n      return null;\n    }\n    return ctrl as AjfTableFormControl;\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfFile} from '@ajf/core/file-input';\nimport {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  Inject,\n  ViewEncapsulation\n} from '@angular/core';\nimport {FormControl} from '@angular/forms';\nimport {DomSanitizer, SafeResourceUrl} from '@angular/platform-browser';\nimport {Observable} from 'rxjs';\nimport {filter, map, shareReplay, startWith, switchMap} from 'rxjs/operators';\n\nimport {AjfBaseFieldComponent} from './base-field';\nimport {AjfFormRendererService} from './form-renderer';\nimport {AJF_WARNING_ALERT_SERVICE, AjfWarningAlertService} from './warning-alert-service';\n\n@Component({\n  selector: 'ajf-image-field',\n  templateUrl: 'image-field.html',\n  styleUrls: ['image-field.css'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n})\nexport class AjfImageFieldComponent extends AjfBaseFieldComponent {\n  readonly imageUrl: Observable<SafeResourceUrl>;\n\n  constructor(\n      cdr: ChangeDetectorRef, service: AjfFormRendererService,\n      @Inject(AJF_WARNING_ALERT_SERVICE) was: AjfWarningAlertService, domSanitizer: DomSanitizer) {\n    super(cdr, service, was);\n    const fileStream = this.control.pipe(\n        filter(control => control != null),\n        switchMap(control => {\n          control = control as FormControl;\n          return control.valueChanges.pipe(\n                     startWith(control.value),\n                     ) as Observable<AjfFile>;\n        }),\n        filter(value => value != null),\n        shareReplay(1),\n    );\n    this.imageUrl = fileStream.pipe(\n        map(file => domSanitizer.bypassSecurityTrustResourceUrl((file as AjfFile).content)),\n    );\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\n\n@Pipe({name: 'ajfIncrement'})\nexport class AjfIncrementPipe implements PipeTransform {\n  transform(value: number, increment: number = 1): number {\n    return value + increment;\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\n\nimport {AjfTableCell} from './interface/fields/table-field';\n\n@Pipe({name: 'ajfIsCellEditable'})\nexport class AjfIsCellEditablePipe implements PipeTransform {\n  transform(cell: string|AjfTableCell): boolean {\n    if (cell == null || typeof cell === 'string') {\n      return false;\n    }\n    return cell.editable === true;\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\n\nimport {AjfFieldInstance} from './interface/fields-instances/field-instance';\nimport {AjfFieldType} from './interface/fields/field-type';\nimport {AjfNodeInstance} from './interface/nodes-instances/node-instance';\nimport {isFieldInstance} from './utils/nodes-instances/is-field-instance';\n\n@Pipe({name: 'ajfIsReadonlyInputField'})\nexport class AjfIsReadonlyInputFieldPipe implements PipeTransform {\n  transform(instance: AjfNodeInstance): boolean {\n    return isFieldInstance(instance) &&\n        (instance as AjfFieldInstance).node.fieldType === AjfFieldType.Formula;\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\nimport {AjfNodeInstance} from './interface/nodes-instances/node-instance';\nimport {isRepeatingSlideInstance} from './utils/nodes-instances/is-repeating-slide-instance';\n\n@Pipe({name: 'ajfIsRepeatingSlideInstance'})\nexport class AjfIsRepeatingSlideInstancePipe implements PipeTransform {\n  transform(instance: AjfNodeInstance): boolean {\n    return isRepeatingSlideInstance(instance);\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\nimport {AjfNodeInstance} from './interface/nodes-instances/node-instance';\nimport {nodeInstanceCompleteName} from './utils/nodes-instances/node-instance-complete-name';\n\n@Pipe({name: 'ajfNodeCompleteName'})\nexport class AjfNodeCompleteNamePipe implements PipeTransform {\n  transform(instance: AjfNodeInstance): string {\n    return instance ? nodeInstanceCompleteName(instance) : '';\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\n\n@Pipe({name: 'ajfRange'})\nexport class AjfRangePipe implements PipeTransform {\n  transform(size: number = 0, start: number = 1, step: number = 1): number[] {\n    const range: number[] = [];\n    for (let length = 0; length < size; ++length) {\n      range.push(start);\n      start += step;\n    }\n    return range;\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfBaseFieldComponent} from './base-field';\n\nexport abstract class AjfInputFieldComponent extends AjfBaseFieldComponent {\n  type: 'text'|'number' = 'text';\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  Inject,\n  ViewEncapsulation\n} from '@angular/core';\n\nimport {AjfFormRendererService} from './form-renderer';\nimport {AjfInputFieldComponent as CoreComponent} from './input-field';\nimport {AJF_WARNING_ALERT_SERVICE, AjfWarningAlertService} from './warning-alert-service';\n\n@Component({\n  selector: 'ajf-read-only-field',\n  templateUrl: 'read-only-field.html',\n  styleUrls: ['read-only-field.css'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n})\nexport class AjfReadOnlyFieldComponent extends CoreComponent {\n  constructor(\n      cdr: ChangeDetectorRef, service: AjfFormRendererService,\n      @Inject(AJF_WARNING_ALERT_SERVICE) was: AjfWarningAlertService) {\n    super(cdr, service, was);\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfFile, fileIcon} from '@ajf/core/file-input';\nimport {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  Inject,\n  ViewEncapsulation\n} from '@angular/core';\nimport {FormControl} from '@angular/forms';\nimport {DomSanitizer, SafeResourceUrl} from '@angular/platform-browser';\nimport {Observable} from 'rxjs';\nimport {filter, map, shareReplay, startWith, switchMap} from 'rxjs/operators';\n\nimport {AjfBaseFieldComponent} from './base-field';\nimport {AjfFormRendererService} from './form-renderer';\nimport {AJF_WARNING_ALERT_SERVICE, AjfWarningAlertService} from './warning-alert-service';\n\n@Component({\n  selector: 'ajf-read-only-file-field',\n  templateUrl: 'read-only-file-field.html',\n  styleUrls: ['read-only-file-field.css'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n})\nexport class AjfReadOnlyFileFieldComponent extends AjfBaseFieldComponent {\n  readonly fileIcon: SafeResourceUrl;\n  readonly fileUrl: Observable<SafeResourceUrl>;\n  readonly fileName: Observable<string>;\n\n  constructor(\n      cdr: ChangeDetectorRef, service: AjfFormRendererService,\n      @Inject(AJF_WARNING_ALERT_SERVICE) was: AjfWarningAlertService, domSanitizer: DomSanitizer) {\n    super(cdr, service, was);\n    this.fileIcon = domSanitizer.bypassSecurityTrustResourceUrl(fileIcon);\n    const fileStream = this.control.pipe(\n        filter(control => control != null),\n        switchMap(control => {\n          control = control as FormControl;\n          return control.valueChanges.pipe(\n                     startWith(control.value),\n                     ) as Observable<AjfFile>;\n        }),\n        filter(value => value != null),\n        shareReplay(1),\n    );\n    this.fileUrl = fileStream.pipe(\n        map(file => domSanitizer.bypassSecurityTrustResourceUrl((file as AjfFile).content)),\n    );\n    this.fileName = fileStream.pipe(map(file => (file as AjfFile).name));\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfFile} from '@ajf/core/file-input';\nimport {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  Inject,\n  ViewEncapsulation\n} from '@angular/core';\nimport {FormControl} from '@angular/forms';\nimport {DomSanitizer, SafeResourceUrl} from '@angular/platform-browser';\nimport {Observable} from 'rxjs';\nimport {filter, map, shareReplay, startWith, switchMap} from 'rxjs/operators';\n\nimport {AjfBaseFieldComponent} from './base-field';\nimport {AjfFormRendererService} from './form-renderer';\nimport {AJF_WARNING_ALERT_SERVICE, AjfWarningAlertService} from './warning-alert-service';\n\n@Component({\n  selector: 'ajf-read-only-image-field',\n  templateUrl: 'read-only-image-field.html',\n  styleUrls: ['read-only-image-field.css'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n})\nexport class AjfReadOnlyImageFieldComponent extends AjfBaseFieldComponent {\n  readonly imageUrl: Observable<SafeResourceUrl>;\n\n  constructor(\n      cdr: ChangeDetectorRef, service: AjfFormRendererService,\n      @Inject(AJF_WARNING_ALERT_SERVICE) was: AjfWarningAlertService, domSanitizer: DomSanitizer) {\n    super(cdr, service, was);\n    const fileStream = this.control.pipe(\n        filter(control => control != null),\n        switchMap(control => {\n          control = control as FormControl;\n          return control.valueChanges.pipe(\n                     startWith(control.value),\n                     ) as Observable<AjfFile>;\n        }),\n        filter(value => value != null),\n        shareReplay(1),\n    );\n    this.imageUrl = fileStream.pipe(\n        map(file => domSanitizer.bypassSecurityTrustResourceUrl((file as AjfFile).content)),\n    );\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\nimport {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  Inject,\n  ViewEncapsulation\n} from '@angular/core';\nimport {Observable} from 'rxjs';\nimport {filter, map} from 'rxjs/operators';\n\nimport {AjfBaseFieldComponent} from './base-field';\nimport {AjfFormRendererService} from './form-renderer';\nimport {\n  AjfFieldWithChoicesInstance\n} from './interface/fields-instances/field-with-choices-instance';\nimport {AJF_WARNING_ALERT_SERVICE, AjfWarningAlertService} from './warning-alert-service';\nimport {AjfFieldType} from './interface/fields/field-type';\n\n@Component({\n  templateUrl: 'read-only-select-field.html',\n  styleUrls: ['read-only-select-field.css'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n})\nexport class AjfReadOnlySelectFieldComponent extends\n  AjfBaseFieldComponent<AjfFieldWithChoicesInstance<String|number>> {\n  readonly multiple: Observable<boolean>;\n\n  constructor(\n      cdr: ChangeDetectorRef, service: AjfFormRendererService,\n      @Inject(AJF_WARNING_ALERT_SERVICE) was: AjfWarningAlertService) {\n    super(cdr, service, was);\n\n    this.multiple = this.control.pipe(\n      filter(control => control != null),\n      map(() => this.instance.node.fieldType === AjfFieldType.MultipleChoice)\n    );\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  Inject,\n  ViewEncapsulation\n} from '@angular/core';\n\nimport {AjfBaseFieldComponent} from './base-field';\nimport {AjfFormRendererService} from './form-renderer';\nimport {AjfTableFieldInstance} from './interface/fields-instances/table-field-instance';\nimport {AJF_WARNING_ALERT_SERVICE, AjfWarningAlertService} from './warning-alert-service';\n\n@Component({\n  templateUrl: 'read-only-table-field.html',\n  styleUrls: ['read-only-table-field.css'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n})\nexport class AjfReadOnlyTableFieldComponent extends AjfBaseFieldComponent<AjfTableFieldInstance> {\n  constructor(\n      cdr: ChangeDetectorRef, service: AjfFormRendererService,\n      @Inject(AJF_WARNING_ALERT_SERVICE) was: AjfWarningAlertService) {\n    super(cdr, service, was);\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {HttpClient} from '@angular/common/http';\nimport {ChangeDetectorRef, Inject} from '@angular/core';\nimport {FormControl} from '@angular/forms';\nimport {DomSanitizer, SafeResourceUrl} from '@angular/platform-browser';\nimport {Observable, of as obsOf} from 'rxjs';\nimport {catchError, filter, map, startWith, switchMap} from 'rxjs/operators';\n\nimport {AjfBaseFieldComponent} from './base-field';\nimport {AjfFormRendererService} from './form-renderer';\nimport {AJF_WARNING_ALERT_SERVICE, AjfWarningAlertService} from './warning-alert-service';\n\nexport type AjfVideoProvider = 'youtube'|'vimeo';\n\ninterface VideoInfo {\n  provider: AjfVideoProvider;\n  id: string;\n}\n\nexport class AjfVideoUrlFieldComponent extends AjfBaseFieldComponent {\n  readonly validUrl: Observable<boolean>;\n  readonly videoThumbnail: Observable<SafeResourceUrl>;\n\n  constructor(\n      cdr: ChangeDetectorRef, service: AjfFormRendererService,\n      @Inject(AJF_WARNING_ALERT_SERVICE) was: AjfWarningAlertService, domSanitizer: DomSanitizer,\n      httpClient: HttpClient) {\n    super(cdr, service, was);\n\n    const video = this.control.pipe(\n        filter(control => control != null),\n        switchMap(control => {\n          control = control as FormControl;\n          return control.valueChanges.pipe(\n              startWith(control.value),\n          );\n        }),\n        filter(value => value != null),\n        map(value => getVideoProviderAndId(value as string)),\n    );\n    this.validUrl = video.pipe(map(v => v != null));\n    this.videoThumbnail = video.pipe(\n        filter(info => info != null),\n        switchMap(info => videoPreviewUrl(httpClient, info as VideoInfo)),\n        filter(url => url != null),\n        map(url => domSanitizer.bypassSecurityTrustResourceUrl(url as string)),\n    );\n  }\n}\n\nfunction videoPreviewUrl(httpClient: HttpClient, video: VideoInfo): Observable<string|null> {\n  if (video.provider === 'youtube') {\n    return obsOf(`https://img.youtube.com/vi/${video.id}/default.jpg`);\n  }\n  if (video.provider === 'vimeo') {\n    return httpClient\n               .get<{thumbnail_url: string}>(\n                   `https://vimeo.com/api/oembed.json?url=https://vimeo.com/${video.id}`)\n               .pipe(\n                   map(response => response.thumbnail_url),\n                   catchError(() => obsOf(null)),\n                   ) as Observable<string|null>;\n  }\n  return obsOf('');\n}\n\nfunction getVideoProviderAndId(url: string): VideoInfo|null {\n  let provider: AjfVideoProvider|null = null;\n  let id: string|null = null;\n  if (/youtube|youtu\\.be|y2u\\.be|i.ytimg\\./.test(url)) {\n    provider = 'youtube';\n    id = getYouTubeVideoId(url);\n  } else if (/vimeo/.test(url)) {\n    provider = 'vimeo';\n    id = getVimeoVideoId(url);\n  }\n  if (provider == null || id == null) {\n    return null;\n  }\n  return {provider, id};\n}\n\nfunction getVimeoVideoId(url: string): string|null {\n  if (url.indexOf('#') > -1) {\n    url = url.split('#')[0];\n  }\n  if (url.indexOf('?') > -1 && url.indexOf('clip_id=') === -1) {\n    url = url.split('?')[0];\n  }\n\n  let id: string|null = null;\n  let arr: string[];\n\n  const vimeoPipe = [\n    'https?:\\/\\/vimeo\\.com\\/[0-9]+$', 'https?:\\/\\/player\\.vimeo\\.com\\/video\\/[0-9]+$',\n    'https?:\\/\\/vimeo\\.com\\/channels', 'groups', 'album'\n  ].join('|');\n\n  const vimeoRegex = new RegExp(vimeoPipe, 'gim');\n\n  if (vimeoRegex.test(url)) {\n    arr = url.split('/');\n    if (arr && arr.length) {\n      id = arr.pop() as string;\n    }\n  } else if (/clip_id=/gim.test(url)) {\n    arr = url.split('clip_id=');\n    if (arr && arr.length) {\n      id = arr[1].split('&')[0];\n    }\n  }\n\n  return id;\n}\n\nfunction getYouTubeVideoId(url: string): string|null {\n  const shortcode = /youtube:\\/\\/|https?:\\/\\/youtu\\.be\\/|http:\\/\\/y2u\\.be\\//g;\n  if (shortcode.test(url)) {\n    const shortcodeId = url.split(shortcode)[1];\n    return stripParameters(shortcodeId);\n  }\n  // /v/ or /vi/\n  const inlinev = /\\/v\\/|\\/vi\\//g;\n\n  if (inlinev.test(url)) {\n    const inlineId = url.split(inlinev)[1];\n    return stripParameters(inlineId);\n  }\n\n  // v= or vi=\n  const parameterV = /v=|vi=/g;\n\n  if (parameterV.test(url)) {\n    const arr = url.split(parameterV);\n    return arr[1].split('&')[0];\n  }\n\n  // v= or vi=\n  const parameterWebp = /\\/an_webp\\//g;\n\n  if (parameterWebp.test(url)) {\n    const webp = url.split(parameterWebp)[1];\n    return stripParameters(webp);\n  }\n\n  // embed\n  const embedReg = /\\/embed\\//g;\n\n  if (embedReg.test(url)) {\n    const embedId = url.split(embedReg)[1];\n    return stripParameters(embedId);\n  }\n\n  // ignore /user/username pattern\n  const usernameReg = /\\/user\\/([a-zA-Z0-9]*)$/g;\n\n  if (usernameReg.test(url)) {\n    return null;\n  }\n\n  // user\n  const userReg = /\\/user\\/(?!.*videos)/g;\n\n  if (userReg.test(url)) {\n    const elements = url.split('/');\n    return stripParameters(elements.pop() as string);\n  }\n\n  // attribution_link\n  const attrReg = /\\/attribution_link\\?.*v%3D([^%&]*)(%26|&|$)/;\n\n  if (attrReg.test(url)) {\n    return (url.match(attrReg) as string[])[1];\n  }\n\n  return null;\n}\n\nfunction stripParameters(url: string): string {\n  // Split parameters or split folder separator\n  if (url.indexOf('?') > -1) {\n    return url.split('?')[0];\n  } else if (url.indexOf('/') > -1) {\n    return url.split('/')[0];\n  }\n  return url;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {HttpClient} from '@angular/common/http';\nimport {\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  Inject,\n  ViewEncapsulation,\n} from '@angular/core';\nimport {DomSanitizer} from '@angular/platform-browser';\n\nimport {AjfFormRendererService} from './form-renderer';\nimport {AjfVideoUrlFieldComponent} from './video-url-field';\nimport {AJF_WARNING_ALERT_SERVICE, AjfWarningAlertService} from './warning-alert-service';\n\n@Component({\n  selector: 'ajf-read-only-video-url-field',\n  templateUrl: 'read-only-video-url-field.html',\n  styleUrls: ['read-only-video-url-field.css'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n})\nexport class AjfReadOnlyVideoUrlFieldComponent extends AjfVideoUrlFieldComponent {\n  constructor(\n      cdr: ChangeDetectorRef, service: AjfFormRendererService,\n      @Inject(AJF_WARNING_ALERT_SERVICE) was: AjfWarningAlertService, domSanitizer: DomSanitizer,\n      httpClient: HttpClient) {\n    super(cdr, service, was, domSanitizer, httpClient);\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\n\n\n@Pipe({name: 'ajfTableRowClass'})\nexport class AjfTableRowClass implements PipeTransform {\n  transform(value: number): string {\n    return value % 2 == 0 ? 'ajf-row-even' : 'ajf-row-odd';\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\nimport {AjfTableFieldInstance} from './interface/fields-instances/table-field-instance';\nimport {AjfTableFormControl} from './interface/forms/table-form-control';\n\n@Pipe({name: 'ajfTableVisibleColumns'})\nexport class AjfTableVisibleColumnsPipe implements PipeTransform {\n  transform(instance: AjfTableFieldInstance): (string|number|AjfTableFormControl)[][] {\n    if (!instance.node.editable) {\n      const val = instance.value || [];\n      return instance.hideEmptyRows ?\n          val.filter(\n                 col => col[1].reduce(\n                     (prev: boolean, cur) => {\n                       return prev || (cur != null && cur !== '' && cur !== 0 && cur !== '0');\n                     },\n                     false))\n              .map(v => [v[0], ...v[1]]) :\n          val.map(v => [v[0], ...v[1]]);\n    }\n    return ((instance.controls as [string, (string | AjfTableFormControl)[]][]) || [])\n        .map(v => [v[0], ...v[1]]);\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe, PipeTransform} from '@angular/core';\nimport {AjfBaseSlideInstance} from './interface/slides-instances/base-slide-instance';\n\n@Pipe({name: 'ajfValidSlide', pure: false})\nexport class AjfValidSlidePipe implements PipeTransform {\n  transform(slide: AjfBaseSlideInstance, idx: number): boolean {\n    if (idx == null || typeof idx !== 'number') {\n      return false;\n    }\n    if (idx >= slide.slideNodes.length) {\n      return true;\n    }\n    return slide.slideNodes[idx]\n        .map(n => {\n          if (n.visible && Object.keys(n).indexOf('valid') > -1) {\n            return (<any>n).valid;\n          }\n          return true;\n        })\n        .reduce((v1, v2) => v1 && v2, true);\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfCommonModule} from '@ajf/core/common';\nimport {AjfFileInputModule} from '@ajf/core/file-input';\nimport {CommonModule} from '@angular/common';\nimport {HttpClientModule} from '@angular/common/http';\nimport {NgModule} from '@angular/core';\nimport {ReactiveFormsModule} from '@angular/forms';\nimport {TranslateModule} from '@ngx-translate/core';\n\nimport {AjfAsFieldInstancePipe} from './as-field-instance';\nimport {AjfAsRepeatingSlideInstancePipe} from './as-repeating-slide-instance';\nimport {AjfBoolToIntPipe} from './bool-to-int';\nimport {AjfDateValuePipe} from './date-value';\nimport {AjfDateValueStringPipe} from './date-value-string';\nimport {AjfExpandFieldWithChoicesPipe} from './expand-input-with-choices';\nimport {AjfFieldHost} from './field-host';\nimport {AjfFieldIconPipe} from './field-icon';\nimport {AjfFieldIsValidPipe} from './field-is-valid';\nimport {AjfFileFieldComponent} from './file-field';\nimport {AjfFormRendererService} from './form-renderer';\nimport {AjfFormStringIdentifierPipe} from './form-string-identifier';\nimport {AjfGetTableCellControlPipe} from './get-table-cell-control';\nimport {AjfImageFieldComponent} from './image-field';\nimport {AjfIncrementPipe} from './increment';\nimport {AjfIsCellEditablePipe} from './is-cell-editable';\nimport {AjfIsReadonlyInputFieldPipe} from './is-readonly-input-field';\nimport {AjfIsRepeatingSlideInstancePipe} from './is-repeating-slide';\nimport {AjfNodeCompleteNamePipe} from './node-complete-name';\nimport {AjfRangePipe} from './range';\nimport {AjfReadOnlyFieldComponent} from './read-only-field';\nimport {AjfReadOnlyFileFieldComponent} from './read-only-file-field';\nimport {AjfReadOnlyImageFieldComponent} from './read-only-image-field';\nimport {AjfReadOnlySelectFieldComponent} from './read-only-select-field';\nimport {AjfReadOnlyTableFieldComponent} from './read-only-table-field';\nimport {AjfReadOnlyVideoUrlFieldComponent} from './read-only-video-url-field';\nimport {AjfTableRowClass} from './table-row-class';\nimport {AjfTableVisibleColumnsPipe} from './table-visible-columns';\nimport {AjfValidSlidePipe} from './valid-slide';\nimport {AjfValidationService} from './validation-service';\n\n@NgModule({\n  declarations: [\n    AjfAsFieldInstancePipe,\n    AjfAsRepeatingSlideInstancePipe,\n    AjfBoolToIntPipe,\n    AjfDateValuePipe,\n    AjfDateValueStringPipe,\n    AjfExpandFieldWithChoicesPipe,\n    AjfFieldHost,\n    AjfFieldIconPipe,\n    AjfFieldIsValidPipe,\n    AjfFileFieldComponent,\n    AjfFormStringIdentifierPipe,\n    AjfGetTableCellControlPipe,\n    AjfImageFieldComponent,\n    AjfIncrementPipe,\n    AjfIsCellEditablePipe,\n    AjfIsReadonlyInputFieldPipe,\n    AjfIsRepeatingSlideInstancePipe,\n    AjfNodeCompleteNamePipe,\n    AjfRangePipe,\n    AjfReadOnlyFieldComponent,\n    AjfReadOnlyFileFieldComponent,\n    AjfReadOnlyImageFieldComponent,\n    AjfReadOnlySelectFieldComponent,\n    AjfReadOnlyTableFieldComponent,\n    AjfReadOnlyVideoUrlFieldComponent,\n    AjfTableRowClass,\n    AjfTableVisibleColumnsPipe,\n    AjfValidSlidePipe,\n  ],\n  imports: [\n    AjfCommonModule, AjfFileInputModule, CommonModule, HttpClientModule, ReactiveFormsModule,\n    TranslateModule\n  ],\n  exports: [\n    AjfAsFieldInstancePipe,\n    AjfAsRepeatingSlideInstancePipe,\n    AjfBoolToIntPipe,\n    AjfDateValuePipe,\n    AjfDateValueStringPipe,\n    AjfExpandFieldWithChoicesPipe,\n    AjfFieldHost,\n    AjfFieldIconPipe,\n    AjfFieldIsValidPipe,\n    AjfFileFieldComponent,\n    AjfFormStringIdentifierPipe,\n    AjfGetTableCellControlPipe,\n    AjfImageFieldComponent,\n    AjfIncrementPipe,\n    AjfIsCellEditablePipe,\n    AjfIsReadonlyInputFieldPipe,\n    AjfIsRepeatingSlideInstancePipe,\n    AjfNodeCompleteNamePipe,\n    AjfRangePipe,\n    AjfReadOnlyFieldComponent,\n    AjfReadOnlyFileFieldComponent,\n    AjfReadOnlyImageFieldComponent,\n    AjfReadOnlySelectFieldComponent,\n    AjfReadOnlyTableFieldComponent,\n    AjfReadOnlyVideoUrlFieldComponent,\n    AjfTableRowClass,\n    AjfTableVisibleColumnsPipe,\n    AjfValidSlidePipe,\n  ],\n  entryComponents: [\n    AjfFileFieldComponent,\n    AjfImageFieldComponent,\n    AjfReadOnlyFieldComponent,\n    AjfReadOnlyFileFieldComponent,\n    AjfReadOnlyImageFieldComponent,\n    AjfReadOnlySelectFieldComponent,\n    AjfReadOnlyTableFieldComponent,\n    AjfReadOnlyVideoUrlFieldComponent,\n  ],\n  providers: [\n    AjfDateValueStringPipe,\n    AjfFormRendererService,\n    AjfValidationService,\n  ],\n})\nexport class AjfFormsModule {\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport function getTypeName(v: any): string {\n  let typeStr = typeof v;\n  return typeStr === 'object' ? v.constructor.toString().match(/\\w+/g)[1] : typeStr;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {InjectionToken} from '@angular/core';\n\nexport const AJF_SEARCH_ALERT_THRESHOLD = new InjectionToken<number>('AJF_SEARCH_ALERT_THRESHOLD');\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfAttachmentsOrigin} from '../../interface/attachments/attachments-origin';\n\nexport type AjfAttachmentsOriginCreate<T> =\n    Pick<AjfAttachmentsOrigin<T>, 'name'>&Partial<AjfAttachmentsOrigin<T>>;\n\nexport function createAttachmentsOrigin<T>(origin: AjfAttachmentsOriginCreate<T>):\n    AjfAttachmentsOrigin<T> {\n  return {\n    ...origin,\n    attachments: origin.attachments || [],\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfAttachmentsOrigin} from '../interface/attachments/attachments-origin';\nimport {\n  AjfAttachmentsOriginCreate,\n  createAttachmentsOrigin\n} from '../utils/attachments/create-attachments-origin';\n\nexport class AjfAttachmentsOriginSerializer {\n  static fromJson(origin: Partial<AjfAttachmentsOrigin<any>>): AjfAttachmentsOrigin<any> {\n    if (origin.name == null) {\n      throw new Error('Malformed attachments origin');\n    }\n    return createAttachmentsOrigin(origin as AjfAttachmentsOriginCreate<any>);\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfChoicesOrigin} from '../../interface/choices/choices-origin';\n\nexport type AjfChoicesOriginCreate<T> =\n    Pick<AjfChoicesOrigin<any>, 'type'|'name'>&Partial<AjfChoicesOrigin<T>>;\n\nexport function createChoicesOrigin<T>(origin: AjfChoicesOriginCreate<T>): AjfChoicesOrigin<T> {\n  return {\n    ...origin,\n    type: origin.type,\n    label: origin.label || '',\n    choices: origin.choices || [],\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfChoicesOrigin} from '../interface/choices/choices-origin';\nimport {AjfChoicesOriginCreate, createChoicesOrigin} from '../utils/choices/create-choices-origin';\n\nexport class AjfChoicesOriginSerializer {\n  static fromJson(origin: Partial<AjfChoicesOrigin<any>>): AjfChoicesOrigin<any> {\n    return createChoicesOrigin<any>({\n      ...origin,\n      type: origin.type || 'fixed',\n      name: origin.name || '',\n    } as AjfChoicesOriginCreate<any>);\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfFieldWithChoices} from '../../interface/fields/field-with-choices';\nimport {AjfFieldCreate, createField} from './create-field';\n\nexport type AjfFieldWithChoicesCreate<T> = AjfFieldCreate&\n    Pick<AjfFieldWithChoices<T>, 'fieldType'|'choicesOrigin'>&Partial<AjfFieldWithChoices<T>>;\n\nexport function createFieldWithChoices<T>(field: AjfFieldWithChoicesCreate<T>):\n    AjfFieldWithChoices<T> {\n  const node = createField({...field});\n  return {\n    ...node,\n    ...field,\n    choices: field.choices || [],\n    forceExpanded: field.forceExpanded || false,\n    forceNarrow: field.forceNarrow || false,\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContainerNode} from '../../interface/nodes/container-node';\nimport {AjfNodeCreate, createNode} from './create-node';\n\nexport type AjfContainerNodeCreate = AjfNodeCreate&Partial<AjfContainerNode>;\n\nexport function createContainerNode(containerNode: AjfContainerNodeCreate): AjfContainerNode {\n  const node = createNode(containerNode);\n  return {\n    ...node,\n    nodes: containerNode.nodes || [],\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfRepeatingNode} from '../../interface/nodes/repeating-node';\nimport {AjfNodeCreate, createNode} from './create-node';\n\nexport type AjfRepeatingNodeCreate = AjfNodeCreate&Partial<AjfRepeatingNode>;\n\nexport function createRepeatingNode(repeatingNode: AjfRepeatingNodeCreate): AjfRepeatingNode {\n  const node = createNode(repeatingNode);\n  return {\n    ...repeatingNode,\n    ...node,\n    minReps: repeatingNode.minReps != null ? repeatingNode.minReps : 1,\n    maxReps: repeatingNode.maxReps != null ? repeatingNode.maxReps : 0,\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeGroup} from '../../interface/nodes/node-group';\nimport {AjfNodeType} from '../../interface/nodes/node-type';\nimport {AjfContainerNodeCreate, createContainerNode} from './create-container-node';\nimport {AjfRepeatingNodeCreate, createRepeatingNode} from './create-repeating-node';\n\nexport type AjfNodeGroupCreate = AjfContainerNodeCreate&AjfRepeatingNodeCreate;\n\nexport function createNodeGroup(nodeGroup: AjfNodeGroupCreate): AjfNodeGroup {\n  return {\n    ...createContainerNode(nodeGroup),\n    ...createRepeatingNode(nodeGroup),\n    nodeType: AjfNodeType.AjfNodeGroup,\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeType} from '../../interface/nodes/node-type';\nimport {AjfRepeatingSlide} from '../../interface/slides/repeating-slide';\nimport {AjfContainerNodeCreate, createContainerNode} from '../nodes/create-container-node';\nimport {AjfRepeatingNodeCreate, createRepeatingNode} from '../nodes/create-repeating-node';\n\nexport type AjfRepeatingSlideCreate = AjfContainerNodeCreate&AjfRepeatingNodeCreate;\n\nexport function createRepeatingSlide(nodeGroup: AjfRepeatingSlideCreate): AjfRepeatingSlide {\n  return {\n    ...createContainerNode(nodeGroup),\n    ...createRepeatingNode(nodeGroup),\n    nodeType: AjfNodeType.AjfRepeatingSlide,\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfNodeType} from '../../interface/nodes/node-type';\nimport {AjfSlide} from '../../interface/slides/slide';\nimport {AjfContainerNodeCreate, createContainerNode} from '../nodes/create-container-node';\n\nexport type AjfSlideCreate = AjfContainerNodeCreate;\n\nexport function createSlide(nodeGroup: AjfSlideCreate): AjfSlide {\n  return {\n    ...createContainerNode(nodeGroup),\n    nodeType: AjfNodeType.AjfSlide,\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfValidationGroup} from '../interface/validation/validation-group';\nimport {createValidationGroup} from '../utils/validation/create-validation-group';\n\nexport class AjfValidationGroupSerializer {\n  static fromJson(group: Partial<AjfValidationGroup>): AjfValidationGroup {\n    return createValidationGroup(group);\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfWarningGroup} from '../interface/warning/warning-group';\nimport {createWarningGroup} from '../utils/warning/create-warning-group';\n\nexport class AjfWarningGroupSerializer {\n  static fromJson(group: Partial<AjfWarningGroup>): AjfWarningGroup {\n    return createWarningGroup(group);\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfConditionSerializer, AjfFormulaSerializer} from '@ajf/core/models';\n\nimport {AjfAttachmentsOrigin} from '../interface/attachments/attachments-origin';\nimport {AjfChoicesOrigin} from '../interface/choices/choices-origin';\nimport {AjfField} from '../interface/fields/field';\nimport {AjfFieldType} from '../interface/fields/field-type';\nimport {AjfFieldWithChoices} from '../interface/fields/field-with-choices';\nimport {AjfFormulaField} from '../interface/fields/formula-field';\nimport {AjfContainerNode} from '../interface/nodes/container-node';\nimport {AjfNode} from '../interface/nodes/node';\nimport {AjfNodeGroup} from '../interface/nodes/node-group';\nimport {AjfFieldNodeLink} from '../interface/nodes/node-link';\nimport {AjfNodeType} from '../interface/nodes/node-type';\nimport {AjfRepeatingNode} from '../interface/nodes/repeating-node';\nimport {AjfRepeatingSlide} from '../interface/slides/repeating-slide';\nimport {AjfSlide} from '../interface/slides/slide';\nimport {AjfFieldCreate, createField} from '../utils/fields/create-field';\nimport {createFieldWithChoices} from '../utils/fields/create-field-with-choices';\nimport {componentsMap} from '../utils/fields/fields-map';\nimport {createContainerNode} from '../utils/nodes/create-container-node';\nimport {AjfNodeCreate, createNode} from '../utils/nodes/create-node';\nimport {createNodeGroup} from '../utils/nodes/create-node-group';\nimport {createRepeatingNode} from '../utils/nodes/create-repeating-node';\nimport {createRepeatingSlide} from '../utils/slides/create-repeating-slide';\nimport {createSlide} from '../utils/slides/create-slide';\n\nimport {AjfValidationGroupSerializer} from './validation-group-serializer';\nimport {AjfWarningGroupSerializer} from './warning-group-serializer';\n\nexport class AjfNodeSerializer {\n  static fromJson(\n      json: Partial<AjfNode>,\n      choicesOrigins?: AjfChoicesOrigin<any>[],\n      attachmentsOrigins?: AjfAttachmentsOrigin<any>[],\n      ): AjfNode {\n    const err = 'Malformed node';\n    json.name = json.name || '';\n    if (json.id == null || json.parent == null || json.nodeType == null) {\n      throw new Error(err);\n    }\n    const obj = json as AjfNodeCreate;\n    if (obj.visibility) {\n      obj.visibility = AjfConditionSerializer.fromJson(obj.visibility);\n    }\n    obj.conditionalBranches =\n        (obj.conditionalBranches || []).map(c => AjfConditionSerializer.fromJson(c));\n    switch (obj.nodeType) {\n      case AjfNodeType.AjfField:\n        return AjfNodeSerializer._fieldFromJson(\n            obj as AjfNodeCreate & Partial<AjfField>,\n            choicesOrigins,\n            attachmentsOrigins,\n        );\n      case AjfNodeType.AjfFieldNodeLink:\n        return AjfNodeSerializer._fieldNodeLinkFromJson(\n            obj as AjfNodeCreate & Partial<AjfFieldNodeLink>);\n      case AjfNodeType.AjfNodeGroup:\n        return AjfNodeSerializer._nodeGroupFromJson(\n            obj as AjfNodeCreate & Partial<AjfNodeGroup>,\n            choicesOrigins,\n            attachmentsOrigins,\n        );\n      case AjfNodeType.AjfRepeatingSlide:\n        return AjfNodeSerializer._repeatingSlideFromJson(\n            obj as AjfNodeCreate & Partial<AjfRepeatingSlide>,\n            choicesOrigins,\n            attachmentsOrigins,\n        );\n      case AjfNodeType.AjfSlide:\n        return AjfNodeSerializer._slideFromJson(\n            obj as AjfNodeCreate & Partial<AjfSlide>,\n            choicesOrigins,\n            attachmentsOrigins,\n        );\n    }\n    throw new Error(err);\n  }\n\n  private static _containerNodeFromJson(\n      json: AjfNodeCreate&Partial<AjfContainerNode>,\n      choicesOrigins?: AjfChoicesOrigin<any>[],\n      attachmentsOrigins?: AjfAttachmentsOrigin<any>[],\n      ): AjfContainerNode {\n    json.nodes = (json.nodes ||\n                  []).map(n => AjfNodeSerializer.fromJson(n, choicesOrigins, attachmentsOrigins));\n    return createContainerNode(json);\n  }\n\n  private static _fieldFromJson(\n      json: AjfNodeCreate&Partial<AjfField>&Partial<{attachmentsOriginRef: string}>,\n      choicesOrigins?: AjfChoicesOrigin<any>[],\n      attachmentsOrigins?: AjfAttachmentsOrigin<any>[],\n      ): AjfField {\n    if (json.fieldType == null) {\n      throw new Error('Malformed field');\n    }\n    const obj = json as AjfFieldCreate;\n    if (obj.validation) {\n      obj.validation = AjfValidationGroupSerializer.fromJson(obj.validation);\n    }\n    if (obj.warning) {\n      obj.warning = AjfWarningGroupSerializer.fromJson(obj.warning);\n    }\n    if (json.attachmentsOriginRef) {\n      obj.attachmentOrigin =\n          (attachmentsOrigins || []).find(a => a.name === json.attachmentsOriginRef);\n    }\n    if (obj.nextSlideCondition) {\n      obj.nextSlideCondition = AjfConditionSerializer.fromJson(obj.nextSlideCondition);\n    }\n    const isCustomFieldWithChoice = obj.fieldType > 100 && componentsMap[obj.fieldType] != null &&\n        componentsMap[obj.fieldType].isFieldWithChoice === true;\n    if (isCustomFieldWithChoice) {\n      return AjfNodeSerializer._fieldWithChoicesFromJson(\n          json as AjfFieldCreate & Partial<AjfFieldWithChoices<any>>,\n          choicesOrigins,\n      );\n    }\n\n    switch (obj.fieldType) {\n      case AjfFieldType.Formula:\n        return AjfNodeSerializer._formulaFieldFromJson(\n            json as AjfFieldCreate & Partial<AjfFormulaField>);\n      case AjfFieldType.MultipleChoice:\n      case AjfFieldType.SingleChoice:\n        return AjfNodeSerializer._fieldWithChoicesFromJson(\n            json as AjfFieldCreate & Partial<AjfFieldWithChoices<any>>,\n            choicesOrigins,\n        );\n    }\n    return createField(obj);\n  }\n\n  private static _fieldNodeLinkFromJson(json: AjfNodeCreate&\n                                        Partial<AjfFieldNodeLink>): AjfFieldNodeLink {\n    return {...createNode(json), nodeType: AjfNodeType.AjfFieldNodeLink};\n  }\n\n  private static _fieldWithChoicesFromJson(\n      json: AjfFieldCreate&Partial<AjfFieldWithChoices<any>>&Partial<{choicesOriginRef: string}>,\n      choicesOrigins?: AjfChoicesOrigin<any>[],\n      ): AjfFieldWithChoices<any> {\n    const err = 'Malformed field with choices';\n    if (json.choicesOriginRef == null) {\n      throw new Error(err);\n    }\n    const choicesOrigin = (choicesOrigins || []).find(c => c.name === json.choicesOriginRef);\n    if (choicesOrigin == null) {\n      throw new Error(err);\n    }\n    if (json.choicesFilter) {\n      json.choicesFilter = AjfFormulaSerializer.fromJson(json.choicesFilter);\n    }\n    if (json.triggerConditions) {\n      json.triggerConditions = json.triggerConditions.map(t => AjfConditionSerializer.fromJson(t));\n    }\n    return createFieldWithChoices<any>({...json, choicesOrigin});\n  }\n\n  private static _formulaFieldFromJson(json: AjfFieldCreate&\n                                       Partial<AjfFormulaField>): AjfFormulaField {\n    if (json.formula) {\n      json.formula = AjfFormulaSerializer.fromJson(json.formula);\n    }\n    return {\n      ...createField(json),\n      fieldType: AjfFieldType.Formula,\n    };\n  }\n\n  private static _nodeGroupFromJson(\n      json: AjfNodeCreate&Partial<AjfNodeGroup>,\n      choicesOrigins?: AjfChoicesOrigin<any>[],\n      attachmentsOrigins?: AjfAttachmentsOrigin<any>[],\n      ): AjfNodeGroup {\n    return createNodeGroup({\n      ...AjfNodeSerializer._containerNodeFromJson(json, choicesOrigins, attachmentsOrigins),\n      ...AjfNodeSerializer._repeatingNodeFromJson(json),\n    });\n  }\n\n  private static _repeatingNodeFromJson(json: AjfNodeCreate&\n                                        Partial<AjfRepeatingNode>): AjfRepeatingNode {\n    if (json.formulaReps) {\n      json.formulaReps = AjfFormulaSerializer.fromJson(json.formulaReps);\n    }\n    return createRepeatingNode(json);\n  }\n\n  private static _repeatingSlideFromJson(\n      json: AjfNodeCreate&Partial<AjfRepeatingSlide>,\n      choicesOrigins?: AjfChoicesOrigin<any>[],\n      attachmentsOrigins?: AjfAttachmentsOrigin<any>[],\n      ): AjfRepeatingSlide {\n    return createRepeatingSlide({\n      ...AjfNodeSerializer._containerNodeFromJson(json, choicesOrigins, attachmentsOrigins),\n      ...AjfNodeSerializer._repeatingNodeFromJson(json),\n    });\n  }\n\n  private static _slideFromJson(\n      json: AjfNodeCreate&Partial<AjfSlide>,\n      choicesOrigins?: AjfChoicesOrigin<any>[],\n      attachmentsOrigins?: AjfAttachmentsOrigin<any>[],\n      ): AjfSlide {\n    return createSlide(\n        AjfNodeSerializer._containerNodeFromJson(json, choicesOrigins, attachmentsOrigins));\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '@ajf/core/models';\nimport {deepCopy} from '@ajf/core/utils';\nimport {AjfForm} from '../interface/forms/form';\nimport {AjfRepeatingSlide} from '../interface/slides/repeating-slide';\nimport {AjfSlide} from '../interface/slides/slide';\nimport {AjfAttachmentsOriginSerializer} from './attachments-origin-serializer';\nimport {AjfChoicesOriginSerializer} from './choices-origin-serializer';\nimport {AjfNodeSerializer} from './node-serializer';\n\nexport class AjfFormSerializer {\n  static fromJson(form: Partial<AjfForm>, context?: AjfContext): AjfForm {\n    const choicesOrigins =\n        (form.choicesOrigins || []).map(c => AjfChoicesOriginSerializer.fromJson(c));\n    const attachmentsOrigins =\n        (form.attachmentsOrigins || []).map(a => AjfAttachmentsOriginSerializer.fromJson(a));\n    const nodes =\n        (form.nodes || [])\n            .map(n => AjfNodeSerializer.fromJson(n, choicesOrigins, attachmentsOrigins)) as (\n            AjfRepeatingSlide | AjfSlide)[];\n    return {\n      ...form,\n      choicesOrigins,\n      attachmentsOrigins,\n      nodes,\n      stringIdentifier: form.stringIdentifier || [],\n      initContext: deepCopy(context || {}),\n    };\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ChangeDetectorRef, Inject} from '@angular/core';\n\nimport {AjfBaseFieldComponent} from './base-field';\nimport {AjfFormRendererService} from './form-renderer';\nimport {AjfTableFieldInstance} from './interface/fields-instances/table-field-instance';\nimport {AjfTableFormControl} from './interface/forms/table-form-control';\nimport {AJF_WARNING_ALERT_SERVICE, AjfWarningAlertService} from './warning-alert-service';\n\nexport abstract class AjfTableFieldComponent extends AjfBaseFieldComponent<AjfTableFieldInstance> {\n  constructor(\n      cdr: ChangeDetectorRef, service: AjfFormRendererService,\n      @Inject(AJF_WARNING_ALERT_SERVICE) was: AjfWarningAlertService) {\n    super(cdr, service, was);\n  }\n\n  goToNextCell(ev: Event, row: number, column: number): void {\n    if (this.instance.controls.length < row ||\n        (this.instance.controls.length >= row && this.instance.controls[row].length < 1) ||\n        this.instance.controls[row][1].length < column) {\n      return;\n    }\n    const rowLength = this.instance.controls[row][1].length;\n    const currentCell = this.instance.controls[row][1][column] as AjfTableFormControl;\n    if (column + 1 >= rowLength) {\n      column = 0;\n      if (row + 1 >= this.instance.controls.length) {\n        row = 1;\n      } else {\n        row += 1;\n      }\n    } else {\n      column += 1;\n    }\n    if (typeof currentCell !== 'string') {\n      currentCell.show = false;\n    }\n    this._showCell(row, column);\n    ev.preventDefault();\n    ev.stopPropagation();\n  }\n\n  goToCell(row: number, column: number): void {\n    this._resetControls();\n    this._showCell(row, column);\n  }\n\n  private _resetControls(): void {\n    this.instance.controls.forEach(row => row[1].forEach(cell => {\n      if (typeof cell !== 'string') {\n        (cell as AjfTableFormControl).show = false;\n      }\n    }));\n  }\n\n  private _showCell(row: number, column: number): void {\n    if (row >= this.instance.controls.length || column >= this.instance.controls[row][1].length) {\n      return;\n    }\n    const nextCell = this.instance.controls[row][1][column] as AjfTableFormControl;\n    if (typeof nextCell !== 'string') {\n      nextCell.show = true;\n    }\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfChoicesFixedOrigin} from '../../interface/choices/choices-fixed-origin';\nimport {AjfChoicesOriginCreate, createChoicesOrigin} from './create-choices-origin';\n\nexport type AjfChoicesFixedOriginCreate<T> =\n    Omit<AjfChoicesOriginCreate<T>, 'type'>&Partial<AjfChoicesFixedOrigin<T>>;\n\nexport function createChoicesFixedOrigin<T = string | number>(\n    origin: AjfChoicesFixedOriginCreate<T>): AjfChoicesFixedOrigin<T> {\n  const type = 'fixed';\n  return {...createChoicesOrigin({...origin, type}), type};\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfChoicesFunctionOrigin} from '../../interface/choices/choices-function-origin';\nimport {AjfChoicesOriginCreate} from './create-choices-origin';\n\nexport type AjfChoicesFunctionOriginCreate<T> = Omit<AjfChoicesOriginCreate<T>, 'type'>&\n    Pick<AjfChoicesFunctionOrigin<T>, 'generator'>&Partial<AjfChoicesFunctionOrigin<T>>;\n\nexport function createChoicesFunctionOrigin<T>(origin: AjfChoicesFunctionOriginCreate<T>):\n    AjfChoicesFunctionOrigin<T> {\n  return {\n    ...origin,\n    type: 'function',\n    label: origin.label || '',\n    choices: origin.choices || [],\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {\n  AjfChoicesObservableArrayOrigin\n} from '../../interface/choices/choices-observable-array-origin';\nimport {AjfChoicesOriginCreate} from './create-choices-origin';\n\nexport type AjfChoicesObservableArrayOriginCreate<T> =\n    Omit<AjfChoicesOriginCreate<T>, 'type'>&Pick<AjfChoicesObservableArrayOrigin<T>, 'generator'>&\n    Partial<AjfChoicesObservableArrayOrigin<T>>;\n\nexport function createChoicesObservableArrayOrigin<T>(\n    origin: AjfChoicesObservableArrayOriginCreate<T>): AjfChoicesObservableArrayOrigin<T> {\n  return {\n    ...origin,\n    type: 'observableArray',\n    label: origin.label || '',\n    choices: origin.choices || [],\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfChoicesObservableOrigin} from '../../interface/choices/choices-observable-origin';\nimport {AjfChoicesOriginCreate} from './create-choices-origin';\n\nexport type AjfChoicesObservableOriginCreate<T> = Omit<AjfChoicesOriginCreate<T>, 'type'>&\n    Pick<AjfChoicesObservableOrigin<T>, 'generator'>&Partial<AjfChoicesObservableOrigin<T>>;\n\nexport function createChoicesObservableOrigin<T>(origin: AjfChoicesObservableOriginCreate<T>):\n    AjfChoicesObservableOrigin<T> {\n  return {\n    ...origin,\n    type: 'observable',\n    label: origin.label || '',\n    choices: origin.choices || [],\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfChoicesPromiseOrigin} from '../../interface/choices/choices-promise-origin';\nimport {AjfChoicesOriginCreate} from './create-choices-origin';\n\nexport type AjfChoicesPromiseOriginCreate<T> = Omit<AjfChoicesOriginCreate<T>, 'type'>&\n    Pick<AjfChoicesPromiseOrigin<T>, 'generator'>&Partial<AjfChoicesPromiseOrigin<T>>;\n\nexport function createChoicesPromiseOrigin<T>(origin: AjfChoicesPromiseOriginCreate<T>):\n    AjfChoicesPromiseOrigin<T> {\n  return {\n    ...origin,\n    type: 'promise',\n    label: origin.label || '',\n    choices: origin.choices || [],\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport function isChoicesOrigin(co: any): boolean {\n  return co != null && typeof co === 'object' && co.name != null && typeof co.name === 'string' &&\n      co.label != null && typeof co.label === 'string' &&\n      ['fixed', 'promise', 'observable', 'observableArray', 'function'].indexOf(co.type) > -1 &&\n      co.choices instanceof Array;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfChoicesOrigin} from '../../interface/choices/choices-origin';\nimport {isChoicesOrigin} from './is-choices-origin';\n\nexport function isChoicesFixedOrigin(origin: AjfChoicesOrigin<any>): boolean {\n  return isChoicesOrigin(origin) && origin.type === 'fixed';\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfField} from '../../interface/fields/field';\nimport {AjfFieldType} from '../../interface/fields/field-type';\n\nexport function isNumberField(field: AjfField): boolean {\n  return field.fieldType === AjfFieldType.Number;\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfForm} from '../../interface/forms/form';\nimport {AjfFormStringIdentifier} from '../../interface/forms/form-string-identifier';\n\nexport type AjfFormCreate = Partial<AjfForm>;\n\nexport function createForm(form: AjfFormCreate = {}): AjfForm {\n  return {\n    nodes: form.nodes || [],\n    choicesOrigins: form.choicesOrigins || [],\n    attachmentsOrigins: form.attachmentsOrigins || [],\n    initContext: form.initContext || {},\n    stringIdentifier: form.stringIdentifier || [] as AjfFormStringIdentifier[],\n    supplementaryInformations: form.supplementaryInformations,\n  };\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfValidation} from '../../interface/validation/validation';\nimport {createValidation} from './create-validation';\n\nexport function maxDigitsValidation(maxValue: number): AjfValidation {\n  return createValidation({\n    condition: `$value ? $value.toString().length <= ${maxValue.toString()} : false`,\n    errorMessage: 'Digits count must be <= ' + maxValue.toString()\n  });\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfValidation} from '../../interface/validation/validation';\nimport {createValidation} from './create-validation';\n\nexport function maxValidation(maxValue: number): AjfValidation {\n  return createValidation({\n    condition: '$value <= ' + maxValue.toString(),\n    errorMessage: 'Value must be <= ' + maxValue.toString()\n  });\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfValidation} from '../../interface/validation/validation';\nimport {createValidation} from './create-validation';\n\nexport function minDigitsValidation(minValue: number): AjfValidation {\n  return createValidation({\n    condition: `$value ? $value.toString().length >= ${minValue.toString()} : false`,\n    errorMessage: 'Digits count must be >= ' + minValue.toString()\n  });\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfValidation} from '../../interface/validation/validation';\nimport {createValidation} from './create-validation';\n\nexport function minValidation(minValue: number): AjfValidation {\n  return createValidation({\n    condition: '$value >= ' + minValue.toString(),\n    errorMessage: 'Value must be >= ' + minValue.toString()\n  });\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfValidation} from '../../interface/validation/validation';\nimport {createValidation} from './create-validation';\n\nexport function notEmptyValidation(): AjfValidation {\n  return createValidation({condition: `notEmpty($value)`, errorMessage: `Value must not be empty`});\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfWarning} from '../../interface/warning/warning';\nimport {createWarning} from './create-warning';\n\nexport function notEmptyWarning(): AjfWarning {\n  return createWarning({condition: 'notEmpty($value)', warningMessage: 'Value must not be empty'});\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport * from './as-field-instance';\nexport * from './as-repeating-slide-instance';\nexport * from './base-field';\nexport * from './bool-to-int';\nexport * from './date-value';\nexport * from './date-value-string';\nexport * from './errors';\nexport * from './expand-input-with-choices';\nexport * from './field';\nexport * from './field-host';\nexport * from './field-icon';\nexport * from './field-is-valid';\nexport * from './field-service';\nexport * from './field-utils';\nexport * from './field-warning-alert-result';\nexport * from './field-with-choices';\nexport * from './file-field';\nexport * from './form';\nexport * from './form-renderer';\nexport * from './form-string-identifier';\nexport * from './forms-module';\nexport * from './get-table-cell-control';\nexport * from './get-type-name';\nexport * from './increment';\nexport * from './input-field';\nexport * from './image-field';\nexport * from './is-cell-editable';\nexport * from './is-readonly-input-field';\nexport * from './is-repeating-slide';\nexport * from './node-complete-name';\nexport * from './range';\nexport * from './read-only-file-field';\nexport * from './read-only-image-field';\nexport * from './read-only-select-field';\nexport * from './read-only-video-url-field';\nexport * from './search-alert-threshold';\nexport * from './serializers/attachments-origin-serializer';\nexport * from './serializers/choices-origin-serializer';\nexport * from './serializers/form-serializer';\nexport * from './serializers/node-serializer';\nexport * from './serializers/validation-group-serializer';\nexport * from './serializers/warning-group-serializer';\nexport * from './table-field';\nexport * from './table-row-class';\nexport * from './table-visible-columns';\nexport * from './valid-slide';\nexport * from './validation-service';\nexport * from './video-url-field';\nexport * from './warning-alert-service';\n\nexport * from './read-only-field';\nexport * from './read-only-table-field';\n\nexport * from './interface/attachments/attachment';\nexport * from './interface/attachments/attachments-fixed-origin';\nexport * from './interface/attachments/attachments-origin';\nexport * from './interface/attachments/attachments-type';\nexport * from './interface/choices/choice';\nexport * from './interface/choices/choices-fixed-origin';\nexport * from './interface/choices/choices-function';\nexport * from './interface/choices/choices-function-origin';\nexport * from './interface/choices/choices-observable-array-origin';\nexport * from './interface/choices/choices-observable-origin';\nexport * from './interface/choices/choices-origin';\nexport * from './interface/choices/choices-origin-type';\nexport * from './interface/choices/choices-promise-origin';\nexport * from './interface/choices/choices-type';\nexport * from './interface/fields/boolean-field';\nexport * from './interface/fields/date-field';\nexport * from './interface/fields/date-input-field';\nexport * from './interface/fields/empty-field';\nexport * from './interface/fields/field';\nexport * from './interface/fields/field-components-map';\nexport * from './interface/fields/field-size';\nexport * from './interface/fields/field-type';\nexport * from './interface/fields/field-with-choices';\nexport * from './interface/fields/file-field';\nexport * from './interface/fields/formula-field';\nexport * from './interface/fields/multiple-choice-field';\nexport * from './interface/fields/number-field';\nexport * from './interface/fields/single-choice-field';\nexport * from './interface/fields/string-field';\nexport * from './interface/fields/table-field';\nexport * from './interface/fields/text-field';\nexport * from './interface/fields/time-field';\nexport * from './interface/fields-instances/date-field-instance';\nexport * from './interface/fields-instances/date-input-field-instance';\nexport * from './interface/fields-instances/empty-field-instance';\nexport * from './interface/fields-instances/field-instance';\nexport * from './interface/fields-instances/field-state';\nexport * from './interface/fields-instances/field-with-choices-instance';\nexport * from './interface/fields-instances/formula-field-instance';\nexport * from './interface/fields-instances/table-field-instance';\nexport * from './interface/forms/form';\nexport * from './interface/forms/form-string-identifier';\nexport * from './interface/nodes/container-node';\nexport * from './interface/nodes/node';\nexport * from './interface/nodes/node-group';\nexport * from './interface/nodes/node-link';\nexport * from './interface/nodes/node-type';\nexport * from './interface/nodes/repeating-container-node';\nexport * from './interface/nodes/repeating-node';\nexport * from './interface/nodes-instances/container-node-instance';\nexport * from './interface/nodes-instances/node-group-instance';\nexport * from './interface/nodes-instances/node-instance';\nexport * from './interface/nodes-instances/repeating-container-node-instance';\nexport * from './interface/nodes-instances/repeating-node-instance';\nexport * from './interface/operations/nodes-instances-operation';\nexport * from './interface/operations/nodes-operation';\nexport * from './interface/operations/renderer-update-map-operation';\nexport * from './interface/renderer-maps/update-map';\nexport * from './interface/slides/repeating-slide';\nexport * from './interface/slides/slide';\nexport * from './interface/slides-instances/base-slide-instance';\nexport * from './interface/slides-instances/repeating-slide-instance';\nexport * from './interface/slides-instances/slide-instance';\nexport * from './interface/validation/validation';\nexport * from './interface/validation/validation-group';\nexport * from './interface/validation/validation-results';\nexport * from './interface/warning/warning';\nexport * from './interface/warning/warning-group';\nexport * from './interface/warning/warning-result';\n\nexport * from './utils/choices/create-choices-fixed-origin';\nexport * from './utils/choices/create-choices-function-origin';\nexport * from './utils/choices/create-choices-observable-array-origin';\nexport * from './utils/choices/create-choices-observable-origin';\nexport * from './utils/choices/create-choices-origin';\nexport * from './utils/choices/create-choices-promise-origin';\nexport * from './utils/choices/init-choices-origin';\nexport * from './utils/choices/is-choices-fixed-origin';\nexport * from './utils/choices/is-choices-origin';\nexport * from './utils/fields/create-field';\nexport * from './utils/fields/is-custom-field-with-choices';\nexport * from './utils/fields/is-field-with-choices';\nexport * from './utils/fields/is-number-field';\nexport * from './utils/fields-instances/create-field-instance';\nexport * from './utils/fields-instances/create-field-with-choices-instance';\nexport * from './utils/forms/build-form-string-identifier';\nexport * from './utils/forms/create-form';\nexport * from './utils/nodes/create-container-node';\nexport * from './utils/nodes/create-node';\nexport * from './utils/nodes/flatten-nodes';\nexport * from './utils/nodes/is-container-node';\nexport * from './utils/nodes/is-field';\nexport * from './utils/nodes/is-repeating-container-node';\nexport * from './utils/nodes/is-slides-node';\nexport * from './utils/nodes-instances/create-node-instance';\nexport * from './utils/validation/create-validation';\nexport * from './utils/validation/create-validation-group';\nexport * from './utils/warning/create-warning';\nexport * from './utils/warning/create-warning-group';\nexport * from './utils/validation/max-digits-validation';\nexport * from './utils/validation/max-validation';\nexport * from './utils/validation/min-digits-validation';\nexport * from './utils/validation/min-validation';\nexport * from './utils/validation/not-empty-validation';\nexport * from './utils/warning/not-empty-warning';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n\nexport {componentsMap as ɵgc_ajf_src_core_forms_forms_d} from './utils/fields/fields-map';\nexport {createNodeGroup as ɵgc_ajf_src_core_forms_forms_a} from './utils/nodes/create-node-group';\nexport {createRepeatingSlide as ɵgc_ajf_src_core_forms_forms_b} from './utils/slides/create-repeating-slide';\nexport {createSlide as ɵgc_ajf_src_core_forms_forms_c} from './utils/slides/create-slide';"],"names":["Pipe","AjfFieldType","AjfNodeType","evaluateExpression","deepCopy","alwaysCondition","EventEmitter","normalizeExpression","createCondition","createFormula","AjfExpressionUtils","Injectable","Subject","BehaviorSubject","Subscription","Observable","map","withLatestFrom","filter","publishReplay","refCount","startWith","scan","share","FormGroup","switchMap","obsOf","from","FormControl","pairwise","debounceTime","timer","tokenize","defer","Directive","ChangeDetectorRef","format","AjfError","ViewContainerRef","coerceBooleanProperty","ComponentFactoryResolver","ViewChild","Input","InjectionToken","Component","ChangeDetectionStrategy","ViewEncapsulation","Inject","delayWhen","Output","ViewChildren","buildStringIdentifierOpts","buildStringIdentifier","shareReplay","DomSanitizer","CoreComponent","fileIcon","HttpClient","catchError","NgModule","AjfCommonModule","AjfFileInputModule","CommonModule","HttpClientModule","ReactiveFormsModule","TranslateModule","AjfConditionSerializer","AjfFormulaSerializer"],"mappings":"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"}