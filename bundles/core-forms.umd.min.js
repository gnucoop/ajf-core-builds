!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("@angular/core"),require("@angular/forms"),require("rxjs"),require("rxjs/operators"),require("date-fns"),require("@ajf/core/models"),require("@angular/cdk/coercion"),require("@ajf/core/page-slider"),require("@ajf/core/utils"),require("esprima"),require("@ajf/core/common"),require("@angular/common")):"function"==typeof define&&define.amd?define("@ajf/core/forms",["exports","@angular/core","@angular/forms","rxjs","rxjs/operators","date-fns","@ajf/core/models","@angular/cdk/coercion","@ajf/core/page-slider","@ajf/core/utils","esprima","@ajf/core/common","@angular/common"],n):n(((e=e||self).ajf=e.ajf||{},e.ajf.core=e.ajf.core||{},e.ajf.core.forms={}),e.ng.core,e.ng.forms,e.rxjs,e.rxjs.operators,e.dateFns,e.ng.core.models,e.ng.cdk.coercion,0,e.ng.core.utils,e.esprima,e.ng.core.common,e.ng.common)}(this,(function(e,n,t,o,r,i,a,s,u,l,c,d,p){"use strict";var f="default"in c?c.default:c,h=function(){function e(){}return e.prototype.transform=function(e){return e},e.decorators=[{type:n.Pipe,args:[{name:"ajfAsFieldInstance"}]}],e}(),m=function(){function e(){}return e.prototype.transform=function(e){return e},e.decorators=[{type:n.Pipe,args:[{name:"ajfAsRepeatingSlideInstance"}]}],e}(),v=function(){function e(e,n,i){var a=this;this._changeDetectorRef=e,this._service=n,this._warningAlertService=i,this._warningTriggerSub=o.Subscription.EMPTY,this._instanceUpdateSub=o.Subscription.EMPTY,this._control=o.defer((function(){return a._service.getControl(a.instance).pipe(r.map((function(e){return e||new t.FormControl})))}))}return Object.defineProperty(e.prototype,"instance",{get:function(){return this._instance},set:function(e){e!==this._instance&&(this._instance=e,this._setUpInstanceUpdate(),this._onInstanceChange())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"control",{get:function(){return this._control},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){var e=this;this._warningTriggerSub=this.instance.warningTrigger.pipe(r.withLatestFrom(this.control),r.filter((function(e){return null!=e[1]}))).subscribe((function(n){if(null!=e.instance.warningResults)var t=n[1],o=e._warningAlertService.showWarningAlertPrompt(e.instance.warningResults.filter((function(e){return e.result})).map((function(e){return e.warning}))).subscribe((function(e){e.result&&t.setValue(null)}),(function(e){o&&o.unsubscribe()}),(function(){o&&o.unsubscribe()}))}))},e.prototype.ngOnDestroy=function(){this._warningTriggerSub.unsubscribe(),this._instanceUpdateSub.unsubscribe()},e.prototype._onInstanceChange=function(){},e.prototype._setUpInstanceUpdate=function(){var e=this;this._instanceUpdateSub.unsubscribe(),this._instanceUpdateSub=null!=this._instance?this._instance.updatedEvt.subscribe((function(){if(e._changeDetectorRef)try{e._changeDetectorRef.detectChanges()}catch(e){}})):o.Subscription.EMPTY,this._changeDetectorRef.detectChanges()},e}(),y=function(){function e(){}return e.prototype.transform=function(e){return e?1:0},e.decorators=[{type:n.Pipe,args:[{name:"ajfBoolToInt"}]}],e}(),g=function(){function e(){}return e.prototype.transform=function(e){return null==e?null:"today"===e?new Date:e},e.decorators=[{type:n.Pipe,args:[{name:"ajfDateValue"}]}],e}(),_=function(){function e(){}return e.prototype.transform=function(e){if(null!=e){var n="today"===e?new Date:e;return i.format(n,"yyyy-MM-dd")}},e.decorators=[{type:n.Injectable},{type:n.Pipe,args:[{name:"ajfDateValueString"}]}],e}(),b=function(e,n){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(e,n)};
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function N(e,n){function t(){this.constructor=e}b(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}var j=function(){return(j=Object.assign||function e(n){for(var t,o=1,r=arguments.length;o<r;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}).apply(this,arguments)};function x(e,n){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var o,r,i=t.call(e),a=[];try{for(;(void 0===n||n-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(r)throw r.error}}return a}function C(){for(var e=[],n=0;n<arguments.length;n++)e=e.concat(x(arguments[n]));return e}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
var T,M=function(e){function n(n){return e.call(this,n)||this}return N(n,e),Object.defineProperty(n.prototype,"name",{get:function(){return"AjfInvalidFieldDefinitionError"},enumerable:!0,configurable:!0}),n}(a.AjfError),F=function(){function e(){}return e.prototype.transform=function(e,n){return!e.node.forceNarrow&&(e.node.forceExpanded||e.filteredChoices&&e.filteredChoices.length<=n)},e.decorators=[{type:n.Pipe,args:[{name:"ajfExpandFieldWithChoices"}]}],e}(),S=function(){function e(e){this.viewContainerRef=e}return e.decorators=[{type:n.Directive,args:[{selector:"[ajf-field-host]"}]}],e.ctorParameters=function(){return[{type:n.ViewContainerRef}]},e}(),w=function(){function e(e,n){this._cdr=e,this._cfr=n,this._init=!1,this._updatedSub=o.Subscription.EMPTY}return Object.defineProperty(e.prototype,"instance",{get:function(){return this._instance},set:function(e){this._instance!==e&&(this._instance=e,this._init&&this._loadComponent())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readonly",{get:function(){return this._readonly},set:function(e){this._readonly=s.coerceBooleanProperty(e),this._init&&this._loadComponent()},enumerable:!0,configurable:!0}),e.prototype.ngOnDestroy=function(){this._updatedSub.unsubscribe()},e.prototype.ngOnInit=function(){this._init=!0,this._loadComponent()},e.prototype._loadComponent=function(){var e=this;if(this._updatedSub.unsubscribe(),this._updatedSub=o.Subscription.EMPTY,null!=this._instance&&null!=this.fieldHost){var n=this.fieldHost.viewContainerRef;n.clear();var t=this.componentsMap[this._instance.node.fieldType];if(null!=t){var r=this._readonly&&t.readOnlyComponent?t.readOnlyComponent:t.component;try{var i=this._cfr.resolveComponentFactory(r),a=n.createComponent(i);this._componentInstance=a.instance,this._componentInstance.instance=this._instance,t.inputs&&Object.keys(t.inputs).forEach((function(n){n in e._componentInstance&&(e._componentInstance[n]=t.inputs[n])})),this._updatedSub=this._instance.updatedEvt.subscribe((function(){return e._cdr.markForCheck()}))}catch(e){console.log(e)}}}},e.decorators=[{type:n.Directive}],e.ctorParameters=function(){return[{type:n.ChangeDetectorRef},{type:n.ComponentFactoryResolver}]},e.propDecorators={fieldHost:[{type:n.ViewChild,args:[S,{static:!0}]}],instance:[{type:n.Input}],readonly:[{type:n.Input}]},e}();
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function A(n){return"ajf-icon-field-"+("string"==typeof e.AjfFieldType[n]?e.AjfFieldType[n].toLowerCase():n)}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */(
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
T=e.AjfFieldType||(e.AjfFieldType={}))[T.String=0]="String",T[T.Text=1]="Text",T[T.Number=2]="Number",T[T.Boolean=3]="Boolean",T[T.SingleChoice=4]="SingleChoice",T[T.MultipleChoice=5]="MultipleChoice",T[T.Formula=6]="Formula",T[T.Empty=7]="Empty",T[T.Date=8]="Date",T[T.DateInput=9]="DateInput",T[T.Time=10]="Time",T[T.Table=11]="Table",T[T.Geolocation=12]="Geolocation",T[T.Barcode=13]="Barcode",T[T.LENGTH=14]="LENGTH";var E,I=function(){function e(){}return e.prototype.transform=function(e){return A(e.fieldType?e.fieldType:e)},e.decorators=[{type:n.Pipe,args:[{name:"ajfFieldIcon"}]}],e}(),R=function(){function e(){}return e.prototype.transform=function(e){return null!=e&&0===e.filter((function(e){return!e.result})).length},e.decorators=[{type:n.Pipe,args:[{name:"ajfFieldIsValid"}]}],e}(),V={},O=function(){function e(){this.componentsMap=V}return e.prototype.registerCustomField=function(e){var n=e.fieldType,t=e.component;if(n<100)throw new Error("Invalid custom field type, it must be greater than 100");if(null==t)throw new Error("Invalid custom field component");this.componentsMap[n]=e},e}(),P=function(e){function n(n,t,o,r){var i=e.call(this,n,t,o)||this;return i._searchThreshold=6,null!=r&&(i._searchThreshold=r),i}return N(n,e),Object.defineProperty(n.prototype,"searchThreshold",{get:function(){return this._searchThreshold},enumerable:!0,configurable:!0}),n}(v);
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function D(e){if("fixed"===e.type)return Promise.resolve();if("function"===e.type)return e.choices=e.generator(),Promise.resolve();if("promise"===e.type){var n=e;return n.generator.then((function(e){return n.choices=e})).then()}if("observable"===e.type){var t=e;if(null!=t.generator)return t.choices=[],new Promise((function(e){t.generator.subscribe((function(e){return t.choices.push(e)}),(function(){}),(function(){return e()}))}))}if("observableArray"===e.type){var o=e;if(null!=o.generator)return o.choices=[],new Promise((function(e){o.generator.subscribe((function(n){o.choices=n,e()}))}))}return Promise.resolve()}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function U(n){return n.fieldType===e.AjfFieldType.SingleChoice||n.fieldType===e.AjfFieldType.MultipleChoice}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function B(n){return null!=n&&n.nodeType===e.AjfNodeType.AjfField}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function k(e){return null!=e&&null!=e.node&&B(e.node)}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function G(e){return null!=e&&k(e)&&U(e.node)}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function J(e,n){var t=e.conditionalBranches;if(null!=t){for(var o=e.verifiedBranch,r=0,i=!1;r<t.length&&!i;)a.evaluateExpression(t[r].condition,n)&&(i=!0,r!==e.verifiedBranch&&(e.verifiedBranch=r)),r++;if(o!==e.verifiedBranch)return!0}return!1}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function W(e,n,t){if(void 0===t&&(t=!0),null==e.visibility)return e.visible=!1,!1;var o=e.visible,r=t&&a.evaluateExpression(e.visibility.condition,n);return r!==e.visible&&(e.visible=r),o!==r}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function L(e){return null==e.prefix||0==e.prefix.length?"":"__"+e.prefix.join("__")}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function $(e){return null!=e&&null!=e.node?""+e.node.name+L(e):""}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function z(e,n){var t=e.formula,o=e.node.editable;if(null!=t&&e.visible&&(!o||o&&null==e.value)){var r=a.evaluateExpression(t.formula,n),i=e.value;return r!==e.value&&(e.value=r,n[$(e)]=e.value,n.$value=e.value),{changed:r!==i,value:r}}return{changed:!1,value:e.value}}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function H(e,n){return null!=e.nextSlideCondition&&a.evaluateExpression(e.nextSlideCondition.condition,n)}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function q(e,n,t){return{result:a.evaluateExpression(e.condition,n,t),error:e.errorMessage,clientValidation:e.clientValidation}}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function Y(e,n,t){var o=e.validation;if(null!=o){t&&Object.keys(t).forEach((function(e){n["__supplementary__"+e+"__"]=t[e]}));var r=$(e);null!=n[r]&&o&&o.forceValue&&(e.value=a.evaluateExpression(o.forceValue.condition,n),n[r]=e.value,n.$value=e.value),e.validationResults=
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function i(e,n,t){var o=[],r=l.deepCopy(t);if(r.$value=n,o=function i(e,n){var t=[];return e.conditions.forEach((function(e){t.push(q(e,n))})),t}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */(e,r),e.maxValue){var s=
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function u(e,n){return null==e.maxValue?null:"number"==typeof e.maxValue?{result:a.evaluateExpression("$value.length <= "+e.maxValue,{$value:n}),error:"Value must be <= "+e.maxValue,clientValidation:!1}:q(e.maxValue,{$value:n})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */(e,n);null!=s&&o.push(s)}if(e.minValue){var c=
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function d(e,n){return null==e.minValue?null:"number"==typeof e.minValue?{result:a.evaluateExpression("$value.length <= "+e.minValue,{$value:n}),error:"Value must be >= "+e.minValue,clientValidation:!1}:q(e.minValue,{$value:n})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */(e,n);null!=c&&o.push(c)}if(e.notEmpty){var p=function f(e,n){if(null==e.notEmpty)return null;var t={$value:n};return"boolean"==typeof e.notEmpty?{result:a.evaluateExpression("($value != null) === "+e.notEmpty,t),error:"Value must not be empty",clientValidation:!1}:q(e.notEmpty,t)}(e,n);null!=p&&o.push(p)}if(e.maxDigits){var h=function m(e,n){if(null==e.maxDigits)return null;var t={$value:n};return"number"==typeof e.maxDigits?{result:a.evaluateExpression("$value.toString().length <= "+e.maxDigits,t),error:"Digits count must be <= "+e.maxDigits,clientValidation:!1}:q(e.maxDigits,t)}(e,n);null!=h&&o.push(h)}if(e.minDigits){var v=function y(e,n){if(null==e.minDigits)return null;var t={$value:n};return"number"==typeof e.minDigits?{result:a.evaluateExpression("$value.toString().length >= "+e.minDigits,t),error:"Digits count must be >= "+e.minDigits,clientValidation:!1}:q(e.minDigits,t)}(e,n);null!=v&&o.push(v)}return o}(o,n[r],n),e.valid=e.validationResults.reduce((function(e,n){return e&&n.result}),!0)}else e.valid=!0}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function Z(e,n){var t=e.warning;null!=t&&null!=n[$(e)]&&t&&(e.warningResults=
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function o(e,n){
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
return function t(e,n){return e.conditions.map((function(e){return function t(e,n,o){return{result:a.evaluateExpression(e.condition,n,o),warning:e.warningMessage}}(e,n)}))}(e,n)}(t,n))}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function K(e,n){e.filteredChoices=null!=e.choicesFilter?e.node.choicesOrigin.choices.filter((function(t){return n.$choice=t,n.$choiceValue=t.value,a.evaluateExpression(e.choicesFilter.formula,n)})):e.node.choicesOrigin.choices}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function Q(e){var n=null!=e.conditionalBranches&&e.conditionalBranches.length>0?e.conditionalBranches:[a.alwaysCondition()];return j(j({},e),{parentNode:null!=e.parentNode?e.parentNode:0,label:e.label||"",visibility:e.visibility||a.alwaysCondition(),conditionalBranches:n})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function X(n){var t=Q(j(j({},n),{nodeType:e.AjfNodeType.AjfField})),o=null!=n.editable?n.editable:n.fieldType!==e.AjfFieldType.Formula&&n.fieldType!==e.AjfFieldType.Table;return j(j(j({},t),n),{nodeType:e.AjfNodeType.AjfField,editable:o,defaultValue:null!=n.defaultValue?n.defaultValue:null,size:n.size||"normal"})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function ee(e){return e.fieldType>100&&null!=V[e.fieldType]&&!0===V[e.fieldType].isFieldWithChoice}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function ne(n){return null!=n&&(n.nodeType===e.AjfNodeType.AjfRepeatingSlide||n.nodeType===e.AjfNodeType.AjfSlide)}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function te(n){return null!=n&&(n.nodeType===e.AjfNodeType.AjfNodeGroup||ne(n))}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function oe(e,n){void 0===n&&(n=!1);var t=[];return e.forEach((function(e){k(e)&&t.push(e),function o(e){return null!=e&&null!=e.node&&te(e.node)}(e)&&(n&&t.push(e),t=t.concat(oe(e.nodes,n)))})),t}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function re(e){return null!=e&&null!=e.node&&ne(e.node)}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function ie(n){return null!=n&&null!=n.node&&
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function t(n){return null!=n&&n.nodeType===e.AjfNodeType.AjfNodeGroup}(n.node)}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function ae(e){return{node:e.node,prefix:e.prefix?C(e.prefix):[],visible:null==e.visible||e.visible,conditionalBranches:[],updatedEvt:new n.EventEmitter}}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function se(e,t){var o=ae(e),r=null;if(null!=o.node&&null!=t){var i=$(o);null!=t[o.node.name]?r=t[o.node.name]:null!=t[i]&&(r=t[i])}return j(j({},o),{node:e.node,value:r,valid:!1,defaultValue:null!=e.defaultValue?e.defaultValue:null,validationResults:e.validationResults||[],warningResults:e.warningResults||[],warningTrigger:new n.EventEmitter})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function ue(e,t){var o=se(e,t);return j(j({},o),{node:e.node,filteredChoices:C(e.node.choices),firstTriggerConditionDone:{},selectionTrigger:new n.EventEmitter})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function le(e){var n=ae(e);return j(j({},n),{node:e.node,nodes:[],slideNodes:[],flatNodes:[],valid:!1,position:0})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function ce(e){return j(j({},e),{conditions:e.conditions||[]})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function de(e){return j(j({},e),{conditions:e.conditions||[]})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function pe(n){return null!=n&&(n.nodeType===e.AjfNodeType.AjfNodeGroup||n.nodeType===e.AjfNodeType.AjfRepeatingSlide)}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function fe(e,n,t){var o=e.condition,r=a.normalizeExpression(o,n,t);return r===o?e:{condition:r}}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function he(e,n,t){var o=!1,r=e.map((function(e){var r=fe(e,n,t);return r!==e&&(o=!0),r}));return o?r:e}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function me(e,n,t){var o=e.formula,r=a.normalizeExpression(o,n,t);return r===o?e:{formula:r}}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function ve(e){return j(j({},e),{clientValidation:e.clientValidation||!1,errorMessage:e.errorMessage||"Undefined Error"})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function ye(e){return j(j({},e),{warningMessage:e.warningMessage||"Undefined Warning"})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function ge(n){return null!=n&&null!=n.node&&re(n)&&
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function t(n){return null!=n&&n.nodeType===e.AjfNodeType.AjfRepeatingSlide}(n.node)}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function _e(e){var n=[];return e.forEach((function(e){n.push(e),te(e)&&(n=n.concat(_e(e.nodes)))})),n}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function be(e,n){var t=[];return e.filter((function(e){return null!=n?e.parent==n:null==e.parent||0===e.parent})).sort((function(e,n){return e.parentNode-n.parentNode})).forEach((function(n){t.push(n),t=t.concat(be(e,n.id))})),t}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function Ne(e,n){var t=e.reps||0;if(n=n||{},null==e.node.formulaReps){var o=n[$(e)];null!=o?e.reps=o:0==t&&(e.reps=1)}else{var r=a.evaluateExpression(e.node.formulaReps.formula,n);r!==t&&(e.reps=r)}return e.canAdd=0===e.node.maxReps||e.reps<e.node.maxReps,e.canRemove=0===e.node.minReps||e.reps>e.node.minReps,t}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */(
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
E=e.AjfNodeType||(e.AjfNodeType={}))[E.AjfField=0]="AjfField",E[E.AjfFieldNodeLink=1]="AjfFieldNodeLink",E[E.AjfNodeGroup=2]="AjfNodeGroup",E[E.AjfSlide=3]="AjfSlide",E[E.AjfRepeatingSlide=4]="AjfRepeatingSlide",E[E.LENGTH=5]="LENGTH";
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
var je=function(){function e(){this._baseUtilFunctions=["/**\n        * count the number of digit contained on x.\n        * @param  x the value used for digit count\n        * @return the count of the digit\n      */\n    var digitCount = function(x) { return x.toString().length; }","/**\n        * count the number of decimal contained on x.\n        * @param  x the value used for decimal count\n        * @return the count of the decimal\n      */\n    var decimalCount = function(x) {\n      return (parseFloat(x).toString().split('.')[1] || []).length;\n    }","/**\n        * check if x is integer\n        * @param  x the value used for check\n        * @return true if x is a number\n      */\n    var isInt = function(x) { return !/[,.]/.test(x); }","/**\n        * check if x is not empity\n        * @param  x the value used for check\n        * @return true if x defined and not null and the number of digit is > 0\n      */\n    var notEmpty = function (x) {\n      return (typeof x !== 'undefined' && x !== null ? x.toString().length > 0 : false);\n    }","/**\n        * check if x is contained on array\n        * @param  x the value used for check\n        * @return the position of x on array or if array === x\n      */\n    var valueInChoice = function(array, x) { return array.indexOf(x) > -1 || array === x; }","var scanGroupField = function(reps, acc, callback) {\n        for (var i = 0; i < reps; i++) {\n            acc = callback(acc, i);\n        }\n        return acc;\n    }","/**\n        * sum the value contained on array\n        * @param  x the array\n        * @return the sum\n      */\n    var sum = function(array) {return array.reduce(function(a, b){ return a + b; }, 0); }","var dateOperations = function(dString, period, operation, v) {\n        fmt = 'mm/dd/yyyy';\n        var d = (typeof dString !== 'undefined') ? dateUtils.parse(dString) : new Date();\n        if (operation == 'remove') {\n          v = -v;\n        }\n        var dateOp;\n        switch (period) {\n          case 'day':\n            dateOp = dateUtils.addDays;\n            break;\n          case 'month':\n            dateOp = dateUtils.addMonths;\n            break;\n          case 'year':\n            dateOp = dateUtils.addYears;\n            break;\n          default:\n            return -1;\n        }\n        return dateUtils.format(dateOp(d, v), fmt);\n      }","/**\n        * round the num\n        * @param  num the value to round\n        * @param  digits how many digit\n        * @return num rounded\n      */\n      var round = function(num, digits) {\n        digits = digits || 0;\n        var f = 0;\n        try { f = parseFloat(num); } catch (e) { }\n        var m = Math.pow(10, digits);\n        return Math.round(f * m) / m;\n      }","/**\n        * extract the property of the source object with property != null\n        * @param  source array of object wich contains property\n        * @param  property the property on wich we want filter\n        * @return array of dates\n      */\n      var extractArray = function(source, property, property2) {\n        source = (source || []).slice(0);\n        var l = source.length;\n        var res = [];\n        for (var i = 0; i < l ; i++) {\n          if (source[i][property] != null && source[i][property2] != null) {\n            res.push(source[i][property] + source[i][property2]);\n          }\n          else if (source[i][property] != null) {\n            res.push(source[i][property]);\n          }\n        }\n        return res;\n      }","/**\n        * extract the property of the source object with property != null\n        * @param  source array of object wich contains property\n        * @param  propertues string array the properties to sum\n        * @return the sum\n      */\n      var extractSum = function(source, properties) {\n        var sum = 0;\n        properties = (properties || []).slice(0);\n        var l = properties.length;\n\n        for (var i = 0; i < l ; i++) {\n          var array = extractArray(source, properties[i]);\n          var leng = array.length;\n          for(var j = 0; j < leng; i++) {\n            sum += array[j];\n          }\n        }\n        return sum;\n      }","/**\n        * extract the array of sum for each week != null\n        * @param  source array of object wich contains property\n        * @param  propertues string array the properties to sum\n        * @return the sum\n      */\n      var extractArraySum = function(source, properties) {\n        var arrays = [];\n        properties = (properties || []).slice(0);\n\n        for (var propI = 0; propI < properties.length ; propI++) {\n          var array = extractArray(source, properties[propI]);\n          arrays.push(array);\n        }\n\n        var res = [];\n        for (var weekI = 0; weekI < array.length; weekI ++ ) {\n          var sum = 0;\n          for (var propI = 0; propI < properties.length ; propI++) {\n            sum = sum + arrays[propI][weekI]\n          }\n          res.push(sum);\n        }\n        return res;\n      }","/**\n        * draw a threshold line on chart related to the property\n        * @param  source array of object wich contains property\n        * @param  property the property on wich we want filter\n        * @return array of dates\n      */\n      var drawThreshold = function(source, property, threshold) {\n        source = (source || []).slice(0);\n        var l = source.length;\n        var res = [];\n        for (var i = 0; i < l ; i++) {\n          if (source[i][property] != null) {\n            res.push(threshold);\n          }\n        }\n        return res;\n      }",'/**\n        * extract the dates of the source object with property != null\n        * @param  source array of object wich contains property and date_start\n        * @param  property the property on wich we want to calculate dates\n        * @param  format the format of the date\n        * @return array of dates\n      */\n      var extractDates = function(source, property, format) {\n        source = (source || []).slice(0);\n        var l = source.length;\n        var res = [];\n        var prefix = \'\';\n        for (var i = 0; i < l ; i++) {\n          if (source[i][property] != null) {\n            switch(format) {\n              case "WW":\n                prefix = "W";\n                break;\n              case "mm":\n                prefix = "M";\n                break;\n              default:\n                prefix = "";\n            }\n            res.push(prefix + formatDate(source[i]["date_start"], format));\n          }\n        }\n        return res;\n      }',"/**\n        * extract the last property contains in source != null\n        * @param  source array of object wich contains property and date_start\n        * @param  property the property to find\n        * @return the last property != null\n      */\n      var lastProperty = function(source, property) {\n        source = (source || []).slice(0);\n        var l = source.length -1;\n\n        while (l >= 0 && source[l][property] == null) {\n          l--;\n          if (l < 0) return 0;\n        }\n        return l >= 0 ? source[l][property] : 0;\n      }","var sumLastProperties = function(source, properties) {\n        source = (source || []).slice(0);\n        var sum = 0;\n        for (var i = 0; i < properties.length; i++) {\n          sum += lastProperty(source, properties[i]);\n        }\n\n        return sum;\n      }",'/**\n        * compute the trend of the property contained on the source.\n        * @param  source array of object wich contains property\n        * @param  property the property on wich we want to calculate the trend\n        * @return an html icon that identifies the trend\n      */\n      var calculateTrendProperty = function(source, property) {\n        source = (source || []).slice(0);\n        var last = source.length - 1;\n        while (source[last][property] == null) {\n          if (last == 0) {\n            break;\n          }\n          last--;\n        }\n        var lastLast = last - 1;\n        if (last == 0) {\n          lastLast = last;\n        } else {\n          while (source[lastLast][property] == null) {\n            if (lastLast == 0) {\n              lastLast = last;\n              break;\n            }\n            lastLast--;\n          }\n        }\n\n        var lastProperty = source[last]?(source[last][property] || 0): 0;\n        var lastLastProperty = source[lastLast]?(source[lastLast][property] || 0): 0;\n\n        if (lastProperty == lastLastProperty) {\n          return \'<p><i class="material-icons" style="color:blue">trending_flat</i></p>\';\n        } else if (lastProperty > lastLastProperty) {\n          return \'<p><i class="material-icons" style="color:green">trending_up</i></p>\';\n        } else {\n          return \'<p><i class="material-icons" style="color:red">trending_down</i></p>\';\n        }\n      }',"/**\n        * compute the average value of the property contained on the source.\n        * @param  source array of object wich contains property\n        * @param  property the property on wich we want to calculate the average\n        * @param  range the range on wich we want to calculate the average\n        * @param  coefficent the coefficent used for calculate the threshold\n                  if coefficent is 0 mean return the count of property > 0\n        * @return the average value || the count of property > 0\n      */\n      var calculateAvgProperty = function(source, property, range, coefficient) {\n        source = (source || []).slice(0);\n\n        source.pop();\n\n        coefficient = coefficient || 1;\n        range = range || 12;\n\n        var l = source.length;\n        var res = 0;\n        var counter = 0;\n        var noZero = 0;\n\n        if(l < range) {\n          range = l;\n        }\n\n        while (range != 0) {\n          counter++;\n          if (source[l - 1][property] != null) {\n            res += source[l - 1][property];\n\n            if (source[l - 1][property] > 0) {\n              noZero++;\n            }\n          }\n          l--;\n          range--;\n        }\n\n        if (coefficient == 0) {\n          return noZero;\n        } else {\n          var threshold = (res/counter)*coefficient || 0;\n          return threshold;\n        }\n      }","var alert = function(source, property, threshold, fmt) {\n        source = (source || []).slice(0);\n        var l = source.length;\n\n        if ( lastProperty(source, property)  > threshold ) {\n          return '<p><i class=\"material-icons\" style=\"color:red\">warning</i></p>';\n          } else {\n            return '<p></p>';\n          }\n      }","var formatNumber = function(num, fmt) {\n        fmt = fmt || '0,0[.]0';\n        return numeral(num).format(fmt);\n      }","var formatDate = function(date, fmt) {\n        fmt = fmt || 'mm-dd-yyyy';\n        return dateUtils.format(date, fmt);\n      }","var isoMonth = function(date, fmt) {\n        fmt = fmt || 'mm';\n        var du = dateUtils;\n        return du.format(du.addDays(du.startOfMonth(date), 4),fmt)\n      }","var nextCounterValue = function(counterName, firstValue) {\n        firstValue = firstValue != null ? firstValue : 0;\n        if (execContext['$$'+counterName] == null) {\n          execContext['$$'+counterName] = firstValue;\n        } else {\n          execContext['$$'+counterName]++;\n        }\n        return execContext['$$'+counterName];\n      }","var getCoordinate = function(source, zoom) {\n        zoom = zoom || 6;\n        if(source == null) {\n          return [51.505,-0.09, zoom];\n        } else {\n          return [source[0], source[1], zoom];\n        }\n      }"],this._functions=[],this._functionsStr="",this._initFunctions()}return e.prototype.addFunction=function(e){this._functions.push(e),this._initFunctions()},e.prototype.addFunctionHandler=function(e,n){void 0===a.AjfExpressionUtils.utils[e]&&(a.AjfExpressionUtils.utils[e]={fn:n})},e.prototype._initFunctions=function(){var e=this._functions.map((function(e){return"string"==typeof e?e:e.toString()})).join("; ");this._functionsStr=this._baseUtilFunctions.join("; ")+"; "+e,a.AjfExpressionUtils.UTIL_FUNCTIONS=this._functionsStr},e.decorators=[{type:n.Injectable}],e.ctorParameters=function(){return[]},e}(),xe=(f||c).tokenize,Ce=function(){function i(e){this._visibilityNodesMapUpdates=new o.Subject,this._repetitionNodesMapUpdates=new o.Subject,this._conditionalBranchNodesMapUpdates=new o.Subject,this._formulaNodesMapUpdates=new o.Subject,this._validationNodesMapUpdates=new o.Subject,this._warningNodesMapUpdates=new o.Subject,this._filteredChoicesNodesMapUpdates=new o.Subject,this._triggerConditionsNodesMapUpdates=new o.Subject,this._nextSlideConditionsNodesMapUpdates=new o.Subject,this._formInitEvent=new n.EventEmitter,this.formInitEvent=this._formInitEvent.asObservable(),this._formGroup=new o.BehaviorSubject(null),this.formGroup=this._formGroup.asObservable(),this._form=new o.BehaviorSubject(null),this._nodesUpdates=new o.Subject,this._formGroupSubscription=o.Subscription.EMPTY,this._valueChanged=new o.Subject,this._nextSlideTrigger=new n.EventEmitter,this.nextSlideTrigger=this._nextSlideTrigger.asObservable(),this._slidesNum=new o.BehaviorSubject(0),this.slidesNum=this._slidesNum.asObservable(),this._initUpdateMapStreams(),this._initNodesStreams(),this._initErrorsStreams(),this._initFormStreams(),this._updateFormValueAndValidity()}return Object.defineProperty(i.prototype,"nodesTree",{get:function(){return this._flatNodesTree},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"errorPositions",{get:function(){return this._errorPositions},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"errors",{get:function(){return this._errors},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentSupplementaryInformations",{get:function(){var e=this._form.getValue();return null!=e&&null!=e.form?e.form.supplementaryInformations:null},enumerable:!0,configurable:!0}),i.prototype.setForm=function(e,n){void 0===n&&(n={}),this._initUpdateMapStreams(),null!=e&&0===Object.keys(n).length&&Object.keys(e.initContext||{}).length>0&&(n=e.initContext||{});var t=this._form.getValue();(null==t&&null!=e||null!=t&&e!==t.form)&&this._form.next({form:e,context:n})},i.prototype.getFormValue=function(){var e=this._formGroup.getValue();return null==e?{}:l.deepCopy(e.value)},i.prototype.addGroup=function(e){var n=this;return new o.Observable((function(t){if(null!=e.formulaReps)return t.next(!1),void t.complete();var o=e.node.maxReps;if(o>0&&e.reps+1>o)return t.next(!1),void t.complete();var r=e.reps;e.reps=e.reps+1,e.canAdd=0===e.node.maxReps||e.reps<e.node.maxReps,e.canRemove=0===e.node.minReps||e.reps>e.node.minReps,n._nodesUpdates.next((function(o){var i=oe(o,!0);return n._adjustReps(i,e,r,n.getFormValue()),t.next(!0),t.complete(),o}))}))},i.prototype.removeGroup=function(e){var n=this;return new o.Observable((function(t){if(null!=e.formulaReps)return t.next(!1),void t.complete();if(e.reps-1<e.node.minReps)return t.next(!1),void t.complete();var o=e.reps;e.reps=e.reps-1,e.canAdd=0===e.node.maxReps||e.reps<e.node.maxReps,e.canRemove=0===e.node.minReps||e.reps>e.node.minReps,n._nodesUpdates.next((function(r){return n._adjustReps(r,e,o,n.getFormValue()),t.next(!0),t.complete(),r}))}))},i.prototype.getControl=function(e){return this.formGroup.pipe(r.map((function(n){var t=$(e);return null!=n&&n.contains(t)?n.controls[t]:null})))},i.prototype._initErrorsStreams=function(){var n=this;this._errorPositions=this._valueChanged.pipe(r.withLatestFrom(this._nodes,this._form),r.filter((function(e){return null!=e[2]&&null!=e[2].form})),r.map((function(t){var o=t[2].form,r=0,i=[];return t[1].forEach((function(n){if(n.node.nodeType===e.AjfNodeType.AjfRepeatingSlide)for(var t=n,o=0;o<t.reps;o++)n.visible&&(r++,0==o&&(t.position=r),(u=o)>=(s=t).slideNodes.length||s.slideNodes[u].map((function(e){return!(e.visible&&Object.keys(e).indexOf("valid")>-1)||e.valid})).reduce((function(e,n){return e&&n}),!0)||i.push(r));else if(n.node.nodeType===e.AjfNodeType.AjfSlide){var a=n;a.visible&&(r++,a.position=r,a.valid||i.push(r))}var s,u})),o.valid=0==i.length,n._slidesNum.next(r),i})),r.publishReplay(),r.refCount()),this._errors=this._errorPositions.pipe(r.map((function(e){return null!=e?e.length:0})),r.startWith(0),r.publishReplay(),r.refCount())},i.prototype._initUpdateMapStreams=function(){this._visibilityNodesMap=this._visibilityNodesMapUpdates.pipe(r.scan((function(e,n){return n(e)}),{}),r.startWith({}),r.share()),this._repetitionNodesMap=this._repetitionNodesMapUpdates.pipe(r.scan((function(e,n){return n(e)}),{}),r.startWith({}),r.share()),this._conditionalBranchNodesMap=this._conditionalBranchNodesMapUpdates.pipe(r.scan((function(e,n){return n(e)}),{}),r.startWith({}),r.share()),this._formulaNodesMap=this._formulaNodesMapUpdates.pipe(r.scan((function(e,n){return n(e)}),{}),r.startWith({}),r.share()),this._validationNodesMap=this._validationNodesMapUpdates.pipe(r.scan((function(e,n){return n(e)}),{}),r.startWith({}),r.share()),this._warningNodesMap=this._warningNodesMapUpdates.pipe(r.scan((function(e,n){return n(e)}),{}),r.startWith({}),r.share()),this._filteredChoicesNodesMap=this._filteredChoicesNodesMapUpdates.pipe(r.scan((function(e,n){return n(e)}),{}),r.startWith({}),r.share()),this._triggerConditionsNodesMap=this._triggerConditionsNodesMapUpdates.pipe(r.scan((function(e,n){return n(e)}),{}),r.startWith({}),r.share()),this._nextSlideConditionsNodesMap=this._nextSlideConditionsNodesMapUpdates.pipe(r.scan((function(e,n){return n(e)}),{}),r.startWith({}),r.share()),this._nodesMaps=[this._visibilityNodesMap,this._repetitionNodesMap,this._conditionalBranchNodesMap,this._formulaNodesMap,this._validationNodesMap,this._warningNodesMap,this._nextSlideConditionsNodesMap,this._filteredChoicesNodesMap,this._triggerConditionsNodesMap]},i.prototype._initFormStreams=function(){var n=this,i=this._form;i.pipe(r.map((function(e){return n._initFormGroupStreams(new t.FormGroup({}))}))).subscribe(this._formGroup),i.pipe(r.switchMap((function(e){if(null==e||null==e.form)return o.of(e);var n=e.form.choicesOrigins||[];return 0===n.length?o.of(e):o.from(Promise.all(n.map((function(e){return D(e)})))).pipe(r.map((function(){return e})))})),r.map((function(t){return function(o){var r=null!=t&&null!=t.form?n._orderedNodesInstancesTree(_e(t.form.nodes),t.form.nodes,void 0,[],t.context||{}):[],i=0;return r.forEach((function(n){if(n.node.nodeType===e.AjfNodeType.AjfRepeatingSlide)for(var t=n,o=0;o<t.reps;o++)n.visible&&(i++,0==o&&(t.position=i));else n.node.nodeType===e.AjfNodeType.AjfSlide&&n.visible&&(i++,n.position=i)})),r}}))).subscribe(this._nodesUpdates)},i.prototype._initNodeInstance=function(o,r,i,s,u){var l=this;void 0===u&&(u=!0);var c=function d(n,t,o,r){var i=null,s=t.nodeType;switch(s){case e.AjfNodeType.AjfField:var u=t;if(u.fieldType>100)i=null!=V[u.fieldType]&&null!=V[u.fieldType].createInstance?V[u.fieldType].createInstance({node:t,prefix:o},r):se({node:t,prefix:o},r);else switch(u.fieldType){case e.AjfFieldType.SingleChoice:case e.AjfFieldType.MultipleChoice:i=ue({node:t,prefix:o},r);break;case e.AjfFieldType.Table:i=function l(e,n){!function t(e){e.rows.forEach((function(n,t){n.forEach((function(n,o){"string"==typeof n&&(e.rows[t][o]={formula:n,editable:e.editable})}))}))}(e.node);var o=se(e,n);return j(j({},o),{node:e.node,context:n,hideEmptyRows:e.hideEmptyRows||!1,controls:[]})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */({node:t,prefix:o},r);break;default:i=se({node:t,prefix:o},r)}break;case e.AjfNodeType.AjfNodeGroup:i=function c(e){var n=ae(e);return j(j({},n),{node:e.node,formulaReps:e.formulaReps,reps:0,nodes:[],flatNodes:[]})}({node:t,prefix:o});break;case e.AjfNodeType.AjfRepeatingSlide:i=function d(e){var n=le(e);return j(j({},n),{node:e.node,slideNodes:[],formulaReps:e.formulaReps,reps:0,nodes:[],flatNodes:[]})}({node:t,prefix:o});break;case e.AjfNodeType.AjfSlide:i=le({node:t,prefix:o})}if(null!=i)if(null!=o&&o.length>0){var p=
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function f(e,n){var t={};return function o(e,n){for(var t=[],o=n.parent;null!=o;){var r=e.map((function(e){return e.node||e})).find((function(e){return e.id==o}));r&&pe(r)&&t.push(r),o=null!=r?r.parent:null}return t}(e,n).forEach((function(e,n){return(e.nodes||[]).forEach((function(e){B(e)&&(t[e.name]=n)}))})),t}(n,t);if(null!=t.visibility){var h=t.visibility.condition,m=a.normalizeExpression(h,p,o);i.visibility=m!==h?a.createCondition({condition:m}):t.visibility}var v=null!=i.node.conditionalBranches&&i.node.conditionalBranches.length>0?i.node.conditionalBranches:[a.alwaysCondition()];if(i.conditionalBranches=he(v,p,o),s===e.AjfNodeType.AjfNodeGroup||s===e.AjfNodeType.AjfRepeatingSlide){var y=i,g=y.node.formulaReps;if(null!=g){var _=g.formula,b=a.normalizeExpression(_,p,o);y.formulaReps=b!==_?a.createFormula({formula:b}):g}}else if(s===e.AjfNodeType.AjfField){var N=(S=i).node;if(N.formula&&(S.formula=me(N.formula,p,o)),null!=N.validation){var x=
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function C(e,n,t){var o=!1,r=e.map((function(e){var r=function i(e,n,t){var o=e.condition,r=a.normalizeExpression(o,n,t);return r===o?e:ve({condition:r})}(e,n,t);return r!==e&&(o=!0),r}));return o?r:e}(N.validation.conditions,p,o);x!==N.validation.conditions?(S.validation=ce(N.validation),S.validation.conditions=x):S.validation=N.validation}if(null!=N.warning){var T=
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function M(e,n,t){var o=!1,r=e.map((function(e){var r=function i(e,n,t){var o=e.condition,r=a.normalizeExpression(o,n,t);return r===o?e:ye({condition:r})}(e,n,t);return r!==e&&(o=!0),r}));return o?r:e}(N.warning.conditions,p,o);T!==N.warning.conditions?(S.warning=de(N.warning),S.warning.conditions=T):S.warning=N.warning}if(null!=N.nextSlideCondition&&(S.nextSlideCondition=fe(N.nextSlideCondition,p,o)),U(N)){var F=(w=i).node;null!=F.choicesFilter&&(w.choicesFilter=me(F.choicesFilter,p,o)),null!=F.triggerConditions&&(w.triggerConditions=he(F.triggerConditions,p,o))}}}else if(i.visibility=i.node.visibility,v=null!=i.node.conditionalBranches&&i.node.conditionalBranches.length>0?i.node.conditionalBranches:[a.alwaysCondition()],i.conditionalBranches=v,ie(i)||ge(i))i.formulaReps=i.node.formulaReps;else if(k(i)){var S,w;(S=i).validation=S.node.validation,S.warning=S.node.warning,S.nextSlideCondition=S.node.nextSlideCondition,G(i)&&((w=i).choicesFilter=w.node.choicesFilter,w.triggerConditions=w.node.triggerConditions),S.formula=S.node.formula}return i}(o,r,i,s);if(null!=c){var p=c.node.nodeType;if(p===e.AjfNodeType.AjfNodeGroup||p===e.AjfNodeType.AjfRepeatingSlide?this._explodeRepeatingNode(o,c,s):p===e.AjfNodeType.AjfSlide&&(c.nodes=this._orderedNodesInstancesTree(o,c.node.nodes,c.node.id,i,s)),W(c,s,u),J(c,s),p===e.AjfNodeType.AjfField){var f=c;if(ee(f.node)||U(f.node))K(f,s);else{if(
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function h(n){return null!=n&&k(n)&&function t(n){return n.fieldType===e.AjfFieldType.Table}(n.node)}(f)){var m=f,v=m.node;m.context=s[$(m)]||s;var y=this._formGroup.getValue(),g=[];g.push([r.label,v.columnLabels]),null!=y&&(v.rows.forEach((function(e,o){var r=[];e.forEach((function(e,i){var a=v.name+"__"+o+"__"+i,s={control:new t.FormControl,show:!1};s.control.setValue(m.context[e.formula]),y.registerControl(a,s.control),r.push(s);var u={formula:{formula:e.formula},node:{name:a,nodeType:0,editable:!1},visible:!0,prefix:[],conditionalBranches:[],updatedEvt:new n.EventEmitter};l._addToNodesFormulaMap(u,e.formula)})),g.push([v.rowLabels[o],r])})),m.controls=g)}else f.value=s[$(c)];!function _(e,n,t){void 0===t&&(t=!0),W(e,n,t),J(e,n),z(e,n),Y(e,n),Z(e,n),H(e,n)}(f,s)}}this._addNodeInstance(c)}return c},i.prototype._adjustReps=function(n,t,o,r){var i=this,a=t.reps,s={added:null,removed:null};if(o<a){var u=[];if(null==t.nodes&&(t.nodes=[]),t.node.nodeType===e.AjfNodeType.AjfNodeGroup){var l=X({id:999,name:"",parent:-1,fieldType:e.AjfFieldType.Empty,label:t.node.label}),c=this._initNodeInstance(n,l,t.prefix.slice(0),r);null!=c&&t.nodes.push(c)}for(var d=function(e){var o=t.prefix.slice(0),a=t.node;o.push(e),be(a.nodes,t.node.id).forEach((function(e){var a=i._initNodeInstance(n,e,o,r);null!=a&&(u.push(a),t.nodes.push(a))})),p._addNodeInstance(t)},p=this,f=o;f<a;f++)d(f);s.added=u}else if(o>a){var h=t.nodes.length/o;t.node.nodeType===e.AjfNodeType.AjfNodeGroup&&h++,s.removed=t.nodes.splice(a*h,h),s.removed.forEach((function(e){i._removeNodeInstance(e)}))}if(o!=a&&null==t.formulaReps){var m=this._formGroup.getValue(),v=$(t);null!=m&&m.contains(v)&&m.controls[v].setValue(t.reps)}if(t.flatNodes=oe(t.nodes),t.node.nodeType===e.AjfNodeType.AjfRepeatingSlide){var y=t,g=[],_=null!=y.nodes?y.nodes.length/y.reps:0;for(f=0;f<t.reps;f++){var b=f*_;g.push(t.nodes.slice(b,b+_))}y.slideNodes=g}return s},i.prototype._updateFormValueAndValidity=function(){this._nodesUpdates.asObservable().pipe(r.withLatestFrom(this._formGroup),r.filter((function(e){return null!==e[1]}))).subscribe((function(e){e[1].updateValueAndValidity()}))},i.prototype._explodeRepeatingNode=function(e,n,t){var o=Ne(n,t);o!==n.reps&&this._adjustReps(e,n,o,t)},i.prototype._orderedNodesInstancesTree=function(e,n,t,o,r){var i=this;void 0===t&&(t=null),void 0===o&&(o=[]);var a=[],s=o.length>0?"__"+o.join("__"):"";return be(n,t).forEach((function(n){var t=a.find((function(e){return e.node.id==n.parent&&L(e)==s})),u=i._initNodeInstance(e,n,o,r,null==t||null!=t.verifiedBranch&&t.verifiedBranch==n.parentNode);null!=u&&a.push(u)})),a},i.prototype._formValueDelta=function(e,n){return Object.keys(n).filter((function(t){return e[t]!==n[t]}))},i.prototype._initFormGroupStreams=function(e){var n=this;this._formGroupSubscription.unsubscribe();var t=!0,i=!0;return this._formInitEvent.emit(0),this._formGroupSubscription=e.valueChanges.pipe(r.startWith({}),r.pairwise(),r.debounceTime(200),r.withLatestFrom.apply(void 0,C(this._nodesMaps,[this._flatNodes]))).subscribe((function(e){var r=t&&{}||e[0][0];t=!1;var s=e[0][1],u=e[1],l=e[2],c=e[3],d=e[4],p=e[5],f=e[6],h=e[7],m=e[8],v=e[9],y=e[10],g=n._formValueDelta(r,s),_=g.length,b=[];g.forEach((function(e){if(b=b.concat(y.filter((function(n){return $(n)===e}))),null!=u[e]&&u[e].forEach((function(e){var t=$(e),r=W(e,s),i=k(e);if(r&&!e.visible){var a=n._formGroup.getValue();if(null!=a)var u=o.timer(200).subscribe((function(){u&&!u.closed&&u.unsubscribe(),a.controls[t].setValue(null)}));i&&(e.value=null)}else if(r&&e.visible&&i){var l=n._formGroup.getValue(),c=z(e,s);null!=l&&c.changed&&l.controls[t].setValue(c.value)}-1===b.indexOf(e)&&b.push(e)})),null!=l[e]&&l[e].forEach((function(e){if(pe(e.node)){var t=e,o=Ne(t,s);o!==t.reps&&n._adjustReps(y,t,o,s)}-1===b.indexOf(e)&&b.push(e)})),null!=c[e]&&c[e].forEach((function(e){J(e,s);var t=e.verifiedBranch;e.conditionalBranches.forEach((function(o,r){r==t?n._showSubtree(s,y,e,r):n._hideSubtree(s,y,e,r)})),-1===b.indexOf(e)&&b.push(e)})),null!=d[e]&&d[e].forEach((function(e){if(k(e)){var t=e,o=z(t,s),r=n._formGroup.getValue();null!=r&&o.changed&&(Y(t,s),r.controls[$(e)].setValue(o.value))}-1===b.indexOf(e)&&b.push(e)})),null!=p[e]&&p[e].forEach((function(e){if(k(e)){var t=e;s.$value=s[$(e)],Y(t,s,n.currentSupplementaryInformations)}-1===b.indexOf(e)&&b.push(e)})),null!=f[e]&&f[e].forEach((function(e){if(k(e)){var n=e;Z(n,s),null!=n.warningResults&&n.warningResults.filter((function(e){return e.result})).length>0&&n.warningTrigger.emit()}-1===b.indexOf(e)&&b.push(e)})),1==_&&null!=h[e]&&1==h[e].filter((function(e){return!!k(e)&&H(e,s)})).length&&n._nextSlideTrigger.emit(),null!=m[e]&&m[e].forEach((function(e){if(k(e)){var n=e;U(n.node)&&K(n,s)}-1===b.indexOf(e)&&b.push(e)})),1==_&&null!=v[e]){var t=v[e].filter((function(e){if(!k(e))return!1;var n=e;return!!U(n.node)&&function t(e,n){if(null==e.triggerConditions)return!1;var t=$(e);if(e.firstTriggerConditionDone[t])return!1;for(var o=!1,r=e.triggerConditions.length,i=0;i<r;i++)if(a.evaluateExpression(e.triggerConditions[i].condition,n)){o=!0;break}return e.firstTriggerConditionDone[t]=o,o}(n,s)}));1==t.length&&t[0].selectionTrigger.emit()}})),b.forEach((function(e){for(var n=y.indexOf(e)-1;n>=0;){var t=y[n];if(re(t)){for(var o=t,r=o.flatNodes.length,i=!0,a=0;a<r;a++){var s=o.flatNodes[a];if(s.visible&&k(s)&&!s.valid){i=!1;break}}o.valid!==i&&(o.valid=i),o.updatedEvt.emit()}n--}e.updatedEvt.emit()})),i&&(i=!1,n._formInitEvent.emit(1)),n._valueChanged.next()})),e},i.prototype._showSubtree=function(e,n,t,o){this._updateSubtreeVisibility(e,n,t,!0,o)},i.prototype._hideSubtree=function(e,n,t,o){this._updateSubtreeVisibility(e,n,t,!1,o)},i.prototype._updateSubtreeVisibility=function(e,n,t,o,r){var i,a=this,s=L(t);i=n.filter(null!=r?function(e){return L(e)==s&&e.node.parent==t.node.id&&e.node.parentNode==r}:function(e){return L(e)==s&&e.node.parent==t.node.id});var u=te(t.node);i.forEach((function(r){(!u||u&&null==t.node.nodes.find((function(e){return e.id==r.node.id})))&&(W(r,e,o),z(r,e),a._updateSubtreeVisibility(e,n,r,o))}))},i.prototype._initNodesStreams=function(){this._nodes=this._nodesUpdates.pipe(r.scan((function(e,n){return n(e)}),[]),r.share()),this._flatNodesTree=this._nodes.pipe(r.map((function(e){return function n(e){var n=[];return e.forEach((function(e){if(re(e)){var t=e;n.push(t),t.flatNodes=oe(t.nodes)}})),n}(e)})),r.share()),this._flatNodes=this._flatNodesTree.pipe(r.map((function(e){var n=[];return e.forEach((function(e){n.push(e),n=n.concat(e.flatNodes)})),n})),r.share())},i.prototype._removeNodeInstance=function(e){var n=$(e);return this._removeNodesVisibilityMapIndex(n),this._removeNodesRepetitionMapIndex(n),this._removeNodesConditionalBranchMapIndex(n),this._removeNodesFormulaMapIndex(n),this._removeNodesValidationMapIndex(n),this._removeNodesWarningMapIndex(n),this._removeNodesNextSlideConditionsMapIndex(n),this._removeNodesFilteredChoicesMapIndex(n),this._removeNodesTriggerConditionsMapIndex(n),re(e)?this._removeSlideInstance(e):(pe(e.node)?this._removeNodeGroupInstance(e):k(e)&&this._removeFieldInstance(e),e)},i.prototype._removeSlideInstance=function(e){var n=this,t=e.node;return null!=t.visibility&&this._removeFromNodesVisibilityMap(e,t.visibility.condition),e.conditionalBranches.forEach((function(t){n._removeFromNodesConditionalBranchMap(e,t.condition)})),e},i.prototype._removeNodeGroupInstance=function(e){var n=e.node;return null!=n.visibility&&this._removeFromNodesVisibilityMap(e,n.visibility.condition),null!=e.formulaReps&&null!=n.formulaReps&&this._removeFromNodesRepetitionMap(e,n.formulaReps.formula),e},i.prototype._removeFieldInstance=function(e){var n=this,t=this._formGroup.getValue(),o=$(e);if(null!=t&&t.contains(o)&&t.removeControl(o),null!=e.validation&&this._validationNodesMapUpdates.next((function(e){return null==e[o]&&delete e[o],e})),null!=e.visibility&&this._removeFromNodesVisibilityMap(e,e.visibility.condition),e.conditionalBranches.forEach((function(t){n._removeFromNodesConditionalBranchMap(e,t.condition)})),e.formula&&this._removeFromNodesFormulaMap(e,e.formula.formula),pe(e.node)&&null!=e.formulaReps&&this._removeFromNodesRepetitionMap(e,e.formulaReps.formula),null!=e.validation&&null!=e.validation.conditions&&e.validation.conditions.forEach((function(t){n._removeFromNodesValidationMap(e,t.condition)})),null!=e.warning&&e.warning.conditions.forEach((function(t){n._removeFromNodesWarningMap(e,t.condition)})),null!=e.nextSlideCondition&&this._removeFromNodesNextSlideConditionsMap(e,e.nextSlideCondition.condition),U(e.node)){var r=e;null!=r.choicesFilter&&(this._removeFromNodesFilteredChoicesMap(e,r.choicesFilter.formula),null!=r.triggerConditions&&r.triggerConditions.forEach((function(t){n._removeFromNodesTriggerConditionsMap(e,t.condition)})))}return e},i.prototype._addNodeInstance=function(n){return pe(n.node)?this._addNodeGroupInstance(n):
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function t(n){return null!=n&&null!=n.node&&function t(n){return null!=n&&n.nodeType===e.AjfNodeType.AjfSlide}(n.node)}(n)?this._addSlideInstance(n):k(n)?this._addFieldInstance(n):n},i.prototype._addFieldInstance=function(e){var n=this,o=this._formGroup.getValue(),r=$(e);if(null!=o&&!o.contains(r)){var i=new t.FormControl;i.setValue(e.value),o.registerControl(r,i)}if(null!=e.validation?this._validationNodesMapUpdates.next((function(n){return null==n[r]&&(n[r]=[]),-1==n[r].indexOf(e)&&n[r].push(e),n})):e.valid=!0,null!=e.visibility&&this._addToNodesVisibilityMap(e,e.visibility.condition),e.conditionalBranches.forEach((function(t){n._addToNodesConditionalBranchMap(e,t.condition)})),e.formula&&this._addToNodesFormulaMap(e,e.formula.formula),ie(e)&&null!=e.formulaReps&&this._addToNodesRepetitionMap(e,e.formulaReps.formula),null!=e.validation&&null!=e.validation.conditions&&e.validation.conditions.forEach((function(t){n._addToNodesValidationMap(e,t.condition)})),null!=e.warning&&e.warning.conditions.forEach((function(t){n._addToNodesWarningMap(e,t.condition)})),null!=e.nextSlideCondition&&this._addToNodesNextSlideConditionsMap(e,e.nextSlideCondition.condition),ee(e.node)||G(e)){var a=e;null!=a.choicesFilter&&this._addToNodesFilteredChoicesMap(e,a.choicesFilter.formula),null!=a.triggerConditions&&a.triggerConditions.forEach((function(t){n._addToNodesTriggerConditionsMap(e,t.condition)}))}return e},i.prototype._addSlideInstance=function(e){var n=this,t=e.node;return null!=t.visibility&&this._addToNodesVisibilityMap(e,t.visibility.condition),e.conditionalBranches.forEach((function(t){n._addToNodesConditionalBranchMap(e,t.condition)})),e},i.prototype._addNodeGroupInstance=function(e){var n=this,o=e.node;if(null!=o.visibility&&this._addToNodesVisibilityMap(e,o.visibility.condition),e.conditionalBranches.forEach((function(t){n._addToNodesConditionalBranchMap(e,t.condition)})),null!=e.formulaReps)null!=o.formulaReps&&this._addToNodesRepetitionMap(e,o.formulaReps.formula);else{var r=this._formGroup.getValue(),i=$(e);if(null!=r&&!r.contains(i)){var a=new t.FormControl;a.setValue(e.reps),r.registerControl(i,a)}}return e},i.prototype._removeNodesVisibilityMapIndex=function(e){this._removeNodesMapIndex(this._visibilityNodesMapUpdates,e)},i.prototype._removeNodesRepetitionMapIndex=function(e){this._removeNodesMapIndex(this._repetitionNodesMapUpdates,e)},i.prototype._removeNodesConditionalBranchMapIndex=function(e){this._removeNodesMapIndex(this._conditionalBranchNodesMapUpdates,e)},i.prototype._removeNodesFormulaMapIndex=function(e){this._removeNodesMapIndex(this._formulaNodesMapUpdates,e)},i.prototype._removeNodesValidationMapIndex=function(e){this._removeNodesMapIndex(this._validationNodesMapUpdates,e)},i.prototype._removeNodesWarningMapIndex=function(e){this._removeNodesMapIndex(this._warningNodesMapUpdates,e)},i.prototype._removeNodesFilteredChoicesMapIndex=function(e){this._removeNodesMapIndex(this._filteredChoicesNodesMapUpdates,e)},i.prototype._removeNodesTriggerConditionsMapIndex=function(e){this._removeNodesMapIndex(this._triggerConditionsNodesMapUpdates,e)},i.prototype._removeNodesNextSlideConditionsMapIndex=function(e){this._removeNodesMapIndex(this._nextSlideConditionsNodesMapUpdates,e)},i.prototype._removeNodesMapIndex=function(e,n){e.next((function(e){return Object.keys(e).indexOf(n)>-1&&delete e[n],e}))},i.prototype._removeFromNodesVisibilityMap=function(e,n){this._removeFromNodesMap(this._visibilityNodesMapUpdates,e,n)},i.prototype._removeFromNodesRepetitionMap=function(e,n){this._removeFromNodesMap(this._repetitionNodesMapUpdates,e,n)},i.prototype._removeFromNodesConditionalBranchMap=function(e,n){this._removeFromNodesMap(this._conditionalBranchNodesMapUpdates,e,n)},i.prototype._removeFromNodesFormulaMap=function(e,n){this._removeFromNodesMap(this._formulaNodesMapUpdates,e,n)},i.prototype._removeFromNodesValidationMap=function(e,n){this._removeFromNodesMap(this._validationNodesMapUpdates,e,n)},i.prototype._removeFromNodesWarningMap=function(e,n){this._removeFromNodesMap(this._warningNodesMapUpdates,e,n)},i.prototype._removeFromNodesFilteredChoicesMap=function(e,n){this._removeFromNodesMap(this._filteredChoicesNodesMapUpdates,e,n)},i.prototype._removeFromNodesTriggerConditionsMap=function(e,n){this._removeFromNodesMap(this._filteredChoicesNodesMapUpdates,e,n)},i.prototype._removeFromNodesNextSlideConditionsMap=function(e,n){this._removeFromNodesMap(this._nextSlideConditionsNodesMapUpdates,e,n)},i.prototype._removeFromNodesMap=function(e,n,t){var o=xe(t).filter((function(e){return"Identifier"==e.type&&"$value"!=e.value}));o.length>0&&e.next((function(e){return o.forEach((function(t){var o=t.value;if(null!=e[o]){var r=e[o].indexOf(n);r>-1&&(e[o].splice(r,1),0==e[o].length&&delete e[o])}})),e}))},i.prototype._addToNodesVisibilityMap=function(e,n){this._addToNodesMap(this._visibilityNodesMapUpdates,e,n)},i.prototype._addToNodesRepetitionMap=function(e,n){this._addToNodesMap(this._repetitionNodesMapUpdates,e,n)},i.prototype._addToNodesConditionalBranchMap=function(e,n){this._addToNodesMap(this._conditionalBranchNodesMapUpdates,e,n)},i.prototype._addToNodesFormulaMap=function(e,n){this._addToNodesMap(this._formulaNodesMapUpdates,e,n)},i.prototype._addToNodesValidationMap=function(e,n){this._addToNodesMap(this._validationNodesMapUpdates,e,n)},i.prototype._addToNodesWarningMap=function(e,n){this._addToNodesMap(this._warningNodesMapUpdates,e,n)},i.prototype._addToNodesFilteredChoicesMap=function(e,n){this._addToNodesMap(this._filteredChoicesNodesMapUpdates,e,n)},i.prototype._addToNodesTriggerConditionsMap=function(e,n){this._addToNodesMap(this._triggerConditionsNodesMapUpdates,e,n)},i.prototype._addToNodesNextSlideConditionsMap=function(e,n){this._addToNodesMap(this._nextSlideConditionsNodesMapUpdates,e,n)},i.prototype._addToNodesMap=function(e,n,t){var o=xe(t).filter((function(e){return"Identifier"==e.type&&"$value"!=e.value}));o.length>0&&e.next((function(e){return o.forEach((function(t){var o=t.value;null==e[o]&&(e[o]=[]),-1===e[o].indexOf(n)&&e[o].push(n)})),e}))},i.decorators=[{type:n.Injectable}],i.ctorParameters=function(){return[{type:je}]},i}(),Te=function Te(){},Me=function(){function t(t,i){this._rendererService=t,this._changeDetectorRef=i,this.ajfFieldTypes=e.AjfFieldType,this._orientationChange=new n.EventEmitter,this.orientationChange=this._orientationChange.asObservable(),this._saveDisabled=!1,this._hasStartMessage=!1,this._hasEndMessage=!1,this._hideTopToolbar=!1,this._hideBottomToolbar=!1,this._hideNavigationButtons=!1,this._fixedOrientation=!1,this._readonly=!1,this._orientation="horizontal",this._errorMoveEvent=new n.EventEmitter,this._init=!1,this._nextSlideSubscription=o.Subscription.EMPTY,this._errorMoveSubscription=o.Subscription.EMPTY,this._formAction=new n.EventEmitter,this.formAction=this._formAction.asObservable(),this.formGroup=t.formGroup,this.slides=t.nodesTree,this._errorPositions=t.errorPositions,this.errors=t.errors,this.slidesNum=t.slidesNum,this.formIsInit=t.formInitEvent.pipe(r.map((function(e){return 1===e})))}return Object.defineProperty(t.prototype,"saveDisabled",{get:function(){return this._saveDisabled},set:function(e){this._saveDisabled=s.coerceBooleanProperty(e),this._changeDetectorRef.markForCheck()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasStartMessage",{get:function(){return this._hasStartMessage},set:function(e){this._hasStartMessage=s.coerceBooleanProperty(e),this._changeDetectorRef.markForCheck()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasEndMessage",{get:function(){return this._hasEndMessage},set:function(e){this._hasEndMessage=s.coerceBooleanProperty(e),this._changeDetectorRef.markForCheck()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hideTopToolbar",{get:function(){return this._hideTopToolbar},set:function(e){this._hideTopToolbar=s.coerceBooleanProperty(e),this._changeDetectorRef.markForCheck()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hideBottompToolbar",{get:function(){return this._hideBottomToolbar},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hideBottomToolbar",{set:function(e){this._hideBottomToolbar=s.coerceBooleanProperty(e),this._changeDetectorRef.markForCheck()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hideNavigationButtons",{get:function(){return this._hideNavigationButtons},set:function(e){this._hideNavigationButtons=s.coerceBooleanProperty(e),this._changeDetectorRef.markForCheck()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fixedOrientation",{get:function(){return this._fixedOrientation},set:function(e){this._fixedOrientation=s.coerceBooleanProperty(e),this._changeDetectorRef.markForCheck()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readonly",{get:function(){return this._readonly},set:function(e){this._readonly=s.coerceBooleanProperty(e),this._changeDetectorRef.markForCheck()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"orientation",{get:function(){return this._orientation},set:function(e){"horizontal"!==e&&"vertical"!==e||e!==this._orientation&&(this._orientation=e,this._changeDetectorRef.markForCheck(),this._orientationChange.emit(this._orientation))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"form",{set:function(e){this._form=e,this._init&&this._rendererService.setForm(this._form)},enumerable:!0,configurable:!0}),t.prototype.goToNextError=function(){this._errorMoveEvent.emit(!0)},t.prototype.goToPrevError=function(){this._errorMoveEvent.emit(!1)},t.prototype.addGroup=function(e){var n=this,t=this._rendererService.addGroup(e).pipe(r.delayWhen((function(){return n.formSlider.pageScrollFinish}))).subscribe((function(e){e&&null!=n.formSlider&&n.formSlider.slide({dir:"down"})}),(function(e){t&&t.unsubscribe()}),(function(){t&&t.unsubscribe()}))},t.prototype.removeGroup=function(e){var n=this,t=this._rendererService.removeGroup(e).pipe(r.delayWhen((function(){return n.formSlider.pageScrollFinish}))).subscribe((function(e){e&&null!=n.formSlider&&n.formSlider.slide({dir:"up"})}),(function(e){t&&t.unsubscribe()}),(function(){t&&t.unsubscribe()}))},t.prototype.onSave=function(e){this._formAction.emit({source:this,action:"save",value:this._rendererService.getFormValue()})},t.prototype.onFormAction=function(e,n){this._formAction.emit({source:this,value:this._rendererService.getFormValue(),action:n})},t.prototype.ngAfterViewInit=function(){null!=this._form&&(this._rendererService.setForm(this._form),this._changeDetectorRef.detectChanges())},t.prototype.ngAfterViewChecked=function(){var e=this;this._init||null==this.formSlider||(this._init=!0,this._errorMoveSubscription=this._errorMoveEvent.pipe(r.withLatestFrom(this._errorPositions)).subscribe((function(n){var t=n[0],o=e.formSlider.currentPage-+e.hasStartMessage+1,r=n[1];if(null!=r){for(var i=!1,a=-1,s=-1,u=0,l=r.length;!i&&u<l;)r[u]==o?(i=!0,a=u>0?u-1:l-1,s=u<l-1?u+1:0):r[u]>o&&(i=!0,a=u>0?u-1:l-1,s=u),u++;i||(a=l-1,s=0),e.formSlider.slide({to:t?r[s]-1:r[a]-1}),e._changeDetectorRef.detectChanges()}})))},t.prototype.ngOnDestroy=function(){this._nextSlideSubscription.unsubscribe(),this._errorMoveSubscription.unsubscribe(),this._orientationChange.complete(),this._errorMoveEvent.complete(),this._formAction.complete()},t.prototype.orientationChangeHandler=function(e){this.orientation=e},t.prototype.trackNodeById=function(e,n){return $(n)},t.decorators=[{type:n.Directive}],t.ctorParameters=function(){return[{type:Ce},{type:n.ChangeDetectorRef}]},t.propDecorators={title:[{type:n.Input}],orientationChange:[{type:n.Output}],saveDisabled:[{type:n.Input}],hasStartMessage:[{type:n.Input}],hasEndMessage:[{type:n.Input}],hideTopToolbar:[{type:n.Input}],hideBottomToolbar:[{type:n.Input}],hideNavigationButtons:[{type:n.Input}],fixedOrientation:[{type:n.Input}],readonly:[{type:n.Input}],orientation:[{type:n.Input}],formSlider:[{type:n.ViewChild,args:["formSlider",{static:!1}]}],fields:[{type:n.ViewChildren,args:[w]}],formAction:[{type:n.Output}],form:[{type:n.Input}]},t}(),Fe=function(){function e(){}return e.prototype.transform=function(e){return null==e||"string"==typeof e?null:e},e.decorators=[{type:n.Pipe,args:[{name:"ajfGetTableCellControl"}]}],e}(),Se=function(){function e(){}return e.prototype.transform=function(e,n){return void 0===n&&(n=1),e+n},e.decorators=[{type:n.Pipe,args:[{name:"ajfIncrement"}]}],e}(),we=function(){function e(){}return e.prototype.transform=function(e){return null!=e&&"string"!=typeof e&&!0===e.editable},e.decorators=[{type:n.Pipe,args:[{name:"ajfIsCellEditable"}]}],e}(),Ae=function(){function e(){}return e.prototype.transform=function(e){return ge(e)},e.decorators=[{type:n.Pipe,args:[{name:"ajfIsRepeatingSlideInstance"}]}],e}(),Ee=function(){function e(){}return e.prototype.transform=function(e){return e?$(e):""},e.decorators=[{type:n.Pipe,args:[{name:"ajfNodeCompleteName"}]}],e}(),Ie=function(){function e(){}return e.prototype.transform=function(e,n,t){void 0===e&&(e=0),void 0===n&&(n=1),void 0===t&&(t=1);for(var o=[],r=0;r<e;++r)o.push(n),n+=t;return o},e.decorators=[{type:n.Pipe,args:[{name:"ajfRange"}]}],e}(),Re=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.type="text",n}return N(n,e),n}(v),Ve=new n.InjectionToken("ajf-warning-alert-service"),Oe=function(e){function t(n,t,o){return e.call(this,n,t,o)||this}return N(t,e),t.decorators=[{type:n.Component,args:[{selector:"ajf-read-only-field",template:'<span *ngIf="control|async as ctrl">{{ctrl.value}}</span>\n',changeDetection:n.ChangeDetectionStrategy.OnPush,encapsulation:n.ViewEncapsulation.None,styles:["ajf-read-only-field span{min-height:1em;display:block}\n"]}]}],t.ctorParameters=function(){return[{type:n.ChangeDetectorRef},{type:Ce},{type:void 0,decorators:[{type:n.Inject,args:[Ve]}]}]},t}(Re),Pe=function(e){function t(n,t,o){return e.call(this,n,t,o)||this}return N(t,e),t.decorators=[{type:n.Component,args:[{template:'<table class="ajf-table-field">\n  <ng-container *ngIf="instance.node as node">\n    <ng-container *ngFor="let columns of instance.controls; let row = index">\n      <tr [ngClass]="row | ajfTableRowClass">\n        <td>\n          <ng-container *ngIf="columns && columns.length > 0 && columns[0] != null">\n            {{ columns[0] | ajfTranslateIfString | ajfFormatIfNumber: \'.0-2\' }}\n          </ng-container>\n        </td>\n        <ng-container *ngIf="columns && columns.length > 1 && columns[1] != null">\n          <td *ngFor="let c of columns[1]; let column = index">\n            <ng-container *ngIf="c|ajfGetTableCellControl as contr">\n              <ng-container *ngIf="contr != null">\n                <span *ngIf="row > 0; else labelCell"\n                  class="ajf-table-cell">{{ contr.control!.value | ajfTranslateIfString | ajfFormatIfNumber: \'.0-2\' }}</span>\n                <ng-template #labelCell>{{ contr | ajfTranslateIfString | ajfFormatIfNumber: \'.0-2\' }}</ng-template>\n              </ng-container>\n            </ng-container>\n          </td>\n        </ng-container>\n      </tr>\n    </ng-container>\n  </ng-container>\n</table>\n',changeDetection:n.ChangeDetectionStrategy.OnPush,encapsulation:n.ViewEncapsulation.None,styles:["\n"]}]}],t.ctorParameters=function(){return[{type:n.ChangeDetectorRef},{type:Ce},{type:void 0,decorators:[{type:n.Inject,args:[Ve]}]}]},t}(v),De=function(){function e(){}return e.prototype.transform=function(e){return e%2==0?"ajf-row-even":"ajf-row-odd"},e.decorators=[{type:n.Pipe,args:[{name:"ajfTableRowClass"}]}],e}(),Ue=function(){function e(){}return e.prototype.transform=function(e){if(!e.node.editable){var n=e.value||[];return e.hideEmptyRows?n.filter((function(e){return e[1].reduce((function(e,n){return e||null!=n&&""!==n&&0!==n&&"0"!==n}),!1)})).map((function(e){return C([e[0]],e[1])})):n.map((function(e){return C([e[0]],e[1])}))}return(e.controls||[]).map((function(e){return C([e[0]],e[1])}))},e.decorators=[{type:n.Pipe,args:[{name:"ajfTableVisibleColumns"}]}],e}(),Be=function(){function e(){}return e.prototype.transform=function(e,n){return null!=n&&"number"==typeof n&&(n>=e.slideNodes.length||e.slideNodes[n].map((function(e){return!(e.visible&&Object.keys(e).indexOf("valid")>-1)||e.valid})).reduce((function(e,n){return e&&n}),!0))},e.decorators=[{type:n.Pipe,args:[{name:"ajfValidSlide",pure:!1}]}],e}(),ke=function(){function e(){}return e.decorators=[{type:n.NgModule,args:[{declarations:[h,m,y,g,_,F,S,I,R,Fe,Se,we,Ae,Ee,Ie,Oe,Pe,De,Ue,Be],imports:[d.AjfCommonModule,p.CommonModule],exports:[h,m,y,g,_,F,S,I,R,Fe,Se,we,Ae,Ee,Ie,Oe,Pe,De,Ue,Be],providers:[_,Ce,je]}]}],e}(),Ge=new n.InjectionToken("AJF_SEARCH_ALERT_THRESHOLD"),Je=function(){function e(){}return e.fromJson=function(e){if(null==e.name)throw new Error("Malformed attachments origin");return
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function n(e){return j(j({},e),{attachments:e.attachments||[]})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */(e)},e}();
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function We(e){return j(j({},e),{type:e.type,label:e.label||"",choices:e.choices||[]})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */var Le=function(){function e(){}return e.fromJson=function(e){return We(j(j({},e),{type:e.type||"fixed",name:e.name||""}))},e}();
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function $e(e){var n=Q(e);return j(j({},n),{nodes:e.nodes||[]})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function ze(e){var n=Q(e);return j(j(j({},e),n),{minReps:null!=e.minReps?e.minReps:1,maxReps:null!=e.maxReps?e.maxReps:0})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function He(n){return j(j(j({},$e(n)),ze(n)),{nodeType:e.AjfNodeType.AjfNodeGroup})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function qe(n){return j(j(j({},$e(n)),ze(n)),{nodeType:e.AjfNodeType.AjfRepeatingSlide})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */function Ye(n){return j(j({},$e(n)),{nodeType:e.AjfNodeType.AjfSlide})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */var Ze=function(){function e(){}return e.fromJson=function(e){return ce(e)},e}(),Ke=function(){function e(){}return e.fromJson=function(e){return de(e)},e}(),Qe=function(){function n(){}return n.fromJson=function(t,o,r){var i="Malformed node";if(t.name=t.name||"",null==t.id||null==t.parent||null==t.nodeType)throw new Error(i);var s=t;switch(s.visibility&&(s.visibility=a.AjfConditionSerializer.fromJson(s.visibility)),s.conditionalBranches=(s.conditionalBranches||[]).map((function(e){return a.AjfConditionSerializer.fromJson(e)})),s.nodeType){case e.AjfNodeType.AjfField:return n._fieldFromJson(s,o,r);case e.AjfNodeType.AjfFieldNodeLink:return n._fieldNodeLinkFromJson(s);case e.AjfNodeType.AjfNodeGroup:return n._nodeGroupFromJson(s,o,r);case e.AjfNodeType.AjfRepeatingSlide:return n._repeatingSlideFromJson(s,o,r);case e.AjfNodeType.AjfSlide:return n._slideFromJson(s,o,r)}throw new Error(i)},n._containerNodeFromJson=function(e,t,o){return e.nodes=(e.nodes||[]).map((function(e){return n.fromJson(e,t,o)})),$e(e)},n._fieldFromJson=function(t,o,r){if(null==t.fieldType)throw new Error("Malformed field");var i=t;if(i.validation&&(i.validation=Ze.fromJson(i.validation)),i.warning&&(i.warning=Ke.fromJson(i.warning)),t.attachmentsOriginRef&&(i.attachmentOrigin=(r||[]).find((function(e){return e.name===t.attachmentsOriginRef}))),i.nextSlideCondition&&(i.nextSlideCondition=a.AjfConditionSerializer.fromJson(i.nextSlideCondition)),i.fieldType>100&&null!=V[i.fieldType]&&!0===V[i.fieldType].isFieldWithChoice)return n._fieldWithChoicesFromJson(t,o);switch(i.fieldType){case e.AjfFieldType.Formula:return n._formulaFieldFromJson(t);case e.AjfFieldType.MultipleChoice:case e.AjfFieldType.SingleChoice:return n._fieldWithChoicesFromJson(t,o)}return X(i)},n._fieldNodeLinkFromJson=function(n){return j(j({},Q(n)),{nodeType:e.AjfNodeType.AjfFieldNodeLink})},n._fieldWithChoicesFromJson=function(e,n){var t="Malformed field with choices";if(null==e.choicesOriginRef)throw new Error(t);var o=(n||[]).find((function(n){return n.name===e.choicesOriginRef}));if(null==o)throw new Error(t);return e.choicesFilter&&(e.choicesFilter=a.AjfFormulaSerializer.fromJson(e.choicesFilter)),e.triggerConditions&&(e.triggerConditions=e.triggerConditions.map((function(e){return a.AjfConditionSerializer.fromJson(e)}))),function r(e){var n=X(j({},e));return j(j(j({},n),e),{choices:e.choices||[],forceExpanded:e.forceExpanded||!1,forceNarrow:e.forceNarrow||!1})}(j(j({},e),{choicesOrigin:o}))},n._formulaFieldFromJson=function(n){return n.formula&&(n.formula=a.AjfFormulaSerializer.fromJson(n.formula)),j(j({},X(n)),{fieldType:e.AjfFieldType.Formula})},n._nodeGroupFromJson=function(e,t,o){return He(j(j({},n._containerNodeFromJson(e,t,o)),n._repeatingNodeFromJson(e)))},n._repeatingNodeFromJson=function(e){return e.formulaReps&&(e.formulaReps=a.AjfFormulaSerializer.fromJson(e.formulaReps)),ze(e)},n._repeatingSlideFromJson=function(e,t,o){return qe(j(j({},n._containerNodeFromJson(e,t,o)),n._repeatingNodeFromJson(e)))},n._slideFromJson=function(e,t,o){return Ye(n._containerNodeFromJson(e,t,o))},n}(),Xe=function(){function e(){}return e.fromJson=function(e,n){var t=(e.choicesOrigins||[]).map((function(e){return Le.fromJson(e)})),o=(e.attachmentsOrigins||[]).map((function(e){return Je.fromJson(e)})),r=(e.nodes||[]).map((function(e){return Qe.fromJson(e,t,o)}));return j(j({},e),{choicesOrigins:t,attachmentsOrigins:o,nodes:r,stringIdentifier:e.stringIdentifier||[],initContext:l.deepCopy(n||{})})},e}(),en=function(e){function t(n,t,o){return e.call(this,n,t,o)||this}return N(t,e),t.prototype.goToNextCell=function(e,n,t){if(!(this.instance.controls.length<n||this.instance.controls.length>=n&&this.instance.controls[n].length<1||this.instance.controls[n][1].length<t)){var o=this.instance.controls[n][1][t];t+1>=this.instance.controls[n][1].length?(t=0,n+1>=this.instance.controls.length?n=1:n+=1):t+=1,"string"!=typeof o&&(o.show=!1),this._showCell(n,t),e.preventDefault(),e.stopPropagation()}},t.prototype.goToCell=function(e,n){this._resetControls(),this._showCell(e,n)},t.prototype._resetControls=function(){this.instance.controls.forEach((function(e){return e[1].forEach((function(e){"string"!=typeof e&&(e.show=!1)}))}))},t.prototype._showCell=function(e,n){if(!(e>=this.instance.controls.length||n>=this.instance.controls[e][1].length)){var t=this.instance.controls[e][1][n];"string"!=typeof t&&(t.show=!0)}},t.ctorParameters=function(){return[{type:n.ChangeDetectorRef},{type:Ce},{type:void 0,decorators:[{type:n.Inject,args:[Ve]}]}]},t}(v);
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function nn(e){return null!=e&&"object"==typeof e&&null!=e.name&&"string"==typeof e.name&&null!=e.label&&"string"==typeof e.label&&["fixed","promise","observable","observableArray","function"].indexOf(e.type)>-1&&e.choices instanceof Array}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
e.AJF_SEARCH_ALERT_THRESHOLD=Ge,e.AJF_WARNING_ALERT_SERVICE=Ve,e.AjfAsFieldInstancePipe=h,e.AjfAsRepeatingSlideInstancePipe=m,e.AjfAttachmentsOriginSerializer=Je,e.AjfBaseFieldComponent=v,e.AjfBoolToIntPipe=y,e.AjfChoicesOriginSerializer=Le,e.AjfDateValuePipe=g,e.AjfDateValueStringPipe=_,e.AjfExpandFieldWithChoicesPipe=F,e.AjfFieldHost=S,e.AjfFieldIconPipe=I,e.AjfFieldIsValidPipe=R,e.AjfFieldService=O,e.AjfFieldWithChoicesComponent=P,e.AjfFormActionEvent=Te,e.AjfFormField=w,e.AjfFormRenderer=Me,e.AjfFormRendererService=Ce,e.AjfFormSerializer=Xe,e.AjfFormsModule=ke,e.AjfGetTableCellControlPipe=Fe,e.AjfIncrementPipe=Se,e.AjfInputFieldComponent=Re,e.AjfInvalidFieldDefinitionError=M,e.AjfIsCellEditablePipe=we,e.AjfIsRepeatingSlideInstancePipe=Ae,e.AjfNodeCompleteNamePipe=Ee,e.AjfNodeSerializer=Qe,e.AjfRangePipe=Ie,e.AjfReadOnlyFieldComponent=Oe,e.AjfReadOnlyTableFieldComponent=Pe,e.AjfTableFieldComponent=en,e.AjfTableRowClass=De,e.AjfTableVisibleColumnsPipe=Ue,e.AjfValidSlidePipe=Be,e.AjfValidationGroupSerializer=Ze,e.AjfValidationService=je,e.AjfWarningGroupSerializer=Ke,e.createChoicesFixedOrigin=
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function tn(e){return j(j({},We(j(j({},e),{type:"fixed"}))),{type:"fixed"})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */,e.createChoicesFunctionOrigin=function on(e){return j(j({},e),{type:"function",label:e.label||"",choices:e.choices||[]})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */,e.createChoicesObservableArrayOrigin=function rn(e){return j(j({},e),{type:"observableArray",label:e.label||"",choices:e.choices||[]})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */,e.createChoicesObservableOrigin=function an(e){return j(j({},e),{type:"observable",label:e.label||"",choices:e.choices||[]})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */,e.createChoicesOrigin=We,e.createChoicesPromiseOrigin=function sn(e){return j(j({},e),{type:"promise",label:e.label||"",choices:e.choices||[]})},e.createContainerNode=$e,e.createField=X,e.createFieldInstance=se,e.createFieldWithChoicesInstance=ue,e.createForm=
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function un(e){return void 0===e&&(e={}),{nodes:e.nodes||[],choicesOrigins:e.choicesOrigins||[],attachmentsOrigins:e.attachmentsOrigins||[],initContext:e.initContext||{},stringIdentifier:e.stringIdentifier||[],supplementaryInformations:e.supplementaryInformations}}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */,e.createNode=Q,e.createNodeInstance=ae,e.createValidation=ve,e.createValidationGroup=ce,e.createWarning=ye,e.createWarningGroup=de,e.fieldIconName=A,e.flattenNodes=_e,e.getTypeName=
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */
function ln(e){var n=typeof e;return"object"===n?e.constructor.toString().match(/\w+/g)[1]:n}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */,e.initChoicesOrigin=D,e.isChoicesFixedOrigin=function cn(e){return nn(e)&&"fixed"===e.type}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */,e.isChoicesOrigin=nn,e.isContainerNode=te,e.isCustomFieldWithChoices=ee,e.isField=B,e.isFieldWithChoices=U,e.isNumberField=function dn(n){return n.fieldType===e.AjfFieldType.Number},e.isRepeatingContainerNode=pe,e.isSlidesNode=ne,e.maxDigitsValidation=function pn(e){return ve({condition:"$value ? $value.toString().length <= "+e.toString()+" : false",errorMessage:"Digits count must be <= "+e.toString()})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */,e.maxValidation=function fn(e){return ve({condition:"$value <= "+e.toString(),errorMessage:"Value must be <= "+e.toString()})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */,e.minDigitsValidation=function hn(e){return ve({condition:"$value ? $value.toString().length >= "+e.toString()+" : false",errorMessage:"Digits count must be >= "+e.toString()})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */,e.minValidation=function mn(e){return ve({condition:"$value >= "+e.toString(),errorMessage:"Value must be >= "+e.toString()})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */,e.notEmptyValidation=function vn(){return ve({condition:"notEmpty($value)",errorMessage:"Value must not be empty"})}
/**
     * @license
     * Copyright (C) Gnucoop soc. coop.
     *
     * This file is part of the Advanced JSON forms (ajf).
     *
     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or
     * modify it under the terms of the GNU Affero General Public License as
     * published by the Free Software Foundation, either version 3 of the License,
     * or (at your option) any later version.
     *
     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,
     * but WITHOUT ANY WARRANTY; without even the implied warranty of
     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero
     * General Public License for more details.
     *
     * You should have received a copy of the GNU Affero General Public License
     * along with Advanced JSON forms (ajf).
     * If not, see http://www.gnu.org/licenses/.
     *
     */,e.notEmptyWarning=function yn(){return ye({condition:"notEmpty($value)",warningMessage:"Value must not be empty"})},e.ɵgc_ajf_src_core_forms_forms_a=He,e.ɵgc_ajf_src_core_forms_forms_b=qe,e.ɵgc_ajf_src_core_forms_forms_c=Ye,e.ɵgc_ajf_src_core_forms_forms_d=V,Object.defineProperty(e,"__esModule",{value:!0})}));