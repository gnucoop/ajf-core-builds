{"version":3,"sources":["src/core/core-forms.umd.js"],"names":["global","factory","exports","module","require","define","amd","self","ajf","core","forms","ng","cdk","coercion","rxjs","operators","dateFns","models","utils","esprima","this","pageSlider","esprima__default","AjfAsFieldInstancePipe","prototype","transform","instance","decorators","type","Pipe","args","name","AjfAsRepeatingSlideInstancePipe","AjfBaseFieldComponent","_changeDetectorRef","_service","_warningAlertService","_this","_warningTriggerSub","Subscription","EMPTY","_instanceUpdateSub","_control","defer","getControl","pipe","map","ctrl","FormControl","Object","defineProperty","get","_instance","set","_setUpInstanceUpdate","_onInstanceChange","enumerable","configurable","_readonly","readonly","coerceBooleanProperty","markForCheck","ngOnInit","warningTrigger","withLatestFrom","control","filter","v","subscribe","warningResults","s","showWarningAlertPrompt","w","result","warning","r","setValue","_e","unsubscribe","ngOnDestroy","updatedEvt","detectChanges","e","AjfBoolToIntPipe","value","AjfDateValuePipe","date","Date","AjfDateValueStringPipe","dateObj","format","Injectable","extendStatics","d","b","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","constructor","create","__assign","assign","t","i","n","arguments","length","call","apply","__read","o","m","Symbol","iterator","ar","next","done","push","error","__spread","concat","AjfFieldType","AjfInvalidFieldDefinitionError","_super","message","AjfError","AjfExpandFieldWithChoicesPipe","threshold","node","forceNarrow","forceExpanded","filteredChoices","fieldIconName","toLowerCase","AjfNodeType","AjfFieldIconPipe","field","fieldType","AjfFieldIsValidPipe","validationResults","f","AjfFieldHost","viewContainerRef","Directive","selector","ctorParameters","ViewContainerRef","AjfFormField","_cdr","_cfr","_updatedSub","_loadComponent","_componentInstance","fieldHost","vcr","clear","componentDef","componentsMap","component","componentFactory","resolveComponentFactory","componentRef","createComponent","inputs","keys","forEach","key","console","log","ChangeDetectorRef","ComponentFactoryResolver","propDecorators","ViewChild","static","Input","AjfFieldService","registerCustomField","Error","AjfFieldWithChoicesComponent","cdr","service","warningAlertService","searchThreshold","_searchThreshold","initChoicesOrigin","origin","Promise","resolve","choices","generator","po_1","then","obso_1","res","c","aoo_1","isFieldWithChoices","SingleChoice","MultipleChoice","isField","nodeType","AjfField","isFieldInstance","nodeInstance","isFieldWithChoicesInstance","updateConditionalBranches","context","conditionalBranches","oldBranch","verifiedBranch","idx","found","evaluateExpression","condition","updateVisibility","branchVisibility","visibility","visible","oldVisibility","newVisibility","nodeInstanceSuffix","prefix","join","nodeInstanceCompleteName","updateFormula","formula","editable","newValue","oldValue","$value","changed","updateNextSlideCondition","nextSlideCondition","evaluateValidation","validation","forceFormula","errorMessage","clientValidation","updateValidation","supplementaryInformations","completeName","forceValue","evaluateValidationGroup","ctx","deepCopy","evaluateValidationConditions","conditions","cond","maxValue","evaluateValidationMaxValue","minValue","evaluateValidationMinValue","notEmpty","evaluateValidationNotEmpty","maxDigits","evaluateValidationMaxDigits","minDigits","evaluateValidationMinDigits","valid","reduce","prev","x","updateWarning","evaluateWarningGroup","evaluateWarningConditions","evaluateWarning","warningMessage","updateFilteredChoices","choicesFilter","choicesOrigin","$choice","$choiceValue","createNode","alwaysCondition","parentNode","label","createField","Formula","Table","defaultValue","size","isCustomFieldWithChoices","isFieldWithChoice","isSlidesNode","AjfRepeatingSlide","AjfSlide","isContainerNode","AjfNodeGroup","flattenNodesInstances","nodes","includeGroups","flatNodes","isContainerNodeInstance","isSlidesInstance","isNodeGroupInstance","isNodeGroup","createNodeInstance","EventEmitter","createFieldInstance","createFieldWithChoicesInstance","fieldInstance","firstTriggerConditionDone","selectionTrigger","createSlideInstance","slideNodes","position","createValidationGroup","group","createWarningGroup","isRepeatingContainerNode","getInstanceCondition","ancestorsNames","oldCondition","newCondition","normalizeExpression","getInstanceConditions","newConditions","getInstanceFormula","oldFormula","newFormula","createValidation","createWarning","isRepeatingSlideInstance","isRepeatingSlide","flattenNodes","orderedNodes","parent","newNodes","sort","n1","n2","id","updateRepsNum","oldReps","reps","formulaReps","ctxReps","newReps","canAdd","maxReps","canRemove","minReps","AjfFormInitStatus","AjfValidationService","_baseUtilFunctions","_functions","_functionsStr","_initFunctions","addFunction","addFunctionHandler","fn","undefined","AjfExpressionUtils","functionsStr","toString","UTIL_FUNCTIONS","tokenize","AjfFormRendererService","_","_visibilityNodesMapUpdates","Subject","_repetitionNodesMapUpdates","_conditionalBranchNodesMapUpdates","_formulaNodesMapUpdates","_validationNodesMapUpdates","_warningNodesMapUpdates","_filteredChoicesNodesMapUpdates","_triggerConditionsNodesMapUpdates","_nextSlideConditionsNodesMapUpdates","_formInitEvent","formInitEvent","asObservable","_formGroup","BehaviorSubject","formGroup","_form","_nodesUpdates","_formGroupSubscription","_valueChanged","_nextSlideTrigger","nextSlideTrigger","_slidesNum","slidesNum","_initUpdateMapStreams","_initNodesStreams","_initErrorsStreams","_initFormStreams","_updateFormValueAndValidity","_flatNodesTree","_errorPositions","_errors","form","getValue","setForm","initContext","currentForm","getFormValue","addGroup","Observable","subscriber","complete","_adjustReps","removeGroup","fieldName","contains","controls","_nodes","currentPosition","errors","rsNode","slide","indexOf","v1","v2","sNode","publishReplay","refCount","startWith","_visibilityNodesMap","scan","rmap","op","share","_repetitionNodesMap","_conditionalBranchNodesMap","_formulaNodesMap","_validationNodesMap","_warningNodesMap","_filteredChoicesNodesMap","_triggerConditionsNodesMap","_nextSlideConditionsNodesMap","_nodesMaps","formObs","_initFormGroupStreams","FormGroup","switchMap","of","choicesOrigins","from","all","co","_nodesInstances","_orderedNodesInstancesTree","_initNodeInstance","allNodes","nodeToNodeInstance","createInstance","createTableFieldInstance","normalizeRows","rows","row","rowIdx","elem","elemIdx","hideEmptyRows","createNodeGroupInstance","createRepeatingSlideInstance","slideInstance","getAncestorRepeatingNodesNames","names","getAncestorRepeatingNodes","nodeGroups","curParent","curNode","find","sn","createCondition","ngInstance","createFormula","fNode","fInstance","getInstanceValidations","validations","newValidations","newValidation","getInstanceValidation","oldValidation","newWarnings","getInstanceWarnings","warnings","newWarning","getInstanceWarning","oldWarning","fwcNode","fwcInstance","triggerConditions","_explodeRepeatingNode","isTableFieldInstance","isTableField","tfInstance_1","tNode_1","formGroup_1","controlsWithLabels_1","columnLabels","cell","registerControl","fakeInstance","_addToNodesFormulaMap","rowLabels","updateFieldInstanceState","_addNodeInstance","added","removed","newNodes_1","Empty","newInstance","slice","_loop_1","this_1","nodesNum","splice","_removeNodeInstance","fg","rsInstance","nodesPerSlide","startNode","values","updateValueAndValidity","nodesInstances","curSuffix","parentNodeInstance","ni","nni","_formValueDelta","k","init","initForm","emit","Initializing","valueChanges","pairwise","debounceTime","_flatNodes","oldFormValue","newFormValue","visibilityMap","repetitionMap","conditionalBranchesMap","formulaMap","validationMap","warningMap","nextSlideConditionsMap","filteredChoicesMap","triggerConditionsMap","delta","deltaLen","updatedNodes","visibilityChanged","fg_1","s_1","timer","closed","rnInstance","_condition","_showSubtree","_hideSubtree","currentSupplementaryInformations","updateTriggerConditions","conditionsNum","subNodesNum","subNode","Complete","branch","_updateSubtreeVisibility","subNodes","nodeSuffix","isContainer","cn","flattenNodesInstancesTree","flatTree","slides","nodeName","_removeNodesVisibilityMapIndex","_removeNodesRepetitionMapIndex","_removeNodesConditionalBranchMapIndex","_removeNodesFormulaMapIndex","_removeNodesValidationMapIndex","_removeNodesWarningMapIndex","_removeNodesNextSlideConditionsMapIndex","_removeNodesFilteredChoicesMapIndex","_removeNodesTriggerConditionsMapIndex","_removeSlideInstance","_removeNodeGroupInstance","_removeFieldInstance","_removeFromNodesVisibilityMap","conditionalBranch","_removeFromNodesConditionalBranchMap","nodeGroupInstance","nodeGroup","_removeFromNodesRepetitionMap","fieldInstanceName","removeControl","vmap","_removeFromNodesFormulaMap","_removeFromNodesValidationMap","_removeFromNodesWarningMap","_removeFromNodesNextSlideConditionsMap","_removeFromNodesFilteredChoicesMap","_removeFromNodesTriggerConditionsMap","_addNodeGroupInstance","isSlideInstance","isSlideNode","_addSlideInstance","_addFieldInstance","_addToNodesVisibilityMap","_addToNodesConditionalBranchMap","_addToNodesRepetitionMap","_addToNodesValidationMap","_addToNodesWarningMap","_addToNodesNextSlideConditionsMap","_addToNodesFilteredChoicesMap","_addToNodesTriggerConditionsMap","nodeGroupInstanceName","index","_removeNodesMapIndex","nodesMap","_removeFromNodesMap","tokens","token","tokenName","_addToNodesMap","AjfFormActionEvent","AjfFormRenderer","_rendererService","ajfFieldTypes","_orientationChange","orientationChange","_saveDisabled","_hasStartMessage","_hasEndMessage","_hideTopToolbar","_hideBottomToolbar","_hideNavigationButtons","_fixedOrientation","_orientation","_errorMoveEvent","_init","_nextSlideSubscription","_errorMoveSubscription","_formAction","formAction","nodesTree","errorPositions","formIsInit","saveDisabled","hasStartMessage","hasEndMessage","hideTopToolbar","hideBottomToolbar","hideNavigationButtons","fixedOrientation","orientation","goToNextError","goToPrevError","delayWhen","formSlider","pageScrollFinish","dir","onSave","_evt","source","action","onFormAction","ngAfterViewInit","ngAfterViewChecked","move","currentPage","prevIdx","nextIdx","errorsLen","to","orientationChangeHandler","trackNodeById","title","Output","fields","ViewChildren","AjfIncrementPipe","increment","AjfIsRepeatingSlideInstancePipe","AjfNodeCompleteNamePipe","AjfRangePipe","start","step","range","length_1","AjfTableRowClass","AjfTableVisibleColumnsPipe","val","col","cur","AjfValidSlidePipe","pure","AjfFormsModule","NgModule","declarations","providers","AjfInputFieldComponent","AJF_SEARCH_ALERT_THRESHOLD","InjectionToken","AjfAttachmentsOriginSerializer","fromJson","createAttachmentsOrigin","attachments","createChoicesOrigin","AjfChoicesOriginSerializer","createContainerNode","containerNode","createRepeatingNode","repeatingNode","createNodeGroup","createRepeatingSlide","createSlide","AjfAttachmentsType","AjfChoicesType","AjfValidationGroupSerializer","AjfWarningGroupSerializer","AjfNodeSerializer","json","attachmentsOrigins","err","obj","AjfConditionSerializer","_fieldFromJson","AjfFieldNodeLink","_fieldNodeLinkFromJson","_nodeGroupFromJson","_repeatingSlideFromJson","_slideFromJson","_containerNodeFromJson","attachmentsOriginRef","attachmentOrigin","a","_fieldWithChoicesFromJson","_formulaFieldFromJson","choicesOriginRef","AjfFormulaSerializer","createFieldWithChoices","_repeatingNodeFromJson","AjfFormSerializer","stringIdentifier","isChoicesOrigin","createChoicesFixedOrigin","createChoicesFunctionOrigin","createChoicesObservableArrayOrigin","createChoicesObservableOrigin","createChoicesPromiseOrigin","createForm","getTypeName","typeStr","match","isChoicesFixedOrigin","isNumberField","Number","maxDigitsValidation","maxValidation","minDigitsValidation","minValidation","notEmptyValidation","notEmptyWarning","ɵgc_ajf_src_core_forms_forms_a","ɵgc_ajf_src_core_forms_forms_b","ɵgc_ajf_src_core_forms_forms_c","ɵgc_ajf_src_core_forms_forms_d"],"mappings":"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","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/core'), require('@angular/cdk/coercion'), require('@angular/forms'), require('rxjs'), require('rxjs/operators'), require('date-fns'), require('@ajf/core/models'), require('@ajf/core/utils'), require('esprima'), require('@ajf/core/page-slider')) :\n    typeof define === 'function' && define.amd ? define('@ajf/core/forms', ['exports', '@angular/core', '@angular/cdk/coercion', '@angular/forms', 'rxjs', 'rxjs/operators', 'date-fns', '@ajf/core/models', '@ajf/core/utils', 'esprima', '@ajf/core/page-slider'], factory) :\n    (global = global || self, factory((global.ajf = global.ajf || {}, global.ajf.core = global.ajf.core || {}, global.ajf.core.forms = {}), global.ng.core, global.ng.cdk.coercion, global.ng.forms, global.rxjs, global.rxjs.operators, global.dateFns, global.ng.core.models, global.ng.core.utils, global.esprima, global.ng.core.pageSlider));\n}(this, (function (exports, core, coercion, forms, rxjs, operators, dateFns, models, utils, esprima, pageSlider) { 'use strict';\n\n    var esprima__default = 'default' in esprima ? esprima['default'] : esprima;\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfAsFieldInstancePipe = /** @class */ (function () {\n        function AjfAsFieldInstancePipe() {\n        }\n        AjfAsFieldInstancePipe.prototype.transform = function (instance) {\n            return instance;\n        };\n        AjfAsFieldInstancePipe.decorators = [\n            { type: core.Pipe, args: [{ name: 'ajfAsFieldInstance' },] }\n        ];\n        return AjfAsFieldInstancePipe;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfAsRepeatingSlideInstancePipe = /** @class */ (function () {\n        function AjfAsRepeatingSlideInstancePipe() {\n        }\n        AjfAsRepeatingSlideInstancePipe.prototype.transform = function (instance) {\n            return instance;\n        };\n        AjfAsRepeatingSlideInstancePipe.decorators = [\n            { type: core.Pipe, args: [{ name: 'ajfAsRepeatingSlideInstance' },] }\n        ];\n        return AjfAsRepeatingSlideInstancePipe;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfBaseFieldComponent = /** @class */ (function () {\n        function AjfBaseFieldComponent(_changeDetectorRef, _service, _warningAlertService) {\n            var _this = this;\n            this._changeDetectorRef = _changeDetectorRef;\n            this._service = _service;\n            this._warningAlertService = _warningAlertService;\n            this._warningTriggerSub = rxjs.Subscription.EMPTY;\n            this._instanceUpdateSub = rxjs.Subscription.EMPTY;\n            this._control = rxjs.defer(function () { return _this._service.getControl(_this.instance).pipe(operators.map(function (ctrl) { return ctrl || new forms.FormControl(); })); });\n        }\n        Object.defineProperty(AjfBaseFieldComponent.prototype, \"instance\", {\n            get: function () { return this._instance; },\n            set: function (instance) {\n                if (instance !== this._instance) {\n                    this._instance = instance;\n                    this._setUpInstanceUpdate();\n                    this._onInstanceChange();\n                }\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(AjfBaseFieldComponent.prototype, \"readonly\", {\n            get: function () { return this._readonly; },\n            set: function (readonly) {\n                this._readonly = coercion.coerceBooleanProperty(readonly);\n                this._changeDetectorRef.markForCheck();\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(AjfBaseFieldComponent.prototype, \"control\", {\n            get: function () { return this._control; },\n            enumerable: true,\n            configurable: true\n        });\n        AjfBaseFieldComponent.prototype.ngOnInit = function () {\n            var _this = this;\n            this._warningTriggerSub = this.instance.warningTrigger.pipe(operators.withLatestFrom(this.control), operators.filter(function (v) { return v[1] != null; })).subscribe(function (v) {\n                if (_this.instance.warningResults == null) {\n                    return;\n                }\n                var control = v[1];\n                var s = _this._warningAlertService.showWarningAlertPrompt(_this.instance.warningResults.filter(function (w) { return w.result; }).map(function (w) { return w.warning; })).subscribe(function (r) {\n                    if (r.result) {\n                        control.setValue(null);\n                    }\n                }, function (_e) { if (s) {\n                    s.unsubscribe();\n                } }, function () { if (s) {\n                    s.unsubscribe();\n                } });\n            });\n        };\n        AjfBaseFieldComponent.prototype.ngOnDestroy = function () {\n            this._warningTriggerSub.unsubscribe();\n            this._instanceUpdateSub.unsubscribe();\n        };\n        AjfBaseFieldComponent.prototype._onInstanceChange = function () { };\n        AjfBaseFieldComponent.prototype._setUpInstanceUpdate = function () {\n            var _this = this;\n            this._instanceUpdateSub.unsubscribe();\n            if (this._instance != null) {\n                this._instanceUpdateSub = this._instance.updatedEvt.subscribe(function () {\n                    if (_this._changeDetectorRef) {\n                        try {\n                            _this._changeDetectorRef.detectChanges();\n                        }\n                        catch (e) { }\n                    }\n                });\n            }\n            else {\n                this._instanceUpdateSub = rxjs.Subscription.EMPTY;\n            }\n            this._changeDetectorRef.detectChanges();\n        };\n        return AjfBaseFieldComponent;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfBoolToIntPipe = /** @class */ (function () {\n        function AjfBoolToIntPipe() {\n        }\n        AjfBoolToIntPipe.prototype.transform = function (value) {\n            return value ? 1 : 0;\n        };\n        AjfBoolToIntPipe.decorators = [\n            { type: core.Pipe, args: [{ name: 'ajfBoolToInt' },] }\n        ];\n        return AjfBoolToIntPipe;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfDateValuePipe = /** @class */ (function () {\n        function AjfDateValuePipe() {\n        }\n        AjfDateValuePipe.prototype.transform = function (date) {\n            if (date == null) {\n                return null;\n            }\n            return date === 'today' ? new Date() : date;\n        };\n        AjfDateValuePipe.decorators = [\n            { type: core.Pipe, args: [{ name: 'ajfDateValue' },] }\n        ];\n        return AjfDateValuePipe;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfDateValueStringPipe = /** @class */ (function () {\n        function AjfDateValueStringPipe() {\n        }\n        AjfDateValueStringPipe.prototype.transform = function (date) {\n            if (date == null) {\n                return undefined;\n            }\n            var dateObj = date === 'today' ? new Date() : date;\n            return dateFns.format(dateObj, 'yyyy-MM-dd');\n        };\n        AjfDateValueStringPipe.decorators = [\n            { type: core.Injectable },\n            { type: core.Pipe, args: [{ name: 'ajfDateValueString' },] }\n        ];\n        return AjfDateValueStringPipe;\n    }());\n\n    /*! *****************************************************************************\r\n    Copyright (c) Microsoft Corporation. All rights reserved.\r\n    Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\n    this file except in compliance with the License. You may obtain a copy of the\r\n    License at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\n    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\n    MERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\n    See the Apache Version 2.0 License for specific language governing permissions\r\n    and limitations under the License.\r\n    ***************************************************************************** */\r\n    /* global Reflect, Promise */\r\n\r\n    var extendStatics = function(d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n\r\n    function __extends(d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    }\r\n\r\n    var __assign = function() {\r\n        __assign = Object.assign || function __assign(t) {\r\n            for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n                s = arguments[i];\r\n                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n            }\r\n            return t;\r\n        };\r\n        return __assign.apply(this, arguments);\r\n    };\r\n\r\n    function __rest(s, e) {\r\n        var t = {};\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n            t[p] = s[p];\r\n        if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n            for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n                t[p[i]] = s[p[i]];\r\n        return t;\r\n    }\r\n\r\n    function __decorate(decorators, target, key, desc) {\r\n        var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n        if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n        else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n        return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n    }\r\n\r\n    function __param(paramIndex, decorator) {\r\n        return function (target, key) { decorator(target, key, paramIndex); }\r\n    }\r\n\r\n    function __metadata(metadataKey, metadataValue) {\r\n        if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n    }\r\n\r\n    function __awaiter(thisArg, _arguments, P, generator) {\r\n        return new (P || (P = Promise))(function (resolve, reject) {\r\n            function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n            function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n            function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n            step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n        });\r\n    }\r\n\r\n    function __generator(thisArg, body) {\r\n        var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n        return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n        function verb(n) { return function (v) { return step([n, v]); }; }\r\n        function step(op) {\r\n            if (f) throw new TypeError(\"Generator is already executing.\");\r\n            while (_) try {\r\n                if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n                if (y = 0, t) op = [op[0] & 2, t.value];\r\n                switch (op[0]) {\r\n                    case 0: case 1: t = op; break;\r\n                    case 4: _.label++; return { value: op[1], done: false };\r\n                    case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                    case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                    default:\r\n                        if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                        if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                        if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                        if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                        if (t[2]) _.ops.pop();\r\n                        _.trys.pop(); continue;\r\n                }\r\n                op = body.call(thisArg, _);\r\n            } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n            if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n        }\r\n    }\r\n\r\n    function __exportStar(m, exports) {\r\n        for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n    }\r\n\r\n    function __values(o) {\r\n        var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n        if (m) return m.call(o);\r\n        return {\r\n            next: function () {\r\n                if (o && i >= o.length) o = void 0;\r\n                return { value: o && o[i++], done: !o };\r\n            }\r\n        };\r\n    }\r\n\r\n    function __read(o, n) {\r\n        var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n        if (!m) return o;\r\n        var i = m.call(o), r, ar = [], e;\r\n        try {\r\n            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n        }\r\n        catch (error) { e = { error: error }; }\r\n        finally {\r\n            try {\r\n                if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n            }\r\n            finally { if (e) throw e.error; }\r\n        }\r\n        return ar;\r\n    }\r\n\r\n    function __spread() {\r\n        for (var ar = [], i = 0; i < arguments.length; i++)\r\n            ar = ar.concat(__read(arguments[i]));\r\n        return ar;\r\n    }\r\n\r\n    function __await(v) {\r\n        return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n    }\r\n\r\n    function __asyncGenerator(thisArg, _arguments, generator) {\r\n        if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n        var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n        return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n        function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n        function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n        function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n        function fulfill(value) { resume(\"next\", value); }\r\n        function reject(value) { resume(\"throw\", value); }\r\n        function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n    }\r\n\r\n    function __asyncDelegator(o) {\r\n        var i, p;\r\n        return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n        function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n    }\r\n\r\n    function __asyncValues(o) {\r\n        if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n        var m = o[Symbol.asyncIterator], i;\r\n        return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n        function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n        function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n    }\r\n\r\n    function __makeTemplateObject(cooked, raw) {\r\n        if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n        return cooked;\r\n    };\r\n\r\n    function __importStar(mod) {\r\n        if (mod && mod.__esModule) return mod;\r\n        var result = {};\r\n        if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n        result.default = mod;\r\n        return result;\r\n    }\r\n\r\n    function __importDefault(mod) {\r\n        return (mod && mod.__esModule) ? mod : { default: mod };\r\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    /**\n     * This class will define an Ajf invalid field definition error\n     */\n    var AjfInvalidFieldDefinitionError = /** @class */ (function (_super) {\n        __extends(AjfInvalidFieldDefinitionError, _super);\n        function AjfInvalidFieldDefinitionError(message) {\n            return _super.call(this, message) || this;\n        }\n        Object.defineProperty(AjfInvalidFieldDefinitionError.prototype, \"name\", {\n            get: function () { return 'AjfInvalidFieldDefinitionError'; },\n            enumerable: true,\n            configurable: true\n        });\n        return AjfInvalidFieldDefinitionError;\n    }(models.AjfError));\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfExpandFieldWithChoicesPipe = /** @class */ (function () {\n        function AjfExpandFieldWithChoicesPipe() {\n        }\n        AjfExpandFieldWithChoicesPipe.prototype.transform = function (instance, threshold) {\n            return !instance.node.forceNarrow && (instance.node.forceExpanded\n                || (instance.filteredChoices && instance.filteredChoices.length <= threshold));\n        };\n        AjfExpandFieldWithChoicesPipe.decorators = [\n            { type: core.Pipe, args: [{ name: 'ajfExpandFieldWithChoices' },] }\n        ];\n        return AjfExpandFieldWithChoicesPipe;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    (function (AjfFieldType) {\n        AjfFieldType[AjfFieldType[\"String\"] = 0] = \"String\";\n        AjfFieldType[AjfFieldType[\"Text\"] = 1] = \"Text\";\n        AjfFieldType[AjfFieldType[\"Number\"] = 2] = \"Number\";\n        AjfFieldType[AjfFieldType[\"Boolean\"] = 3] = \"Boolean\";\n        AjfFieldType[AjfFieldType[\"SingleChoice\"] = 4] = \"SingleChoice\";\n        AjfFieldType[AjfFieldType[\"MultipleChoice\"] = 5] = \"MultipleChoice\";\n        AjfFieldType[AjfFieldType[\"Formula\"] = 6] = \"Formula\";\n        AjfFieldType[AjfFieldType[\"Empty\"] = 7] = \"Empty\";\n        AjfFieldType[AjfFieldType[\"Date\"] = 8] = \"Date\";\n        AjfFieldType[AjfFieldType[\"DateInput\"] = 9] = \"DateInput\";\n        AjfFieldType[AjfFieldType[\"Time\"] = 10] = \"Time\";\n        AjfFieldType[AjfFieldType[\"Table\"] = 11] = \"Table\";\n        AjfFieldType[AjfFieldType[\"Geolocation\"] = 12] = \"Geolocation\";\n        AjfFieldType[AjfFieldType[\"Barcode\"] = 13] = \"Barcode\";\n        AjfFieldType[AjfFieldType[\"LENGTH\"] = 14] = \"LENGTH\";\n    })(exports.AjfFieldType || (exports.AjfFieldType = {}));\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function fieldIconName(type) {\n        return \"ajf-icon-field-\" + (typeof exports.AjfFieldType[type] === 'string'\n            ? exports.AjfFieldType[type].toLowerCase()\n            : type);\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfFieldIconPipe = /** @class */ (function () {\n        function AjfFieldIconPipe() {\n        }\n        AjfFieldIconPipe.prototype.transform = function (field) {\n            return fieldIconName(field.fieldType ? field.fieldType : field);\n        };\n        AjfFieldIconPipe.decorators = [\n            { type: core.Pipe, args: [{ name: 'ajfFieldIcon' },] }\n        ];\n        return AjfFieldIconPipe;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfFieldIsValidPipe = /** @class */ (function () {\n        function AjfFieldIsValidPipe() {\n        }\n        AjfFieldIsValidPipe.prototype.transform = function (validationResults) {\n            return validationResults != null\n                && validationResults.filter(function (f) { return !f.result; }).length === 0;\n        };\n        AjfFieldIsValidPipe.decorators = [\n            { type: core.Pipe, args: [{ name: 'ajfFieldIsValid' },] }\n        ];\n        return AjfFieldIsValidPipe;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfFieldHost = /** @class */ (function () {\n        function AjfFieldHost(viewContainerRef) {\n            this.viewContainerRef = viewContainerRef;\n        }\n        AjfFieldHost.decorators = [\n            { type: core.Directive, args: [{ selector: '[ajf-field-host]' },] }\n        ];\n        /** @nocollapse */\n        AjfFieldHost.ctorParameters = function () { return [\n            { type: core.ViewContainerRef }\n        ]; };\n        return AjfFieldHost;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfFormField = /** @class */ (function () {\n        function AjfFormField(_cdr, _cfr) {\n            this._cdr = _cdr;\n            this._cfr = _cfr;\n            this._updatedSub = rxjs.Subscription.EMPTY;\n        }\n        Object.defineProperty(AjfFormField.prototype, \"instance\", {\n            get: function () { return this._instance; },\n            set: function (instance) {\n                if (this._instance !== instance) {\n                    this._instance = instance;\n                    this._loadComponent();\n                }\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormField.prototype, \"readonly\", {\n            get: function () { return this._readonly; },\n            set: function (readonly) {\n                this._readonly = coercion.coerceBooleanProperty(readonly);\n                if (this._componentInstance != null) {\n                    this._componentInstance.readonly = this._readonly;\n                }\n                this._cdr.markForCheck();\n            },\n            enumerable: true,\n            configurable: true\n        });\n        AjfFormField.prototype.ngOnDestroy = function () {\n            this._updatedSub.unsubscribe();\n        };\n        AjfFormField.prototype.ngOnInit = function () {\n            this._loadComponent();\n        };\n        AjfFormField.prototype._loadComponent = function () {\n            var _this = this;\n            this._updatedSub.unsubscribe();\n            this._updatedSub = rxjs.Subscription.EMPTY;\n            if (this._instance == null || this.fieldHost == null) {\n                return;\n            }\n            var vcr = this.fieldHost.viewContainerRef;\n            vcr.clear();\n            var componentDef = this.componentsMap[this._instance.node.fieldType];\n            if (componentDef == null) {\n                return;\n            }\n            var component = componentDef.component;\n            try {\n                var componentFactory = this._cfr.resolveComponentFactory(component);\n                var componentRef = vcr.createComponent(componentFactory);\n                this._componentInstance = componentRef.instance;\n                this._componentInstance.instance = this._instance;\n                this._componentInstance.readonly = this._readonly;\n                if (componentDef.inputs) {\n                    Object.keys(componentDef.inputs).forEach(function (key) {\n                        if (key in _this._componentInstance) {\n                            _this._componentInstance[key] = componentDef.inputs[key];\n                        }\n                    });\n                }\n                this._updatedSub = this._instance.updatedEvt.subscribe(function () { return _this._cdr.markForCheck(); });\n            }\n            catch (e) {\n                console.log(e);\n            }\n        };\n        AjfFormField.decorators = [\n            { type: core.Directive }\n        ];\n        /** @nocollapse */\n        AjfFormField.ctorParameters = function () { return [\n            { type: core.ChangeDetectorRef },\n            { type: core.ComponentFactoryResolver }\n        ]; };\n        AjfFormField.propDecorators = {\n            fieldHost: [{ type: core.ViewChild, args: [AjfFieldHost, { static: true },] }],\n            instance: [{ type: core.Input }],\n            readonly: [{ type: core.Input }]\n        };\n        return AjfFormField;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var componentsMap = {};\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfFieldService = /** @class */ (function () {\n        function AjfFieldService() {\n            this.componentsMap = componentsMap;\n        }\n        AjfFieldService.prototype.registerCustomField = function (field) {\n            var fieldType = field.fieldType, component = field.component;\n            if (fieldType < 100) {\n                throw new Error('Invalid custom field type, it must be greater than 100');\n            }\n            if (component == null) {\n                throw new Error('Invalid custom field component');\n            }\n            this.componentsMap[fieldType] = field;\n        };\n        return AjfFieldService;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfFieldWithChoicesComponent = /** @class */ (function (_super) {\n        __extends(AjfFieldWithChoicesComponent, _super);\n        function AjfFieldWithChoicesComponent(cdr, service, warningAlertService, searchThreshold) {\n            var _this = _super.call(this, cdr, service, warningAlertService) || this;\n            _this._searchThreshold = 6;\n            if (searchThreshold != null) {\n                _this._searchThreshold = searchThreshold;\n            }\n            return _this;\n        }\n        Object.defineProperty(AjfFieldWithChoicesComponent.prototype, \"searchThreshold\", {\n            get: function () { return this._searchThreshold; },\n            enumerable: true,\n            configurable: true\n        });\n        return AjfFieldWithChoicesComponent;\n    }(AjfBaseFieldComponent));\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    (function (AjfNodeType) {\n        AjfNodeType[AjfNodeType[\"AjfField\"] = 0] = \"AjfField\";\n        AjfNodeType[AjfNodeType[\"AjfFieldNodeLink\"] = 1] = \"AjfFieldNodeLink\";\n        AjfNodeType[AjfNodeType[\"AjfNodeGroup\"] = 2] = \"AjfNodeGroup\";\n        AjfNodeType[AjfNodeType[\"AjfSlide\"] = 3] = \"AjfSlide\";\n        AjfNodeType[AjfNodeType[\"AjfRepeatingSlide\"] = 4] = \"AjfRepeatingSlide\";\n        AjfNodeType[AjfNodeType[\"LENGTH\"] = 5] = \"LENGTH\";\n    })(exports.AjfNodeType || (exports.AjfNodeType = {}));\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function initChoicesOrigin(origin) {\n        if (origin.type === 'fixed') {\n            return Promise.resolve();\n        }\n        if (origin.type === 'function') {\n            var fo = origin;\n            fo.choices = fo.generator();\n            return Promise.resolve();\n        }\n        if (origin.type === 'promise') {\n            var po_1 = origin;\n            return po_1.generator.then(function (choices) { return po_1.choices = choices; }).then();\n        }\n        if (origin.type === 'observable') {\n            var obso_1 = origin;\n            if (obso_1.generator != null) {\n                obso_1.choices = [];\n                return new Promise(function (res) {\n                    obso_1.generator.subscribe(function (c) { return obso_1.choices.push(c); }, function () { }, function () { return res(); });\n                });\n            }\n        }\n        if (origin.type === 'observableArray') {\n            var aoo_1 = origin;\n            if (aoo_1.generator != null) {\n                aoo_1.choices = [];\n                return new Promise(function (res) {\n                    aoo_1.generator.subscribe(function (choices) {\n                        aoo_1.choices = choices;\n                        res();\n                    });\n                });\n            }\n        }\n        return Promise.resolve();\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function isFieldWithChoices(field) {\n        return field.fieldType === exports.AjfFieldType.SingleChoice ||\n            field.fieldType === exports.AjfFieldType.MultipleChoice;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function isField(node) {\n        return node != null && node.nodeType === exports.AjfNodeType.AjfField;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function isFieldInstance(nodeInstance) {\n        return nodeInstance != null && nodeInstance.node != null && isField(nodeInstance.node);\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function isFieldWithChoicesInstance(nodeInstance) {\n        return nodeInstance != null && isFieldInstance(nodeInstance) &&\n            isFieldWithChoices(nodeInstance.node);\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function isTableField(field) {\n        return field.fieldType === exports.AjfFieldType.Table;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function isTableFieldInstance(nodeInstance) {\n        return nodeInstance != null && isFieldInstance(nodeInstance) &&\n            isTableField(nodeInstance.node);\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function updateConditionalBranches(instance, context) {\n        var conditionalBranches = instance.conditionalBranches;\n        if (conditionalBranches != null) {\n            var oldBranch = instance.verifiedBranch;\n            var idx = 0;\n            var found = false;\n            while (idx < conditionalBranches.length && !found) {\n                var verified = models.evaluateExpression(conditionalBranches[idx].condition, context);\n                if (verified) {\n                    found = true;\n                    if (idx !== instance.verifiedBranch) {\n                        instance.verifiedBranch = idx;\n                    }\n                }\n                idx++;\n            }\n            if (oldBranch !== instance.verifiedBranch) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function updateVisibility(instance, context, branchVisibility) {\n        if (branchVisibility === void 0) { branchVisibility = true; }\n        if (instance.visibility == null) {\n            instance.visible = false;\n            return false;\n        }\n        var visibility = instance.visibility;\n        var oldVisibility = instance.visible;\n        var newVisibility = branchVisibility && models.evaluateExpression(visibility.condition, context);\n        if (newVisibility !== instance.visible) {\n            instance.visible = newVisibility;\n        }\n        return oldVisibility !== newVisibility;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function nodeInstanceSuffix(instance) {\n        if (instance.prefix == null || instance.prefix.length == 0) {\n            return '';\n        }\n        return \"__\" + instance.prefix.join('__');\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function nodeInstanceCompleteName(instance) {\n        return instance != null && instance.node != null\n            ? \"\" + instance.node.name + nodeInstanceSuffix(instance)\n            : '';\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    /**\n     * update the relative instance value and the context\n     * if !editable evaluate expression once one time and flag changed is false\n     */\n    function updateFormula(instance, context) {\n        var formula = instance.formula;\n        var editable = instance.node.editable;\n        if (formula != null && instance.visible && (!editable || (editable && instance.value == null))) {\n            var newValue = models.evaluateExpression(formula.formula, context);\n            var oldValue = instance.value;\n            if (newValue !== instance.value) {\n                instance.value = newValue;\n                context[nodeInstanceCompleteName(instance)] = instance.value;\n                context.$value = instance.value;\n            }\n            return { changed: newValue !== oldValue, value: newValue };\n        }\n        return { changed: false, value: instance.value };\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function updateNextSlideCondition(instance, context) {\n        if (instance.nextSlideCondition != null) {\n            return models.evaluateExpression(instance.nextSlideCondition.condition, context);\n        }\n        return false;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function evaluateValidation(validation, context, forceFormula) {\n        return {\n            result: models.evaluateExpression(validation.condition, context, forceFormula),\n            error: validation.errorMessage,\n            clientValidation: validation.clientValidation,\n        };\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function evaluateValidationConditions(validation, context) {\n        var res = [];\n        validation.conditions.forEach(function (cond) {\n            res.push(evaluateValidation(cond, context));\n        });\n        return res;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function evaluateValidationMaxDigits(validation, value) {\n        if (validation.maxDigits == null) {\n            return null;\n        }\n        var ctx = { '$value': value };\n        if (typeof validation.maxDigits === 'number') {\n            return {\n                result: models.evaluateExpression(\"$value.toString().length <= \" + validation.maxDigits, ctx),\n                error: \"Digits count must be <= \" + validation.maxDigits,\n                clientValidation: false\n            };\n        }\n        return evaluateValidation(validation.maxDigits, ctx);\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function evaluateValidationMaxValue(validation, value) {\n        if (validation.maxValue == null) {\n            return null;\n        }\n        var ctx = { '$value': value };\n        if (typeof validation.maxValue === 'number') {\n            return {\n                result: models.evaluateExpression(\"$value.length <= \" + validation.maxValue, ctx),\n                error: \"Value must be <= \" + validation.maxValue,\n                clientValidation: false\n            };\n        }\n        return evaluateValidation(validation.maxValue, { '$value': value });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function evaluateValidationMinDigits(validation, value) {\n        if (validation.minDigits == null) {\n            return null;\n        }\n        var ctx = { '$value': value };\n        if (typeof validation.minDigits === 'number') {\n            return {\n                result: models.evaluateExpression(\"$value.toString().length >= \" + validation.minDigits, ctx),\n                error: \"Digits count must be >= \" + validation.minDigits,\n                clientValidation: false\n            };\n        }\n        return evaluateValidation(validation.minDigits, ctx);\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function evaluateValidationMinValue(validation, value) {\n        if (validation.minValue == null) {\n            return null;\n        }\n        var ctx = { '$value': value };\n        if (typeof validation.minValue === 'number') {\n            return {\n                result: models.evaluateExpression(\"$value.length <= \" + validation.minValue, ctx),\n                error: \"Value must be >= \" + validation.minValue,\n                clientValidation: false\n            };\n        }\n        return evaluateValidation(validation.minValue, { '$value': value });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function evaluateValidationNotEmpty(validation, value) {\n        if (validation.notEmpty == null) {\n            return null;\n        }\n        var ctx = { '$value': value };\n        if (typeof validation.notEmpty === 'boolean') {\n            return {\n                result: models.evaluateExpression(\"($value != null) === \" + validation.notEmpty, ctx),\n                error: 'Value must not be empty',\n                clientValidation: false\n            };\n        }\n        return evaluateValidation(validation.notEmpty, ctx);\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function evaluateValidationGroup(validation, value, context) {\n        var res = [];\n        var ctx = utils.deepCopy(context);\n        ctx['$value'] = value;\n        res = evaluateValidationConditions(validation, ctx);\n        if (validation.maxValue) {\n            var maxValue = evaluateValidationMaxValue(validation, value);\n            if (maxValue != null) {\n                res.push(maxValue);\n            }\n        }\n        if (validation.minValue) {\n            var minValue = evaluateValidationMinValue(validation, value);\n            if (minValue != null) {\n                res.push(minValue);\n            }\n        }\n        if (validation.notEmpty) {\n            var notEmpty = evaluateValidationNotEmpty(validation, value);\n            if (notEmpty != null) {\n                res.push(notEmpty);\n            }\n        }\n        if (validation.maxDigits) {\n            var maxDigits = evaluateValidationMaxDigits(validation, value);\n            if (maxDigits != null) {\n                res.push(maxDigits);\n            }\n        }\n        if (validation.minDigits) {\n            var minDigits = evaluateValidationMinDigits(validation, value);\n            if (minDigits != null) {\n                res.push(minDigits);\n            }\n        }\n        return res;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function updateValidation(instance, context, supplementaryInformations) {\n        var validation = instance.validation;\n        if (validation == null) {\n            instance.valid = true;\n            return;\n        }\n        if (supplementaryInformations) {\n            Object.keys(supplementaryInformations).forEach(function (key) {\n                context[\"__supplementary__\" + key + \"__\"] = supplementaryInformations[key];\n            });\n        }\n        var completeName = nodeInstanceCompleteName(instance);\n        if (context[completeName] != null && validation && validation.forceValue) {\n            instance.value = models.evaluateExpression(validation.forceValue.condition, context);\n            context[completeName] = instance.value;\n            context.$value = instance.value;\n        }\n        instance.validationResults =\n            evaluateValidationGroup(validation, context[completeName], context);\n        instance.valid = instance.validationResults.reduce(function (prev, x) { return prev && x.result; }, true);\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function evaluateWarning(warning, context, forceFormula) {\n        return {\n            result: models.evaluateExpression(warning.condition, context, forceFormula),\n            warning: warning.warningMessage,\n        };\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function evaluateWarningConditions(warning, context) {\n        return warning.conditions.map(function (cond) { return evaluateWarning(cond, context); });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function evaluateWarningGroup(warning, context) {\n        return evaluateWarningConditions(warning, context);\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function updateWarning(instance, context) {\n        var warning = instance.warning;\n        if (warning == null) {\n            return;\n        }\n        var completeName = nodeInstanceCompleteName(instance);\n        if (context[completeName] != null && warning) {\n            instance.warningResults = evaluateWarningGroup(warning, context);\n        }\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function updateFieldInstanceState(instance, context, branchVisibility) {\n        if (branchVisibility === void 0) { branchVisibility = true; }\n        updateVisibility(instance, context, branchVisibility);\n        updateConditionalBranches(instance, context);\n        updateFormula(instance, context);\n        updateValidation(instance, context);\n        updateWarning(instance, context);\n        updateNextSlideCondition(instance, context);\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function updateFilteredChoices(instance, context) {\n        if (instance.choicesFilter != null) {\n            instance.filteredChoices = instance.node.choicesOrigin.choices.filter(function (c) {\n                context.$choice = c;\n                context.$choiceValue = c.value;\n                return models.evaluateExpression(instance.choicesFilter.formula, context);\n            });\n        }\n        else {\n            instance.filteredChoices = instance.node.choicesOrigin.choices;\n        }\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function updateTriggerConditions(instance, context) {\n        if (instance.triggerConditions == null) {\n            return false;\n        }\n        var completeName = nodeInstanceCompleteName(instance);\n        if (instance.firstTriggerConditionDone[completeName]) {\n            return false;\n        }\n        var found = false;\n        var conditionsNum = instance.triggerConditions.length;\n        for (var i = 0; i < conditionsNum; i++) {\n            if (models.evaluateExpression(instance.triggerConditions[i].condition, context)) {\n                found = true;\n                break;\n            }\n        }\n        instance.firstTriggerConditionDone[completeName] = found;\n        return found;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createNode(node) {\n        var conditionalBranches = node.conditionalBranches != null && node.conditionalBranches.length > 0 ?\n            node.conditionalBranches :\n            [models.alwaysCondition()];\n        return __assign(__assign({}, node), { parentNode: node.parentNode != null ? node.parentNode : 0, label: node.label || '', visibility: node.visibility || models.alwaysCondition(), conditionalBranches: conditionalBranches });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createField(field) {\n        var node = createNode(__assign(__assign({}, field), { nodeType: exports.AjfNodeType.AjfField }));\n        var editable = field.editable != null ?\n            field.editable :\n            field.fieldType !== exports.AjfFieldType.Formula && field.fieldType !== exports.AjfFieldType.Table;\n        return __assign(__assign(__assign({}, node), field), { nodeType: exports.AjfNodeType.AjfField, editable: editable, defaultValue: field.defaultValue != null ? field.defaultValue : null, size: field.size || 'normal' });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function isCustomFieldWithChoices(field) {\n        return field.fieldType > 100\n            && componentsMap[field.fieldType] != null\n            && componentsMap[field.fieldType].isFieldWithChoice === true;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function isSlidesNode(node) {\n        return node != null &&\n            (node.nodeType === exports.AjfNodeType.AjfRepeatingSlide || node.nodeType === exports.AjfNodeType.AjfSlide);\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function isContainerNode(node) {\n        return node != null && (node.nodeType === exports.AjfNodeType.AjfNodeGroup || isSlidesNode(node));\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function isContainerNodeInstance(nodeInstance) {\n        return nodeInstance != null && nodeInstance.node != null && isContainerNode(nodeInstance.node);\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function flattenNodesInstances(nodes, includeGroups) {\n        if (includeGroups === void 0) { includeGroups = false; }\n        var flatNodes = [];\n        nodes.forEach(function (nodeInstance) {\n            if (isFieldInstance(nodeInstance)) {\n                flatNodes.push(nodeInstance);\n            }\n            if (isContainerNodeInstance(nodeInstance)) {\n                if (includeGroups) {\n                    flatNodes.push(nodeInstance);\n                }\n                flatNodes = flatNodes.concat(flattenNodesInstances(nodeInstance.nodes, includeGroups));\n            }\n        });\n        return flatNodes;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function isSlidesInstance(nodeInstance) {\n        return nodeInstance != null && nodeInstance.node != null && isSlidesNode(nodeInstance.node);\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function flattenNodesInstancesTree(nodes) {\n        var flatTree = [];\n        nodes.forEach(function (nodeInstance) {\n            if (isSlidesInstance(nodeInstance)) {\n                var ni = nodeInstance;\n                flatTree.push(ni);\n                ni.flatNodes = flattenNodesInstances(ni.nodes);\n            }\n        });\n        return flatTree;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function isNodeGroup(node) {\n        return node != null && node.nodeType === exports.AjfNodeType.AjfNodeGroup;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function isNodeGroupInstance(nodeInstance) {\n        return nodeInstance != null && nodeInstance.node != null && isNodeGroup(nodeInstance.node);\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function isSlideNode(node) {\n        return node != null && node.nodeType === exports.AjfNodeType.AjfSlide;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function isSlideInstance(nodeInstance) {\n        return nodeInstance != null && nodeInstance.node != null && isSlideNode(nodeInstance.node);\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createNodeInstance(instance) {\n        return {\n            node: instance.node,\n            prefix: instance.prefix ? __spread(instance.prefix) : [],\n            visible: instance.visible != null ? instance.visible : true,\n            conditionalBranches: [],\n            updatedEvt: new core.EventEmitter()\n        };\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createFieldInstance(instance, context) {\n        var nodeInstance = createNodeInstance(instance);\n        var value = null;\n        if (nodeInstance.node != null && context != null) {\n            var completeName = nodeInstanceCompleteName(nodeInstance);\n            if (context[nodeInstance.node.name] != null) {\n                value = context[nodeInstance.node.name];\n            }\n            else if (context[completeName] != null) {\n                value = context[completeName];\n            }\n        }\n        return __assign(__assign({}, nodeInstance), { node: instance.node, value: value, valid: false, defaultValue: instance.defaultValue != null ? instance.defaultValue : null, validationResults: instance.validationResults || [], warningResults: instance.warningResults || [], warningTrigger: new core.EventEmitter() });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createFieldWithChoicesInstance(instance, context) {\n        var fieldInstance = createFieldInstance(instance, context);\n        return __assign(__assign({}, fieldInstance), { node: instance.node, filteredChoices: __spread(instance.node.choices), firstTriggerConditionDone: {}, selectionTrigger: new core.EventEmitter() });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    /**\n     * to mantain retrocompatibility with old string type convert string to AjfTableCell\n     * check  node.rows: (string|AjfTableCell)[][];\n     * if elem of map is string convert in to AjfTableCell object\n     */\n    function normalizeRows(node) {\n        node.rows.forEach(function (row, rowIdx) {\n            row.forEach(function (elem, elemIdx) {\n                if (typeof elem === 'string') {\n                    node.rows[rowIdx][elemIdx] = {\n                        formula: elem,\n                        editable: node.editable\n                    };\n                }\n            });\n        });\n    }\n    function createTableFieldInstance(instance, context) {\n        normalizeRows(instance.node);\n        var fieldInstance = createFieldInstance(instance, context);\n        return __assign(__assign({}, fieldInstance), { node: instance.node, context: context, hideEmptyRows: instance.hideEmptyRows || false, controls: [] });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createNodeGroupInstance(instance) {\n        var nodeInstance = createNodeInstance(instance);\n        return __assign(__assign({}, nodeInstance), { node: instance.node, formulaReps: instance.formulaReps, reps: 0, nodes: [], flatNodes: [] });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createSlideInstance(instance) {\n        var nodeInstance = createNodeInstance(instance);\n        return __assign(__assign({}, nodeInstance), { node: instance.node, nodes: [], slideNodes: [], flatNodes: [], valid: false, position: 0 });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createRepeatingSlideInstance(instance) {\n        var slideInstance = createSlideInstance(instance);\n        return __assign(__assign({}, slideInstance), { node: instance.node, slideNodes: [], formulaReps: instance.formulaReps, reps: 0, nodes: [], flatNodes: [] });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createValidationGroup(group) {\n        return __assign(__assign({}, group), { conditions: group.conditions || [] });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createWarningGroup(group) {\n        return __assign(__assign({}, group), { conditions: group.conditions || [] });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function isRepeatingContainerNode(node) {\n        return node != null &&\n            (node.nodeType === exports.AjfNodeType.AjfNodeGroup ||\n                node.nodeType === exports.AjfNodeType.AjfRepeatingSlide);\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function getAncestorRepeatingNodes(allNodes, node) {\n        var nodeGroups = [];\n        var curParent = node.parent;\n        while (curParent != null) {\n            var curNode = allNodes.map(function (n) { return n.node || n; })\n                .find(function (n) { return n.id == curParent; });\n            if (curNode) {\n                if (isRepeatingContainerNode(curNode)) {\n                    nodeGroups.push(curNode);\n                }\n            }\n            curParent = curNode != null ? curNode.parent : null;\n        }\n        return nodeGroups;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function getAncestorRepeatingNodesNames(allNodes, node) {\n        var names = {};\n        var nodeGroups = getAncestorRepeatingNodes(allNodes, node);\n        nodeGroups.forEach(function (n, idx) { return (n.nodes || []).forEach(function (sn) {\n            if (isField(sn)) {\n                names[sn.name] = idx;\n            }\n        }); });\n        return names;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function getInstanceCondition(condition, ancestorsNames, prefix) {\n        var oldCondition = condition.condition;\n        var newCondition = models.normalizeExpression(oldCondition, ancestorsNames, prefix);\n        if (newCondition === oldCondition) {\n            return condition;\n        }\n        return { condition: newCondition };\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function getInstanceConditions(conditions, ancestorsNames, prefix) {\n        var changed = false;\n        var newConditions = conditions.map(function (condition) {\n            var newCondition = getInstanceCondition(condition, ancestorsNames, prefix);\n            if (newCondition !== condition) {\n                changed = true;\n            }\n            return newCondition;\n        });\n        return changed ? newConditions : conditions;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function getInstanceFormula(formula, ancestorsNames, prefix) {\n        var oldFormula = formula.formula;\n        var newFormula = models.normalizeExpression(oldFormula, ancestorsNames, prefix);\n        if (newFormula === oldFormula) {\n            return formula;\n        }\n        return { formula: newFormula };\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createValidation(validation) {\n        return __assign(__assign({}, validation), { clientValidation: validation.clientValidation || false, errorMessage: validation.errorMessage || 'Undefined Error' });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function getInstanceValidation(validation, ancestorsNames, prefix) {\n        var oldValidation = validation.condition;\n        var newValidation = models.normalizeExpression(oldValidation, ancestorsNames, prefix);\n        if (newValidation === oldValidation) {\n            return validation;\n        }\n        return createValidation({ condition: newValidation });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function getInstanceValidations(validations, ancestorsNames, prefix) {\n        var changed = false;\n        var newValidations = validations.map(function (validation) {\n            var newValidation = getInstanceValidation(validation, ancestorsNames, prefix);\n            if (newValidation !== validation) {\n                changed = true;\n            }\n            return newValidation;\n        });\n        return changed ? newValidations : validations;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createWarning(warning) {\n        return __assign(__assign({}, warning), { warningMessage: warning.warningMessage || 'Undefined Warning' });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function getInstanceWarning(warning, ancestorsNames, prefix) {\n        var oldWarning = warning.condition;\n        var newWarning = models.normalizeExpression(oldWarning, ancestorsNames, prefix);\n        if (newWarning === oldWarning) {\n            return warning;\n        }\n        return createWarning({ condition: newWarning });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function getInstanceWarnings(warnings, ancestorsNames, prefix) {\n        var changed = false;\n        var newWarnings = warnings.map(function (warning) {\n            var newWarning = getInstanceWarning(warning, ancestorsNames, prefix);\n            if (newWarning !== warning) {\n                changed = true;\n            }\n            return newWarning;\n        });\n        return changed ? newWarnings : warnings;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function isRepeatingSlide(node) {\n        return node != null && node.nodeType === exports.AjfNodeType.AjfRepeatingSlide;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function isRepeatingSlideInstance(nodeInstance) {\n        return nodeInstance != null && nodeInstance.node != null && isSlidesInstance(nodeInstance) &&\n            isRepeatingSlide(nodeInstance.node);\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function nodeToNodeInstance(allNodes, node, prefix, context) {\n        var instance = null;\n        var nodeType = node.nodeType;\n        switch (nodeType) {\n            case exports.AjfNodeType.AjfField:\n                var field = node;\n                if (field.fieldType > 100) {\n                    if (componentsMap[field.fieldType] != null\n                        && componentsMap[field.fieldType].createInstance != null) {\n                        instance = componentsMap[field.fieldType].createInstance({ node: node, prefix: prefix }, context);\n                    }\n                    else {\n                        instance = createFieldInstance({ node: node, prefix: prefix }, context);\n                    }\n                }\n                else {\n                    switch (field.fieldType) {\n                        case exports.AjfFieldType.SingleChoice:\n                        case exports.AjfFieldType.MultipleChoice:\n                            instance = createFieldWithChoicesInstance({ node: node, prefix: prefix }, context);\n                            break;\n                        case exports.AjfFieldType.Table:\n                            instance = createTableFieldInstance({ node: node, prefix: prefix }, context);\n                            break;\n                        default:\n                            instance = createFieldInstance({ node: node, prefix: prefix }, context);\n                            break;\n                    }\n                }\n                break;\n            case exports.AjfNodeType.AjfNodeGroup:\n                instance = createNodeGroupInstance({ node: node, prefix: prefix });\n                break;\n            case exports.AjfNodeType.AjfRepeatingSlide:\n                instance = createRepeatingSlideInstance({ node: node, prefix: prefix });\n                break;\n            case exports.AjfNodeType.AjfSlide:\n                instance = createSlideInstance({ node: node, prefix: prefix });\n                break;\n        }\n        if (instance != null) {\n            var hasPrefix = prefix != null && prefix.length > 0;\n            if (hasPrefix) {\n                var ancestorsNames = getAncestorRepeatingNodesNames(allNodes, node);\n                if (node.visibility != null) {\n                    var oldVisibility = node.visibility.condition;\n                    var newVisibility = models.normalizeExpression(oldVisibility, ancestorsNames, prefix);\n                    instance.visibility = newVisibility !== oldVisibility ?\n                        models.createCondition({ condition: newVisibility }) :\n                        node.visibility;\n                }\n                var conditionalBranches = instance.node.conditionalBranches != null\n                    && instance.node.conditionalBranches.length > 0\n                    ? instance.node.conditionalBranches\n                    : [models.alwaysCondition()];\n                instance.conditionalBranches = getInstanceConditions(conditionalBranches, ancestorsNames, prefix);\n                if (nodeType === exports.AjfNodeType.AjfNodeGroup || nodeType === exports.AjfNodeType.AjfRepeatingSlide) {\n                    var ngInstance = instance;\n                    var formulaReps = ngInstance.node.formulaReps;\n                    if (formulaReps != null) {\n                        var oldFormula = formulaReps.formula;\n                        var newFormula = models.normalizeExpression(oldFormula, ancestorsNames, prefix);\n                        ngInstance.formulaReps =\n                            newFormula !== oldFormula ? models.createFormula({ formula: newFormula }) : formulaReps;\n                    }\n                }\n                else if (nodeType === exports.AjfNodeType.AjfField) {\n                    var fInstance = instance;\n                    var fNode = fInstance.node;\n                    if (fNode.formula) {\n                        fInstance.formula = getInstanceFormula(fNode.formula, ancestorsNames, prefix);\n                    }\n                    if (fNode.validation != null) {\n                        var newConditions = getInstanceValidations(fNode.validation.conditions, ancestorsNames, prefix);\n                        if (newConditions !== fNode.validation.conditions) {\n                            fInstance.validation = createValidationGroup(fNode.validation);\n                            fInstance.validation.conditions = newConditions;\n                        }\n                        else {\n                            fInstance.validation = fNode.validation;\n                        }\n                    }\n                    if (fNode.warning != null) {\n                        var newWarnings = getInstanceWarnings(fNode.warning.conditions, ancestorsNames, prefix);\n                        if (newWarnings !== fNode.warning.conditions) {\n                            fInstance.warning = createWarningGroup(fNode.warning);\n                            fInstance.warning.conditions = newWarnings;\n                        }\n                        else {\n                            fInstance.warning = fNode.warning;\n                        }\n                    }\n                    if (fNode.nextSlideCondition != null) {\n                        fInstance.nextSlideCondition =\n                            getInstanceCondition(fNode.nextSlideCondition, ancestorsNames, prefix);\n                    }\n                    if (isFieldWithChoices(fNode)) {\n                        var fwcInstance = instance;\n                        var fwcNode = fwcInstance.node;\n                        if (fwcNode.choicesFilter != null) {\n                            fwcInstance.choicesFilter =\n                                getInstanceFormula(fwcNode.choicesFilter, ancestorsNames, prefix);\n                        }\n                        if (fwcNode.triggerConditions != null) {\n                            fwcInstance.triggerConditions =\n                                getInstanceConditions(fwcNode.triggerConditions, ancestorsNames, prefix);\n                        }\n                    }\n                }\n            }\n            else {\n                instance.visibility = instance.node.visibility;\n                var conditionalBranches = instance.node.conditionalBranches != null\n                    && instance.node.conditionalBranches.length > 0\n                    ? instance.node.conditionalBranches\n                    : [models.alwaysCondition()];\n                instance.conditionalBranches = conditionalBranches;\n                if (isNodeGroupInstance(instance) || isRepeatingSlideInstance(instance)) {\n                    var rgInstance = instance;\n                    rgInstance.formulaReps = rgInstance.node.formulaReps;\n                }\n                else if (isFieldInstance(instance)) {\n                    var fInstance = instance;\n                    fInstance.validation = fInstance.node.validation;\n                    fInstance.warning = fInstance.node.warning;\n                    fInstance.nextSlideCondition = fInstance.node.nextSlideCondition;\n                    if (isFieldWithChoicesInstance(instance)) {\n                        var fwcInstance = instance;\n                        fwcInstance.choicesFilter = fwcInstance.node.choicesFilter;\n                        fwcInstance.triggerConditions = fwcInstance.node.triggerConditions;\n                    }\n                    fInstance.formula = fInstance.node.formula;\n                }\n            }\n        }\n        return instance;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function flattenNodes(nodes) {\n        var flatNodes = [];\n        nodes.forEach(function (node) {\n            flatNodes.push(node);\n            if (isContainerNode(node)) {\n                flatNodes = flatNodes.concat(flattenNodes(node.nodes));\n            }\n        });\n        return flatNodes;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function orderedNodes(nodes, parent) {\n        var newNodes = [];\n        nodes\n            .filter(function (n) { return parent != null ? n.parent == parent : n.parent == null || n.parent === 0; })\n            .sort(function (n1, n2) { return n1.parentNode - n2.parentNode; })\n            .forEach(function (n) {\n            newNodes.push(n);\n            newNodes = newNodes.concat(orderedNodes(nodes, n.id));\n        });\n        return newNodes;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function updateRepsNum(instance, context) {\n        var oldReps = instance.reps || 0;\n        context = context || {};\n        if (instance.node.formulaReps == null) {\n            var ctxReps = context[nodeInstanceCompleteName(instance)];\n            if (ctxReps != null) {\n                instance.reps = ctxReps;\n            }\n            else if (oldReps == 0) {\n                instance.reps = 1;\n            }\n        }\n        else {\n            var newReps = models.evaluateExpression(instance.node.formulaReps.formula, context);\n            if (newReps !== oldReps) {\n                instance.reps = newReps;\n            }\n        }\n        instance.canAdd = instance.node.maxReps === 0 || instance.reps < instance.node.maxReps;\n        instance.canRemove = instance.node.minReps === 0 || instance.reps > instance.node.minReps;\n        return oldReps;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function validSlide(slide, idx) {\n        if (idx >= slide.slideNodes.length) {\n            return true;\n        }\n        return slide.slideNodes[idx]\n            .map(function (n) {\n            if (n.visible && Object.keys(n).indexOf('valid') > -1) {\n                return n.valid;\n            }\n            return true;\n        })\n            .reduce(function (v1, v2) { return v1 && v2; }, true);\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfValidationService = /** @class */ (function () {\n        function AjfValidationService() {\n            this._baseUtilFunctions = [\n                \"/**\\n        * count the number of digit contained on x.\\n        * @param  x the value used for digit count\\n        * @return the count of the digit\\n      */\\n    var digitCount = function(x) { return x.toString().length; }\",\n                \"/**\\n        * count the number of decimal contained on x.\\n        * @param  x the value used for decimal count\\n        * @return the count of the decimal\\n      */\\n    var decimalCount = function(x) {\\n      return (parseFloat(x).toString().split('.')[1] || []).length;\\n    }\",\n                \"/**\\n        * check if x is integer\\n        * @param  x the value used for check\\n        * @return true if x is a number\\n      */\\n    var isInt = function(x) { return !/[,.]/.test(x); }\",\n                \"/**\\n        * check if x is not empity\\n        * @param  x the value used for check\\n        * @return true if x defined and not null and the number of digit is > 0\\n      */\\n    var notEmpty = function (x) {\\n      return (typeof x !== 'undefined' && x !== null ? x.toString().length > 0 : false);\\n    }\",\n                \"/**\\n        * check if x is contained on array\\n        * @param  x the value used for check\\n        * @return the position of x on array or if array === x\\n      */\\n    var valueInChoice = function(array, x) { return array.indexOf(x) > -1 || array === x; }\",\n                \"var scanGroupField = function(reps, acc, callback) {\\n        for (var i = 0; i < reps; i++) {\\n            acc = callback(acc, i);\\n        }\\n        return acc;\\n    }\",\n                \"/**\\n        * sum the value contained on array\\n        * @param  x the array\\n        * @return the sum\\n      */\\n    var sum = function(array) {return array.reduce(function(a, b){ return a + b; }, 0); }\",\n                \"var dateOperations = function(dString, period, operation, v) {\\n        fmt = 'mm/dd/yyyy';\\n        var d = (typeof dString !== 'undefined') ? dateUtils.parse(dString) : new Date();\\n        if (operation == 'remove') {\\n          v = -v;\\n        }\\n        var dateOp;\\n        switch (period) {\\n          case 'day':\\n            dateOp = dateUtils.addDays;\\n            break;\\n          case 'month':\\n            dateOp = dateUtils.addMonths;\\n            break;\\n          case 'year':\\n            dateOp = dateUtils.addYears;\\n            break;\\n          default:\\n            return -1;\\n        }\\n        return dateUtils.format(dateOp(d, v), fmt);\\n      }\",\n                \"/**\\n        * round the num\\n        * @param  num the value to round\\n        * @param  digits how many digit\\n        * @return num rounded\\n      */\\n      var round = function(num, digits) {\\n        digits = digits || 0;\\n        var f = 0;\\n        try { f = parseFloat(num); } catch (e) { }\\n        var m = Math.pow(10, digits);\\n        return Math.round(f * m) / m;\\n      }\",\n                \"/**\\n        * extract the property of the source object with property != null\\n        * @param  source array of object wich contains property\\n        * @param  property the property on wich we want filter\\n        * @return array of dates\\n      */\\n      var extractArray = function(source, property, property2) {\\n        source = (source || []).slice(0);\\n        var l = source.length;\\n        var res = [];\\n        for (var i = 0; i < l ; i++) {\\n          if (source[i][property] != null && source[i][property2] != null) {\\n            res.push(source[i][property] + source[i][property2]);\\n          }\\n          else if (source[i][property] != null) {\\n            res.push(source[i][property]);\\n          }\\n        }\\n        return res;\\n      }\",\n                \"/**\\n        * extract the property of the source object with property != null\\n        * @param  source array of object wich contains property\\n        * @param  propertues string array the properties to sum\\n        * @return the sum\\n      */\\n      var extractSum = function(source, properties) {\\n        var sum = 0;\\n        properties = (properties || []).slice(0);\\n        var l = properties.length;\\n\\n        for (var i = 0; i < l ; i++) {\\n          var array = extractArray(source, properties[i]);\\n          var leng = array.length;\\n          for(var j = 0; j < leng; i++) {\\n            sum += array[j];\\n          }\\n        }\\n        return sum;\\n      }\",\n                \"/**\\n        * extract the array of sum for each week != null\\n        * @param  source array of object wich contains property\\n        * @param  propertues string array the properties to sum\\n        * @return the sum\\n      */\\n      var extractArraySum = function(source, properties) {\\n        var arrays = [];\\n        properties = (properties || []).slice(0);\\n\\n        for (var propI = 0; propI < properties.length ; propI++) {\\n          var array = extractArray(source, properties[propI]);\\n          arrays.push(array);\\n        }\\n\\n        var res = [];\\n        for (var weekI = 0; weekI < array.length; weekI ++ ) {\\n          var sum = 0;\\n          for (var propI = 0; propI < properties.length ; propI++) {\\n            sum = sum + arrays[propI][weekI]\\n          }\\n          res.push(sum);\\n        }\\n        return res;\\n      }\",\n                \"/**\\n        * draw a threshold line on chart related to the property\\n        * @param  source array of object wich contains property\\n        * @param  property the property on wich we want filter\\n        * @return array of dates\\n      */\\n      var drawThreshold = function(source, property, threshold) {\\n        source = (source || []).slice(0);\\n        var l = source.length;\\n        var res = [];\\n        for (var i = 0; i < l ; i++) {\\n          if (source[i][property] != null) {\\n            res.push(threshold);\\n          }\\n        }\\n        return res;\\n      }\",\n                \"/**\\n        * extract the dates of the source object with property != null\\n        * @param  source array of object wich contains property and date_start\\n        * @param  property the property on wich we want to calculate dates\\n        * @param  format the format of the date\\n        * @return array of dates\\n      */\\n      var extractDates = function(source, property, format) {\\n        source = (source || []).slice(0);\\n        var l = source.length;\\n        var res = [];\\n        var prefix = '';\\n        for (var i = 0; i < l ; i++) {\\n          if (source[i][property] != null) {\\n            switch(format) {\\n              case \\\"WW\\\":\\n                prefix = \\\"W\\\";\\n                break;\\n              case \\\"mm\\\":\\n                prefix = \\\"M\\\";\\n                break;\\n              default:\\n                prefix = \\\"\\\";\\n            }\\n            res.push(prefix + formatDate(source[i][\\\"date_start\\\"], format));\\n          }\\n        }\\n        return res;\\n      }\",\n                \"/**\\n        * extract the last property contains in source != null\\n        * @param  source array of object wich contains property and date_start\\n        * @param  property the property to find\\n        * @return the last property != null\\n      */\\n      var lastProperty = function(source, property) {\\n        source = (source || []).slice(0);\\n        var l = source.length -1;\\n\\n        while (l >= 0 && source[l][property] == null) {\\n          l--;\\n          if (l < 0) return 0;\\n        }\\n        return l >= 0 ? source[l][property] : 0;\\n      }\",\n                \"var sumLastProperties = function(source, properties) {\\n        source = (source || []).slice(0);\\n        var sum = 0;\\n        for (var i = 0; i < properties.length; i++) {\\n          sum += lastProperty(source, properties[i]);\\n        }\\n\\n        return sum;\\n      }\",\n                \"/**\\n        * compute the trend of the property contained on the source.\\n        * @param  source array of object wich contains property\\n        * @param  property the property on wich we want to calculate the trend\\n        * @return an html icon that identifies the trend\\n      */\\n      var calculateTrendProperty = function(source, property) {\\n        source = (source || []).slice(0);\\n        var last = source.length - 1;\\n        while (source[last][property] == null) {\\n          if (last == 0) {\\n            break;\\n          }\\n          last--;\\n        }\\n        var lastLast = last - 1;\\n        if (last == 0) {\\n          lastLast = last;\\n        } else {\\n          while (source[lastLast][property] == null) {\\n            if (lastLast == 0) {\\n              lastLast = last;\\n              break;\\n            }\\n            lastLast--;\\n          }\\n        }\\n\\n        var lastProperty = source[last]?(source[last][property] || 0): 0;\\n        var lastLastProperty = source[lastLast]?(source[lastLast][property] || 0): 0;\\n\\n        if (lastProperty == lastLastProperty) {\\n          return '<p><i class=\\\"material-icons\\\" style=\\\"color:blue\\\">trending_flat</i></p>';\\n        } else if (lastProperty > lastLastProperty) {\\n          return '<p><i class=\\\"material-icons\\\" style=\\\"color:green\\\">trending_up</i></p>';\\n        } else {\\n          return '<p><i class=\\\"material-icons\\\" style=\\\"color:red\\\">trending_down</i></p>';\\n        }\\n      }\",\n                \"/**\\n        * compute the average value of the property contained on the source.\\n        * @param  source array of object wich contains property\\n        * @param  property the property on wich we want to calculate the average\\n        * @param  range the range on wich we want to calculate the average\\n        * @param  coefficent the coefficent used for calculate the threshold\\n                  if coefficent is 0 mean return the count of property > 0\\n        * @return the average value || the count of property > 0\\n      */\\n      var calculateAvgProperty = function(source, property, range, coefficient) {\\n        source = (source || []).slice(0);\\n\\n        source.pop();\\n\\n        coefficient = coefficient || 1;\\n        range = range || 12;\\n\\n        var l = source.length;\\n        var res = 0;\\n        var counter = 0;\\n        var noZero = 0;\\n\\n        if(l < range) {\\n          range = l;\\n        }\\n\\n        while (range != 0) {\\n          counter++;\\n          if (source[l - 1][property] != null) {\\n            res += source[l - 1][property];\\n\\n            if (source[l - 1][property] > 0) {\\n              noZero++;\\n            }\\n          }\\n          l--;\\n          range--;\\n        }\\n\\n        if (coefficient == 0) {\\n          return noZero;\\n        } else {\\n          var threshold = (res/counter)*coefficient || 0;\\n          return threshold;\\n        }\\n      }\",\n                \"var alert = function(source, property, threshold, fmt) {\\n        source = (source || []).slice(0);\\n        var l = source.length;\\n\\n        if ( lastProperty(source, property)  > threshold ) {\\n          return '<p><i class=\\\"material-icons\\\" style=\\\"color:red\\\">warning</i></p>';\\n          } else {\\n            return '<p></p>';\\n          }\\n      }\",\n                \"var formatNumber = function(num, fmt) {\\n        fmt = fmt || '0,0[.]0';\\n        return numeral(num).format(fmt);\\n      }\",\n                \"var formatDate = function(date, fmt) {\\n        fmt = fmt || 'mm-dd-yyyy';\\n        return dateUtils.format(date, fmt);\\n      }\",\n                \"var isoMonth = function(date, fmt) {\\n        fmt = fmt || 'mm';\\n        var du = dateUtils;\\n        return du.format(du.addDays(du.startOfMonth(date), 4),fmt)\\n      }\",\n                \"var nextCounterValue = function(counterName, firstValue) {\\n        firstValue = firstValue != null ? firstValue : 0;\\n        if (execContext['$$'+counterName] == null) {\\n          execContext['$$'+counterName] = firstValue;\\n        } else {\\n          execContext['$$'+counterName]++;\\n        }\\n        return execContext['$$'+counterName];\\n      }\",\n                \"var getCoordinate = function(source, zoom) {\\n        zoom = zoom || 6;\\n        if(source == null) {\\n          return [51.505,-0.09, zoom];\\n        } else {\\n          return [source[0], source[1], zoom];\\n        }\\n      }\"\n            ];\n            this._functions = [];\n            this._functionsStr = '';\n            this._initFunctions();\n        }\n        AjfValidationService.prototype.addFunction = function (f) {\n            this._functions.push(f);\n            this._initFunctions();\n        };\n        AjfValidationService.prototype.addFunctionHandler = function (name, fn) {\n            if (models.AjfExpressionUtils.utils[name] === undefined) {\n                models.AjfExpressionUtils.utils[name] = { fn: fn };\n            }\n        };\n        AjfValidationService.prototype._initFunctions = function () {\n            var functionsStr = this._functions\n                .map(function (f) { return typeof f === 'string' ? f : f.toString(); })\n                .join('; ');\n            this._functionsStr = this._baseUtilFunctions.join('; ') + \"; \" + functionsStr;\n            models.AjfExpressionUtils.UTIL_FUNCTIONS = this._functionsStr;\n        };\n        AjfValidationService.decorators = [\n            { type: core.Injectable }\n        ];\n        /** @nocollapse */\n        AjfValidationService.ctorParameters = function () { return []; };\n        return AjfValidationService;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var esprimaMod = esprima__default || esprima;\n    var tokenize = esprimaMod.tokenize;\n    (function (AjfFormInitStatus) {\n        AjfFormInitStatus[AjfFormInitStatus[\"Initializing\"] = 0] = \"Initializing\";\n        AjfFormInitStatus[AjfFormInitStatus[\"Complete\"] = 1] = \"Complete\";\n    })(exports.AjfFormInitStatus || (exports.AjfFormInitStatus = {}));\n    var AjfFormRendererService = /** @class */ (function () {\n        function AjfFormRendererService(_) {\n            this._visibilityNodesMapUpdates = new rxjs.Subject();\n            this._repetitionNodesMapUpdates = new rxjs.Subject();\n            this._conditionalBranchNodesMapUpdates = new rxjs.Subject();\n            this._formulaNodesMapUpdates = new rxjs.Subject();\n            this._validationNodesMapUpdates = new rxjs.Subject();\n            this._warningNodesMapUpdates = new rxjs.Subject();\n            this._filteredChoicesNodesMapUpdates = new rxjs.Subject();\n            this._triggerConditionsNodesMapUpdates = new rxjs.Subject();\n            this._nextSlideConditionsNodesMapUpdates = new rxjs.Subject();\n            this._formInitEvent = new core.EventEmitter();\n            this.formInitEvent = this._formInitEvent.asObservable();\n            this._formGroup = new rxjs.BehaviorSubject(null);\n            this.formGroup = this._formGroup.asObservable();\n            this._form = new rxjs.BehaviorSubject(null);\n            this._nodesUpdates = new rxjs.Subject();\n            this._formGroupSubscription = rxjs.Subscription.EMPTY;\n            this._valueChanged = new rxjs.Subject();\n            this._nextSlideTrigger = new core.EventEmitter();\n            this.nextSlideTrigger = this._nextSlideTrigger.asObservable();\n            this._slidesNum = new rxjs.BehaviorSubject(0);\n            this.slidesNum = this._slidesNum.asObservable();\n            this._initUpdateMapStreams();\n            this._initNodesStreams();\n            this._initErrorsStreams();\n            this._initFormStreams();\n            this._updateFormValueAndValidity();\n        }\n        Object.defineProperty(AjfFormRendererService.prototype, \"nodesTree\", {\n            get: function () {\n                return this._flatNodesTree;\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormRendererService.prototype, \"errorPositions\", {\n            get: function () { return this._errorPositions; },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormRendererService.prototype, \"errors\", {\n            get: function () { return this._errors; },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormRendererService.prototype, \"currentSupplementaryInformations\", {\n            get: function () {\n                var form = this._form.getValue();\n                return form != null && form.form != null ? form.form.supplementaryInformations : null;\n            },\n            enumerable: true,\n            configurable: true\n        });\n        AjfFormRendererService.prototype.setForm = function (form, context) {\n            if (context === void 0) { context = {}; }\n            this._initUpdateMapStreams();\n            if (form != null && Object.keys(context).length === 0 &&\n                Object.keys(form.initContext || {}).length > 0) {\n                context = form.initContext || {};\n            }\n            var currentForm = this._form.getValue();\n            if ((currentForm == null && form != null) ||\n                (currentForm != null && form !== currentForm.form)) {\n                this._form.next({ form: form, context: context });\n            }\n        };\n        AjfFormRendererService.prototype.getFormValue = function () {\n            var formGroup = this._formGroup.getValue();\n            if (formGroup == null) {\n                return {};\n            }\n            var res = utils.deepCopy(formGroup.value);\n            return res;\n        };\n        AjfFormRendererService.prototype.addGroup = function (group) {\n            var _this = this;\n            return new rxjs.Observable(function (subscriber) {\n                if (group.formulaReps != null) {\n                    subscriber.next(false);\n                    subscriber.complete();\n                    return;\n                }\n                var maxReps = group.node.maxReps;\n                if (maxReps > 0 && group.reps + 1 > maxReps) {\n                    subscriber.next(false);\n                    subscriber.complete();\n                    return;\n                }\n                var oldReps = group.reps;\n                group.reps = group.reps + 1;\n                group.canAdd = group.node.maxReps === 0 || group.reps < group.node.maxReps;\n                group.canRemove = group.node.minReps === 0 || group.reps > group.node.minReps;\n                _this._nodesUpdates.next(function (nodes) {\n                    var flatNodes = flattenNodesInstances(nodes, true);\n                    _this._adjustReps(flatNodes, group, oldReps, _this.getFormValue());\n                    subscriber.next(true);\n                    subscriber.complete();\n                    return nodes;\n                });\n            });\n        };\n        AjfFormRendererService.prototype.removeGroup = function (group) {\n            var _this = this;\n            return new rxjs.Observable(function (subscriber) {\n                if (group.formulaReps != null) {\n                    subscriber.next(false);\n                    subscriber.complete();\n                    return;\n                }\n                var minReps = group.node.minReps;\n                if (group.reps - 1 < minReps) {\n                    subscriber.next(false);\n                    subscriber.complete();\n                    return;\n                }\n                var oldReps = group.reps;\n                group.reps = group.reps - 1;\n                group.canAdd = group.node.maxReps === 0 || group.reps < group.node.maxReps;\n                group.canRemove = group.node.minReps === 0 || group.reps > group.node.minReps;\n                _this._nodesUpdates.next(function (nodes) {\n                    _this._adjustReps(nodes, group, oldReps, _this.getFormValue());\n                    subscriber.next(true);\n                    subscriber.complete();\n                    return nodes;\n                });\n            });\n        };\n        AjfFormRendererService.prototype.getControl = function (field) {\n            return this.formGroup.pipe(operators.map(function (f) {\n                var fieldName = nodeInstanceCompleteName(field);\n                return f != null && f.contains(fieldName) ? f.controls[fieldName] : null;\n            }));\n        };\n        AjfFormRendererService.prototype._initErrorsStreams = function () {\n            var _this = this;\n            this._errorPositions = this._valueChanged.pipe(operators.withLatestFrom(this._nodes, this._form), operators.filter(function (v) { return v[2] != null && v[2].form != null; }), operators.map(function (v) {\n                var nodes = v[1];\n                var form = v[2].form;\n                var currentPosition = 0;\n                var errors = [];\n                nodes.forEach(function (node) {\n                    if (node.node.nodeType === exports.AjfNodeType.AjfRepeatingSlide) {\n                        var rsNode = node;\n                        for (var i = 0; i < rsNode.reps; i++) {\n                            if (node.visible) {\n                                currentPosition++;\n                                if (i == 0) {\n                                    rsNode.position = currentPosition;\n                                }\n                                if (!validSlide(rsNode, i)) {\n                                    errors.push(currentPosition);\n                                }\n                            }\n                        }\n                    }\n                    else if (node.node.nodeType === exports.AjfNodeType.AjfSlide) {\n                        var sNode = node;\n                        if (sNode.visible) {\n                            currentPosition++;\n                            sNode.position = currentPosition;\n                            if (!sNode.valid) {\n                                errors.push(currentPosition);\n                            }\n                        }\n                    }\n                });\n                form.valid = errors.length == 0;\n                _this._slidesNum.next(currentPosition);\n                return errors;\n            }), operators.publishReplay(), operators.refCount());\n            this._errors = this._errorPositions.pipe(operators.map(function (e) { return e != null ? e.length : 0; }), operators.startWith(0), operators.publishReplay(), operators.refCount());\n        };\n        AjfFormRendererService.prototype._initUpdateMapStreams = function () {\n            this._visibilityNodesMap =\n                this._visibilityNodesMapUpdates\n                    .pipe(operators.scan(function (rmap, op) {\n                    return op(rmap);\n                }, {}), operators.startWith({}), operators.share());\n            this._repetitionNodesMap =\n                this._repetitionNodesMapUpdates\n                    .pipe(operators.scan(function (rmap, op) {\n                    return op(rmap);\n                }, {}), operators.startWith({}), operators.share());\n            this._conditionalBranchNodesMap =\n                this._conditionalBranchNodesMapUpdates\n                    .pipe(operators.scan(function (rmap, op) {\n                    return op(rmap);\n                }, {}), operators.startWith({}), operators.share());\n            this._formulaNodesMap =\n                this._formulaNodesMapUpdates\n                    .pipe(operators.scan(function (rmap, op) {\n                    return op(rmap);\n                }, {}), operators.startWith({}), operators.share());\n            this._validationNodesMap =\n                this._validationNodesMapUpdates\n                    .pipe(operators.scan(function (rmap, op) {\n                    return op(rmap);\n                }, {}), operators.startWith({}), operators.share());\n            this._warningNodesMap =\n                this._warningNodesMapUpdates\n                    .pipe(operators.scan(function (rmap, op) {\n                    return op(rmap);\n                }, {}), operators.startWith({}), operators.share());\n            this._filteredChoicesNodesMap =\n                this._filteredChoicesNodesMapUpdates\n                    .pipe(operators.scan(function (rmap, op) {\n                    return op(rmap);\n                }, {}), operators.startWith({}), operators.share());\n            this._triggerConditionsNodesMap =\n                this._triggerConditionsNodesMapUpdates\n                    .pipe(operators.scan(function (rmap, op) {\n                    return op(rmap);\n                }, {}), operators.startWith({}), operators.share());\n            this._nextSlideConditionsNodesMap =\n                this._nextSlideConditionsNodesMapUpdates\n                    .pipe(operators.scan(function (rmap, op) {\n                    return op(rmap);\n                }, {}), operators.startWith({}), operators.share());\n            this._nodesMaps = [\n                this._visibilityNodesMap,\n                this._repetitionNodesMap,\n                this._conditionalBranchNodesMap,\n                this._formulaNodesMap,\n                this._validationNodesMap,\n                this._warningNodesMap,\n                this._nextSlideConditionsNodesMap,\n                this._filteredChoicesNodesMap,\n                this._triggerConditionsNodesMap\n            ];\n        };\n        AjfFormRendererService.prototype._initFormStreams = function () {\n            var _this = this;\n            var formObs = this._form;\n            formObs\n                .pipe(operators.map(function (_form) {\n                return _this._initFormGroupStreams(new forms.FormGroup({}));\n            }))\n                .subscribe(this._formGroup);\n            formObs\n                .pipe(operators.switchMap(function (form) {\n                if (form == null || form.form == null) {\n                    return rxjs.of(form);\n                }\n                var choicesOrigins = form.form.choicesOrigins || [];\n                if (choicesOrigins.length === 0) {\n                    return rxjs.of(form);\n                }\n                return rxjs.from(Promise.all(choicesOrigins.map(function (co) { return initChoicesOrigin(co); }))).pipe(operators.map(function () { return form; }));\n            }), operators.map(function (form) {\n                return function (_nodesInstances) {\n                    var nodes = form != null && form.form != null ?\n                        _this._orderedNodesInstancesTree(flattenNodes(form.form.nodes), form.form.nodes, undefined, [], form.context || {}) :\n                        [];\n                    var currentPosition = 0;\n                    nodes.forEach(function (node) {\n                        if (node.node.nodeType === exports.AjfNodeType.AjfRepeatingSlide) {\n                            var rsNode = node;\n                            for (var i = 0; i < rsNode.reps; i++) {\n                                if (node.visible) {\n                                    currentPosition++;\n                                    if (i == 0) {\n                                        rsNode.position = currentPosition;\n                                    }\n                                }\n                            }\n                        }\n                        else if (node.node.nodeType === exports.AjfNodeType.AjfSlide) {\n                            var sNode = node;\n                            if (sNode.visible) {\n                                currentPosition++;\n                                sNode.position = currentPosition;\n                            }\n                        }\n                    });\n                    return nodes;\n                };\n            }))\n                .subscribe(this._nodesUpdates);\n        };\n        AjfFormRendererService.prototype._initNodeInstance = function (allNodes, node, prefix, context, branchVisibility) {\n            var _this = this;\n            if (branchVisibility === void 0) { branchVisibility = true; }\n            var instance = nodeToNodeInstance(allNodes, node, prefix, context);\n            if (instance != null) {\n                var nodeType = instance.node.nodeType;\n                if (nodeType === exports.AjfNodeType.AjfNodeGroup || nodeType === exports.AjfNodeType.AjfRepeatingSlide) {\n                    this._explodeRepeatingNode(allNodes, instance, context);\n                }\n                else if (nodeType === exports.AjfNodeType.AjfSlide) {\n                    var sInstance = instance;\n                    sInstance.nodes = this._orderedNodesInstancesTree(allNodes, sInstance.node.nodes, sInstance.node.id, prefix, context);\n                }\n                updateVisibility(instance, context, branchVisibility);\n                updateConditionalBranches(instance, context);\n                if (nodeType === exports.AjfNodeType.AjfField) {\n                    var fInstance = instance;\n                    if (isCustomFieldWithChoices(fInstance.node) || isFieldWithChoices(fInstance.node)) {\n                        updateFilteredChoices(fInstance, context);\n                    }\n                    else {\n                        if (isTableFieldInstance(fInstance)) {\n                            var tfInstance_1 = fInstance;\n                            var tNode_1 = tfInstance_1.node;\n                            tfInstance_1.context = context[nodeInstanceCompleteName(tfInstance_1)] || context;\n                            var formGroup_1 = this._formGroup.getValue();\n                            var controlsWithLabels_1 = [];\n                            controlsWithLabels_1.push([node.label, tNode_1.columnLabels]);\n                            if (formGroup_1 != null) {\n                                tNode_1.rows.forEach(function (row, rowIdx) {\n                                    var r = [];\n                                    row.forEach(function (cell, idx) {\n                                        /*\n                                        every control is registered with the cell position\n                                        inside the form control matrix\n                                        with this mask `${tNode.name}__${rowIdx}__${idx}`\n                                        */\n                                        var name = tNode_1.name + \"__\" + rowIdx + \"__\" + idx;\n                                        var control = new forms.FormControl();\n                                        control.setValue(tfInstance_1.context[cell.formula]);\n                                        formGroup_1\n                                            .registerControl(name, control);\n                                        r.push(control);\n                                        /* create a object that respect the instance interface\n                                        with the minimum defined properties to allow to run addToNodeFormula map*/\n                                        var fakeInstance = {\n                                            formula: { formula: cell.formula },\n                                            node: {\n                                                name: name,\n                                                nodeType: 0,\n                                                editable: false\n                                            },\n                                            visible: true,\n                                            prefix: [],\n                                            conditionalBranches: [],\n                                            updatedEvt: new core.EventEmitter()\n                                        };\n                                        _this._addToNodesFormulaMap(fakeInstance, cell.formula);\n                                    });\n                                    controlsWithLabels_1.push([tNode_1.rowLabels[rowIdx], r]);\n                                });\n                                tfInstance_1.controls = controlsWithLabels_1;\n                            }\n                        }\n                        else {\n                            fInstance.value = context[nodeInstanceCompleteName(instance)];\n                        }\n                        updateFieldInstanceState(fInstance, context);\n                    }\n                }\n                this._addNodeInstance(instance);\n            }\n            return instance;\n        };\n        AjfFormRendererService.prototype._adjustReps = function (allNodes, instance, oldReps, context) {\n            var _this = this;\n            var newReps = instance.reps;\n            var result = {\n                added: null,\n                removed: null\n            };\n            if (oldReps < newReps) {\n                var newNodes_1 = [];\n                if (instance.nodes == null) {\n                    instance.nodes = [];\n                }\n                if (instance.node.nodeType === exports.AjfNodeType.AjfNodeGroup) {\n                    var node = createField({\n                        id: 999,\n                        name: '',\n                        parent: -1,\n                        fieldType: exports.AjfFieldType.Empty,\n                        label: instance.node.label\n                    });\n                    var newInstance = this._initNodeInstance(allNodes, node, instance.prefix.slice(0), context);\n                    if (newInstance != null) {\n                        instance.nodes.push(newInstance);\n                    }\n                }\n                var _loop_1 = function (i) {\n                    var prefix = instance.prefix.slice(0);\n                    var group = instance.node;\n                    prefix.push(i);\n                    orderedNodes(group.nodes, instance.node.id)\n                        .forEach(function (n) {\n                        var newInstance = _this._initNodeInstance(allNodes, n, prefix, context);\n                        if (newInstance != null) {\n                            newNodes_1.push(newInstance);\n                            instance.nodes.push(newInstance);\n                        }\n                    });\n                    this_1._addNodeInstance(instance);\n                };\n                var this_1 = this;\n                for (var i = oldReps; i < newReps; i++) {\n                    _loop_1(i);\n                }\n                result.added = newNodes_1;\n            }\n            else if (oldReps > newReps) {\n                var nodesNum = instance.nodes.length / oldReps;\n                if (instance.node.nodeType === exports.AjfNodeType.AjfNodeGroup) {\n                    nodesNum++;\n                }\n                result.removed = instance.nodes.splice(newReps * nodesNum, nodesNum);\n                result.removed.forEach((function (n) {\n                    _this._removeNodeInstance(n);\n                }));\n            }\n            if (oldReps != newReps && instance.formulaReps == null) {\n                var fg = this._formGroup.getValue();\n                var completeName = nodeInstanceCompleteName(instance);\n                if (fg != null && fg.contains(completeName)) {\n                    fg.controls[completeName].setValue(instance.reps);\n                }\n            }\n            instance.flatNodes = flattenNodesInstances(instance.nodes);\n            if (instance.node.nodeType === exports.AjfNodeType.AjfRepeatingSlide) {\n                var rsInstance = instance;\n                var slideNodes = [];\n                var nodesPerSlide = rsInstance.nodes != null ? rsInstance.nodes.length / rsInstance.reps : 0;\n                for (var i = 0; i < instance.reps; i++) {\n                    var startNode = i * nodesPerSlide;\n                    slideNodes.push(instance.nodes.slice(startNode, startNode + nodesPerSlide));\n                }\n                rsInstance.slideNodes = slideNodes;\n            }\n            return result;\n        };\n        AjfFormRendererService.prototype._updateFormValueAndValidity = function () {\n            this._nodesUpdates.asObservable()\n                .pipe(operators.withLatestFrom(this._formGroup), operators.filter(function (values) { return values[1] !== null; }))\n                .subscribe(function (values) {\n                var form = values[1];\n                form.updateValueAndValidity();\n            });\n        };\n        AjfFormRendererService.prototype._explodeRepeatingNode = function (allNodes, instance, context) {\n            var oldReps = updateRepsNum(instance, context);\n            if (oldReps !== instance.reps) {\n                this._adjustReps(allNodes, instance, oldReps, context);\n            }\n        };\n        AjfFormRendererService.prototype._orderedNodesInstancesTree = function (allNodes, nodes, parent, prefix, context) {\n            var _this = this;\n            if (parent === void 0) { parent = null; }\n            if (prefix === void 0) { prefix = []; }\n            var nodesInstances = [];\n            var curSuffix = prefix.length > 0 ? '__' + prefix.join('__') : '';\n            orderedNodes(nodes, parent).forEach(function (node) {\n                var parentNodeInstance = nodesInstances.find(function (ni) { return ni.node.id == node.parent && nodeInstanceSuffix(ni) == curSuffix; });\n                var branchVisibility = parentNodeInstance != null ?\n                    parentNodeInstance.verifiedBranch != null &&\n                        parentNodeInstance.verifiedBranch == node.parentNode :\n                    true;\n                var nni = _this._initNodeInstance(allNodes, node, prefix, context, branchVisibility);\n                if (nni != null) {\n                    nodesInstances.push(nni);\n                }\n            });\n            return nodesInstances;\n        };\n        AjfFormRendererService.prototype._formValueDelta = function (oldValue, newValue) {\n            return Object.keys(newValue)\n                .filter(function (k) { return oldValue[k] !== newValue[k]; });\n        };\n        AjfFormRendererService.prototype._initFormGroupStreams = function (formGroup) {\n            var _this = this;\n            this._formGroupSubscription.unsubscribe();\n            var init = true;\n            var initForm = true;\n            this._formInitEvent.emit(exports.AjfFormInitStatus.Initializing);\n            this._formGroupSubscription =\n                formGroup.valueChanges\n                    .pipe(operators.startWith({}), operators.pairwise(), operators.debounceTime(200), operators.withLatestFrom.apply(void 0, __spread((this._nodesMaps), [this._flatNodes])))\n                    .subscribe(function (v) {\n                    var oldFormValue = init && {} || v[0][0];\n                    init = false;\n                    var newFormValue = v[0][1];\n                    var visibilityMap = v[1];\n                    var repetitionMap = v[2];\n                    var conditionalBranchesMap = v[3];\n                    var formulaMap = v[4];\n                    var validationMap = v[5];\n                    var warningMap = v[6];\n                    var nextSlideConditionsMap = v[7];\n                    var filteredChoicesMap = v[8];\n                    var triggerConditionsMap = v[9];\n                    var nodes = v[10];\n                    // takes the names of the fields that have changed\n                    var delta = _this._formValueDelta(oldFormValue, newFormValue);\n                    var deltaLen = delta.length;\n                    var updatedNodes = [];\n                    /*\n                      for each field update all properties map\n                      with the following rule  \"if fieldname is in map update it\" and\n                      push on updateNodes the node instance that wrap field\n                    */\n                    delta.forEach(function (fieldName) {\n                        updatedNodes = updatedNodes.concat(nodes.filter(function (n) { return nodeInstanceCompleteName(n) === fieldName; }));\n                        if (visibilityMap[fieldName] != null) {\n                            visibilityMap[fieldName].forEach(function (nodeInstance) {\n                                var completeName = nodeInstanceCompleteName(nodeInstance);\n                                var visibilityChanged = updateVisibility(nodeInstance, newFormValue);\n                                var isField = isFieldInstance(nodeInstance);\n                                if (visibilityChanged && !nodeInstance.visible) {\n                                    var fg_1 = _this._formGroup.getValue();\n                                    if (fg_1 != null) {\n                                        var s_1 = rxjs.timer(200).subscribe(function () {\n                                            if (s_1 && !s_1.closed) {\n                                                s_1.unsubscribe();\n                                            }\n                                            fg_1.controls[completeName].setValue(null);\n                                        });\n                                    }\n                                    if (isField) {\n                                        nodeInstance.value = null;\n                                    }\n                                }\n                                else if (visibilityChanged && nodeInstance.visible && isField) {\n                                    var fg = _this._formGroup.getValue();\n                                    var res = updateFormula(nodeInstance, newFormValue);\n                                    if (fg != null && res.changed) {\n                                        fg.controls[completeName].setValue(res.value);\n                                    }\n                                }\n                                if (updatedNodes.indexOf(nodeInstance) === -1) {\n                                    updatedNodes.push(nodeInstance);\n                                }\n                            });\n                        }\n                        if (repetitionMap[fieldName] != null) {\n                            repetitionMap[fieldName].forEach(function (nodeInstance) {\n                                if (isRepeatingContainerNode(nodeInstance.node)) {\n                                    var rnInstance = nodeInstance;\n                                    var oldReps = updateRepsNum(rnInstance, newFormValue);\n                                    if (oldReps !== rnInstance.reps) {\n                                        _this._adjustReps(nodes, rnInstance, oldReps, newFormValue);\n                                    }\n                                }\n                                if (updatedNodes.indexOf(nodeInstance) === -1) {\n                                    updatedNodes.push(nodeInstance);\n                                }\n                            });\n                        }\n                        if (conditionalBranchesMap[fieldName] != null) {\n                            conditionalBranchesMap[fieldName].forEach(function (nodeInstance) {\n                                // const branchChanged = nodeInstance.updateConditionalBranches(newFormValue);\n                                updateConditionalBranches(nodeInstance, newFormValue);\n                                // if (branchChanged) {\n                                var verifiedBranch = nodeInstance.verifiedBranch;\n                                nodeInstance.conditionalBranches.forEach(function (_condition, idx) {\n                                    if (idx == verifiedBranch) {\n                                        _this._showSubtree(newFormValue, nodes, nodeInstance, idx);\n                                    }\n                                    else {\n                                        _this._hideSubtree(newFormValue, nodes, nodeInstance, idx);\n                                    }\n                                });\n                                // }\n                                if (updatedNodes.indexOf(nodeInstance) === -1) {\n                                    updatedNodes.push(nodeInstance);\n                                }\n                            });\n                        }\n                        if (formulaMap[fieldName] != null) {\n                            formulaMap[fieldName].forEach(function (nodeInstance) {\n                                if (isFieldInstance(nodeInstance)) {\n                                    var fInstance = nodeInstance;\n                                    var res = updateFormula(fInstance, newFormValue);\n                                    var fg = _this._formGroup.getValue();\n                                    if (fg != null && res.changed) {\n                                        updateValidation(fInstance, newFormValue);\n                                        fg.controls[nodeInstanceCompleteName(nodeInstance)].setValue(res.value);\n                                    }\n                                }\n                                if (updatedNodes.indexOf(nodeInstance) === -1) {\n                                    updatedNodes.push(nodeInstance);\n                                }\n                            });\n                        }\n                        if (validationMap[fieldName] != null) {\n                            validationMap[fieldName].forEach(function (nodeInstance) {\n                                if (isFieldInstance(nodeInstance)) {\n                                    var fInstance = nodeInstance;\n                                    newFormValue.$value = newFormValue[nodeInstanceCompleteName(nodeInstance)];\n                                    updateValidation(fInstance, newFormValue, _this.currentSupplementaryInformations);\n                                }\n                                if (updatedNodes.indexOf(nodeInstance) === -1) {\n                                    updatedNodes.push(nodeInstance);\n                                }\n                            });\n                        }\n                        if (warningMap[fieldName] != null) {\n                            warningMap[fieldName].forEach(function (nodeInstance) {\n                                if (isFieldInstance(nodeInstance)) {\n                                    var fInstance = nodeInstance;\n                                    updateWarning(fInstance, newFormValue);\n                                    if (fInstance.warningResults != null &&\n                                        fInstance.warningResults.filter(function (warning) { return warning.result; }).length > 0) {\n                                        fInstance.warningTrigger.emit();\n                                    }\n                                }\n                                if (updatedNodes.indexOf(nodeInstance) === -1) {\n                                    updatedNodes.push(nodeInstance);\n                                }\n                            });\n                        }\n                        if (deltaLen == 1 && nextSlideConditionsMap[fieldName] != null) {\n                            if (nextSlideConditionsMap[fieldName]\n                                .filter(function (nodeInstance) {\n                                if (isFieldInstance(nodeInstance)) {\n                                    var fInstance = nodeInstance;\n                                    return updateNextSlideCondition(fInstance, newFormValue);\n                                }\n                                return false;\n                            })\n                                .length == 1) {\n                                _this._nextSlideTrigger.emit();\n                            }\n                        }\n                        if (filteredChoicesMap[fieldName] != null) {\n                            filteredChoicesMap[fieldName].forEach(function (nodeInstance) {\n                                if (isFieldInstance(nodeInstance)) {\n                                    var fInstance = nodeInstance;\n                                    if (isFieldWithChoices(fInstance.node)) {\n                                        updateFilteredChoices(fInstance, newFormValue);\n                                    }\n                                }\n                                if (updatedNodes.indexOf(nodeInstance) === -1) {\n                                    updatedNodes.push(nodeInstance);\n                                }\n                            });\n                        }\n                        if (deltaLen == 1 && triggerConditionsMap[fieldName] != null) {\n                            var res = triggerConditionsMap[fieldName].filter(function (nodeInstance) {\n                                if (!isFieldInstance(nodeInstance)) {\n                                    return false;\n                                }\n                                var fInstance = nodeInstance;\n                                if (!isFieldWithChoices(fInstance.node)) {\n                                    return false;\n                                }\n                                return updateTriggerConditions(fInstance, newFormValue);\n                            });\n                            if (res.length == 1) {\n                                res[0].selectionTrigger.emit();\n                            }\n                        }\n                    });\n                    updatedNodes.forEach(function (n) {\n                        var nodeIdx = nodes.indexOf(n);\n                        var idx = nodeIdx - 1;\n                        while (idx >= 0) {\n                            var curNode = nodes[idx];\n                            if (isSlidesInstance(curNode)) {\n                                var slide = curNode;\n                                var subNodesNum = slide.flatNodes.length;\n                                var valid = true;\n                                for (var i = 0; i < subNodesNum; i++) {\n                                    var subNode = slide.flatNodes[i];\n                                    if (subNode.visible && isFieldInstance(subNode)\n                                        && !subNode.valid) {\n                                        valid = false;\n                                        break;\n                                    }\n                                }\n                                if (slide.valid !== valid) {\n                                    slide.valid = valid;\n                                }\n                                slide.updatedEvt.emit();\n                            }\n                            idx--;\n                        }\n                        n.updatedEvt.emit();\n                    });\n                    if (initForm) {\n                        initForm = false;\n                        _this._formInitEvent.emit(exports.AjfFormInitStatus.Complete);\n                    }\n                    _this._valueChanged.next();\n                });\n            return formGroup;\n        };\n        AjfFormRendererService.prototype._showSubtree = function (context, nodes, node, branch) {\n            this._updateSubtreeVisibility(context, nodes, node, true, branch);\n        };\n        AjfFormRendererService.prototype._hideSubtree = function (context, nodes, node, branch) {\n            this._updateSubtreeVisibility(context, nodes, node, false, branch);\n        };\n        AjfFormRendererService.prototype._updateSubtreeVisibility = function (context, nodes, node, visible, branch) {\n            var _this = this;\n            var subNodes;\n            var nodeSuffix = nodeInstanceSuffix(node);\n            if (branch != null) {\n                subNodes = nodes.filter(function (n) {\n                    var suffix = nodeInstanceSuffix(n);\n                    return suffix == nodeSuffix && n.node.parent == node.node.id && n.node.parentNode == branch;\n                });\n            }\n            else {\n                subNodes = nodes.filter(function (n) {\n                    var suffix = nodeInstanceSuffix(n);\n                    return suffix == nodeSuffix && n.node.parent == node.node.id;\n                });\n            }\n            var isContainer = isContainerNode(node.node);\n            subNodes.forEach(function (n) {\n                if (!isContainer ||\n                    (isContainer && node.node.nodes.find(function (cn) { return cn.id == n.node.id; }) == null)) {\n                    updateVisibility(n, context, visible);\n                    updateFormula(n, context);\n                    _this._updateSubtreeVisibility(context, nodes, n, visible);\n                }\n            });\n        };\n        AjfFormRendererService.prototype._initNodesStreams = function () {\n            this._nodes =\n                this._nodesUpdates.pipe(operators.scan(function (nodes, op) {\n                    return op(nodes);\n                }, []), operators.share());\n            this._flatNodesTree = this._nodes.pipe(operators.map(function (nodes) { return flattenNodesInstancesTree(nodes); }), operators.share());\n            this._flatNodes = this._flatNodesTree.pipe(operators.map(function (slides) {\n                var nodes = [];\n                slides.forEach(function (s) {\n                    nodes.push(s);\n                    nodes = nodes.concat(s.flatNodes);\n                });\n                return nodes;\n            }), operators.share());\n        };\n        AjfFormRendererService.prototype._removeNodeInstance = function (nodeInstance) {\n            var nodeName = nodeInstanceCompleteName(nodeInstance);\n            this._removeNodesVisibilityMapIndex(nodeName);\n            this._removeNodesRepetitionMapIndex(nodeName);\n            this._removeNodesConditionalBranchMapIndex(nodeName);\n            this._removeNodesFormulaMapIndex(nodeName);\n            this._removeNodesValidationMapIndex(nodeName);\n            this._removeNodesWarningMapIndex(nodeName);\n            this._removeNodesNextSlideConditionsMapIndex(nodeName);\n            this._removeNodesFilteredChoicesMapIndex(nodeName);\n            this._removeNodesTriggerConditionsMapIndex(nodeName);\n            if (isSlidesInstance(nodeInstance)) {\n                return this._removeSlideInstance(nodeInstance);\n            }\n            else if (isRepeatingContainerNode(nodeInstance.node)) {\n                this._removeNodeGroupInstance(nodeInstance);\n            }\n            else if (isFieldInstance(nodeInstance)) {\n                this._removeFieldInstance(nodeInstance);\n            }\n            return nodeInstance;\n        };\n        AjfFormRendererService.prototype._removeSlideInstance = function (slideInstance) {\n            var _this = this;\n            var slide = slideInstance.node;\n            if (slide.visibility != null) {\n                this._removeFromNodesVisibilityMap(slideInstance, slide.visibility.condition);\n            }\n            slideInstance.conditionalBranches.forEach(function (conditionalBranch) {\n                _this._removeFromNodesConditionalBranchMap(slideInstance, conditionalBranch.condition);\n            });\n            return slideInstance;\n        };\n        AjfFormRendererService.prototype._removeNodeGroupInstance = function (nodeGroupInstance) {\n            var nodeGroup = nodeGroupInstance.node;\n            if (nodeGroup.visibility != null) {\n                this._removeFromNodesVisibilityMap(nodeGroupInstance, nodeGroup.visibility.condition);\n            }\n            if (nodeGroupInstance.formulaReps != null && nodeGroup.formulaReps != null) {\n                this._removeFromNodesRepetitionMap(nodeGroupInstance, nodeGroup.formulaReps.formula);\n            }\n            return nodeGroupInstance;\n        };\n        AjfFormRendererService.prototype._removeFieldInstance = function (fieldInstance) {\n            var _this = this;\n            var formGroup = this._formGroup.getValue();\n            var fieldInstanceName = nodeInstanceCompleteName(fieldInstance);\n            if (formGroup != null && formGroup.contains(fieldInstanceName)) {\n                formGroup.removeControl(fieldInstanceName);\n            }\n            if (fieldInstance.validation != null) {\n                this._validationNodesMapUpdates.next(function (vmap) {\n                    if (vmap[fieldInstanceName] == null) {\n                        delete vmap[fieldInstanceName];\n                    }\n                    return vmap;\n                });\n            }\n            if (fieldInstance.visibility != null) {\n                this._removeFromNodesVisibilityMap(fieldInstance, fieldInstance.visibility.condition);\n            }\n            fieldInstance.conditionalBranches.forEach(function (conditionalBranch) {\n                _this._removeFromNodesConditionalBranchMap(fieldInstance, conditionalBranch.condition);\n            });\n            if (fieldInstance.formula) {\n                this._removeFromNodesFormulaMap(fieldInstance, fieldInstance.formula.formula);\n            }\n            // TODO: check this, probably is never verified\n            if (isRepeatingContainerNode(fieldInstance.node)) {\n                var rcInstance = fieldInstance;\n                if (rcInstance.formulaReps != null) {\n                    this._removeFromNodesRepetitionMap(fieldInstance, rcInstance.formulaReps.formula);\n                }\n            }\n            if (fieldInstance.validation != null && fieldInstance.validation.conditions != null) {\n                fieldInstance.validation.conditions.forEach(function (condition) {\n                    _this._removeFromNodesValidationMap(fieldInstance, condition.condition);\n                });\n            }\n            if (fieldInstance.warning != null) {\n                fieldInstance.warning.conditions.forEach(function (condition) {\n                    _this._removeFromNodesWarningMap(fieldInstance, condition.condition);\n                });\n            }\n            if (fieldInstance.nextSlideCondition != null) {\n                this._removeFromNodesNextSlideConditionsMap(fieldInstance, fieldInstance.nextSlideCondition.condition);\n            }\n            if (isFieldWithChoices(fieldInstance.node)) {\n                var fwcInstance = fieldInstance;\n                if (fwcInstance.choicesFilter != null) {\n                    this._removeFromNodesFilteredChoicesMap(fieldInstance, fwcInstance.choicesFilter.formula);\n                    if (fwcInstance.triggerConditions != null) {\n                        fwcInstance.triggerConditions.forEach(function (condition) {\n                            _this._removeFromNodesTriggerConditionsMap(fieldInstance, condition.condition);\n                        });\n                    }\n                }\n            }\n            return fieldInstance;\n        };\n        AjfFormRendererService.prototype._addNodeInstance = function (nodeInstance) {\n            if (isRepeatingContainerNode(nodeInstance.node)) {\n                return this._addNodeGroupInstance(nodeInstance);\n            }\n            else if (isSlideInstance(nodeInstance)) {\n                return this._addSlideInstance(nodeInstance);\n            }\n            else if (isFieldInstance(nodeInstance)) {\n                return this._addFieldInstance(nodeInstance);\n            }\n            return nodeInstance;\n        };\n        AjfFormRendererService.prototype._addFieldInstance = function (fieldInstance) {\n            var _this = this;\n            var formGroup = this._formGroup.getValue();\n            var fieldInstanceName = nodeInstanceCompleteName(fieldInstance);\n            if (formGroup != null && !formGroup.contains(fieldInstanceName)) {\n                var control = new forms.FormControl();\n                control.setValue(fieldInstance.value);\n                formGroup.registerControl(fieldInstanceName, control);\n            }\n            if (fieldInstance.validation != null) {\n                this._validationNodesMapUpdates.next(function (vmap) {\n                    if (vmap[fieldInstanceName] == null) {\n                        vmap[fieldInstanceName] = [];\n                    }\n                    if (vmap[fieldInstanceName].indexOf(fieldInstance) == -1) {\n                        vmap[fieldInstanceName].push(fieldInstance);\n                    }\n                    return vmap;\n                });\n            }\n            else {\n                fieldInstance.valid = true;\n            }\n            if (fieldInstance.visibility != null) {\n                this._addToNodesVisibilityMap(fieldInstance, fieldInstance.visibility.condition);\n            }\n            fieldInstance.conditionalBranches.forEach(function (conditionalBranch) {\n                _this._addToNodesConditionalBranchMap(fieldInstance, conditionalBranch.condition);\n            });\n            if (fieldInstance.formula) {\n                this._addToNodesFormulaMap(fieldInstance, fieldInstance.formula.formula);\n            }\n            if (isNodeGroupInstance(fieldInstance)) {\n                var ngInstance = fieldInstance;\n                if (ngInstance.formulaReps != null) {\n                    this._addToNodesRepetitionMap(fieldInstance, ngInstance.formulaReps.formula);\n                }\n            }\n            if (fieldInstance.validation != null && fieldInstance.validation.conditions != null) {\n                fieldInstance.validation.conditions.forEach(function (condition) {\n                    _this._addToNodesValidationMap(fieldInstance, condition.condition);\n                });\n            }\n            if (fieldInstance.warning != null) {\n                fieldInstance.warning.conditions.forEach(function (condition) {\n                    _this._addToNodesWarningMap(fieldInstance, condition.condition);\n                });\n            }\n            if (fieldInstance.nextSlideCondition != null) {\n                this._addToNodesNextSlideConditionsMap(fieldInstance, fieldInstance.nextSlideCondition.condition);\n            }\n            if (isCustomFieldWithChoices(fieldInstance.node) || isFieldWithChoicesInstance(fieldInstance)) {\n                var fwcInstance = fieldInstance;\n                if (fwcInstance.choicesFilter != null) {\n                    this._addToNodesFilteredChoicesMap(fieldInstance, fwcInstance.choicesFilter.formula);\n                }\n                if (fwcInstance.triggerConditions != null) {\n                    fwcInstance.triggerConditions.forEach(function (condition) {\n                        _this._addToNodesTriggerConditionsMap(fieldInstance, condition.condition);\n                    });\n                }\n            }\n            return fieldInstance;\n        };\n        AjfFormRendererService.prototype._addSlideInstance = function (slideInstance) {\n            var _this = this;\n            var slide = slideInstance.node;\n            if (slide.visibility != null) {\n                this._addToNodesVisibilityMap(slideInstance, slide.visibility.condition);\n            }\n            slideInstance.conditionalBranches.forEach(function (conditionalBranch) {\n                _this._addToNodesConditionalBranchMap(slideInstance, conditionalBranch.condition);\n            });\n            return slideInstance;\n        };\n        AjfFormRendererService.prototype._addNodeGroupInstance = function (nodeGroupInstance) {\n            var _this = this;\n            var nodeGroup = nodeGroupInstance.node;\n            if (nodeGroup.visibility != null) {\n                this._addToNodesVisibilityMap(nodeGroupInstance, nodeGroup.visibility.condition);\n            }\n            nodeGroupInstance.conditionalBranches.forEach(function (conditionalBranch) {\n                _this._addToNodesConditionalBranchMap(nodeGroupInstance, conditionalBranch.condition);\n            });\n            if (nodeGroupInstance.formulaReps != null) {\n                if (nodeGroup.formulaReps != null) {\n                    this._addToNodesRepetitionMap(nodeGroupInstance, nodeGroup.formulaReps.formula);\n                }\n            }\n            else {\n                var formGroup = this._formGroup.getValue();\n                var nodeGroupInstanceName = nodeInstanceCompleteName(nodeGroupInstance);\n                if (formGroup != null && !formGroup.contains(nodeGroupInstanceName)) {\n                    var control = new forms.FormControl();\n                    control.setValue(nodeGroupInstance.reps);\n                    formGroup.registerControl(nodeGroupInstanceName, control);\n                }\n            }\n            return nodeGroupInstance;\n        };\n        AjfFormRendererService.prototype._removeNodesVisibilityMapIndex = function (index) {\n            this._removeNodesMapIndex(this._visibilityNodesMapUpdates, index);\n        };\n        AjfFormRendererService.prototype._removeNodesRepetitionMapIndex = function (index) {\n            this._removeNodesMapIndex(this._repetitionNodesMapUpdates, index);\n        };\n        AjfFormRendererService.prototype._removeNodesConditionalBranchMapIndex = function (index) {\n            this._removeNodesMapIndex(this._conditionalBranchNodesMapUpdates, index);\n        };\n        AjfFormRendererService.prototype._removeNodesFormulaMapIndex = function (index) {\n            this._removeNodesMapIndex(this._formulaNodesMapUpdates, index);\n        };\n        AjfFormRendererService.prototype._removeNodesValidationMapIndex = function (index) {\n            this._removeNodesMapIndex(this._validationNodesMapUpdates, index);\n        };\n        AjfFormRendererService.prototype._removeNodesWarningMapIndex = function (index) {\n            this._removeNodesMapIndex(this._warningNodesMapUpdates, index);\n        };\n        AjfFormRendererService.prototype._removeNodesFilteredChoicesMapIndex = function (index) {\n            this._removeNodesMapIndex(this._filteredChoicesNodesMapUpdates, index);\n        };\n        AjfFormRendererService.prototype._removeNodesTriggerConditionsMapIndex = function (index) {\n            this._removeNodesMapIndex(this._triggerConditionsNodesMapUpdates, index);\n        };\n        AjfFormRendererService.prototype._removeNodesNextSlideConditionsMapIndex = function (index) {\n            this._removeNodesMapIndex(this._nextSlideConditionsNodesMapUpdates, index);\n        };\n        AjfFormRendererService.prototype._removeNodesMapIndex = function (nodesMap, index) {\n            nodesMap.next(function (vmap) {\n                if (Object.keys(vmap).indexOf(index) > -1) {\n                    delete vmap[index];\n                }\n                return vmap;\n            });\n        };\n        AjfFormRendererService.prototype._removeFromNodesVisibilityMap = function (nodeInstance, formula) {\n            this._removeFromNodesMap(this._visibilityNodesMapUpdates, nodeInstance, formula);\n        };\n        AjfFormRendererService.prototype._removeFromNodesRepetitionMap = function (nodeInstance, formula) {\n            this._removeFromNodesMap(this._repetitionNodesMapUpdates, nodeInstance, formula);\n        };\n        AjfFormRendererService.prototype._removeFromNodesConditionalBranchMap = function (nodeInstance, formula) {\n            this._removeFromNodesMap(this._conditionalBranchNodesMapUpdates, nodeInstance, formula);\n        };\n        AjfFormRendererService.prototype._removeFromNodesFormulaMap = function (nodeInstance, formula) {\n            this._removeFromNodesMap(this._formulaNodesMapUpdates, nodeInstance, formula);\n        };\n        AjfFormRendererService.prototype._removeFromNodesValidationMap = function (nodeInstance, formula) {\n            this._removeFromNodesMap(this._validationNodesMapUpdates, nodeInstance, formula);\n        };\n        AjfFormRendererService.prototype._removeFromNodesWarningMap = function (nodeInstance, formula) {\n            this._removeFromNodesMap(this._warningNodesMapUpdates, nodeInstance, formula);\n        };\n        AjfFormRendererService.prototype._removeFromNodesFilteredChoicesMap = function (nodeInstance, formula) {\n            this._removeFromNodesMap(this._filteredChoicesNodesMapUpdates, nodeInstance, formula);\n        };\n        AjfFormRendererService.prototype._removeFromNodesTriggerConditionsMap = function (nodeInstance, formula) {\n            this._removeFromNodesMap(this._filteredChoicesNodesMapUpdates, nodeInstance, formula);\n        };\n        AjfFormRendererService.prototype._removeFromNodesNextSlideConditionsMap = function (nodeInstance, formula) {\n            this._removeFromNodesMap(this._nextSlideConditionsNodesMapUpdates, nodeInstance, formula);\n        };\n        AjfFormRendererService.prototype._removeFromNodesMap = function (nodesMap, nodeInstance, formula) {\n            var tokens = tokenize(formula)\n                .filter(function (token) { return token.type == 'Identifier' && token.value != '$value'; });\n            if (tokens.length > 0) {\n                nodesMap.next(function (vmap) {\n                    tokens.forEach(function (token) {\n                        var tokenName = token.value;\n                        if (vmap[tokenName] != null) {\n                            var idx = vmap[tokenName].indexOf(nodeInstance);\n                            if (idx > -1) {\n                                vmap[tokenName].splice(idx, 1);\n                                if (vmap[tokenName].length == 0) {\n                                    delete vmap[tokenName];\n                                }\n                            }\n                        }\n                    });\n                    return vmap;\n                });\n            }\n        };\n        AjfFormRendererService.prototype._addToNodesVisibilityMap = function (nodeInstance, formula) {\n            this._addToNodesMap(this._visibilityNodesMapUpdates, nodeInstance, formula);\n        };\n        AjfFormRendererService.prototype._addToNodesRepetitionMap = function (nodeInstance, formula) {\n            this._addToNodesMap(this._repetitionNodesMapUpdates, nodeInstance, formula);\n        };\n        AjfFormRendererService.prototype._addToNodesConditionalBranchMap = function (nodeInstance, formula) {\n            this._addToNodesMap(this._conditionalBranchNodesMapUpdates, nodeInstance, formula);\n        };\n        AjfFormRendererService.prototype._addToNodesFormulaMap = function (nodeInstance, formula) {\n            this._addToNodesMap(this._formulaNodesMapUpdates, nodeInstance, formula);\n        };\n        AjfFormRendererService.prototype._addToNodesValidationMap = function (nodeInstance, formula) {\n            this._addToNodesMap(this._validationNodesMapUpdates, nodeInstance, formula);\n        };\n        AjfFormRendererService.prototype._addToNodesWarningMap = function (nodeInstance, formula) {\n            this._addToNodesMap(this._warningNodesMapUpdates, nodeInstance, formula);\n        };\n        AjfFormRendererService.prototype._addToNodesFilteredChoicesMap = function (nodeInstance, formula) {\n            this._addToNodesMap(this._filteredChoicesNodesMapUpdates, nodeInstance, formula);\n        };\n        AjfFormRendererService.prototype._addToNodesTriggerConditionsMap = function (nodeInstance, formula) {\n            this._addToNodesMap(this._triggerConditionsNodesMapUpdates, nodeInstance, formula);\n        };\n        AjfFormRendererService.prototype._addToNodesNextSlideConditionsMap = function (nodeInstance, formula) {\n            this._addToNodesMap(this._nextSlideConditionsNodesMapUpdates, nodeInstance, formula);\n        };\n        AjfFormRendererService.prototype._addToNodesMap = function (nodesMap, nodeInstance, formula) {\n            var tokens = tokenize(formula)\n                .filter(function (token) { return token.type == 'Identifier' && token.value != '$value'; });\n            if (tokens.length > 0) {\n                nodesMap.next(function (vmap) {\n                    tokens.forEach(function (token) {\n                        var tokenName = token.value;\n                        if (vmap[tokenName] == null) {\n                            vmap[tokenName] = [];\n                        }\n                        if (vmap[tokenName].indexOf(nodeInstance) === -1) {\n                            vmap[tokenName].push(nodeInstance);\n                        }\n                    });\n                    return vmap;\n                });\n            }\n        };\n        AjfFormRendererService.decorators = [\n            { type: core.Injectable }\n        ];\n        /** @nocollapse */\n        AjfFormRendererService.ctorParameters = function () { return [\n            { type: AjfValidationService }\n        ]; };\n        return AjfFormRendererService;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfFormActionEvent = /** @class */ (function () {\n        function AjfFormActionEvent() {\n        }\n        return AjfFormActionEvent;\n    }());\n    var AjfFormRenderer = /** @class */ (function () {\n        /**\n         * this constructor will init current formula by ajfBuilderService\n         */\n        function AjfFormRenderer(_rendererService, _changeDetectorRef) {\n            this._rendererService = _rendererService;\n            this._changeDetectorRef = _changeDetectorRef;\n            // ajfFieldTypes [ Text, Number, Boolean, SingleChoice, MultipleChoice,\n            // Formula, Empty, Composed, LENGTH ]\n            this.ajfFieldTypes = exports.AjfFieldType;\n            this._orientationChange = new core.EventEmitter();\n            this.orientationChange = this._orientationChange.asObservable();\n            this._saveDisabled = false;\n            this._hasStartMessage = false;\n            this._hasEndMessage = false;\n            this._hideTopToolbar = false;\n            this._hideBottomToolbar = false;\n            this._hideNavigationButtons = false;\n            this._fixedOrientation = false;\n            this._readonly = false;\n            this._orientation = 'horizontal';\n            this._errorMoveEvent = new core.EventEmitter();\n            // _init is a private boolean\n            this._init = false;\n            this._nextSlideSubscription = rxjs.Subscription.EMPTY;\n            this._errorMoveSubscription = rxjs.Subscription.EMPTY;\n            this._formAction = new core.EventEmitter();\n            this.formAction = this._formAction.asObservable();\n            this.formGroup = _rendererService.formGroup;\n            this.slides = _rendererService.nodesTree;\n            this._errorPositions = _rendererService.errorPositions;\n            this.errors = _rendererService.errors;\n            this.slidesNum = _rendererService.slidesNum;\n            this.formIsInit = _rendererService.formInitEvent.pipe(operators.map(function (e) { return e === exports.AjfFormInitStatus.Complete; }));\n        }\n        Object.defineProperty(AjfFormRenderer.prototype, \"saveDisabled\", {\n            get: function () { return this._saveDisabled; },\n            set: function (saveDisabled) {\n                this._saveDisabled = coercion.coerceBooleanProperty(saveDisabled);\n                this._changeDetectorRef.markForCheck();\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormRenderer.prototype, \"hasStartMessage\", {\n            get: function () { return this._hasStartMessage; },\n            set: function (hasStartMessage) {\n                this._hasStartMessage = coercion.coerceBooleanProperty(hasStartMessage);\n                this._changeDetectorRef.markForCheck();\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormRenderer.prototype, \"hasEndMessage\", {\n            get: function () { return this._hasEndMessage; },\n            set: function (hasEndMessage) {\n                this._hasEndMessage = coercion.coerceBooleanProperty(hasEndMessage);\n                this._changeDetectorRef.markForCheck();\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormRenderer.prototype, \"hideTopToolbar\", {\n            get: function () { return this._hideTopToolbar; },\n            set: function (hideTopToolbar) {\n                this._hideTopToolbar = coercion.coerceBooleanProperty(hideTopToolbar);\n                this._changeDetectorRef.markForCheck();\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormRenderer.prototype, \"hideBottompToolbar\", {\n            get: function () { return this._hideBottomToolbar; },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormRenderer.prototype, \"hideBottomToolbar\", {\n            set: function (hideBottomToolbar) {\n                this._hideBottomToolbar = coercion.coerceBooleanProperty(hideBottomToolbar);\n                this._changeDetectorRef.markForCheck();\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormRenderer.prototype, \"hideNavigationButtons\", {\n            get: function () { return this._hideNavigationButtons; },\n            set: function (hideNavigationButtons) {\n                this._hideNavigationButtons = coercion.coerceBooleanProperty(hideNavigationButtons);\n                this._changeDetectorRef.markForCheck();\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormRenderer.prototype, \"fixedOrientation\", {\n            get: function () { return this._fixedOrientation; },\n            set: function (fixedOrientation) {\n                this._fixedOrientation = coercion.coerceBooleanProperty(fixedOrientation);\n                this._changeDetectorRef.markForCheck();\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormRenderer.prototype, \"readonly\", {\n            get: function () { return this._readonly; },\n            set: function (readonly) {\n                this._readonly = coercion.coerceBooleanProperty(readonly);\n                this._changeDetectorRef.markForCheck();\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormRenderer.prototype, \"orientation\", {\n            get: function () { return this._orientation; },\n            set: function (orientation) {\n                if (orientation !== 'horizontal' && orientation !== 'vertical') {\n                    return;\n                }\n                if (orientation !== this._orientation) {\n                    this._orientation = orientation;\n                    this._changeDetectorRef.markForCheck();\n                    this._orientationChange.emit(this._orientation);\n                }\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(AjfFormRenderer.prototype, \"form\", {\n            set: function (form) {\n                this._form = form;\n                if (this._init) {\n                    this._rendererService.setForm(this._form);\n                }\n            },\n            enumerable: true,\n            configurable: true\n        });\n        /**\n         * this method will scroll to next error received by subscribe\n         */\n        AjfFormRenderer.prototype.goToNextError = function () { this._errorMoveEvent.emit(true); };\n        /**\n         * this method will scroll to prev error received by subscribe\n         */\n        AjfFormRenderer.prototype.goToPrevError = function () { this._errorMoveEvent.emit(false); };\n        /**\n         * this method will add group\n         */\n        AjfFormRenderer.prototype.addGroup = function (nodeGroup) {\n            var _this = this;\n            var s = this._rendererService.addGroup(nodeGroup).pipe(operators.delayWhen(function () { return _this.formSlider.pageScrollFinish; })).subscribe(function (r) { if (r && _this.formSlider != null) {\n                _this.formSlider.slide({ dir: 'down' });\n            } }, function (_e) { if (s) {\n                s.unsubscribe();\n            } }, function () { if (s) {\n                s.unsubscribe();\n            } });\n        };\n        /**\n         * this method will remove group\n         */\n        AjfFormRenderer.prototype.removeGroup = function (nodeGroup) {\n            var _this = this;\n            var s = this._rendererService.removeGroup(nodeGroup).pipe(operators.delayWhen(function () { return _this.formSlider.pageScrollFinish; })).subscribe(function (r) { if (r && _this.formSlider != null) {\n                _this.formSlider.slide({ dir: 'up' });\n            } }, function (_e) { if (s) {\n                s.unsubscribe();\n            } }, function () { if (s) {\n                s.unsubscribe();\n            } });\n        };\n        AjfFormRenderer.prototype.onSave = function (_evt) {\n            this._formAction.emit({\n                source: this,\n                action: 'save',\n                value: this._rendererService.getFormValue()\n            });\n        };\n        AjfFormRenderer.prototype.onFormAction = function (_evt, action) {\n            this._formAction.emit({\n                source: this,\n                value: this._rendererService.getFormValue(),\n                action: action\n            });\n        };\n        /**\n         * this method will set current form in rederer service when init form\n         */\n        AjfFormRenderer.prototype.ngAfterViewInit = function () {\n            if (this._form != null) {\n                this._rendererService.setForm(this._form);\n                this._changeDetectorRef.detectChanges();\n            }\n        };\n        AjfFormRenderer.prototype.ngAfterViewChecked = function () {\n            var _this = this;\n            if (!this._init && this.formSlider != null) {\n                this._init = true;\n                this._errorMoveSubscription = this._errorMoveEvent.pipe(operators.withLatestFrom(this._errorPositions)).subscribe(function (v) {\n                    var move = v[0];\n                    var currentPosition = _this.formSlider.currentPage - (+_this.hasStartMessage) + 1;\n                    var errors = v[1];\n                    if (errors == null) {\n                        return;\n                    }\n                    var found = false;\n                    var prevIdx = -1;\n                    var nextIdx = -1;\n                    var idx = 0;\n                    var errorsLen = errors.length;\n                    while (!found && idx < errorsLen) {\n                        if (errors[idx] == currentPosition) {\n                            found = true;\n                            prevIdx = idx > 0 ? idx - 1 : errorsLen - 1;\n                            nextIdx = idx < errorsLen - 1 ? idx + 1 : 0;\n                        }\n                        else if (errors[idx] > currentPosition) {\n                            found = true;\n                            prevIdx = idx > 0 ? idx - 1 : errorsLen - 1;\n                            nextIdx = idx;\n                        }\n                        idx++;\n                    }\n                    if (!found) {\n                        prevIdx = errorsLen - 1;\n                        nextIdx = 0;\n                    }\n                    _this.formSlider.slide({ to: move ? errors[nextIdx] - 1 : errors[prevIdx] - 1 });\n                    _this._changeDetectorRef.detectChanges();\n                });\n            }\n        };\n        AjfFormRenderer.prototype.ngOnDestroy = function () {\n            this._nextSlideSubscription.unsubscribe();\n            this._errorMoveSubscription.unsubscribe();\n            this._orientationChange.complete();\n            this._errorMoveEvent.complete();\n            this._formAction.complete();\n        };\n        AjfFormRenderer.prototype.orientationChangeHandler = function (orientation) {\n            this.orientation = orientation;\n        };\n        AjfFormRenderer.prototype.trackNodeById = function (_, node) {\n            return nodeInstanceCompleteName(node);\n        };\n        AjfFormRenderer.decorators = [\n            { type: core.Directive }\n        ];\n        /** @nocollapse */\n        AjfFormRenderer.ctorParameters = function () { return [\n            { type: AjfFormRendererService },\n            { type: core.ChangeDetectorRef }\n        ]; };\n        AjfFormRenderer.propDecorators = {\n            title: [{ type: core.Input }],\n            orientationChange: [{ type: core.Output }],\n            saveDisabled: [{ type: core.Input }],\n            hasStartMessage: [{ type: core.Input }],\n            hasEndMessage: [{ type: core.Input }],\n            hideTopToolbar: [{ type: core.Input }],\n            hideBottomToolbar: [{ type: core.Input }],\n            hideNavigationButtons: [{ type: core.Input }],\n            fixedOrientation: [{ type: core.Input }],\n            readonly: [{ type: core.Input }],\n            orientation: [{ type: core.Input }],\n            formSlider: [{ type: core.ViewChild, args: ['formSlider', { static: false },] }],\n            fields: [{ type: core.ViewChildren, args: [AjfFormField,] }],\n            formAction: [{ type: core.Output }],\n            form: [{ type: core.Input }]\n        };\n        return AjfFormRenderer;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfIncrementPipe = /** @class */ (function () {\n        function AjfIncrementPipe() {\n        }\n        AjfIncrementPipe.prototype.transform = function (value, increment) {\n            if (increment === void 0) { increment = 1; }\n            return value + increment;\n        };\n        AjfIncrementPipe.decorators = [\n            { type: core.Pipe, args: [{ name: 'ajfIncrement' },] }\n        ];\n        return AjfIncrementPipe;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfIsRepeatingSlideInstancePipe = /** @class */ (function () {\n        function AjfIsRepeatingSlideInstancePipe() {\n        }\n        AjfIsRepeatingSlideInstancePipe.prototype.transform = function (instance) {\n            return isRepeatingSlideInstance(instance);\n        };\n        AjfIsRepeatingSlideInstancePipe.decorators = [\n            { type: core.Pipe, args: [{ name: 'ajfIsRepeatingSlideInstance' },] }\n        ];\n        return AjfIsRepeatingSlideInstancePipe;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfNodeCompleteNamePipe = /** @class */ (function () {\n        function AjfNodeCompleteNamePipe() {\n        }\n        AjfNodeCompleteNamePipe.prototype.transform = function (instance) {\n            return instance ? nodeInstanceCompleteName(instance) : '';\n        };\n        AjfNodeCompleteNamePipe.decorators = [\n            { type: core.Pipe, args: [{ name: 'ajfNodeCompleteName' },] }\n        ];\n        return AjfNodeCompleteNamePipe;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfRangePipe = /** @class */ (function () {\n        function AjfRangePipe() {\n        }\n        AjfRangePipe.prototype.transform = function (size, start, step) {\n            if (size === void 0) { size = 0; }\n            if (start === void 0) { start = 1; }\n            if (step === void 0) { step = 1; }\n            var range = [];\n            for (var length_1 = 0; length_1 < size; ++length_1) {\n                range.push(start);\n                start += step;\n            }\n            return range;\n        };\n        AjfRangePipe.decorators = [\n            { type: core.Pipe, args: [{ name: 'ajfRange' },] }\n        ];\n        return AjfRangePipe;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfTableRowClass = /** @class */ (function () {\n        function AjfTableRowClass() {\n        }\n        AjfTableRowClass.prototype.transform = function (value) {\n            return value % 2 == 0 ? 'ajf-row-even' : 'ajf-row-odd';\n        };\n        AjfTableRowClass.decorators = [\n            { type: core.Pipe, args: [{ name: 'ajfTableRowClass' },] }\n        ];\n        return AjfTableRowClass;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfTableVisibleColumnsPipe = /** @class */ (function () {\n        function AjfTableVisibleColumnsPipe() {\n        }\n        AjfTableVisibleColumnsPipe.prototype.transform = function (instance) {\n            if (!instance.node.editable) {\n                var val = instance.value || [];\n                return instance.hideEmptyRows\n                    ? val.filter(function (col) { return col[1].reduce(function (prev, cur) {\n                        return prev || (cur != null && cur !== '' && cur !== 0 && cur !== '0');\n                    }, false); }).map(function (v) { return __spread([v[0]], v[1]); })\n                    : val.map(function (v) { return __spread([v[0]], v[1]); });\n            }\n            return (instance.controls || []).map(function (v) { return __spread([v[0]], v[1]); });\n        };\n        AjfTableVisibleColumnsPipe.decorators = [\n            { type: core.Pipe, args: [{ name: 'ajfTableVisibleColumns' },] }\n        ];\n        return AjfTableVisibleColumnsPipe;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfValidSlidePipe = /** @class */ (function () {\n        function AjfValidSlidePipe() {\n        }\n        AjfValidSlidePipe.prototype.transform = function (slide, idx) {\n            if (idx == null || typeof idx !== 'number') {\n                return false;\n            }\n            if (idx >= slide.slideNodes.length) {\n                return true;\n            }\n            return slide.slideNodes[idx]\n                .map(function (n) {\n                if (n.visible && Object.keys(n).indexOf('valid') > -1) {\n                    return n.valid;\n                }\n                return true;\n            }).reduce(function (v1, v2) { return v1 && v2; }, true);\n        };\n        AjfValidSlidePipe.decorators = [\n            { type: core.Pipe, args: [{ name: 'ajfValidSlide', pure: false },] }\n        ];\n        return AjfValidSlidePipe;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfFormsModule = /** @class */ (function () {\n        function AjfFormsModule() {\n        }\n        AjfFormsModule.decorators = [\n            { type: core.NgModule, args: [{\n                        declarations: [\n                            AjfAsFieldInstancePipe,\n                            AjfAsRepeatingSlideInstancePipe,\n                            AjfBoolToIntPipe,\n                            AjfDateValuePipe,\n                            AjfDateValueStringPipe,\n                            AjfExpandFieldWithChoicesPipe,\n                            AjfFieldHost,\n                            AjfFieldIconPipe,\n                            AjfFieldIsValidPipe,\n                            AjfIncrementPipe,\n                            AjfIsRepeatingSlideInstancePipe,\n                            AjfNodeCompleteNamePipe,\n                            AjfRangePipe,\n                            AjfTableRowClass,\n                            AjfTableVisibleColumnsPipe,\n                            AjfValidSlidePipe,\n                        ],\n                        exports: [\n                            AjfAsFieldInstancePipe,\n                            AjfAsRepeatingSlideInstancePipe,\n                            AjfBoolToIntPipe,\n                            AjfDateValuePipe,\n                            AjfDateValueStringPipe,\n                            AjfExpandFieldWithChoicesPipe,\n                            AjfFieldHost,\n                            AjfFieldIconPipe,\n                            AjfFieldIsValidPipe,\n                            AjfIncrementPipe,\n                            AjfIsRepeatingSlideInstancePipe,\n                            AjfNodeCompleteNamePipe,\n                            AjfRangePipe,\n                            AjfTableRowClass,\n                            AjfTableVisibleColumnsPipe,\n                            AjfValidSlidePipe,\n                        ],\n                        providers: [AjfDateValueStringPipe, AjfFormRendererService, AjfValidationService]\n                    },] }\n        ];\n        return AjfFormsModule;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function getTypeName(v) {\n        var typeStr = typeof v;\n        return typeStr === 'object'\n            ? v.constructor.toString().match(/\\w+/g)[1]\n            : typeStr;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfInputFieldComponent = /** @class */ (function (_super) {\n        __extends(AjfInputFieldComponent, _super);\n        function AjfInputFieldComponent() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            _this.type = 'text';\n            return _this;\n        }\n        return AjfInputFieldComponent;\n    }(AjfBaseFieldComponent));\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AJF_SEARCH_ALERT_THRESHOLD = new core.InjectionToken('AJF_SEARCH_ALERT_THRESHOLD');\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createAttachmentsOrigin(origin) {\n        return __assign(__assign({}, origin), { attachments: origin.attachments || [] });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfAttachmentsOriginSerializer = /** @class */ (function () {\n        function AjfAttachmentsOriginSerializer() {\n        }\n        AjfAttachmentsOriginSerializer.fromJson = function (origin) {\n            if (origin.name == null) {\n                throw new Error('Malformed attachments origin');\n            }\n            return createAttachmentsOrigin(origin);\n        };\n        return AjfAttachmentsOriginSerializer;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createChoicesOrigin(origin) {\n        return __assign(__assign({}, origin), { type: origin.type, label: origin.label || '', choices: origin.choices || [] });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfChoicesOriginSerializer = /** @class */ (function () {\n        function AjfChoicesOriginSerializer() {\n        }\n        AjfChoicesOriginSerializer.fromJson = function (origin) {\n            return createChoicesOrigin(__assign(__assign({}, origin), { type: origin.type || 'fixed', name: origin.name || '' }));\n        };\n        return AjfChoicesOriginSerializer;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createFieldWithChoices(field) {\n        var node = createField(__assign({}, field));\n        return __assign(__assign(__assign({}, node), field), { choices: field.choices || [], forceExpanded: field.forceExpanded || false, forceNarrow: field.forceNarrow || false });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createContainerNode(containerNode) {\n        var node = createNode(containerNode);\n        return __assign(__assign({}, node), { nodes: containerNode.nodes || [] });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createRepeatingNode(repeatingNode) {\n        var node = createNode(repeatingNode);\n        return __assign(__assign(__assign({}, repeatingNode), node), { minReps: repeatingNode.minReps != null ? repeatingNode.minReps : 1, maxReps: repeatingNode.maxReps != null ? repeatingNode.maxReps : 0 });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createNodeGroup(nodeGroup) {\n        return __assign(__assign(__assign({}, createContainerNode(nodeGroup)), createRepeatingNode(nodeGroup)), { nodeType: exports.AjfNodeType.AjfNodeGroup });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createRepeatingSlide(nodeGroup) {\n        return __assign(__assign(__assign({}, createContainerNode(nodeGroup)), createRepeatingNode(nodeGroup)), { nodeType: exports.AjfNodeType.AjfRepeatingSlide });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createSlide(nodeGroup) {\n        return __assign(__assign({}, createContainerNode(nodeGroup)), { nodeType: exports.AjfNodeType.AjfSlide });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfValidationGroupSerializer = /** @class */ (function () {\n        function AjfValidationGroupSerializer() {\n        }\n        AjfValidationGroupSerializer.fromJson = function (group) {\n            return createValidationGroup(group);\n        };\n        return AjfValidationGroupSerializer;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfWarningGroupSerializer = /** @class */ (function () {\n        function AjfWarningGroupSerializer() {\n        }\n        AjfWarningGroupSerializer.fromJson = function (group) {\n            return createWarningGroup(group);\n        };\n        return AjfWarningGroupSerializer;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfNodeSerializer = /** @class */ (function () {\n        function AjfNodeSerializer() {\n        }\n        AjfNodeSerializer.fromJson = function (json, choicesOrigins, attachmentsOrigins) {\n            var err = 'Malformed node';\n            json.name = json.name || '';\n            if (json.id == null || json.parent == null || json.nodeType == null) {\n                throw new Error(err);\n            }\n            var obj = json;\n            if (obj.visibility) {\n                obj.visibility = models.AjfConditionSerializer.fromJson(obj.visibility);\n            }\n            obj.conditionalBranches =\n                (obj.conditionalBranches || []).map(function (c) { return models.AjfConditionSerializer.fromJson(c); });\n            switch (obj.nodeType) {\n                case exports.AjfNodeType.AjfField:\n                    return AjfNodeSerializer._fieldFromJson(obj, choicesOrigins, attachmentsOrigins);\n                case exports.AjfNodeType.AjfFieldNodeLink:\n                    return AjfNodeSerializer._fieldNodeLinkFromJson(obj);\n                case exports.AjfNodeType.AjfNodeGroup:\n                    return AjfNodeSerializer._nodeGroupFromJson(obj, choicesOrigins, attachmentsOrigins);\n                case exports.AjfNodeType.AjfRepeatingSlide:\n                    return AjfNodeSerializer._repeatingSlideFromJson(obj, choicesOrigins, attachmentsOrigins);\n                case exports.AjfNodeType.AjfSlide:\n                    return AjfNodeSerializer._slideFromJson(obj, choicesOrigins, attachmentsOrigins);\n            }\n            throw new Error(err);\n        };\n        AjfNodeSerializer._containerNodeFromJson = function (json, choicesOrigins, attachmentsOrigins) {\n            json.nodes = (json.nodes ||\n                []).map(function (n) { return AjfNodeSerializer.fromJson(n, choicesOrigins, attachmentsOrigins); });\n            return createContainerNode(json);\n        };\n        AjfNodeSerializer._fieldFromJson = function (json, choicesOrigins, attachmentsOrigins) {\n            if (json.fieldType == null) {\n                throw new Error('Malformed field');\n            }\n            var obj = json;\n            if (obj.validation) {\n                obj.validation = AjfValidationGroupSerializer.fromJson(obj.validation);\n            }\n            if (obj.warning) {\n                obj.warning = AjfWarningGroupSerializer.fromJson(obj.warning);\n            }\n            if (json.attachmentsOriginRef) {\n                obj.attachmentOrigin =\n                    (attachmentsOrigins || []).find(function (a) { return a.name === json.attachmentsOriginRef; });\n            }\n            if (obj.nextSlideCondition) {\n                obj.nextSlideCondition = models.AjfConditionSerializer.fromJson(obj.nextSlideCondition);\n            }\n            var isCustomFieldWithChoice = obj.fieldType > 100\n                && componentsMap[obj.fieldType] != null\n                && componentsMap[obj.fieldType].isFieldWithChoice === true;\n            if (isCustomFieldWithChoice) {\n                return AjfNodeSerializer._fieldWithChoicesFromJson(json, choicesOrigins);\n            }\n            switch (obj.fieldType) {\n                case exports.AjfFieldType.Formula:\n                    return AjfNodeSerializer._formulaFieldFromJson(json);\n                case exports.AjfFieldType.MultipleChoice:\n                case exports.AjfFieldType.SingleChoice:\n                    return AjfNodeSerializer._fieldWithChoicesFromJson(json, choicesOrigins);\n            }\n            return createField(obj);\n        };\n        AjfNodeSerializer._fieldNodeLinkFromJson = function (json) {\n            return __assign(__assign({}, createNode(json)), { nodeType: exports.AjfNodeType.AjfFieldNodeLink });\n        };\n        AjfNodeSerializer._fieldWithChoicesFromJson = function (json, choicesOrigins) {\n            var err = 'Malformed field with choices';\n            if (json.choicesOriginRef == null) {\n                throw new Error(err);\n            }\n            var choicesOrigin = (choicesOrigins || []).find(function (c) { return c.name === json.choicesOriginRef; });\n            if (choicesOrigin == null) {\n                throw new Error(err);\n            }\n            if (json.choicesFilter) {\n                json.choicesFilter = models.AjfFormulaSerializer.fromJson(json.choicesFilter);\n            }\n            if (json.triggerConditions) {\n                json.triggerConditions = json.triggerConditions.map(function (t) { return models.AjfConditionSerializer.fromJson(t); });\n            }\n            return createFieldWithChoices(__assign(__assign({}, json), { choicesOrigin: choicesOrigin }));\n        };\n        AjfNodeSerializer._formulaFieldFromJson = function (json) {\n            if (json.formula) {\n                json.formula = models.AjfFormulaSerializer.fromJson(json.formula);\n            }\n            return __assign(__assign({}, createField(json)), { fieldType: exports.AjfFieldType.Formula });\n        };\n        AjfNodeSerializer._nodeGroupFromJson = function (json, choicesOrigins, attachmentsOrigins) {\n            return createNodeGroup(__assign(__assign({}, AjfNodeSerializer._containerNodeFromJson(json, choicesOrigins, attachmentsOrigins)), AjfNodeSerializer._repeatingNodeFromJson(json)));\n        };\n        AjfNodeSerializer._repeatingNodeFromJson = function (json) {\n            if (json.formulaReps) {\n                json.formulaReps = models.AjfFormulaSerializer.fromJson(json.formulaReps);\n            }\n            return createRepeatingNode(json);\n        };\n        AjfNodeSerializer._repeatingSlideFromJson = function (json, choicesOrigins, attachmentsOrigins) {\n            return createRepeatingSlide(__assign(__assign({}, AjfNodeSerializer._containerNodeFromJson(json, choicesOrigins, attachmentsOrigins)), AjfNodeSerializer._repeatingNodeFromJson(json)));\n        };\n        AjfNodeSerializer._slideFromJson = function (json, choicesOrigins, attachmentsOrigins) {\n            return createSlide(AjfNodeSerializer._containerNodeFromJson(json, choicesOrigins, attachmentsOrigins));\n        };\n        return AjfNodeSerializer;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfFormSerializer = /** @class */ (function () {\n        function AjfFormSerializer() {\n        }\n        AjfFormSerializer.fromJson = function (form, context) {\n            var choicesOrigins = (form.choicesOrigins || []).map(function (c) { return AjfChoicesOriginSerializer.fromJson(c); });\n            var attachmentsOrigins = (form.attachmentsOrigins || []).map(function (a) { return AjfAttachmentsOriginSerializer.fromJson(a); });\n            var nodes = (form.nodes || [])\n                .map(function (n) { return AjfNodeSerializer.fromJson(n, choicesOrigins, attachmentsOrigins); });\n            return __assign(__assign({}, form), { choicesOrigins: choicesOrigins,\n                attachmentsOrigins: attachmentsOrigins,\n                nodes: nodes, stringIdentifier: form.stringIdentifier || [], initContext: utils.deepCopy(context || {}) });\n        };\n        return AjfFormSerializer;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    (function (AjfAttachmentsType) {\n        AjfAttachmentsType[AjfAttachmentsType[\"Link\"] = 0] = \"Link\";\n        AjfAttachmentsType[AjfAttachmentsType[\"Pdf\"] = 1] = \"Pdf\";\n        AjfAttachmentsType[AjfAttachmentsType[\"LENGTH\"] = 2] = \"LENGTH\";\n    })(exports.AjfAttachmentsType || (exports.AjfAttachmentsType = {}));\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    (function (AjfChoicesType) {\n        AjfChoicesType[AjfChoicesType[\"String\"] = 0] = \"String\";\n        AjfChoicesType[AjfChoicesType[\"Number\"] = 1] = \"Number\";\n        AjfChoicesType[AjfChoicesType[\"LENGTH\"] = 2] = \"LENGTH\";\n    })(exports.AjfChoicesType || (exports.AjfChoicesType = {}));\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createChoicesFixedOrigin(origin) {\n        var type = 'fixed';\n        return __assign(__assign({}, createChoicesOrigin(__assign(__assign({}, origin), { type: type }))), { type: type });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createChoicesFunctionOrigin(origin) {\n        return __assign(__assign({}, origin), { type: 'function', label: origin.label || '', choices: origin.choices || [] });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createChoicesObservableArrayOrigin(origin) {\n        return __assign(__assign({}, origin), { type: 'observableArray', label: origin.label || '', choices: origin.choices || [] });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createChoicesObservableOrigin(origin) {\n        return __assign(__assign({}, origin), { type: 'observable', label: origin.label || '', choices: origin.choices || [] });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createChoicesPromiseOrigin(origin) {\n        return __assign(__assign({}, origin), { type: 'promise', label: origin.label || '', choices: origin.choices || [] });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function isChoicesOrigin(co) {\n        return co != null\n            && typeof co === 'object'\n            && co.name != null\n            && typeof co.name === 'string'\n            && co.label != null\n            && typeof co.label === 'string'\n            && ['fixed', 'promise', 'observable', 'observableArray', 'function'].indexOf(co.type) > -1\n            && co.choices instanceof Array;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function isChoicesFixedOrigin(origin) {\n        return isChoicesOrigin(origin) && origin.type === 'fixed';\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function isNumberField(field) {\n        return field.fieldType === exports.AjfFieldType.Number;\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function createForm(form) {\n        if (form === void 0) { form = {}; }\n        return {\n            nodes: form.nodes || [],\n            choicesOrigins: form.choicesOrigins || [],\n            attachmentsOrigins: form.attachmentsOrigins || [],\n            initContext: form.initContext || {},\n            stringIdentifier: form.stringIdentifier || [],\n            supplementaryInformations: form.supplementaryInformations,\n        };\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function maxDigitsValidation(maxValue) {\n        return createValidation({\n            condition: \"$value ? $value.toString().length <= \" + maxValue.toString() + \" : false\",\n            errorMessage: 'Digits count must be <= ' + maxValue.toString()\n        });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function maxValidation(maxValue) {\n        return createValidation({\n            condition: '$value <= ' + maxValue.toString(),\n            errorMessage: 'Value must be <= ' + maxValue.toString()\n        });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function minDigitsValidation(minValue) {\n        return createValidation({\n            condition: \"$value ? $value.toString().length >= \" + minValue.toString() + \" : false\",\n            errorMessage: 'Digits count must be >= ' + minValue.toString()\n        });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function minValidation(minValue) {\n        return createValidation({\n            condition: '$value >= ' + minValue.toString(),\n            errorMessage: 'Value must be >= ' + minValue.toString()\n        });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function notEmptyValidation() {\n        return createValidation({ condition: \"notEmpty($value)\", errorMessage: \"Value must not be empty\" });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    function notEmptyWarning() {\n        return createWarning({ condition: 'notEmpty($value)', warningMessage: 'Value must not be empty' });\n    }\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n\n    /**\n     * Generated bundle index. Do not edit.\n     */\n\n    exports.AJF_SEARCH_ALERT_THRESHOLD = AJF_SEARCH_ALERT_THRESHOLD;\n    exports.AjfAsFieldInstancePipe = AjfAsFieldInstancePipe;\n    exports.AjfAsRepeatingSlideInstancePipe = AjfAsRepeatingSlideInstancePipe;\n    exports.AjfAttachmentsOriginSerializer = AjfAttachmentsOriginSerializer;\n    exports.AjfBaseFieldComponent = AjfBaseFieldComponent;\n    exports.AjfBoolToIntPipe = AjfBoolToIntPipe;\n    exports.AjfChoicesOriginSerializer = AjfChoicesOriginSerializer;\n    exports.AjfDateValuePipe = AjfDateValuePipe;\n    exports.AjfDateValueStringPipe = AjfDateValueStringPipe;\n    exports.AjfExpandFieldWithChoicesPipe = AjfExpandFieldWithChoicesPipe;\n    exports.AjfFieldHost = AjfFieldHost;\n    exports.AjfFieldIconPipe = AjfFieldIconPipe;\n    exports.AjfFieldIsValidPipe = AjfFieldIsValidPipe;\n    exports.AjfFieldService = AjfFieldService;\n    exports.AjfFieldWithChoicesComponent = AjfFieldWithChoicesComponent;\n    exports.AjfFormActionEvent = AjfFormActionEvent;\n    exports.AjfFormField = AjfFormField;\n    exports.AjfFormRenderer = AjfFormRenderer;\n    exports.AjfFormRendererService = AjfFormRendererService;\n    exports.AjfFormSerializer = AjfFormSerializer;\n    exports.AjfFormsModule = AjfFormsModule;\n    exports.AjfIncrementPipe = AjfIncrementPipe;\n    exports.AjfInputFieldComponent = AjfInputFieldComponent;\n    exports.AjfInvalidFieldDefinitionError = AjfInvalidFieldDefinitionError;\n    exports.AjfIsRepeatingSlideInstancePipe = AjfIsRepeatingSlideInstancePipe;\n    exports.AjfNodeCompleteNamePipe = AjfNodeCompleteNamePipe;\n    exports.AjfNodeSerializer = AjfNodeSerializer;\n    exports.AjfRangePipe = AjfRangePipe;\n    exports.AjfTableRowClass = AjfTableRowClass;\n    exports.AjfTableVisibleColumnsPipe = AjfTableVisibleColumnsPipe;\n    exports.AjfValidSlidePipe = AjfValidSlidePipe;\n    exports.AjfValidationGroupSerializer = AjfValidationGroupSerializer;\n    exports.AjfValidationService = AjfValidationService;\n    exports.AjfWarningGroupSerializer = AjfWarningGroupSerializer;\n    exports.createChoicesFixedOrigin = createChoicesFixedOrigin;\n    exports.createChoicesFunctionOrigin = createChoicesFunctionOrigin;\n    exports.createChoicesObservableArrayOrigin = createChoicesObservableArrayOrigin;\n    exports.createChoicesObservableOrigin = createChoicesObservableOrigin;\n    exports.createChoicesOrigin = createChoicesOrigin;\n    exports.createChoicesPromiseOrigin = createChoicesPromiseOrigin;\n    exports.createContainerNode = createContainerNode;\n    exports.createField = createField;\n    exports.createFieldInstance = createFieldInstance;\n    exports.createFieldWithChoicesInstance = createFieldWithChoicesInstance;\n    exports.createForm = createForm;\n    exports.createNode = createNode;\n    exports.createNodeInstance = createNodeInstance;\n    exports.createValidation = createValidation;\n    exports.createValidationGroup = createValidationGroup;\n    exports.createWarning = createWarning;\n    exports.createWarningGroup = createWarningGroup;\n    exports.fieldIconName = fieldIconName;\n    exports.flattenNodes = flattenNodes;\n    exports.getTypeName = getTypeName;\n    exports.initChoicesOrigin = initChoicesOrigin;\n    exports.isChoicesFixedOrigin = isChoicesFixedOrigin;\n    exports.isChoicesOrigin = isChoicesOrigin;\n    exports.isContainerNode = isContainerNode;\n    exports.isCustomFieldWithChoices = isCustomFieldWithChoices;\n    exports.isField = isField;\n    exports.isFieldWithChoices = isFieldWithChoices;\n    exports.isNumberField = isNumberField;\n    exports.isRepeatingContainerNode = isRepeatingContainerNode;\n    exports.isSlidesNode = isSlidesNode;\n    exports.maxDigitsValidation = maxDigitsValidation;\n    exports.maxValidation = maxValidation;\n    exports.minDigitsValidation = minDigitsValidation;\n    exports.minValidation = minValidation;\n    exports.notEmptyValidation = notEmptyValidation;\n    exports.notEmptyWarning = notEmptyWarning;\n    exports.ɵgc_ajf_src_core_forms_forms_a = createNodeGroup;\n    exports.ɵgc_ajf_src_core_forms_forms_b = createRepeatingSlide;\n    exports.ɵgc_ajf_src_core_forms_forms_c = createSlide;\n    exports.ɵgc_ajf_src_core_forms_forms_d = componentsMap;\n\n    Object.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=core-forms.umd.js.map\n"]}