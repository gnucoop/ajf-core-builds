{"version":3,"sources":["src/core/core-map.umd.js"],"names":["global","factory","exports","module","require","define","amd","self","ajf","core","map","ng","leaflet","rxjs","this","AjfMapContainerDirective","_el","Object","defineProperty","prototype","get","nativeElement","enumerable","configurable","decorators","type","Directive","args","selector","ctorParameters","ElementRef","AjfMapComponent","_columnWidthChanged","Subscription","EMPTY","set","coordinate","_coordinate","slice","_setMapView","tl","_tileLayer","_addTileLayerToMap","attribution","_attribution","disabled","_disabled","_disableMap","_map","ngAfterViewInit","mapContainer","_initMap","redraw","invalidateSize","ngOnDestroy","unsubscribe","htmlElement","zoomControl","attributionControl","x","y","z","length","setView","_this","eachLayer","l","removeLayer","tileLayer","addTo","dragging","disable","touchZoom","doubleClickZoom","scrollWheelZoom","boxZoom","keyboard","tap","Component","template","changeDetection","ChangeDetectionStrategy","OnPush","encapsulation","ViewEncapsulation","None","styles","propDecorators","ViewChild","static","Input","AjfMapModule","NgModule","declarations","ɵgc_ajf_src_core_map_map_a","value"],"mappings":"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","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/core'), require('leaflet'), require('rxjs')) :\n    typeof define === 'function' && define.amd ? define('@ajf/core/map', ['exports', '@angular/core', 'leaflet', 'rxjs'], factory) :\n    (global = global || self, factory((global.ajf = global.ajf || {}, global.ajf.core = global.ajf.core || {}, global.ajf.core.map = {}), global.ng.core, global.leaflet, global.rxjs));\n}(this, (function (exports, core, leaflet, rxjs) { 'use strict';\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfMapContainerDirective = /** @class */ (function () {\n        function AjfMapContainerDirective(_el) {\n            this._el = _el;\n        }\n        Object.defineProperty(AjfMapContainerDirective.prototype, \"htmlElement\", {\n            get: function () {\n                return this._el.nativeElement;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        AjfMapContainerDirective.decorators = [\n            { type: core.Directive, args: [{ selector: '[mapContainer]' },] }\n        ];\n        AjfMapContainerDirective.ctorParameters = function () { return [\n            { type: core.ElementRef }\n        ]; };\n        return AjfMapContainerDirective;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfMapComponent = /** @class */ (function () {\n        function AjfMapComponent() {\n            this._columnWidthChanged = rxjs.Subscription.EMPTY;\n        }\n        Object.defineProperty(AjfMapComponent.prototype, \"coordinate\", {\n            set: function (coordinate) {\n                this._coordinate = coordinate.slice(0);\n                this._setMapView();\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfMapComponent.prototype, \"tileLayer\", {\n            set: function (tl) {\n                this._tileLayer = tl;\n                this._addTileLayerToMap();\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfMapComponent.prototype, \"attribution\", {\n            set: function (attribution) {\n                this._attribution = attribution;\n                this._addTileLayerToMap();\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfMapComponent.prototype, \"disabled\", {\n            set: function (disabled) {\n                this._disabled = disabled;\n                this._disableMap();\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(AjfMapComponent.prototype, \"map\", {\n            get: function () {\n                return this._map;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        AjfMapComponent.prototype.ngAfterViewInit = function () {\n            if (this.mapContainer) {\n                this._initMap();\n                this._setMapView();\n                this._addTileLayerToMap();\n                this._disableMap();\n            }\n        };\n        AjfMapComponent.prototype.redraw = function () {\n            if (this.mapContainer && this._map) {\n                this._map.invalidateSize();\n            }\n        };\n        AjfMapComponent.prototype.ngOnDestroy = function () {\n            this._columnWidthChanged.unsubscribe();\n        };\n        AjfMapComponent.prototype._initMap = function () {\n            var options = { zoomControl: false, attributionControl: false };\n            this._map = leaflet.map(this.mapContainer.htmlElement, options);\n        };\n        AjfMapComponent.prototype._setMapView = function () {\n            if (this._map == null) {\n                return;\n            }\n            var x, y, z;\n            if (this._coordinate != null && this._coordinate.length === 3) {\n                x = this._coordinate[0];\n                y = this._coordinate[1];\n                z = this._coordinate[2];\n            }\n            else {\n                x = 0;\n                y = 0;\n                z = 14;\n            }\n            this._map.setView([x, y], z);\n        };\n        AjfMapComponent.prototype._addTileLayerToMap = function () {\n            var _this = this;\n            if (this._map == null || this._tileLayer == null) {\n                return;\n            }\n            this._map.eachLayer(function (l) { return _this._map.removeLayer(l); });\n            leaflet.tileLayer(this._tileLayer, { attribution: this._attribution }).addTo(this._map);\n        };\n        AjfMapComponent.prototype._disableMap = function () {\n            if (this._map == null) {\n                return;\n            }\n            if (this._disabled) {\n                this._map.dragging.disable();\n                this._map.touchZoom.disable();\n                this._map.doubleClickZoom.disable();\n                this._map.scrollWheelZoom.disable();\n                this._map.boxZoom.disable();\n                this._map.keyboard.disable();\n                if (this._map.tap) {\n                    this._map.tap.disable();\n                }\n            }\n        };\n        AjfMapComponent.decorators = [\n            { type: core.Component, args: [{\n                        selector: 'ajf-map',\n                        template: \"<div mapContainer></div>\\n\",\n                        changeDetection: core.ChangeDetectionStrategy.OnPush,\n                        encapsulation: core.ViewEncapsulation.None,\n                        styles: [\"ajf-map{display:block;position:relative;width:100%;min-height:200px}ajf-map [mapContainer]{position:absolute;min-width:100px;width:100%;height:100%}\\n\"]\n                    },] }\n        ];\n        AjfMapComponent.propDecorators = {\n            mapContainer: [{ type: core.ViewChild, args: [AjfMapContainerDirective, { static: true },] }],\n            coordinate: [{ type: core.Input }],\n            tileLayer: [{ type: core.Input }],\n            attribution: [{ type: core.Input }],\n            disabled: [{ type: core.Input }]\n        };\n        return AjfMapComponent;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfMapModule = /** @class */ (function () {\n        function AjfMapModule() {\n        }\n        AjfMapModule.decorators = [\n            { type: core.NgModule, args: [{\n                        declarations: [\n                            AjfMapComponent,\n                            AjfMapContainerDirective,\n                        ],\n                        exports: [\n                            AjfMapComponent,\n                        ],\n                    },] }\n        ];\n        return AjfMapModule;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n\n    /**\n     * Generated bundle index. Do not edit.\n     */\n\n    exports.AjfMapComponent = AjfMapComponent;\n    exports.AjfMapModule = AjfMapModule;\n    exports.ɵgc_ajf_src_core_map_map_a = AjfMapContainerDirective;\n\n    Object.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=core-map.umd.js.map\n"]}