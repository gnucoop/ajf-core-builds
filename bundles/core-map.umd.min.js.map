{"version":3,"sources":["src/core/core-map.umd.js"],"names":["global","factory","exports","module","require","define","amd","self","ajf","core","map","ng","rxjs","leaflet","this","L","L__default","AjfMapContainerDirective","_el","Object","defineProperty","prototype","get","nativeElement","enumerable","configurable","decorators","type","Directive","args","selector","ctorParameters","ElementRef","leafletLib","AjfMapComponent","_columnWidthChanged","Subscription","EMPTY","set","coordinate","_coordinate","slice","_setMapView","tileLayer","_tileLayer","_addTileLayerToMap","attribution","_attribution","disabled","_disabled","_disableMap","_map","ngAfterViewInit","mapContainer","_initMap","redraw","invalidateSize","ngOnDestroy","unsubscribe","htmlElement","zoomControl","attributionControl","x","y","z","length","setView","_this","eachLayer","l","removeLayer","addTo","dragging","disable","touchZoom","doubleClickZoom","scrollWheelZoom","boxZoom","keyboard","tap","Component","template","changeDetection","ChangeDetectionStrategy","OnPush","encapsulation","ViewEncapsulation","None","styles","propDecorators","ViewChild","static","Input","AjfMapModule","NgModule","declarations","ɵajf_src_core_map_map_a","value"],"mappings":"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","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/core'), require('rxjs'), require('leaflet')) :\n    typeof define === 'function' && define.amd ? define('@ajf/core/map', ['exports', '@angular/core', 'rxjs', 'leaflet'], factory) :\n    (global = global || self, factory((global.ajf = global.ajf || {}, global.ajf.core = global.ajf.core || {}, global.ajf.core.map = {}), global.ng.core, global.rxjs, global.leaflet));\n}(this, (function (exports, core, rxjs, L) { 'use strict';\n\n    var L__default = 'default' in L ? L['default'] : L;\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfMapContainerDirective = /** @class */ (function () {\n        function AjfMapContainerDirective(_el) {\n            this._el = _el;\n        }\n        Object.defineProperty(AjfMapContainerDirective.prototype, \"htmlElement\", {\n            get: function () { return this._el.nativeElement; },\n            enumerable: true,\n            configurable: true\n        });\n        AjfMapContainerDirective.decorators = [\n            { type: core.Directive, args: [{\n                        selector: '[mapContainer]'\n                    },] }\n        ];\n        /** @nocollapse */\n        AjfMapContainerDirective.ctorParameters = function () { return [\n            { type: core.ElementRef }\n        ]; };\n        return AjfMapContainerDirective;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var leafletLib = L__default || L;\n    var AjfMapComponent = /** @class */ (function () {\n        function AjfMapComponent() {\n            this._columnWidthChanged = rxjs.Subscription.EMPTY;\n        }\n        Object.defineProperty(AjfMapComponent.prototype, \"coordinate\", {\n            set: function (coordinate) {\n                this._coordinate = coordinate.slice(0);\n                this._setMapView();\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(AjfMapComponent.prototype, \"tileLayer\", {\n            set: function (tileLayer) {\n                this._tileLayer = tileLayer;\n                this._addTileLayerToMap();\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(AjfMapComponent.prototype, \"attribution\", {\n            set: function (attribution) {\n                this._attribution = attribution;\n                this._addTileLayerToMap();\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(AjfMapComponent.prototype, \"disabled\", {\n            set: function (disabled) {\n                this._disabled = disabled;\n                this._disableMap();\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(AjfMapComponent.prototype, \"map\", {\n            get: function () { return this._map; },\n            enumerable: true,\n            configurable: true\n        });\n        AjfMapComponent.prototype.ngAfterViewInit = function () {\n            if (this.mapContainer) {\n                this._initMap();\n                this._setMapView();\n                this._addTileLayerToMap();\n                this._disableMap();\n            }\n        };\n        AjfMapComponent.prototype.redraw = function () {\n            if (this.mapContainer && this._map) {\n                this._map.invalidateSize();\n            }\n        };\n        AjfMapComponent.prototype.ngOnDestroy = function () {\n            this._columnWidthChanged.unsubscribe();\n        };\n        AjfMapComponent.prototype._initMap = function () {\n            var options = {\n                zoomControl: false,\n                attributionControl: false\n            };\n            this._map = leafletLib.map(this.mapContainer.htmlElement, options);\n        };\n        AjfMapComponent.prototype._setMapView = function () {\n            if (this._map == null) {\n                return;\n            }\n            var x, y, z;\n            if (this._coordinate != null && this._coordinate.length === 3) {\n                x = this._coordinate[0];\n                y = this._coordinate[1];\n                z = this._coordinate[2];\n            }\n            else {\n                x = 0;\n                y = 0;\n                z = 14;\n            }\n            this._map.setView([x, y], z);\n        };\n        AjfMapComponent.prototype._addTileLayerToMap = function () {\n            var _this = this;\n            if (this._map == null || this._tileLayer == null) {\n                return;\n            }\n            this._map.eachLayer(function (l) { return _this._map.removeLayer(l); });\n            leafletLib.tileLayer(this._tileLayer, {\n                attribution: this._attribution\n            }).addTo(this._map);\n        };\n        AjfMapComponent.prototype._disableMap = function () {\n            if (this._map == null) {\n                return;\n            }\n            if (this._disabled) {\n                this._map.dragging.disable();\n                this._map.touchZoom.disable();\n                this._map.doubleClickZoom.disable();\n                this._map.scrollWheelZoom.disable();\n                this._map.boxZoom.disable();\n                this._map.keyboard.disable();\n                if (this._map.tap) {\n                    this._map.tap.disable();\n                }\n            }\n        };\n        AjfMapComponent.decorators = [\n            { type: core.Component, args: [{\n                        selector: 'ajf-map',\n                        template: \"<div mapContainer></div>\\n\",\n                        changeDetection: core.ChangeDetectionStrategy.OnPush,\n                        encapsulation: core.ViewEncapsulation.None,\n                        styles: [\"ajf-map{display:block;position:relative;width:100%;min-height:200px}ajf-map [mapContainer]{position:absolute;min-width:100px;width:100%;height:100%}\\n\"]\n                    }] }\n        ];\n        AjfMapComponent.propDecorators = {\n            mapContainer: [{ type: core.ViewChild, args: [AjfMapContainerDirective, { static: true },] }],\n            coordinate: [{ type: core.Input }],\n            tileLayer: [{ type: core.Input }],\n            attribution: [{ type: core.Input }],\n            disabled: [{ type: core.Input }]\n        };\n        return AjfMapComponent;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n    var AjfMapModule = /** @class */ (function () {\n        function AjfMapModule() {\n        }\n        AjfMapModule.decorators = [\n            { type: core.NgModule, args: [{\n                        declarations: [\n                            AjfMapComponent,\n                            AjfMapContainerDirective\n                        ],\n                        exports: [\n                            AjfMapComponent\n                        ]\n                    },] }\n        ];\n        return AjfMapModule;\n    }());\n\n    /**\n     * @license\n     * Copyright (C) Gnucoop soc. coop.\n     *\n     * This file is part of the Advanced JSON forms (ajf).\n     *\n     * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n     * modify it under the terms of the GNU Affero General Public License as\n     * published by the Free Software Foundation, either version 3 of the License,\n     * or (at your option) any later version.\n     *\n     * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n     * but WITHOUT ANY WARRANTY; without even the implied warranty of\n     * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n     * General Public License for more details.\n     *\n     * You should have received a copy of the GNU Affero General Public License\n     * along with Advanced JSON forms (ajf).\n     * If not, see http://www.gnu.org/licenses/.\n     *\n     */\n\n    /**\n     * Generated bundle index. Do not edit.\n     */\n\n    exports.AjfMapComponent = AjfMapComponent;\n    exports.AjfMapModule = AjfMapModule;\n    exports.ɵajf_src_core_map_map_a = AjfMapContainerDirective;\n\n    Object.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=core-map.umd.js.map\n"]}