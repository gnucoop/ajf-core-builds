{"version":3,"file":"core-page-slider.umd.min.js","sources":["../../src/core/page-slider/page-slider-item.ts","../../src/core/page-slider/page-slider.ts","../../src/core/page-slider/page-slider-module.ts"],"sourcesContent":["/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {\n  ChangeDetectionStrategy, Component, ElementRef, EventEmitter,\n  OnDestroy, Output, Renderer2, ViewChild, ViewEncapsulation\n} from '@angular/core';\nimport {ResizeSensor} from 'css-element-queries';\nimport {Observable, Subscription} from 'rxjs';\nimport {debounceTime} from 'rxjs/operators';\n\nimport {AjfPageSliderItemScrollDirection} from './page-slider-item-scroll-direction';\n\n@Component({\n  moduleId: module.id,\n  selector: 'ajf-page-slider-item',\n  templateUrl: 'page-slider-item.html',\n  styleUrls: ['page-slider-item.css'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n})\nexport class AjfPageSliderItem implements OnDestroy {\n  @ViewChild('wrapper', {static: true}) wrapper: ElementRef;\n  @ViewChild('content', {static: true}) content: ElementRef;\n\n  private _scrollEvt = new EventEmitter<{x: number, y: number}>();\n  @Output()\n  readonly scroll: Observable<{x: number, y: number}> = this._scrollEvt.asObservable();\n\n  private _scrollX = 0;\n  private _scrollY = 0;\n  private _resizeSensor: ResizeSensor;\n  private _resizeEvent: EventEmitter<void> = new EventEmitter<void>();\n  private _resizeSub: Subscription = Subscription.EMPTY;\n\n  constructor(\n    private _el: ElementRef,\n    private _renderer: Renderer2,\n  ) {\n    this._resizeSensor = new ResizeSensor(_el.nativeElement, () => this._onResize());\n\n    this._resizeSub = this._resizeEvent.pipe(\n      debounceTime(300),\n    ).subscribe(() => this._fixScrollOnResize());\n  }\n\n  ngOnDestroy(): void {\n    if (this._resizeSensor) { this._resizeSensor.detach(); }\n    this._resizeSub.unsubscribe();\n    this._resizeEvent.complete();\n  }\n\n  setScroll(dir: AjfPageSliderItemScrollDirection,  amount: number, _duration: number): boolean {\n    if (this._el == null || this.wrapper == null || amount === 0) { return false; }\n    const el = this._el.nativeElement;\n    const wrapper = this.wrapper.nativeElement;\n    let containerSize, wrapperSize, currentScroll;\n    if (dir === 'x') {\n      containerSize = el.clientWidth;\n      wrapperSize = wrapper.clientWidth;\n      currentScroll = this._scrollX;\n    } else {\n      containerSize = el.clientHeight;\n      wrapperSize = wrapper.clientHeight;\n      currentScroll = this._scrollY;\n    }\n    const maxScroll = containerSize - wrapperSize;\n    if (\n      wrapperSize <= containerSize\n      || (currentScroll === maxScroll && amount < 0)\n      || (currentScroll === 0 && amount > 0)\n    ) { return false; }\n    if (amount < 0) {\n      if (dir === 'x') {\n        this._scrollX = Math.max(maxScroll, this._scrollX + amount);\n      } else {\n        this._scrollY = Math.max(maxScroll, this._scrollY + amount);\n      }\n    } else {\n      if (dir === 'x') {\n        this._scrollX = Math.min(0, this._scrollX + amount);\n      } else {\n        this._scrollY = Math.min(0, this._scrollY + amount);\n      }\n    }\n    this._renderer.setStyle(\n      wrapper, 'transform', `translate(${this._scrollX}px, ${this._scrollY}px)`\n    );\n    this._scrollEvt.emit({x: this._scrollX, y: this._scrollY});\n    return true;\n  }\n\n  private _onResize(): void {\n    this._resizeEvent.emit();\n  }\n\n  private _fixScrollOnResize(): void {\n    if (this.content == null || this.wrapper == null) { return; }\n    const content = this.content.nativeElement;\n    const wrapper = this.wrapper.nativeElement;\n    const maxScrollX = Math.min(0, content.clientWidth - wrapper.clientWidth);\n    const maxScrollY = Math.min(0, content.clientHeight - wrapper.clientHeight);\n    if (\n      maxScrollX !== 0 || maxScrollY !== 0\n      || (maxScrollX === 0 && this._scrollX !== 0)\n      || (maxScrollY === 0 && this._scrollY !== 0)\n    ) {\n      this._scrollX = Math.max(\n        maxScrollX, this._scrollX - (content.scrollLeft != null ? content.scrollLeft : 0));\n      this._scrollY = Math.max(\n        maxScrollY, this._scrollY - (content.scrollTop != null ? content.scrollTop : 0));\n      content.scrollTop = content.scrollLeft = 0;\n      this._renderer.setStyle(\n        wrapper, 'transform', `translate(${this._scrollX}px, ${this._scrollY}px)`\n      );\n      this._scrollEvt.emit({x: this._scrollX, y: this._scrollY});\n    }\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {animate, AnimationBuilder, style} from '@angular/animations';\nimport {\n  AfterContentInit, ChangeDetectorRef, ElementRef, EventEmitter, OnDestroy, QueryList, Renderer2\n} from '@angular/core';\n\nimport {Observable, Subscription} from 'rxjs';\nimport {filter, map, scan, throttleTime} from 'rxjs/operators';\n\nimport {coerceBooleanProperty} from '@ajf/core/utils';\n\nimport {AjfPageSliderItem} from './page-slider-item';\nimport {AjfPageSliderSlideOptions} from './page-slider-slide-options';\n\nexport type AjfPageSliderOrientation = 'horizontal' | 'vertical';\n\ninterface Point {\n  x: number;\n  y: number;\n  time: number;\n}\n\ninterface Movement {\n  velocityX: number;\n  velocityY: number;\n  deltaX: number;\n  deltaY: number;\n  deltaTime: number;\n}\n\ninterface MousheWheelMove {\n  dir: 'x' | 'y';\n  amount: number;\n}\n\nexport class AjfPageSlider implements AfterContentInit, OnDestroy {\n  body: ElementRef;\n  pages: QueryList<AjfPageSliderItem>;\n\n  private _pageScrollFinish: EventEmitter<void> = new EventEmitter<void>();\n  readonly pageScrollFinish: Observable<void> = this._pageScrollFinish.asObservable();\n\n  private _orientationChange: EventEmitter<AjfPageSliderOrientation>\n    = new EventEmitter<AjfPageSliderOrientation>();\n  readonly orientationChange: Observable<AjfPageSliderOrientation> =\n    this._orientationChange.asObservable();\n\n  duration = 300;\n\n  private _orientation: AjfPageSliderOrientation = 'horizontal';\n  get orientation(): AjfPageSliderOrientation { return this._orientation; }\n  set orientation(orientation: AjfPageSliderOrientation) {\n    if (this._orientation !== orientation) {\n      this._orientation = orientation;\n      this._cdr.markForCheck();\n      this._updateSize();\n      this._restoreCurrentPage();\n      this._orientationChange.emit(this._orientation);\n    }\n  }\n\n  private _fixedOrientation = false;\n  get fixedOrientation(): boolean { return this._fixedOrientation; }\n  set fixedOrientation(fixedOrientation: boolean) {\n    this._fixedOrientation = coerceBooleanProperty(fixedOrientation);\n    this._cdr.markForCheck();\n  }\n\n  private _currentPage = -1;\n  get currentPage(): number { return this._currentPage; }\n  set currentPage(currentPage: number) {\n    if (this.pages == null || currentPage < 0 || currentPage >= this.pages.length) { return; }\n    this._currentPage = currentPage;\n    this._doSlide();\n  }\n\n  private _hideNavigationButtons: boolean;\n  get hideNavigationButtons(): boolean { return this._hideNavigationButtons; }\n  set hideNavigationButtons(hnb: boolean) {\n    this._hideNavigationButtons = coerceBooleanProperty(hnb);\n    this._cdr.markForCheck();\n  }\n\n  private _animating = false;\n  private _pagesSub: Subscription = Subscription.EMPTY;\n\n  private _currentOrigin: Point | null;\n  private _mouseWheelEvt: EventEmitter<MousheWheelMove> = new EventEmitter<MousheWheelMove>();\n  private _mouseWheelSub: Subscription = Subscription.EMPTY;\n\n  constructor(\n    private _animationBuilder: AnimationBuilder,\n    private _cdr: ChangeDetectorRef,\n    private _renderer: Renderer2\n  ) {\n    this._mouseWheelSub = this._mouseWheelEvt.pipe(\n      map(evt => {\n        const page = this._getCurrentPage();\n        if (page == null) { return null; }\n        return {evt, res: page.setScroll(evt.dir, evt.amount, 0)};\n      }),\n      filter(r => r != null\n        && r.res === false\n        && (\n          (r.evt.dir === 'x' && this.orientation === 'horizontal')\n          || (r.evt.dir === 'y' && this.orientation === 'vertical')\n        )\n      ),\n      map(r => r!.evt.amount),\n      scan((acc, val) => {\n        if (acc === 0) { return val; }\n        if (acc / Math.abs(acc) !== val / Math.abs(val)) {return 0; }\n        return acc + val;\n      }, 0),\n      filter(val => !this._animating && Math.abs(val) > 150),\n      throttleTime(1500),\n    ).subscribe(val => {\n      this._mouseWheelEvt.emit({dir: 'x', amount: val > 0 ? -1 : + 1});\n      this.slide({dir: val > 0 ? 'back' : 'forward'});\n    });\n  }\n\n  ngAfterContentInit(): void {\n    this._onSlidesChange();\n    this._pagesSub = this.pages.changes.subscribe(() => this._onSlidesChange());\n  }\n\n  ngOnDestroy(): void {\n    this._pagesSub.unsubscribe();\n    this._mouseWheelEvt.complete();\n    this._mouseWheelSub.unsubscribe();\n    this._orientationChange.complete();\n  }\n\n  switchOrientation(): void {\n    if (this._orientation === 'horizontal') {\n      this.orientation = 'vertical';\n    } else {\n      this.orientation = 'horizontal';\n    }\n  }\n\n  slide(opts: AjfPageSliderSlideOptions): void {\n    if (this.pages == null) { return; }\n    if (opts.dir) {\n      if (opts.dir === 'back' || opts.dir === 'up' || opts.dir === 'left') {\n        this._slideBack();\n      } else if (opts.dir === 'forward' || opts.dir === 'down' || opts.dir === 'right') {\n        this._slideForward();\n      }\n    } else if (opts.to) {\n      this._slideTo(opts.to);\n    }\n  }\n\n  onMouseWheel(evt: WheelEvent): void {\n    const absDeltaX = Math.abs(evt.deltaX);\n    const absDeltaY = Math.abs(evt.deltaY);\n    if (absDeltaX === 0 && absDeltaY === 0) { return; }\n    if (absDeltaX > absDeltaY) {\n      this._mouseWheelEvt.emit({dir: 'x', amount: -evt.deltaX});\n    } else {\n      this._mouseWheelEvt.emit({dir: 'y', amount: -evt.deltaY});\n    }\n  }\n\n  onTouchStart(evt: TouchEvent): void {\n    if (evt.touches == null || evt.touches.length === 0 || this._animating) { return; }\n    this._currentOrigin = {\n      x: evt.touches[0].clientX,\n      y: evt.touches[0].clientY,\n      time: + new Date()\n    };\n  }\n\n  onTouchMove(evt: TouchEvent): void {\n    if (\n      evt.touches == null || evt.touches.length === 0\n      || this._currentOrigin == null || this._animating\n    ) { return; }\n    const point: Point = {\n      x: evt.touches[0].clientX,\n      y: evt.touches[0].clientY,\n      time: + new Date()\n    };\n    const movement = this._calculateMovement(point);\n    this._currentOrigin = point;\n\n    if (movement.velocityX === 0 && movement.velocityY === 0) { return; }\n    const absVelocityX = Math.abs(movement.velocityX);\n    const absVelocityY = Math.abs(movement.velocityY);\n    if (absVelocityX > absVelocityY) {\n      if (\n        this.orientation === 'horizontal' && absVelocityX > 1.5 && Math.abs(movement.deltaX) > 50\n      ) {\n        this._resetCurrentOrigin();\n        this.slide({dir: movement.velocityX < 0 ? 'forward' : 'back'});\n      } else {\n        const page = this._getCurrentPage();\n        if (page != null) {\n          page.setScroll('x', movement.deltaX, movement.deltaTime);\n        }\n      }\n    } else {\n      if (\n        this.orientation === 'vertical' && absVelocityY > 1.5 && Math.abs(movement.deltaY) > 50\n      ) {\n        this._resetCurrentOrigin();\n        this.slide({dir: movement.velocityY < 0 ? 'forward' : 'back'});\n      } else {\n        const page = this._getCurrentPage();\n        if (page != null) {\n          page.setScroll('y', movement.deltaY, movement.deltaTime);\n        }\n      }\n    }\n  }\n\n  onTouchEnd(): void {\n    this._resetCurrentOrigin();\n  }\n\n  isCurrentPageLong(): boolean {\n    const curPage = this._getCurrentPage();\n    if (curPage == null) { return false; }\n    return curPage.wrapper.nativeElement.clientHeight > curPage.content.nativeElement.clientHeight;\n  }\n\n  private _resetCurrentOrigin(): void {\n    this._currentOrigin = null;\n  }\n\n  private _getCurrentPage(): AjfPageSliderItem | null {\n    if (this.pages == null || this.currentPage < 0 || this.currentPage >= this.pages.length) {\n      return null;\n    }\n    return this.pages.toArray()[this.currentPage];\n  }\n\n  private _calculateMovement(point: Point): Movement {\n    const deltaX = point.x - this._currentOrigin!.x;\n    const deltaY = point.y - this._currentOrigin!.y;\n    const deltaTime = point.time - this._currentOrigin!.time;\n    return {\n      velocityX: deltaX / deltaTime,\n      deltaX,\n      velocityY: deltaY / deltaTime,\n      deltaY,\n      deltaTime,\n    };\n  }\n\n  private _slideBack(): void {\n    if (this._currentPage <= 0) { return; }\n    this.currentPage = this._currentPage - 1;\n  }\n\n  private _slideForward(): void {\n    if (this._currentPage >= this.pages.length) { return; }\n    this.currentPage = this._currentPage + 1;\n  }\n\n  private _slideTo(page: number): void {\n    if (page >= 0 && page < this.pages.length) {\n      this.currentPage = page;\n    }\n  }\n\n  private _doSlide(immediate = false): void {\n    if (this.body == null || this.pages == null || this._animating) { return; }\n    this._animating = true;\n    const animation = this._animationBuilder.build(animate(\n      immediate ? 0 : this.duration,\n      style({transform: this._getCurrentTranslation()})\n    ));\n\n    const player = animation.create(this.body.nativeElement);\n    player.onDone(() => {\n      this._animating = false;\n      this._pageScrollFinish.emit();\n    });\n    player.play();\n  }\n\n  private _getCurrentTranslation(): string {\n    const slideSize = 100 / this.pages.length;\n    const position = this._currentPage === -1 ? 0 : this._currentPage * slideSize;\n    const translation = this._orientation === 'vertical' ? 'Y' : 'X';\n    return `translate${translation}(-${position}%)`;\n  }\n\n  private _getProps(): {prop: string, removeProp: string} {\n    if (this._orientation === 'vertical') {\n      return {prop: 'height', removeProp: 'width'};\n    }\n    return {prop: 'width', removeProp: 'height'};\n  }\n\n  private _onSlidesChange(): void {\n    this._updateSize();\n  }\n\n  private _updateSize(): void {\n    if (this.body == null || this.pages == null) { return; }\n    const {prop, removeProp} = this._getProps();\n    this._renderer.setStyle(this.body.nativeElement, prop, `${this.pages.length * 100}%`);\n    this._renderer.setStyle(this.body.nativeElement, removeProp, null);\n    let curPage: number;\n    if (this.pages.length === 0) {\n      curPage = -1;\n    } else if (this._currentPage === -1) {\n      curPage = 0;\n    } else if (this._currentPage >= this.pages.length) {\n      curPage = this.pages.length - 1;\n    } else {\n      curPage = this._currentPage;\n    }\n    this._currentPage = curPage;\n    this._restoreCurrentPage();\n  }\n\n  private _restoreCurrentPage(): void {\n    this._doSlide(true);\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {NgModule} from '@angular/core';\n\nimport {AjfPageSliderItem} from './page-slider-item';\n\n@NgModule({\n  declarations: [\n    AjfPageSliderItem,\n  ],\n  exports: [\n    AjfPageSliderItem,\n  ]\n})\nexport class AjfPageSliderModule { }\n"],"names":["AjfPageSliderItem","prototype","ngOnDestroy","this","_resizeSensor","detach","_resizeSub","unsubscribe","_resizeEvent","complete","setScroll","dir","amount","_duration","_el","wrapper","containerSize","wrapperSize","currentScroll","el","nativeElement","clientWidth","_scrollX","clientHeight","_scrollY","maxScroll","Math","max","min","_renderer","setStyle","_scrollEvt","emit","x","y","_onResize","_fixScrollOnResize","content","maxScrollX","maxScrollY","scrollLeft","scrollTop","type","Component","args","selector","template","styles","changeDetection","ChangeDetectionStrategy","OnPush","encapsulation","ViewEncapsulation","None","propDecorators","scroll","Output","_this","EventEmitter","asObservable","Subscription","EMPTY","ResizeSensor","pipe","debounceTime","subscribe","AjfPageSlider","Object","defineProperty","_orientation","orientation","_cdr","markForCheck","_updateSize","_restoreCurrentPage","_orientationChange","_fixedOrientation","fixedOrientation","coerceBooleanProperty","_currentPage","currentPage","pages","length","_doSlide","_hideNavigationButtons","hnb","ngAfterContentInit","_onSlidesChange","_pagesSub","changes","_mouseWheelEvt","_mouseWheelSub","switchOrientation","slide","opts","_slideBack","_slideForward","to","_slideTo","onMouseWheel","evt","absDeltaX","abs","deltaX","absDeltaY","deltaY","onTouchStart","touches","_animating","_currentOrigin","clientX","clientY","time","Date","onTouchMove","point","movement","_calculateMovement","velocityX","velocityY","page","absVelocityX","absVelocityY","_resetCurrentOrigin","_getCurrentPage","deltaTime","onTouchEnd","isCurrentPageLong","curPage","toArray","immediate","body","player","_animationBuilder","build","animate","duration","style","transform","_getCurrentTranslation","create","onDone","_pageScrollFinish","play","slideSize","position","_getProps","prop","removeProp","_a","pageScrollFinish","orientationChange","map","res","filter","r","scan","acc","val","throttleTime","AjfPageSliderModule","NgModule","declarations","exports"],"mappings":"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"}