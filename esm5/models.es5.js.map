{"version":3,"file":"models.es5.js","sources":["../../../src/core/models/utils/validate-expression.ts","../../../src/core/models/utils/normalize-expression.ts","../../../src/core/models/utils/never-condition.ts","../../../src/core/models/utils/get-context-string.ts","../../../src/core/models/utils/evaluate-expression.ts","../../../src/core/models/utils/expression-utils.ts","../../../src/core/models/utils/validation-functions.ts","../../../src/core/models/utils/debug.ts","../../../src/core/models/utils/always-condition.ts","../../../src/core/models/serializers/formula-serializer.ts","../../../src/core/models/utils/create-formula.ts","../../../src/core/models/serializers/condition-serializer.ts","../../../src/core/models/utils/create-condition.ts","../../../src/core/models/error.ts"],"sourcesContent":["/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '../interface/context';\nimport {dbg} from './debug';\nimport {getContextString} from './get-context-string';\n\nlet cachedContext: any = {};\nlet cachedContextString = '{}';\n\nexport function validateExpression(str: string, context?: AjfContext): boolean {\n  if (context === cachedContext) {\n    console.log('cache hit');\n  } else {\n    cachedContext = context;\n    cachedContextString = getContextString(context);\n  }\n  let ctx = cachedContextString;\n  try {\n    let f = new Function(`${ctx}${str}`);\n    dbg(<any>`validating formula %s using context %j`, str, ctx);\n    f();\n    dbg(`formula %s validated`, str);\n    f = <any>null;\n    return true;\n  } catch (e) {\n    dbg(`formula %s not validated: error %j`, str, e);\n    return false;\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport * as esprima from 'esprima';\nconst esprimaMod: any = (esprima as any).default || esprima;\nconst {tokenize} = esprimaMod;\n\nexport function normalizeExpression(\n    formula: string, ancestorsNames: {[prop: string]: number}, prefix: number[]): string {\n  const ancestorsNameStrings = Object.keys(ancestorsNames);\n  const tokens = tokenize(formula)\n                     .filter((token: any) => token.type == 'Identifier' && token.value != '$value')\n                     .map((token: any) => token.value);\n  tokens.forEach((t: any) => {\n    if (ancestorsNameStrings.indexOf(t) > -1) {\n      formula = formula.replace(\n          new RegExp(`\\\\b${t}\\\\b`, 'g'), `${t}__${prefix.slice(ancestorsNames[t]).join('__')}`);\n    }\n  });\n  return formula;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfCondition} from '../interface/condition';\nimport {createCondition} from './create-condition';\n\nexport function neverCondition(): AjfCondition {\n  return createCondition({condition: 'false'});\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '../interface/context';\nimport {AjfExpressionUtils} from './expression-utils';\n\nexport function getContextString(context?: AjfContext): string {\n  let fstr = AjfExpressionUtils.UTIL_FUNCTIONS;\n  if (context instanceof Array) {\n    for (let i = 0; i < context.length; i++) {\n      fstr = `${fstr}var ${context[i]} = true;`;\n    }\n  } else if (context != null) {\n    Object.keys(context).forEach(x => {\n      let val: any = context[x];\n      if (val == null || isNaN(Number(val)) || val === '' || val instanceof Array) {\n        if (val instanceof Array) {\n          for (let i = 0; i < val.length; i++) {\n            val[i] =\n                (val == null || isNaN(Number(val[i])) || val[i] === '') && val[i] || Number(val[i]);\n          }\n        }\n        val = JSON.stringify(val);\n      } else {\n        val = Number(val);\n      }\n      fstr = `${fstr}var ${x} = ${val}; `;\n    });\n  }\n  return fstr;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport * as esprima from 'esprima';\nconst esprimaMod: any = (esprima as any).default || esprima;\nconst {tokenize} = esprimaMod;\n\nimport {AjfContext} from '../interface/context';\nimport {dbg} from './debug';\nimport {AjfExpressionUtils} from './expression-utils';\n\nlet execContext: any = {};\n\nexport function evaluateExpression(\n    expression: string, context?: AjfContext, forceFormula?: string): any {\n  let formula = forceFormula || expression || '';\n  if (formula === '') {\n    return '';\n  }\n  if (formula === 'true') {\n    return true;\n  }\n  if (formula === 'false') {\n    return false;\n  }\n  if (context != null && context[formula] !== undefined) {\n    return context[formula];\n  }\n  if (/^\"[^\"]*\"$/.test(formula)) {\n    return formula.replace(/^\"+|\"+$/g, '');\n  }\n  const identifiers =\n      tokenize(formula).filter((t: any) => t.type === 'Identifier').map((t: any) => t.value);\n  const ctx: any[] = [];\n  identifiers.forEach((key: string) => {\n    let val: any = null;\n    if (context != null && context[key] !== undefined) {\n      val = context[key];\n    } else if (AjfExpressionUtils.utils[key] !== undefined) {\n      const util = AjfExpressionUtils.utils[key];\n      val = util.fn;\n    }\n    ctx.push(val);\n  });\n  identifiers.push('execContext');\n  ctx.push(execContext);\n\n  try {\n    if (dbg.enabled) {\n      dbg(`evaluating formula %s using context %j`, formula, ctx);\n    }\n    let f = new Function(...identifiers, `return ${formula}`);\n    const res = f(...ctx);\n    if (dbg.enabled) {\n      dbg(`formula %s evaluated: result %s`, formula, res);\n    }\n    f = <any>null;\n    return res;\n  } catch (e) {\n    console.log(e);\n    if (dbg.enabled) {\n      dbg(`formula %s not evaluated: error %j`, formula, e.message);\n    }\n    return false;\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfValidationFn} from '../interface/validation-function';\n\nimport * as vfuncs from './validation-functions';\n\nexport class AjfExpressionUtils {\n  static UTIL_FUNCTIONS = '';\n\n  static utils: {[name: string]: AjfValidationFn} = {\n    digitCount: {fn: vfuncs.digitCount},\n    decimalCount: {fn: vfuncs.decimalCount},\n    isInt: {fn: vfuncs.isInt},\n    notEmpty: {fn: vfuncs.notEmpty},\n    valueInChoice: {fn: vfuncs.valueInChoice},\n    scanGroupField: {fn: vfuncs.scanGroupField},\n    sum: {fn: vfuncs.sum},\n    dateOperations: {fn: vfuncs.dateOperations},\n    round: {fn: vfuncs.round},\n    extractArray: {fn: vfuncs.extractArray},\n    extractSum: {fn: vfuncs.extractSum},\n    extractArraySum: {fn: vfuncs.extractArraySum},\n    drawThreshold: {fn: vfuncs.drawThreshold},\n    extractDates: {fn: vfuncs.extractDates},\n    lastProperty: {fn: vfuncs.lastProperty},\n    sumLastProperties: {fn: vfuncs.sumLastProperties},\n    calculateTrendProperty: {fn: vfuncs.calculateTrendProperty},\n    calculateTrendByProperties: {fn: vfuncs.calculateTrendByProperties},\n    calculateAvgProperty: {fn: vfuncs.calculateAvgProperty},\n    calculateAvgPropertyArray: {fn: vfuncs.calculateAvgPropertyArray},\n    alert: {fn: vfuncs.alert},\n    formatNumber: {fn: vfuncs.formatNumber},\n    formatDate: {fn: vfuncs.formatDate},\n    isoMonth: {fn: vfuncs.isoMonth},\n    getCoordinate: {fn: vfuncs.getCoordinate},\n    Math: {fn: Math},\n    parseInt: {fn: parseInt},\n    parseFloat: {fn: parseFloat},\n    parseDate: {fn: vfuncs.dateUtils.parse},\n    Date: {fn: Date}\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {\n  addDays, addMonths, addYears, endOfISOWeek, format, getDay, parse, startOfISOWeek, startOfMonth\n} from 'date-fns';\nimport * as numeral from 'numeral';\n\nconst numeralConstructor: (value?: any) => any = (<any>numeral).default || numeral;\n\n\nexport const dateUtils = {\n  addDays,\n  addMonths,\n  addYears,\n  endOfISOWeek,\n  format,\n  getDay,\n  parse,\n  startOfMonth,\n  startOfISOWeek\n};\n\nexport function digitCount(x: number): number {\n  if ( isNaN(x) || typeof(x) !== 'number') {\n    return 0;\n  }\n  if ( !isFinite(x)) {\n    return Infinity;\n  }\n  return x.toString().replace(/[^0-9]/g, '').length;\n}\n\nexport function decimalCount(x: string|number): number {\n  if (typeof x === 'string') {\n    x = parseFloat(x);\n  }\n  if (typeof x !== 'number' || isNaN(x)) {\n    return 0;\n  }\n  const parts = x.toString().split('.');\n  return parts.length > 1 ? parts[1].length : 0;\n}\n\nexport function isInt(x: string|number): boolean {\n  if (typeof(x) === 'string') {\n    return /^-?\\d+$/.test(x);\n  }\n  if (typeof (x) === 'number') {\n    return Math.round(x) === x;\n  }\n  return false;\n}\n\nexport function notEmpty(x: any): boolean {\n  return (typeof x !== 'undefined' && x !== null ? x.toString().length > 0 : false);\n}\n\nexport function valueInChoice(array: any[], x: any): boolean {\n  return (array || []).indexOf(x) > -1 || array === x;\n}\n\nexport function scanGroupField(reps: number, acc: any, callback: any): any {\n  for (let i = 0; i < reps; i++) {\n    acc = callback(acc, i);\n  }\n  return acc;\n}\n\nexport function sum(array: any[]): any {\n  return array.reduce((a, b) => a + b, 0);\n}\n\nexport function dateOperations(dString: string, period: string, operation: string, v: any): string {\n  const fmt = 'MM/DD/YYYY';\n  let d = (typeof dString !== 'undefined') ? dateUtils.parse(dString) : new Date();\n  if (operation == 'remove') {\n    v = -v;\n  }\n  let dateOp;\n  switch (period) {\n    case 'day':\n      dateOp = dateUtils.addDays;\n      break;\n    case 'month':\n      dateOp = dateUtils.addMonths;\n      break;\n    case 'year':\n      dateOp = dateUtils.addYears;\n      break;\n    default:\n      return '';\n  }\n  return dateUtils.format(dateOp(d, v), fmt);\n}\n\nexport function round(num: number|string, digits: number): number {\n  digits = digits || 0;\n  let f;\n  if (typeof num !== 'number') {\n    try {\n      f = parseFloat(num);\n    } catch (e) {\n    }\n  } else {\n    f = num;\n  }\n  if (f == null || isNaN(f)) {\n    f = 0;\n  }\n  const m = Math.pow(10, digits);\n  return Math.round(f * m) / m;\n}\n\nexport function extractArray(source: any[], property: string, property2?: string): any[] {\n  source = (source || []).slice(0);\n  const l = source.length;\n  const res: any[] = [];\n  for (let i = 0; i < l; i++) {\n    if (source[i][property] != null && property2 != null && source[i][property2] != null) {\n      res.push(Number(source[i][property]) + Number(source[i][property2]));\n    } else if (source[i][property] != null) {\n      res.push(source[i][property]);\n    }\n  }\n  return res;\n}\n\nexport function extractSum(source: any[], properties: string[]): number {\n  let sumVal = 0;\n  properties = (properties || []).slice(0);\n  const l = properties.length;\n\n  for (let i = 0; i < l; i++) {\n    const array = extractArray(source, properties[i]);\n    const leng = array.length;\n    for (let j = 0; j < leng; j++) {\n      if (!isNaN(Number(array[j]))) {\n        sumVal += Number(array[j]);\n      }\n    }\n  }\n  return sumVal;\n}\n\nexport function extractArraySum(source: any[], properties: string[]): any[] {\n  const arrays: any[] = [];\n  properties = (properties || []).slice(0);\n\n  for (let i = 0; i < properties.length; i++) {\n    const array = extractArray(source, properties[i]);\n    arrays.push(array);\n  }\n\n  const res: any[] = [];\n  if (arrays.length > 0) {\n    for (let weekI = 0; weekI < arrays[0].length; weekI++) {\n      let sumVal = 0;\n      for (let propI = 0; propI < properties.length; propI++) {\n        sumVal = sumVal + Number(arrays[propI][weekI]);\n      }\n      res.push(sumVal);\n    }\n  }\n  return res;\n}\n\nexport function drawThreshold(source: any[], property: string, threshold: any[]): any[] {\n  source = (source || []).slice(0);\n  threshold = threshold || [0];\n  if (!(threshold instanceof Array)) {\n    threshold = [threshold];\n  }\n  const l = source.length;\n  const res: any[] = [];\n  let count = 0;\n  for (let i = 0; i < l; i++) {\n    if (source[i][property] != null) {\n      if (threshold.length > count) {\n        res.push(threshold[count]);\n      } else {\n        res.push(threshold[0]);\n      }\n      count++;\n    }\n  }\n  return res;\n}\n\nexport function extractDates(source: any[], property: string, fmt: string): string[] {\n  source = (source || []).slice(0);\n  const l = source.length;\n  const res: any = [];\n  let prefix = '';\n  for (let i = 0; i < l; i++) {\n    if (source[i][property] != null) {\n      switch (fmt) {\n        case 'WW':\n          prefix = 'W';\n          res.push(prefix + formatDate(source[i]['date_start'], fmt));\n          break;\n        case 'MM':\n          prefix = 'M';\n          res.push(prefix + isoMonth(source[i]['date_start'], fmt));\n          break;\n        default:\n          prefix = '';\n          res.push(prefix + formatDate(source[i]['date_start'], fmt));\n      }\n    }\n  }\n  return res;\n}\n\nexport function lastProperty(source: any, property: string): any {\n  source = (source || []).slice(0);\n  let l = source.length - 1;\n\n  while (l >= 0 && source[l][property] == null) {\n    l--;\n    if (l < 0) {\n      return '';\n    }\n  }\n  return l >= 0 ? source[l][property] : '';\n}\n\nexport function sumLastProperties(source: any[], properties: string[]): number {\n  source = (source || []).slice(0);\n  let sumVal = 0;\n  let val = 0;\n  for (let i = 0; i < properties.length; i++) {\n    val = Number(lastProperty(source, properties[i]));\n    if (!isNaN(val)) {\n      sumVal += val;\n    }\n  }\n  return sumVal;\n}\n\nexport function calculateTrendProperty(source: any[], property: string): string {\n  source = (source || []).slice(0);\n  let last = source.length - 1;\n  while (source[last][property] == null) {\n    if (last == 0) {\n      break;\n    }\n    last--;\n  }\n  let lastLast = last - 1;\n  if (last == 0) {\n    lastLast = last;\n  } else {\n    while (source[lastLast][property] == null) {\n      if (lastLast == 0) {\n        lastLast = last;\n        break;\n      }\n      lastLast--;\n    }\n  }\n\n  const lastProp = source[last] ? (source[last][property] || 0) : 0;\n  const lastLastProp = source[lastLast] ? (source[lastLast][property] || 0) : 0;\n\n  if (lastProp == lastLastProp) {\n    return '<p><i class=\"material-icons\" style=\"color:blue\">trending_flat</i></p>';\n  } else if (lastProp > lastLastProp) {\n    return '<p><i class=\"material-icons\" style=\"color:green\">trending_up</i></p>';\n  } else {\n    return '<p><i class=\"material-icons\" style=\"color:red\">trending_down</i></p>';\n  }\n}\n\nexport function calculateTrendByProperties(source: any[], properties: string[]): string {\n  const arraysum = extractArraySum(source, properties);\n\n  const lastProp = arraysum.length > 0 ? (arraysum[arraysum.length - 1] || 0) : 0;\n  const lastLastProp = arraysum.length > 1 ? (arraysum[arraysum.length - 2] || 0) : lastProp;\n\n  if (lastProp == lastLastProp) {\n    return '<p><i class=\"material-icons\" style=\"color:blue\">trending_flat</i></p>';\n  } else if (lastProp > lastLastProp) {\n    return '<p><i class=\"material-icons\" style=\"color:green\">trending_up</i></p>';\n  } else {\n    return '<p><i class=\"material-icons\" style=\"color:red\">trending_down</i></p>';\n  }\n}\n\nexport function calculateAvgProperty(\n    source: any[], property: string, range: number, coefficient: number): number {\n  source = (source || []).slice(0);\n\n  coefficient = coefficient || 1;\n  range = range || 12;\n\n  let l = source.length;\n  let res = 0;\n  let counter = 0;\n  let noZero = 0;\n\n  if (l < range) {\n    range = l;\n  }\n\n  while (range != 0) {\n    if (source[l - 1][property] != null) {\n      counter++;\n      res += Number(source[l - 1][property]);\n\n      if (source[l - 1][property] > 0) {\n        noZero++;\n      }\n    }\n    l--;\n    range--;\n  }\n\n  if (coefficient == 0) {\n    return noZero;\n  } else {\n    return round((res / counter) * coefficient, 2) || 0;\n  }\n}\n\nexport function calculateAvgPropertyArray(\n    source: any[], properties: string[], range: number, coefficient: number): number[] {\n  source = (source || []).slice(0);\n  const resArr: any[] = [];\n\n  if (properties && properties.length > 0) {\n    let avg = 0;\n\n    coefficient = coefficient || 1;\n    range = range || 12;\n\n    const sourceArr = properties.length > 1 ? extractArraySum(source, properties) :\n                                              extractArray(source, properties[0]);\n\n    let l = sourceArr.length;\n\n    for (let len = l; len > 0; len--) {\n      let res = 0;\n      let counter = 0;\n      let noZero = 0;\n\n      if (len < range) {\n        range = len;\n      }\n\n      for (let r = 1; r <= range; r++) {\n        let val = sourceArr[len - r];\n        if (val != null) {\n          counter++;\n          res += Number(val);\n          if (val > 0) {\n            noZero++;\n          }\n        }\n      }\n\n      if (counter > 0) {\n        if (coefficient == 0) {\n          avg = noZero;\n        } else {\n          avg = (res / counter) * coefficient || 0;\n        }\n        resArr.push(round(avg, 2));\n      }\n    }\n  }\n  return resArr.reverse();\n}\n\nexport function alert(source: any[], property: string, threshold: number): string {\n  source = (source || []).slice(0);\n\n  if (lastProperty(source, property) > threshold) {\n    return '<p><i class=\"material-icons\" style=\"color:red\">warning</i></p>';\n  } else {\n    return '<p></p>';\n  }\n}\n\nexport function formatNumber(num: number, fmt?: string): string {\n  fmt = fmt || '0,0[.]0';\n  return numeralConstructor(num).format(fmt);\n}\n\nexport function formatDate(date: Date, fmt?: string): string {\n  fmt = fmt || 'MM-DD-YYYY';\n  return dateUtils.format(date, fmt);\n}\n\nexport function isoMonth(date: Date, fmt?: string): string {\n  fmt = fmt || 'MM';\n  const du = dateUtils;\n  return du.format(du.addDays(du.startOfISOWeek(date), 3), fmt);\n}\n\nexport function getCoordinate(source: any, zoom?: number): [number, number, number] {\n  zoom = zoom || 6;\n  if (source == null) {\n    return [51.505, -0.09, zoom];\n  } else {\n    return [source[0], source[1], zoom];\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport * as debug from 'debug';\n\nconst debugConstructor: (value?: any) => debug.IDebugger = (<any>debug).default || debug;\n\nexport const dbg = debugConstructor('ajf:models:validated-property');\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfCondition} from '../interface/condition';\nimport {createCondition} from './create-condition';\n\nexport function alwaysCondition(): AjfCondition {\n  return createCondition({condition: 'true'});\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfFormula} from '../interface/formula';\nimport {createFormula} from '../utils/create-formula';\n\nexport class AjfFormulaSerializer {\n  static fromJson(json: Partial<AjfFormula>): AjfFormula {\n    return createFormula(json);\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfFormula} from '../interface/formula';\n\nexport function createFormula(formula: Partial<AjfFormula> = {}): AjfFormula {\n  return {formula: formula.formula || ''};\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfCondition} from '../interface/condition';\nimport {createCondition} from '../utils/create-condition';\n\nexport class AjfConditionSerializer {\n  static fromJson(json: Partial<AjfCondition>): AjfCondition {\n    return createCondition(json);\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfCondition} from '../interface/condition';\n\nexport function createCondition(condition: Partial<AjfCondition> = {}): AjfCondition {\n  return {condition: condition.condition || ''};\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport class AjfError extends Error {\n  stack: string;\n  get name(): string { return 'AjfError'; }\n  get message(): string { return this._message; }\n  // this private string is the error message\n  private _message: string;\n  /**\n   * this constructor will init the message error\n   */\n  constructor(message?: string) {\n    super(message);\n\n    // Set the prototype explicitly. Workaround needed in TS >= 2.1 when extending built-ins\n    // See: https://github.com/Microsoft/TypeScript-wiki/blob/master/Breaking-Changes.md\n    Object.setPrototypeOf(this, AjfError.prototype);\n\n    this._message = message || '';\n  }\n}\n"],"names":["tokenize","esprimaMod","((/** @type {?} */ (esprima))).default","vfuncs.dateUtils","vfuncs.getCoordinate","vfuncs.isoMonth","vfuncs.formatDate","vfuncs.formatNumber","vfuncs.alert","vfuncs.calculateAvgPropertyArray","vfuncs.calculateAvgProperty","vfuncs.calculateTrendByProperties","vfuncs.calculateTrendProperty","vfuncs.sumLastProperties","vfuncs.lastProperty","vfuncs.extractDates","vfuncs.drawThreshold","vfuncs.extractArraySum","vfuncs.extractSum","vfuncs.extractArray","vfuncs.round","vfuncs.dateOperations","vfuncs.sum","vfuncs.scanGroupField","vfuncs.valueInChoice","vfuncs.notEmpty","vfuncs.isInt","vfuncs.decimalCount","vfuncs.digitCount","((/** @type {?} */ (numeral))).default","((/** @type {?} */ (debug))).default","tslib_1.__extends"],"mappings":"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"}