{"version":3,"file":"reports.es5.js","sources":["../../../src/core/reports/utils/reports-instances/create-report-instance.ts","../../../src/core/reports/utils/reports-instances/create-report-container-instance.ts","../../../src/core/reports/utils/widgets-instances/widget-to-widget-instance.ts","../../../src/core/reports/utils/widgets-instances/create-widget-instance.ts","../../../src/core/reports/utils/aggregation/evaluate-aggregation.ts","../../../src/core/reports/widget.ts","../../../src/core/reports/serializers/report-serializer.ts","../../../src/core/reports/utils/reports/create-report.ts","../../../src/core/reports/serializers/report-container-serializer.ts","../../../src/core/reports/serializers/widget-serializer.ts","../../../src/core/reports/utils/widgets/create-widget.ts","../../../src/core/reports/serializers/dataset-serializer.ts","../../../src/core/reports/utils/dataset/create-dataset.ts","../../../src/core/reports/serializers/aggregation-serializer.ts","../../../src/core/reports/utils/aggregation/create-aggregation.ts","../../../src/core/reports/reports-module.ts","../../../src/core/reports/widget-host.ts","../../../src/core/reports/get-column-content.ts","../../../src/core/reports/report.ts","../../../src/core/reports/interface/widgets/widget-type.ts","../../../src/core/reports/interface/aggregation/aggregation-type.ts","../../../src/core/reports/chart-utils.ts","../../../src/core/reports/interface/charts/chart-type.ts","../../../src/core/reports/base-widget.ts"],"sourcesContent":["/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext, evaluateExpression} from '@ajf/core/models';\nimport {TranslateService} from '@ngx-translate/core';\n\nimport {AjfReportInstance} from '../../interface/reports-instances/report-instance';\nimport {AjfReport} from '../../interface/reports/report';\n\nimport {createReportContainerInstance} from './create-report-container-instance';\n\nexport function createReportInstance(\n    report: AjfReport, context: AjfContext, ts: TranslateService): AjfReportInstance {\n  (report.variables || []).forEach(variable => {\n    context[variable.name] = evaluateExpression(variable.formula.formula, context);\n  });\n  return {\n    report,\n    header: report.header ? createReportContainerInstance(report.header, context, ts) : undefined,\n    content: report.content ? createReportContainerInstance(report.content, context, ts) :\n                              undefined,\n    footer: report.footer ? createReportContainerInstance(report.footer, context, ts) : undefined,\n    styles: report.styles || {},\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext} from '@ajf/core/models';\nimport {TranslateService} from '@ngx-translate/core';\n\nimport {\n  AjfReportContainerInstance\n} from '../../interface/reports-instances/report-container-instance';\nimport {AjfReportContainer} from '../../interface/reports/report-container';\nimport {widgetToWidgetInstance} from '../widgets-instances/widget-to-widget-instance';\n\nexport function createReportContainerInstance(\n    container: AjfReportContainer, context: AjfContext,\n    ts: TranslateService): AjfReportContainerInstance {\n  const content = container.content.map(c => widgetToWidgetInstance(c, context, ts));\n  return {\n    container,\n    content,\n    styles: container.styles,\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext, AjfFormula, createFormula, evaluateExpression} from '@ajf/core/models';\nimport {deepCopy} from '@ajf/core/utils';\nimport {TranslateService} from '@ngx-translate/core';\n\nimport {chartToChartJsType} from '../../chart-utils';\nimport {AjfChartWidgetInstance} from '../../interface/widgets-instances/chart-widget-instance';\nimport {AjfFormulaWidgetInstance} from '../../interface/widgets-instances/formula-widget-instance';\nimport {\n  AjfImageContainerWidgetInstance\n} from '../../interface/widgets-instances/image-container-widget-instance';\nimport {AjfImageWidgetInstance} from '../../interface/widgets-instances/image-widget-instance';\nimport {AjfMapWidgetInstance} from '../../interface/widgets-instances/map-widget-instance';\nimport {AjfTableWidgetInstance} from '../../interface/widgets-instances/table-widget-instance';\nimport {AjfTextWidgetInstance} from '../../interface/widgets-instances/text-widget-instance';\nimport {AjfWidgetInstance} from '../../interface/widgets-instances/widget-instance';\nimport {\n  AjfWidgetWithContentInstance\n} from '../../interface/widgets-instances/widget-with-content-instance';\nimport {AjfChartWidget} from '../../interface/widgets/chart-widget';\nimport {AjfFormulaWidget} from '../../interface/widgets/formula-widget';\nimport {AjfImageContainerWidget} from '../../interface/widgets/image-container-widget';\nimport {AjfImageWidget} from '../../interface/widgets/image-widget';\nimport {AjfMapWidget} from '../../interface/widgets/map-widget';\nimport {AjfTableWidget} from '../../interface/widgets/table-widget';\nimport {AjfTextWidget} from '../../interface/widgets/text-widget';\nimport {AjfWidget} from '../../interface/widgets/widget';\nimport {AjfWidgetType} from '../../interface/widgets/widget-type';\nimport {AjfWidgetWithContent} from '../../interface/widgets/widget-with-content';\nimport {evaluateAggregation} from '../aggregation/evaluate-aggregation';\n\nimport {createWidgetInstance} from './create-widget-instance';\n\nexport function widgetToWidgetInstance(\n    widget: AjfWidget, context: AjfContext, ts: TranslateService): AjfWidgetInstance {\n  const wi = createWidgetInstance(widget, context, ts);\n  if (widget.widgetType === AjfWidgetType.Column || widget.widgetType === AjfWidgetType.Layout) {\n    const wwc = widget as AjfWidgetWithContent;\n    const wwci = wi as AjfWidgetWithContentInstance;\n    let content = [] as AjfWidgetInstance[];\n    wwc.content.forEach(c => {\n      if (wwc.repetitions != null) {\n        wwci.repetitions = evaluateExpression(wwc.repetitions.formula, context);\n        if (typeof wwci.repetitions === 'number' && wwci.repetitions > 0) {\n          for (let i = 0 ; i < wwci.repetitions ; i++) {\n            content.push(widgetToWidgetInstance(c, {...context, '$repetition': i}, ts));\n          }\n        }\n      } else {\n        content.push(widgetToWidgetInstance(c, context, ts));\n      }\n      wwci.content = content;\n    });\n  } else if (widget.widgetType === AjfWidgetType.Chart) {\n    const cw = widget as AjfChartWidget;\n    const cwi = wi as AjfChartWidgetInstance;\n    const labels = cw.labels instanceof Array ? cw.labels : [cw.labels];\n    const evLabels = labels.map(l => {\n      let evf = evaluateExpression(l.formula, context);\n      try {\n        if (evf instanceof Array) {\n          evf = evf.map(v => v != null && typeof v === 'string' && v.trim().length > 0\n            ? ts.instant(v) : v);\n        } else {\n          evf = evf != null && typeof evf === 'string' && evf.trim().length > 0\n            ? ts.instant(evf) : evf;\n        }\n      } catch (_e) {\n      }\n      return evf;\n    });\n    cwi.labels = cw.labels instanceof Array ? evLabels : evLabels[0];\n    cwi.datasets = cw.dataset.map(d => {\n      let ds: any = {\n        ...d.options || {},\n        data: evaluateAggregation(d.aggregation, d.formula, context),\n      };\n      if (d.chartType != null) {\n        const ct = chartToChartJsType(d.chartType);\n        ds = {...ds, chartType: ct, type: ct };\n      }\n      if (d.options != null) {\n        ds = {...ds, options: d.options};\n      }\n      if (d.label != null) {\n        ds = {...ds, label: d.label};\n      }\n      if (d.datalabels != null) {\n        ds.datalabels = deepCopy(d.datalabels);\n      }\n      return ds;\n    });\n    cwi.data = {labels: cwi.labels, datasets: cwi.datasets};\n    cwi.chartType = chartToChartJsType(cw.type || cw.chartType);\n  } else if (widget.widgetType === AjfWidgetType.Table) {\n    const tw = widget as AjfTableWidget;\n    const twi = wi as AjfTableWidgetInstance;\n    const trFormula = (f: AjfFormula) => {\n      let formula = f.formula;\n      if (formula.substr(0, 1) === '\"') {\n        const ft = formula.slice(1, -1);\n        const transFt = ft != null && typeof ft === 'string' && ft.trim().length > 0\n          ? ts.instant(ft) : ft;\n        if (ft.length > 0) {\n          formula = `\"${transFt}\"`;\n        }\n      } else {\n        formula = formula != null && typeof formula === 'string' && formula.trim().length > 0\n          ? ts.instant(formula) : formula;\n      }\n      return evaluateExpression(formula, context);\n    };\n    twi.dataset = tw.dataset.map(row => row.map(cell => {\n      return cell.formula instanceof Array ? cell.formula.map(f => trFormula(f as AjfFormula)) :\n                                             trFormula(cell.formula!);\n    }));\n    twi.data = (tw.dataset ||\n                []).map(row => row.map(cell => ({\n                                         value: evaluateExpression(cell.formula.formula, context),\n                                         style: {...tw.cellStyles, ...cell.style},\n                                         rowspan: cell.rowspan,\n                                         colspan: cell.colspan,\n                                       })));\n  } else if (widget.widgetType === AjfWidgetType.Image) {\n    const iw = widget as AjfImageWidget;\n    const iwi = wi as AjfImageWidgetInstance;\n    if (iw.flag) {\n      iwi.flag = evaluateExpression(iw.flag.formula, context);\n    }\n    if (iw.icon) {\n      iwi.icon = evaluateExpression(iw.icon.formula, context);\n    }\n    if (iw.url) {\n      iwi.url = evaluateExpression(iw.url.formula, context);\n    }\n  } else if (widget.widgetType === AjfWidgetType.ImageContainer) {\n    const icw = widget as AjfImageContainerWidget;\n    const icwi = wi as AjfImageContainerWidgetInstance;\n    if (icw.flags) {\n      const flags = icw.flags instanceof Array ? icw.flags : [icw.flags];\n      icwi.flags = flags.map(f => evaluateExpression(f.formula, context));\n    }\n    if (icw.icons) {\n      const icons = icw.icons instanceof Array ? icw.icons : [icw.icons];\n      icwi.icons = icons.map(f => evaluateExpression(f.formula, context));\n    }\n    if (icw.urls) {\n      const urls = icw.urls instanceof Array ? icw.urls : [icw.urls];\n      icwi.urls = urls.map(f => evaluateExpression(f.formula, context));\n    }\n  } else if (widget.widgetType === AjfWidgetType.Text) {\n    const tew = widget as AjfTextWidget;\n    const tewi = wi as AjfTextWidgetInstance;\n    const formulaRegEx: RegExp = /\\[{2}(.+?)\\]{2}/g;\n    const matches: {idx: number, len: number, formula: AjfFormula}[] = [];\n    let match: RegExpExecArray|null;\n    let htmlText = tew.htmlText;\n    while (match = formulaRegEx.exec(htmlText)) {\n      const idx = match.index;\n      const len = match[0].length;\n      const formula = createFormula({formula: match[1]});\n      matches.push({idx, len, formula});\n    }\n    matches.reverse().forEach((m) => {\n      let calcValue;\n      try {\n        calcValue = evaluateExpression(m.formula.formula, context);\n      } catch (e) {\n        calcValue = '';\n      }\n      htmlText = `${htmlText.substr(0, m.idx)}${calcValue}${htmlText.substr(m.idx + m.len)}`;\n    });\n    tewi.htmlText = htmlText != null && htmlText.length > 0 ? ts.instant(htmlText) : htmlText;\n  } else if (widget.widgetType === AjfWidgetType.Formula) {\n    const fw = widget as AjfFormulaWidget;\n    const fwi = wi as AjfFormulaWidgetInstance;\n    fwi.formula = evaluateExpression(fw.formula.formula, context);\n  } else if (widget.widgetType === AjfWidgetType.Map) {\n    const mw = widget as AjfMapWidget;\n    const mwi = wi as AjfMapWidgetInstance;\n    mwi.coordinate = evaluateExpression(mw.coordinate.formula, context);\n  }\n  return wi;\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext, evaluateExpression} from '@ajf/core/models';\nimport {TranslateService} from '@ngx-translate/core';\n\nimport {AjfWidgetInstance} from '../../interface/widgets-instances/widget-instance';\nimport {AjfWidget} from '../../interface/widgets/widget';\n\nexport function createWidgetInstance(\n    widget: AjfWidget, context: AjfContext, _ts: TranslateService): AjfWidgetInstance {\n  return {\n    widget,\n    widgetType: widget.widgetType,\n    visible: evaluateExpression(widget.visibility.condition, context),\n    styles: widget.styles || {},\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfContext, AjfFormula, evaluateExpression} from '@ajf/core/models';\nimport {AjfAggregation} from '../../interface/aggregation/aggregation';\nimport {AjfAggregationType} from '../../interface/aggregation/aggregation-type';\n\nexport function evaluateAggregation(\n    aggregation: AjfAggregation, formulas: AjfFormula[], context: AjfContext): number[] {\n  const data: any[] = formulas.map(f => evaluateExpression(f.formula, context));\n  switch (aggregation.aggregation) {\n    case AjfAggregationType.None:\n      if (data.length !== 1) {\n        throw new Error('Invalid aggregation');\n      }\n      return data[0];\n    case AjfAggregationType.Sum:\n      return data.map((r: any) => r.reduce((s: any, d: any) => s + d, 0));\n    case AjfAggregationType.Average:\n    case AjfAggregationType.WeightedAverage:\n      return data.map((r: any) => {\n        const sum = r.reduce((s: any, d: any) => s + d, 0);\n        return sum / data.length;\n      });\n    default:\n      return [];\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ComponentFactoryResolver, OnInit, Renderer2} from '@angular/core';\n\nimport {AjfWidgetInstance} from './interface/widgets-instances/widget-instance';\nimport {AjfWidgetComponentsMap} from './widget-components-map';\nimport {AjfWidgetHost} from './widget-host';\n\nexport abstract class AjfReportWidget implements OnInit {\n  widgetHost: AjfWidgetHost;\n\n  private _instance: AjfWidgetInstance;\n  get instance(): AjfWidgetInstance { return this._instance; }\n  set instance(instance: AjfWidgetInstance) {\n    if (this._instance !== instance) {\n      this._instance = instance;\n      if (this._init) {\n        this._loadComponent();\n      }\n    }\n  }\n\n  protected abstract widgetsMap: AjfWidgetComponentsMap;\n\n  private _init = false;\n\n  constructor(private _cfr: ComponentFactoryResolver, private _renderer: Renderer2) { }\n\n  ngOnInit(): void {\n    this._init = true;\n    this._loadComponent();\n  }\n\n  private _loadComponent(): void {\n    if (\n      !this._init || this._instance == null\n      || this.widgetHost == null || !this.instance.visible) {\n      return;\n    }\n\n    const vcr = this.widgetHost.viewContainerRef;\n    vcr.clear();\n    const componentDef = this.widgetsMap[this._instance.widget.widgetType];\n    if (componentDef == null) { return; }\n    const component = componentDef.component;\n    try {\n      const componentFactory = this._cfr.resolveComponentFactory(component);\n      const componentRef = vcr.createComponent(componentFactory);\n      const componentInstance = componentRef.instance;\n\n      Object.keys(this._instance.widget.styles).forEach((style: string) => {\n        try {\n          this._renderer.setStyle(\n            componentInstance.el.nativeElement,\n            style,\n            `${this._instance.widget.styles[style]}`\n          );\n        } catch (e) { }\n      });\n\n      componentInstance.instance = this._instance;\n      if (componentDef.inputs) {\n        Object.keys(componentDef.inputs).forEach(key => {\n          if (key in componentInstance) {\n            (componentInstance as any)[key] = componentDef.inputs![key];\n          }\n        });\n      }\n    } catch (e) { }\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfReport} from '../interface/reports/report';\nimport {AjfReportContainer} from '../interface/reports/report-container';\nimport {createReport} from '../utils/reports/create-report';\nimport {AjfReportContainerSerializer} from './report-container-serializer';\n\nexport class AjfReportSerializer {\n  static fromJson(json: Partial<AjfReport>): AjfReport {\n    const containers: (keyof AjfReport)[] = ['header', 'footer', 'content'];\n    containers.forEach(c => {\n      if (json[c]) {\n        (json[c] as AjfReportContainer) =\n            AjfReportContainerSerializer.fromJson(json[c] as Partial<AjfReportContainer>);\n      }\n    });\n    return createReport(json);\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfReport} from '../../interface/reports/report';\n\nexport type AjfReportCreate = Partial<AjfReport>;\n\nexport function createReport(report: AjfReportCreate): AjfReport {\n  return {...report};\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfReportContainer} from '../interface/reports/report-container';\nimport {AjfWidgetSerializer} from './widget-serializer';\n\nexport class AjfReportContainerSerializer {\n  static fromJson(json: Partial<AjfReportContainer>): AjfReportContainer {\n    json.content = (json.content || []).map(c => AjfWidgetSerializer.fromJson(c));\n    return {...json, content: json.content!, styles: json.styles || {}};\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfConditionSerializer, AjfFormulaSerializer, alwaysCondition} from '@ajf/core/models';\n\nimport {AjfChartDataset} from '../interface/dataset/chart-dataset';\nimport {AjfTableDataset} from '../interface/dataset/table-dataset';\nimport {AjfChartWidget} from '../interface/widgets/chart-widget';\nimport {AjfDataWidget} from '../interface/widgets/data-widget';\nimport {AjfMapWidget} from '../interface/widgets/map-widget';\nimport {AjfWidget} from '../interface/widgets/widget';\nimport {AjfWidgetType} from '../interface/widgets/widget-type';\nimport {AjfWidgetWithContent} from '../interface/widgets/widget-with-content';\nimport {createWidget} from '../utils/widgets/create-widget';\n\nimport {AjfDatasetSerializer} from './dataset-serializer';\n\nexport class AjfWidgetSerializer {\n  static fromJson(json: Partial<AjfWidget>): AjfWidget {\n    if (json.widgetType == null) {\n      throw new Error('Malformed widget');\n    }\n    json.visibility =\n        json.visibility ? AjfConditionSerializer.fromJson(json.visibility) : alwaysCondition();\n    json.styles = json.styles || {};\n    const obj = json as AjfWidget;\n    if (obj.widgetType === AjfWidgetType.Layout || obj.widgetType === AjfWidgetType.Column) {\n      return AjfWidgetSerializer._widgetWithContentFromJson(obj);\n    }\n    if (obj.widgetType === AjfWidgetType.Chart || obj.widgetType === AjfWidgetType.Table) {\n      const w = AjfWidgetSerializer._dataWidgetFromJson(obj);\n      if (obj.widgetType === AjfWidgetType.Chart) {\n        const cw = w as AjfChartWidget;\n        if (cw.labels instanceof Array) {\n          cw.labels.map(l => AjfFormulaSerializer.fromJson(l));\n        } else if (cw.labels != null) {\n          cw.labels = AjfFormulaSerializer.fromJson(cw.labels);\n        }\n      }\n      return w;\n    }\n    if (obj.widgetType === AjfWidgetType.Map) {\n      const mw = obj as AjfMapWidget;\n      mw.coordinate = AjfFormulaSerializer.fromJson(mw.coordinate);\n    }\n    return obj;\n  }\n\n  private static _dataWidgetFromJson(json: AjfWidget&Partial<AjfDataWidget>): AjfDataWidget {\n    const dataset = json.dataset ?\n        (json.widgetType === AjfWidgetType.Table ?\n             (json.dataset as AjfTableDataset[][])\n                 .map(row => row.map(cell => AjfDatasetSerializer.fromJson(cell))) :\n             (json.dataset as AjfChartDataset[]).map(d => AjfDatasetSerializer.fromJson(d))) :\n        [];\n    return {...createWidget(json), dataset};\n  }\n\n  private static _widgetWithContentFromJson(json: AjfWidget&\n                                           Partial<AjfWidgetWithContent>): AjfWidgetWithContent {\n    const content = (json.content || []).map(c => AjfWidgetSerializer.fromJson(c));\n    return {...createWidget(json), content};\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {alwaysCondition} from '@ajf/core/models';\nimport {AjfWidget} from '../../interface/widgets/widget';\n\nexport type AjfWidgetCreate = Pick<AjfWidget, 'widgetType'>&Partial<AjfWidget>;\n\nexport function createWidget(widget: AjfWidgetCreate): AjfWidget {\n  return {\n    ...widget,\n    styles: widget.styles || {},\n    visibility: widget.visibility || alwaysCondition(),\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfFormulaSerializer} from '@ajf/core/models';\n\nimport {AjfDataset} from '../interface/dataset/dataset';\nimport {createDataset} from '../utils/dataset/create-dataset';\n\nimport {AjfAggregationSerializer} from './aggregation-serializer';\n\nexport class AjfDatasetSerializer {\n  static fromJson(json: Partial<AjfDataset>): AjfDataset {\n    if (json.formula == null || json.aggregation == null || json.label == null) {\n      throw new Error('Malformed dataset');\n    }\n    json.formula = json.formula instanceof Array ?\n        json.formula = json.formula.map(f => AjfFormulaSerializer.fromJson(f)) :\n        AjfFormulaSerializer.fromJson(json.formula);\n    json.aggregation = AjfAggregationSerializer.fromJson(json.aggregation);\n    return createDataset(json);\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfAggregationType} from '../../interface/aggregation/aggregation-type';\nimport {AjfDataset} from '../../interface/dataset/dataset';\nimport {createAggregation} from '../aggregation/create-aggregation';\n\nexport function createDataset(dataset: Partial<AjfDataset>): AjfDataset {\n  return {\n    ...dataset,\n    aggregation: dataset.aggregation || createAggregation({aggregation: AjfAggregationType.None}),\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfAggregation} from '../interface/aggregation/aggregation';\nimport {createAggregation} from '../utils/aggregation/create-aggregation';\n\nexport class AjfAggregationSerializer {\n  static fromJson(json: Partial<AjfAggregation>): AjfAggregation {\n    if (json.aggregation == null) {\n      throw new Error('Malformed aggregation');\n    }\n    return createAggregation({...json, aggregation: json.aggregation});\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {AjfAggregation} from '../../interface/aggregation/aggregation';\nimport {AjfAggregationType} from '../../interface/aggregation/aggregation-type';\n\nexport type AjfAggregationCreate = Partial<AjfAggregation>;\n\nexport function createAggregation(aggregation: AjfAggregationCreate): AjfAggregation {\n  return {\n    ...aggregation,\n    aggregation: aggregation.aggregation || AjfAggregationType.None,\n  };\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {NgModule} from '@angular/core';\n\nimport {AjfGetColumnContentPipe} from './get-column-content';\nimport {AjfWidgetHost} from './widget-host';\n\n@NgModule({\n  declarations: [\n    AjfGetColumnContentPipe,\n    AjfWidgetHost,\n  ],\n  exports: [\n    AjfGetColumnContentPipe,\n    AjfWidgetHost,\n  ],\n})\nexport class AjfReportsModule {\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Directive, ViewContainerRef} from '@angular/core';\n\n@Directive({selector: '[ajf-widget-host]'})\nexport class AjfWidgetHost {\n  constructor(readonly viewContainerRef: ViewContainerRef) { }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Pipe} from '@angular/core';\nimport {AjfLayoutWidgetInstance} from './interface/widgets-instances/layout-widget-instance';\nimport {AjfWidgetInstance} from './interface/widgets-instances/widget-instance';\n\n@Pipe({name: 'ajfGetColumnContent'})\nexport class AjfGetColumnContentPipe {\n  transform(instance: AjfLayoutWidgetInstance, column: number): AjfWidgetInstance|null {\n    return column >= 0 && column < instance.content.length ? instance.content[column] : null;\n  }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ChangeDetectorRef} from '@angular/core';\n\nimport {AjfReportInstance} from './interface/reports-instances/report-instance';\nimport {AjfReport} from './interface/reports/report';\n\nexport abstract class AjfReportRenderer {\n  private _instance: AjfReportInstance;\n  get instance(): AjfReportInstance { return this._instance; }\n  set instance(instance: AjfReportInstance) {\n    this._instance = instance;\n    this._report = instance != null ? instance.report : null;\n    this._cdr.markForCheck();\n  }\n\n  private _report: AjfReport | null;\n  get report(): AjfReport | null {\n    return this._report;\n  }\n\n  constructor(private _cdr: ChangeDetectorRef) { }\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum AjfWidgetType {\n  Layout,\n  PageBreak,\n  Image,\n  Text,\n  Chart,\n  Table,\n  Map,\n  Column,\n  Formula,\n  ImageContainer,\n  LENGTH\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum AjfAggregationType {\n  None,\n  Sum,\n  Average,\n  WeightedAverage,\n  LENGTH\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ExtendedChartType} from '@ajf/core/chart';\nimport {AjfChartType} from './interface/charts/chart-type';\n\nexport function chartToChartJsType(chartType?: AjfChartType): ExtendedChartType {\n    switch (chartType) {\n      case AjfChartType.Line:\n      return 'line';\n      case AjfChartType.Bar:\n      return 'bar';\n      case AjfChartType.HorizontalBar:\n      return 'horizontalBar';\n      case AjfChartType.Radar:\n      return 'radar';\n      case AjfChartType.Scatter:\n      return 'scatter';\n      case AjfChartType.Doughnut:\n      return 'doughnut';\n      case AjfChartType.Pie:\n      return 'pie';\n      case AjfChartType.PolarArea:\n      return 'polarArea';\n      case AjfChartType.Bubble:\n      return 'bubble';\n      default:\n      return 'line';\n    }\n  }\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport enum AjfChartType {\n  Line,\n  Bar,\n  HorizontalBar,\n  Radar,\n  Scatter,\n  Doughnut,\n  Pie,\n  PolarArea,\n  Bubble,\n  LENGTH\n}\n","/**\n * @license\n * Copyright (C) 2018 Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {ChangeDetectorRef, ElementRef} from '@angular/core';\nimport {AjfWidgetInstance} from './interface/widgets-instances/widget-instance';\n\nexport abstract class AjfBaseWidgetComponent<T extends AjfWidgetInstance = AjfWidgetInstance> {\n  private _instance: T;\n  get instance(): T { return this._instance; }\n  set instance(instance: T) {\n    if (this._instance !== instance) {\n      this._instance = instance;\n      this._cdr.detectChanges();\n    }\n  }\n\n  constructor(private _cdr: ChangeDetectorRef, readonly el: ElementRef) { }\n}\n"],"names":["tslib_1.__assign"],"mappings":"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"}