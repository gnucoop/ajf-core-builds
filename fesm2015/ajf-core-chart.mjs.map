{"version":3,"file":"ajf-core-chart.mjs","sources":["../../../projects/core/chart/src/register-chart-plugins.ts","../../../projects/core/chart/src/chart.ts","../../../projects/core/chart/src/chart.html","../../../projects/core/chart/src/chart-module.ts","../../../projects/core/chart/src/public_api.ts","../../../projects/core/chart/src/ajf-core-chart.ts"],"sourcesContent":["/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Chart} from 'chart.js';\n\nexport function registerChartPlugins(plugins: any[]) {\n  if (plugins != null && plugins.length > 0) {\n    plugins.forEach(plugin => Chart.plugins.register(plugin));\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {deepCopy} from '@ajf/core/utils';\nimport {\n  AfterViewInit,\n  ChangeDetectionStrategy,\n  Component,\n  ElementRef,\n  Input,\n  OnChanges,\n  Renderer2,\n  SimpleChanges,\n  ViewEncapsulation,\n} from '@angular/core';\nimport * as chartJs from 'chart.js';\n// tslint:disable-next-line:no-duplicate-imports\nimport {\n  ChartData,\n  ChartLegendLabelItem,\n  ChartOptions,\n  ChartPoint,\n  ChartSize,\n  ChartTooltipItem,\n  ChartTooltipModel,\n} from 'chart.js';\n\nimport {ExtendedChartType} from './extended-chart-type';\n\nconst {Chart} = ((chartJs as any).default || chartJs) as typeof chartJs;\n\n// We only need to set canvasDataUrl of the AjfChartWidgetInstance here,\n// avoid importing the actual interface because of the circular dependency:\ninterface ChartWidgetInstance {\n  canvasDataUrl?(): string;\n}\n\n@Component({\n  selector: 'ajf-chart',\n  templateUrl: 'chart.html',\n  styleUrls: ['chart.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n})\nexport class AjfChartComponent implements AfterViewInit, OnChanges {\n  @Input() data?: ChartData;\n  @Input() options?: ChartOptions;\n  @Input() chartType?: ExtendedChartType;\n  @Input() instance?: ChartWidgetInstance;\n\n  private _chart: Chart | null = null;\n  private _chartCanvasElement: HTMLCanvasElement | null = null;\n  private _chartTypesNeedPoints: ExtendedChartType[] = ['scatter', 'bubble'];\n\n  constructor(private _el: ElementRef, private _renderer: Renderer2) {}\n\n  ngAfterViewInit(): void {\n    this._rebuildChart();\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if ('chartType' in changes) {\n      this._rebuildChart();\n    } else if ('options' in changes || 'data' in changes) {\n      this._updateChart();\n    }\n    if ('instance' in changes && this.instance != null) {\n      this.instance.canvasDataUrl = () => {\n        if (this._chartCanvasElement == null) {\n          return '';\n        }\n        return this._chartCanvasElement.toDataURL();\n      };\n    }\n  }\n\n  private _fixData(chartType: ExtendedChartType, data: ChartData): ChartData {\n    const newData: ChartData = deepCopy(data);\n    let maxPointsNum = 0;\n    (newData.datasets || []).forEach(dataset => {\n      if (dataset.label == null) {\n        dataset.label = '';\n      }\n      maxPointsNum = Math.max(maxPointsNum, (dataset.data || []).length);\n      const datasetType = dataset.type != null ? <ExtendedChartType>dataset.type : chartType;\n      if (this._chartTypesNeedPoints.indexOf(datasetType) > -1) {\n        dataset.data = (<any[]>(dataset.data || [])).map((d, idx) => {\n          if (typeof d === 'number') {\n            return <any>{x: idx, y: d, r: d};\n          }\n          return <ChartPoint>d;\n        });\n      }\n    });\n    const labels = newData.labels || [];\n    if (maxPointsNum > 0 && labels.length < maxPointsNum) {\n      for (let i = labels.length; i < maxPointsNum; i++) {\n        labels.push('');\n      }\n      newData.labels = labels;\n    }\n    return newData;\n  }\n\n  private _updateChart(): void {\n    if (this._chart == null) {\n      this._rebuildChart();\n    } else {\n      (<any>this._chart).options = {\n        ...deepCopy((<any>this._chart).options),\n        ...deepCopy(this.options || {}),\n      };\n      this._chart.data = {\n        ...deepCopy(this._chart.data),\n        ...deepCopy(this.data),\n      };\n      this._chart.update();\n    }\n  }\n\n  private _rebuildChart(): void {\n    if (this._chart != null) {\n      this._chart.destroy();\n      this._chart = null;\n    }\n    if (this._chartCanvasElement != null) {\n      this._chartCanvasElement.remove();\n      this._chartCanvasElement = null;\n    }\n    if (this.data != null) {\n      this._chartCanvasElement = this._renderer.createElement('canvas');\n      const widgetExportElement: HTMLElement = this._el.nativeElement.parentElement.parentElement;\n      const height = widgetExportElement.clientHeight;\n      const width = widgetExportElement.clientWidth;\n      if (widgetExportElement != null) {\n        if (height > 0) {\n          this._renderer.setStyle(this._el.nativeElement, 'height', `${height}px`);\n          this._renderer.setStyle(this._chartCanvasElement, 'height', `${height}px`);\n        }\n        if (width > 0) {\n          this._renderer.setStyle(this._chartCanvasElement, 'width', width);\n        }\n      } else {\n        this._renderer.setStyle(this._chartCanvasElement, 'width', 'inherit');\n        this._renderer.setStyle(this._chartCanvasElement, 'height', 'inherit');\n      }\n      this._renderer.appendChild(this._el.nativeElement, this._chartCanvasElement);\n      if (this.chartType != null) {\n        const ctx = this._chartCanvasElement!.getContext('2d') as CanvasRenderingContext2D;\n        this._chart = new Chart(ctx, {\n          type: this.chartType,\n          data: this._fixData(this.chartType, this.data),\n          options: this._fixChartOptions(this.options),\n        });\n      }\n    }\n  }\n\n  private _fixChartOptions(chartOptions: ChartOptions | undefined): ChartOptions {\n    const options = deepCopy(chartOptions || {}) || {};\n    if (options.legendCallback) {\n      const legendCallback = (\n        typeof options.legendCallback === 'string'\n          ? new Function(options.legendCallback)\n          : options.legendCallback\n      ) as (chart: Chart) => string;\n      options.legendCallback = legendCallback;\n    }\n    if (options.onHover) {\n      const onHover = (\n        typeof options.onHover === 'string' ? new Function(options.onHover) : options.onHover\n      ) as (this: Chart, event: MouseEvent, activeElements: {}[]) => any;\n      options.onHover = onHover;\n    }\n    if (options.onClick) {\n      const onClick = (\n        typeof options.onClick === 'string' ? new Function(options.onClick) : options.onClick\n      ) as (event?: MouseEvent, activeElements?: {}[]) => any;\n      options.onClick = onClick;\n    }\n    if (options.onResize) {\n      const onResize = (\n        typeof options.onResize === 'string' ? new Function(options.onResize) : options.onResize\n      ) as (this: Chart, newSize: ChartSize) => void;\n      options.onResize = onResize;\n    }\n    if (options.legend) {\n      const legend = options.legend;\n      if (legend.onClick) {\n        const onClick = (\n          typeof legend.onClick === 'string' ? new Function(legend.onClick) : legend.onClick\n        ) as (event: MouseEvent, legendItem: ChartLegendLabelItem) => void;\n        legend.onClick = onClick;\n      }\n      if (legend.onHover) {\n        const onHover = (\n          typeof legend.onHover === 'string' ? new Function(legend.onHover) : legend.onHover\n        ) as (event: MouseEvent, legendItem: ChartLegendLabelItem) => void;\n        legend.onHover = onHover;\n      }\n      if (legend.onLeave) {\n        const onLeave = (\n          typeof legend.onLeave === 'string' ? new Function(legend.onLeave) : legend.onLeave\n        ) as (event: MouseEvent, legendItem: ChartLegendLabelItem) => void;\n        legend.onLeave = onLeave;\n      }\n      if (legend.labels) {\n        const labels = legend.labels;\n        if (labels.generateLabels) {\n          const generateLabels = (\n            typeof labels.generateLabels === 'string'\n              ? new Function(labels.generateLabels)\n              : labels.generateLabels\n          ) as (chart: Chart) => ChartLegendLabelItem[];\n          labels.generateLabels = generateLabels;\n        }\n        if (labels.filter) {\n          const filter = (\n            typeof labels.filter === 'string' ? new Function(labels.filter) : labels.filter\n          ) as (legendItem: ChartLegendLabelItem, data: ChartData) => any;\n          labels.filter = filter;\n        }\n      }\n    }\n    if (options.tooltips) {\n      const tooltips = options.tooltips;\n      if (tooltips.custom) {\n        const custom = (\n          typeof tooltips.custom === 'string' ? new Function(tooltips.custom) : tooltips.custom\n        ) as (tooltipModel: ChartTooltipModel) => void;\n        tooltips.custom = custom;\n      }\n      if (tooltips.callbacks) {\n        const callbacks = tooltips.callbacks;\n        for (const key in callbacks) {\n          const callback = (callbacks as any)[key] as (\n            item: ChartTooltipItem[],\n            data: ChartData,\n          ) => string | string[];\n          (callbacks as any)[key] =\n            typeof callback === 'string' ? new Function(callback) : callback;\n        }\n      }\n      if (tooltips.filter) {\n        type FilterFn = (item: ChartTooltipItem, data: ChartData) => boolean;\n        const filter = (\n          typeof tooltips.filter === 'string' ? new Function(tooltips.filter) : tooltips.filter\n        ) as FilterFn;\n        tooltips.filter = filter;\n      }\n      if (tooltips.itemSort) {\n        type SortFn = (\n          itemA: ChartTooltipItem,\n          itemB: ChartTooltipItem,\n          data?: ChartData,\n        ) => number;\n        const itemSort = (\n          typeof tooltips.itemSort === 'string'\n            ? new Function(tooltips.itemSort)\n            : tooltips.itemSort\n        ) as SortFn;\n        tooltips.itemSort = itemSort;\n      }\n    }\n    if (options.hover) {\n      const hover = options.hover;\n      if (hover.onHover) {\n        const onHover = (\n          typeof hover.onHover === 'string' ? new Function(hover.onHover) : hover.onHover\n        ) as (this: Chart, event: MouseEvent, activeElements: {}[]) => any;\n        hover.onHover = onHover;\n      }\n    }\n    if (options.animation) {\n      const animation = options.animation;\n      if (animation.onProgress) {\n        const onProgress = (\n          typeof animation.onProgress === 'string'\n            ? new Function(animation.onProgress)\n            : animation.onProgress\n        ) as (chart: any) => void;\n        animation.onProgress = onProgress;\n      }\n      if (animation.onComplete) {\n        const onComplete = (\n          typeof animation.onComplete === 'string'\n            ? new Function(animation.onComplete)\n            : animation.onComplete\n        ) as (chart: any) => void;\n        animation.onComplete = onComplete;\n      }\n    }\n    if (options.scales == null) {\n      options.scales = {xAxes: [], yAxes: []};\n    }\n    if (options.scales.xAxes == null) {\n      options.scales.xAxes = [];\n    }\n    if (options.scales.yAxes == null) {\n      options.scales.yAxes = [];\n    }\n    options.scales.yAxes.forEach((yAxe: any) => {\n      if (yAxe.ticks && yAxe.ticks.callback) {\n        const callback = (\n          typeof yAxe.ticks.callback === 'string'\n            ? new Function(yAxe.ticks.callback)\n            : yAxe.ticks.callback\n        ) as (value: any, index: any, values: any) => string | number;\n        yAxe.ticks.callback = callback;\n      }\n    });\n    options.scales.xAxes.forEach((xAxe: any) => {\n      if (xAxe.ticks && xAxe.ticks.callback) {\n        const callback = (\n          typeof xAxe.ticks.callback === 'string'\n            ? new Function(xAxe.ticks.callback)\n            : xAxe.ticks.callback\n        ) as (value: any, index: any, values: any) => string | number;\n        xAxe.ticks.callback = callback;\n      }\n    });\n    if (this.chartType == 'pie') {\n      let newOptions = deepCopy(options);\n      newOptions.pieceLabel = {\n        ...{\n          render: function (args: any) {\n            if (args.label) {\n              return args.label + ':' + args.value;\n            } else {\n              return args.value;\n            }\n          },\n          ...newOptions.pieceLabel,\n        },\n        position: 'outside',\n      };\n      return newOptions;\n    }\n    return options;\n  }\n}\n","","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {NgModule} from '@angular/core';\n\nimport {AjfChartComponent} from './chart';\n\n@NgModule({\n  declarations: [AjfChartComponent],\n  exports: [AjfChartComponent],\n})\nexport class AjfChartModule {}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nexport * from './extended-chart-type';\nexport * from './register-chart-plugins';\nexport * from './chart';\nexport * from './chart-module';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":["Chart"],"mappings":"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"}