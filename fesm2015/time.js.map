{"version":3,"file":"time.js","sources":["../../../../../../src/core/time/time-model.ts","../../../../../../src/core/time/time.ts","../../../../../../src/core/time/index.ts"],"sourcesContent":["/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {EventEmitter} from '@angular/core';\nimport {Observable} from 'rxjs';\n\nexport class AjfTimeModel {\n  private _changed: EventEmitter<string> = new EventEmitter<string>();\n  readonly changed: Observable<string> = this._changed.asObservable();\n\n  private _hours = 0;\n  private _minutes = 0;\n\n  get minutes() {\n    return this._minutes;\n  }\n  set minutes(value: number) {\n    if (value > -1 && value < 61) {\n      this._minutes = value;\n      this._changed.emit(this.toString());\n    }\n  }\n\n  get hours() {\n    return this._hours;\n  }\n  set hours(value: number) {\n    if (value > -1 && value < 24) {\n      this._hours = value;\n      this._changed.emit(this.toString());\n    }\n  }\n\n  toString() {\n    let minutes = this.minutes.toString().length > 1 && this.minutes || `0${this.minutes}`;\n    let hours = this.hours.toString().length > 1 && this.hours || `0${this.hours}`;\n    return `${hours}:${minutes}`;\n  }\n\n  fromString(value: string) {\n    try {\n      let splitted = value.split(':');\n      if (splitted.length == 2) {\n        this.hours = parseInt(splitted[0]);\n        this.minutes = parseInt(splitted[1]);\n      }\n    } catch (e) {\n    }\n  }\n}\n","/**\n * @license\n * Copyright (C) Gnucoop soc. coop.\n *\n * This file is part of the Advanced JSON forms (ajf).\n *\n * Advanced JSON forms (ajf) is free software: you can redistribute it and/or\n * modify it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * Advanced JSON forms (ajf) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero\n * General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with Advanced JSON forms (ajf).\n * If not, see http://www.gnu.org/licenses/.\n *\n */\n\nimport {Directive, Input, OnDestroy} from '@angular/core';\nimport {ControlValueAccessor} from '@angular/forms';\nimport {Subscription} from 'rxjs';\n\nimport {AjfTimeModel} from './time-model';\n\n@Directive()\nexport abstract class AjfTime implements ControlValueAccessor, OnDestroy {\n  @Input() readonly: boolean;\n\n  get time(): AjfTimeModel {\n    return this._value;\n  }\n\n  private _value: AjfTimeModel = new AjfTimeModel();\n  get value(): string {\n    return this._value.toString();\n  }\n\n  set value(value: string) {\n    if (value !== this._value.toString()) {\n      this._value.fromString(value);\n      this._onChangeCallback(value);\n    }\n  }\n\n  get hours(): number {\n    return this._value.hours;\n  }\n  set hours(hours: number) {\n    this._value.hours = hours;\n    this._onChangeCallback(this._value.toString());\n  }\n\n  get minutes(): number {\n    return this._value.minutes;\n  }\n  set minutes(minutes: number) {\n    this._value.minutes = minutes;\n    this._onChangeCallback(this._value.toString());\n  }\n\n  private _onChangeCallback: (_: any) => void = (_: any) => {};\n  private _onTouchedCallback: () => void = () => {};\n  private _valueChangeSub: Subscription = Subscription.EMPTY;\n\n  constructor() {\n    this._valueChangeSub = this._value.changed.subscribe((x: string) => {\n      this._onChangeCallback(x);\n    });\n  }\n\n  ngOnDestroy(): void {\n    this._valueChangeSub.unsubscribe();\n  }\n\n  writeValue(value: string) {\n    this._value.fromString(value);\n  }\n\n  registerOnChange(fn: (value: any) => void) {\n    this._onChangeCallback = fn;\n  }\n\n  registerOnTouched(fn: any) {\n    this._onTouchedCallback = fn;\n  }\n\n  focusHandler(): void {\n    this._onTouchedCallback();\n  }\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}